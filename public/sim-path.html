<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Path Traversal Simulation</title>
    <!-- [KR] ì„¤ì • íŒŒì¼ ë¡œë“œ / [EN] Load configuration file -->
    <script src="config.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; max-width: 800px; margin: 0 auto;}
        .container { display: flex; gap: 20px; }
        .box { flex: 1; border: 1px solid #ddd; padding: 20px; border-radius: 8px; }
        .vuln { background-color: #ffe6e6; }
        .secure { background-color: #e6fffa; }
        input { width: 100%; padding: 8px; margin: 10px 0; box-sizing: border-box; }
        button { padding: 8px 16px; cursor: pointer; }
        
        /* ì½”ë“œ ê°€ì´ë“œ ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .code-section { margin-top: 40px; border-top: 2px solid #eee; padding-top: 20px; }
        details { background: #f9f9f9; margin-bottom: 10px; border-radius: 5px; border: 1px solid #ddd; }
        summary { padding: 10px; cursor: pointer; font-weight: bold; }
        pre { background: #333; color: #fff; padding: 15px; overflow-x: auto; }
        .comment { color: #999; }
    </style>
</head>
<body>
    <a href="index.html">â† Main Menu</a>
    <h1>ğŸ“ ê²½ë¡œ ì¡°ì‘ ë° ìì› ì‚½ì… (Path Traversal)</h1>

    <div style="background:#f4f7f9; padding:15px; margin-bottom:20px; border-left:5px solid #007bff;">
        <h3>ğŸ“˜ ì·¨ì•½ì  ê°œìš” (Overview)</h3>
        <p><strong>[KR]</strong> ê²€ì¦ë˜ì§€ ì•Šì€ ì™¸ë¶€ ì…ë ¥ê°’ìœ¼ë¡œ íŒŒì¼ ê²½ë¡œë¥¼ ì¡°ì‘í•˜ì—¬, ì‹œìŠ¤í…œì˜ ë¯¼ê°í•œ íŒŒì¼(ì˜ˆ: /etc/passwd)ì— ë¬´ë‹¨ìœ¼ë¡œ ì ‘ê·¼í•˜ëŠ” ê³µê²©ì…ë‹ˆë‹¤.</p>
        <p><strong>[EN]</strong> An attack where an attacker manipulates file paths using unvalidated input to access sensitive system files (e.g., /etc/passwd).</p>
    </div>
    
    <div class="container">
        <!-- ì·¨ì•½í•œ ëª¨ë“œ (Vulnerable) -->
        <div class="box vuln">
            <h2>ğŸš« ì·¨ì•½í•œ ëª¨ë“œ (Vulnerable)</h2>
            <p>[KR] ê³µê²©: <code>../</code>ë¥¼ ì‚¬ìš©í•´ ìƒìœ„ í´ë” ì ‘ê·¼</p>
            <p>[EN] Attack: Use <code>../</code> to access parent dir</p>
            <input type="text" id="vulnInput" value="../../../etc/passwd">
            <button onclick="runTest('vulnerablePath', 'vulnInput')">Run Attack</button>
        </div>

        <!-- ì•ˆì „í•œ ëª¨ë“œ (Secure) -->
        <div class="box secure">
            <h2>âœ… ì•ˆì „í•œ ëª¨ë“œ (Secure)</h2>
            <p>[KR] ë°©ì–´: ê²½ë¡œ ì´ë™ ë¬¸ì ì œê±° í•„í„°ë§</p>
            <p>[EN] Defense: Filter path traversal chars</p>
            <input type="text" id="secureInput" value="../../../etc/passwd">
            <button onclick="runTest('securePath', 'secureInput')">Run Secure</button>
        </div>
    </div>

    <!-- í•˜ë‹¨ ì½”ë“œ ì˜ˆì œ ì„¹ì…˜ -->
    <div class="code-section">
        <h2>ğŸ“š ì–¸ì–´ë³„ ì‹œíì–´ ì½”ë”© ê°€ì´ë“œ (Secure Coding Guide)</h2>
        
        <!-- Python ì˜ˆì œ -->
        <details>
            <summary>ğŸ Python (Django/Flask)</summary>
            <pre><code><span class="comment"># [KR] ì™¸ë¶€ ì…ë ¥ê°’ì—ì„œ ê²½ë¡œ ì¡°ì‘ ë¬¸ìì—´(/, \, .. ë“±)ì„ ì œê±°í•´ì•¼ í•œë‹¤.</span>
<span class="comment"># [EN] External input must be filtered to remove directory traversal sequences.</span>

import os

def get_info(request):
    filename = request.POST.get('request_file')
    
    <span class="comment"># âŒ ì·¨ì•½ (Vulnerable): ì…ë ¥ê°’ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš© (Use input as is)</span>
    <span class="comment"># with open(filename) as f: ...</span>

    <span class="comment"># âœ… ì•ˆì „ (Secure): replace() ë˜ëŠ” os.path.basename() ì‚¬ìš©</span>
    filename = filename.replace("..", "").replace("/", "").replace("\\", "")
    # OR
    filename = os.path.basename(filename)
    
    if filename:
        with open(filename, "r") as f: ...</code></pre>
        </details>

        <!-- Java ì˜ˆì œ -->
        <details>
            <summary>â˜• Java (JSP/Servlet)</summary>
            <pre><code><span class="comment">// [KR] ì™¸ë¶€ ì…ë ¥ê°’ì— ëŒ€í•˜ì—¬ ê²½ë¡œìˆœíšŒ ë¬¸ìì—´(/, \, &, .. ë“±)ì„ ì œê±°í•œë‹¤.</span>
<span class="comment">// [EN] Remove path traversal characters from external input.</span>

String fileName = request.getParameter("P");

<span class="comment">// âŒ ì·¨ì•½ (Vulnerable)</span>
<span class="comment">// fis = new FileInputStream("C:/datas/" + fileName);</span>

<span class="comment">// âœ… ì•ˆì „ (Secure): replaceAll() ì‚¬ìš©</span>
if (fileName != null) {
    fileName = fileName.replaceAll("\\.\\.", "").replaceAll("/", "").replaceAll("\\\\", "");
}

File f = new File("C:/datas/" + fileName);</code></pre>
        </details>
    </div>

    <script>
        function runTest(funcName, inputId) {
            const inputVal = document.getElementById(inputId).value;
            // ê²½ë¡œ ì¡°ì‘ ë¬¸ì(../)ê°€ URL íŒŒë¼ë¯¸í„°ë¡œ ì˜ ì „ë‹¬ë˜ë„ë¡ ì¸ì½”ë”©
            const encodedInput = encodeURIComponent(inputVal);
            // config.jsì˜ BASE_URL ì‚¬ìš©
            const url = `${BASE_URL}/${funcName}?file=${encodedInput}`;
            window.open(url, '_blank');
        }
    </script>
</body>
</html>