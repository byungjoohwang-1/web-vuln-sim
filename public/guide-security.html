<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2-2. 보안 기능 가이드</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <style>
        /* CSS 스타일은 이전 페이지들과 동일하게 유지 */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; overflow-x: hidden; background-color: #f8f9fa; }
        #wrapper { display: flex; width: 100%; height: 100vh; }
        #sidebar-wrapper { min-height: 100vh; width: 280px; background-color: #0f172a; color: #94a3b8; flex-shrink: 0; display: flex; flex-direction: column; }
        .sidebar-brand, .menu-category { padding: 1.5rem 1.25rem; border-bottom: 1px solid #1e293b; }
        .list-group-item.active { background-color: #1e293b; color: #fff; }
        #page-content-wrapper { width: 100%; overflow-y: auto; background-color: #fff; }
        .code-block-header { background-color: #1e293b; color: #fff; padding: 0.5rem 1rem; font-weight: bold; border-radius: 0.25rem 0.25rem 0 0; display: flex; justify-content: space-between; align-items: center; }
        pre[class*="language-"] { margin: 0; border-radius: 0 0 0.25rem 0.25rem; white-space: pre-wrap; word-break: break-all; }
        .code-container { margin-bottom: 30px; }
    </style>
</head>
<body>

<div id="wrapper">
    <div id="sidebar-wrapper">
        <div class="sidebar-brand">
            <i class="fa-solid fa-cube me-2"></i> Web Security Simulator
            <small>V0.2 BETA | MADE BY JACK</small>
        </div>

        <div class="list-group list-group-flush mt-2">
            <div class="menu-category" data-bs-toggle="collapse" data-bs-target="#menu1"><span><i class="fa-solid fa-bug text-danger me-2"></i> 1. Simulator (10 Attacks)</span><i class="fa-solid fa-chevron-down fa-xs"></i></div>
            <div class="collapse show" id="menu1">
                <a href="sim-sql.html" class="list-group-item list-group-item-action"> SQL Injection</a>
                <a href="sim-cmd.html" class="list-group-item list-group-item-action"> Command Injection</a>
                <a href="sim-xxe.html" class="list-group-item list-group-item-action"> XXE Injection</a>
                <a href="sim-xss.html" class="list-group-item list-group-item-action"> Reflected XSS</a>
                <a href="sim-csrf.html" class="list-group-item list-group-item-action"> CSRF Attack</a>
                <a href="sim-ssrf.html" class="list-group-item list-group-item-action"> SSRF</a>
                <a href="sim-upload.html" class="list-group-item list-group-item-action"> File Upload</a>
                <a href="sim-path.html" class="list-group-item list-group-item-action"> Path Traversal</a>
                <a href="sim-split.html" class="list-group-item list-group-item-action"> HTTP Splitting</a>
                <a href="sim-brute.html" class="list-group-item list-group-item-action"> Brute Force</a>
                <a href="sim-idor.html" class="list-group-item list-group-item-action"> IDOR</a>
                <a href="sim-code.html" class="list-group-item list-group-item-action"> Code Injection</a>
            </div>

            <div class="menu-category mt-1" data-bs-toggle="collapse" data-bs-target="#menu2"><span><i class="fa-solid fa-book me-2"></i> 2. Secure Coding Guidelines</span><i class="fa-solid fa-chevron-down fa-xs"></i></div>
            <div class="collapse show" id="menu2">
                <a href="guide-input.html" class="list-group-item list-group-item-action"><i class="fa-regular fa-file-lines"></i> 2-1. 입력 데이터 검증 및 표현</a>
                <a href="guide-security.html" class="list-group-item list-group-item-action active"><i class="fa-solid fa-shield-halved"></i> 2-2. 보안 기능</a>
                <a href="sim-time-state.html" class="list-group-item list-group-item-action"><i class="fa-solid fa-hourglass-half"></i> 2-3. 시간 및 상태</a>
                <a href="sim-error-handling.html" class="list-group-item list-group-item-action"><i class="fa-solid fa-bug"></i> 2-4. 에러 처리</a>
                <a href="sim-quality.html" class="list-group-item list-group-item-action"><i class="fa-solid fa-check-double"></i> 2-5. 코드 품질</a>
                <a href="sim-encap.html" class="list-group-item list-group-item-action"><i class="fa-solid fa-box-open"></i> 2-6. 캡슐화 및 API 오용</a>
            </div>
        </div>
    </div>
    
    <div id="page-content-wrapper">
        <div class="container-fluid p-5">
            <h1 class="mb-4 text-primary"><i class="fa-solid fa-shield-halved me-2"></i> 2-2. 보안 기능 가이드 (16개 항목)</h1>
            <p class="lead">인증, 인가, 암호화, 세션 관리 등 애플리케이션의 핵심 보안 기능 구현 시 발생하는 취약점 및 안전한 코드 가이드입니다[cite: 2049, 3236, 7155].</p>
            <hr>
            
            <h2 class="mt-5 mb-3 text-danger"><i class="fa-solid fa-key me-2"></i> 1. 적절한 인증 없는 중요 기능 허용</h2>
            <p class="text-secondary">중요 기능이나 자원을 요청할 때 인증 여부를 확인하지 않아 중요 정보가 노출되거나 권한이 도용될 수 있습니다[cite: 2050, 3236, 7155].</p>
            <div class="row g-4 mb-4 code-container">
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-danger"><span>Java - 취약한 코드</span><span class="badge bg-light text-dark">권한 확인 없음</span></div>
                        <pre><code class="language-java">/* 취약한 코드 (Java) */
//...
String userId = (String) session.getAttribute("userId"); // 로그인 ID
String requestedUserId = memberModel.getUserId(); // 요청 ID

// 로그인한 사용자와 요청한 사용자 ID 일치 확인 누락 [cite: 6152]
if (service.modifyMember(memberModel)) {
    // 회원정보 수정 로직
} 
// 만약 requestedUserId가 다른 사용자 ID라면 IDOR 발생
</code></pre>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-success"><span>Java - 안전한 코드</span><span class="badge bg-light text-dark">Fix: 요청 사용자 확인</span></div>
                        <pre><code class="language-java">/* 안전한 코드 (Java) */
String userId = (String) session.getAttribute("userId"); 
String requestedUserId = memberModel.getUserId();

// 요청된 자원이 로그인된 사용자의 것인지 확인
if (!requestedUserId.equals(userId)) {
    // 권한 없음 에러 처리 [cite: 6157]
    throw new SecurityException("접근 권한이 없습니다.");
}
if (service.modifyMember(memberModel)) {
    // 안전하게 회원정보 수정
}
</code></pre>
                    </div>
                </div>
            </div>

            <h2 class="mt-5 mb-3 text-danger"><i class="fa-solid fa-user-lock me-2"></i> 2. 부적절한 인가</h2>
            <p class="text-secondary">프로그램이 모든 실행 경로에 대해 접근 제어를 검사하지 않거나 불완전하게 검사하여 비인가자가 정보를 유출할 수 있습니다[cite: 2149, 3234, 7155].</p>
            <div class="row g-4 mb-4 code-container">
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-danger"><span>Python - 취약한 코드</span><span class="badge bg-light text-dark">권한 확인 없음</span></div>
                        <pre><code class="language-python"># 취약한 코드 (Python Django)
def delete_content(request):
    action = request.POST.get('action', "")
    content_id = request.POST.get('content_id', "")
    
    # 작업 요청을 하는 사용자의 권한 확인 없이 delete 수행 [cite: 2184]
    if action is not None and action == "delete":
        Content.objects.filter(id=content_id).delete()
        return render(request, '/success.html')
</code></pre>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-success"><span>Python - 안전한 코드</span><span class="badge bg-light text-dark">Fix: 데코레이터 사용</span></div>
                        <pre><code class="language-python"># 안전한 코드 (Python Django)
from django.contrib.auth.decorators import login_required, permission_required

# @permission_required: 해당 기능을 수행할 권한이 있는지 확인 [cite: 2199]
@login_required
@permission_required('content.delete', raise_exception=True) 
def delete_content(request):
    action = request.POST.get('action', "")
    content_id = request.POST.get('content_id', "")
    
    if action is not None and action == "delete":
        # 권한 확인 후 delete 수행
        Content.objects.filter(id=content_id).delete()
</code></pre>
                    </div>
                </div>
            </div>

            <h2 class="mt-5 mb-3 text-danger"><i class="fa-solid fa-user-slash me-2"></i> 3. 중요한 자원에 대한 잘못된 권한 설정</h2>
            <p class="text-secondary">중요 자원(설정 파일 등)에 대해 최소 권한이 아닌 과도한 권한이 부여되어 비인가자에게 노출됩니다[cite: 2224, 3235, 7155].</p>
            <div class="row g-4 mb-4 code-container">
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-danger"><span>Python - 취약한 코드</span><span class="badge bg-light text-dark">전체 사용자 권한 허용</span></div>
                        <pre><code class="language-python"># 취약한 코드 (Python)
import os
def write_file():
    # 모든 사용자(Owner, Group, Others)에게 읽기, 쓰기, 실행 권한을 부여 (0777) [cite: 2248]
    os.chmod('/root/system_config', 0o777) 
    with open("/root/system_config", 'w') as f:
        f.write("your config is broken")
</code></pre>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-success"><span>Python - 안전한 코드</span><span class="badge bg-light text-dark">Fix: 최소 권한 할당</span></div>
                        <pre><code class="language-python"># 안전한 코드 (Python)
import os
def write_file_secure():
    # 소유자(Owner) 외에는 아무런 권한을 주지 않음 (0700) [cite: 2265]
    os.chmod('/root/system_config', 0o700) 
    with open("/root/system_config", "w") as f:
        f.write("your config is secure")
</code></pre>
                    </div>
                </div>
            </div>

            <h2 class="mt-5 mb-3 text-danger"><i class="fa-solid fa-skull-crossbones me-2"></i> 4. 취약한 암호화 알고리즘 사용</h2>
            <p class="text-secondary">MD5, SHA1, DES 등 정보보호 측면에서 취약한 암호화 알고리즘을 사용하여 중요 정보의 기밀성을 보장할 수 없습니다[cite: 2274, 2290, 3235, 7155].</p>
            <div class="row g-4 mb-4 code-container">
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-danger"><span>Python - 취약한 코드</span><span class="badge bg-light text-dark">DES/MD5 사용</span></div>
                        <pre><code class="language-python"># 취약한 코드 (Python)
from Crypto.Cipher import DES
# 취약한 DES 알고리즘 사용 [cite: 2311]
cipher_des = DES.new(key, DES.MODE_ECB) 

import hashlib
# 취약한 md5 해시함수 사용 [cite: 2344]
hash_text = hashlib.md5(plain_text.encode('utf-8')).hexdigest()
</code></pre>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-success"><span>Python - 안전한 코드</span><span class="badge bg-light text-dark">Fix: AES/SHA-256 사용</span></div>
                        <pre><code class="language-python"># 안전한 코드 (Python)
from Crypto.Cipher import AES
# 1. 안전한 AES 알고리즘 및 CBC 모드 사용 [cite: 2327]
cipher_aes = AES.new(key, AES.MODE_CBC, iv) 

import hashlib
# 2. 안전한 sha-256 해시함수 사용 [cite: 2356]
hash_text = hashlib.sha256(plain_text.encode('utf-8')).hexdigest()
</code></pre>
                    </div>
                </div>
            </div>

            <h2 class="mt-5 mb-3 text-danger"><i class="fa-solid fa-lock-slash me-2"></i> 5. 암호화되지 않은 중요정보</h2>
            <p class="text-secondary">중요 정보(개인정보, 패스워드 등)를 평문으로 **저장**하거나 **전송**하여 인가되지 않은 사용자에게 노출됩니다[cite: 2371, 2382, 3235, 7155].</p>
            <div class="row g-4 mb-4 code-container">
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-danger"><span>Python - 취약한 코드</span><span class="badge bg-light text-dark">평문 저장/전송</span></div>
                        <pre><code class="language-python"># 취약한 코드 (Python DB/Socket)
# 1. 평문 저장 [cite: 2398]
curs.execute(
'UPDATE USERS SET PASSWORD=%s WHERE USER_ID=%s',
password, user_id # 암호화되지 않은 패스워드
)

# 2. 평문 전송 [cite: 2455]
with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
    s.sendall(password.encode('utf-8')) # 암호화 하지 않고 전송
</code></pre>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-success"><span>Python - 안전한 코드</span><span class="badge bg-light text-dark">Fix: 해시 + Salt 저장/암호화 전송</span></div>
                        <pre><code class="language-python"># 안전한 코드 (Python)
# 1. 해시 + Salt 저장 [cite: 2426]
hash_obj.update(bytes(password + salt, 'utf-8'))
hash_pwd = hash_obj.hexdigest()
curs.execute('UPDATE USERS SET PASSWORD=%s ...', (hash_pwd, user_id))

# 2. 암호화 전송 [cite: 2481]
aes = AEScipher(block_key)
enc_passowrd = aes.encrypt(passowrd) # 중요 정보는 암호화하여 전송
s.sendall(enc_passowrd.encode('utf-8'))
</code></pre>
                    </div>
                </div>
            </div>

            <h2 class="mt-5 mb-3 text-danger"><i class="fa-solid fa-code me-2"></i> 6. 하드코드된 중요정보</h2>
            <p class="text-secondary">소스코드 내부에 패스워드, 암호화 키 등 중요 정보를 상수로 직접 코딩하여 소스코드 유출 시 함께 노출됩니다[cite: 2530, 2541, 3235, 7153].</p>
            <div class="row g-4 mb-4 code-container">
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-danger"><span>Python - 취약한 코드</span><span class="badge bg-light text-dark">DB 정보 하드코딩</span></div>
                        <pre><code class="language-python"># 취약한 코드 (Python pymysql)
def query_execute(query):
    # user, passwd가 소스코드에 평문으로 하드코딩되어 있음 [cite: 2555, 2564, 2566]
    dbconn = pymysql.connect(
        host='127.0.0.1',
        user='root',
        passwd='1234', 
    )
</code></pre>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-success"><span>Python - 안전한 코드</span><span class="badge bg-light text-dark">Fix: 외부 파일/복호화</span></div>
                        <pre><code class="language-python"># 안전한 코드 (Python)
def query_execute(query, config_path):
    with open(config_path, 'r') as config:
        dbconf = json.load(fp=config)
        # 외부 설정 파일에서 암호화된 값을 가져와 복호화한 후에 사용 [cite: 2592, 2597]
        dbUser = decrypt(blockkey, dbconf['user'])
        dbPasswd = decrypt(blockkey, dbconf['passwd'])
    
    dbconn = pymysql.connect(user=dbUser, passwd=dbPasswd)
</code></pre>
                    </div>
                </div>
            </div>

            <h2 class="mt-5 mb-3 text-danger"><i class="fa-solid fa-key me-2"></i> 7. 충분하지 않은 키 길이 사용</h2>
            <p class="text-secondary">RSA는 2048 비트 이상, 대칭 암호화는 128비트 이상의 키를 사용해야 합니다. 키 길이가 짧으면 짧은 시간 안에 키를 찾아낼 수 있습니다[cite: 2643, 2670, 3235, 7153].</p>
            <div class="row g-4 mb-4 code-container">
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-danger"><span>Python - 취약한 코드</span><span class="badge bg-light text-dark">약한 RSA 키 길이</span></div>
                        <pre><code class="language-python"># 취약한 코드 (Python)
from Crypto.PublicKey import RSA
def make_rsa_key_pair():
    # RSA 키 길이를 2048 비트 이하로 설정하는 경우 안전하지 않음 [cite: 2682]
    private_key = RSA.generate(1024) 
    # ECC의 키 길이를 224비트 이하로 설정하는 경우 안전하지 않음 [cite: 2691]
    ecc_curve = registry.get_curve('secp192r1') 
</code></pre>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-success"><span>Python - 안전한 코드</span><span class="badge bg-light text-dark">Fix: 2048 비트 이상</span></div>
                        <pre><code class="language-python"># 안전한 코드 (Python)
from Crypto.PublicKey import RSA
def make_rsa_key_pair():
    # RSA 키 길이를 2048 비트 이상으로 길게 설정 [cite: 2712]
    private_key = RSA.generate(2048)
    
def make_ecc():
    # ECC 키 길이를 224 비트 이상으로 설정 [cite: 2721]
    ecc_curve = registry.get_curve('secp224r1')
</code></pre>
                    </div>
                </div>
            </div>

            <h2 class="mt-5 mb-3 text-danger"><i class="fa-solid fa-dice me-2"></i> 8. 적절하지 않은 난수 값 사용</h2>
            <p class="text-secondary">예측 불가능한 난수가 필요한 상황(세션 ID, 암호화 키)에서 예측 가능한 난수(예: `random` 모듈)를 사용하여 공격에 취약해집니다[cite: 2741, 2752, 3236, 7155].</p>
            <div class="row g-4 mb-4 code-container">
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-danger"><span>Python - 취약한 코드</span><span class="badge bg-light text-dark">random 라이브러리 사용</span></div>
                        <pre><code class="language-python"># 취약한 코드 (Python)
import random
def get_otp_number():
    random_str = ""
    # random 라이브러리는 주요 보안 기능을 위한 난수로 안전하지 않다 [cite: 2772, 2774]
    for i in range(6):
        random_str += str(random.randrange(10))
    return random_str
</code></pre>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-success"><span>Python - 안전한 코드</span><span class="badge bg-light text-dark">Fix: secrets 모듈 사용</span></div>
                        <pre><code class="language-python"># 안전한 코드 (Python)
import secrets
def get_otp_number():
    random_str = ""
    # 보안기능에 적합한 난수 생성용 secrets 라이브러리 사용 [cite: 2792]
    for i in range(6):
        random_str += str(secrets.randbelow(10))
    return random_str
</code></pre>
                    </div>
                </div>
            </div>

            <h2 class="mt-5 mb-3 text-danger"><i class="fa-solid fa-clipboard-question me-2"></i> 9. 취약한 비밀번호 허용</h2>
            <p class="text-secondary">강한 비밀번호 조합 규칙(영문, 숫자, 특수문자 등)이 미흡하여 무차별 대입 공격에 취약해집니다[cite: 2834, 2841, 3236, 7155].</p>
            <div class="row g-4 mb-4 code-container">
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-danger"><span>Python - 취약한 코드</span><span class="badge bg-light text-dark">복잡도 검증 누락</span></div>
                        <pre><code class="language-python"># 취약한 코드 (Python Flask)
def register():
    password = request.form.get('password')
    # 패스워드 생성 규칙을 확인하지 않고 회원 가입 [cite: 2878]
    usertable = User()
    usertable.password = password
    db.session.add(usertable)
</code></pre>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-success"><span>Python - 안전한 코드</span><span class="badge bg-light text-dark">Fix: 정규식 복잡도 검사</span></div>
                        <pre><code class="language-python"># 안전한 코드 (Python Flask)
import re
# ... (check_password 함수 정의)

def register_secure():
    password = request.form.get('password')
    
    if not check_password(password):
        # 패스워드 복잡도 검증 후 가입 승인 처리 [cite: 2882]
        return make_response("패스워드 조합규칙에 맞지 않습니다.", 400)
    
    usertable = User()
    usertable.password = password
    db.session.add(usertable)
</code></pre>
                    </div>
                </div>
            </div>
            
            <h2 class="mt-5 mb-3 text-danger"><i class="fa-solid fa-signature me-2"></i> 10. 부적절한 전자서명 확인</h2>
            <p class="text-secondary">전자서명을 검증하지 않거나 검증 절차가 부적절하면 위변조된 파일/코드가 실행될 수 있습니다[cite: 2895, 3236, 7155].</p>
            <div class="row g-4 mb-4 code-container">
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-danger"><span>Python - 취약한 코드</span><span class="badge bg-light text-dark">전자서명 검증 누락</span></div>
                        <pre><code class="language-python"># 취약한 코드 (Python)
def verify_data(request):
    encrypted_code = request.POST.get("encrypted_msg", "")
    # 클라이언트로부터 전달받은 데이터(전자서명을 수신 처리 하지 않음) [cite: 2901]
    # ...
    origin_python_code = decrypt_with_symmetric_key(secret_key, encrypted_code)
    
    # 전자서명 검증 없이 파이썬 코드 실행 [cite: 2902]
    eval(origin_python_code) 
</code></pre>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-success"><span>Python - 안전한 코드</span><span class="badge bg-light text-dark">Fix: 전자서명 검증</span></div>
                        <pre><code class="language-python"># 안전한 코드 (Python)
def verify_data_secure(request):
    # ... (코드 및 서명 복호화)
    # 클라이언트의 공개키를 통해 파이썬 코드(원문)와 전자서명을 검증
    verify_result = verify_digit_signature(origin_python_code, origin_signature, public_key)
    
    # 전자서명 검증을 통과해야만 파이썬 코드 실행 [cite: 2907, 2908]
    if verify_result:
        eval(origin_python_code)
    else:
        return render(request, "/verify_failed.html")
</code></pre>
                    </div>
                </div>
            </div>
            
            <h2 class="mt-5 mb-3 text-danger"><i class="fa-solid fa-certificate me-2"></i> 11. 부적절한 인증서 유효성 검증</h2>
            <p class="text-secondary">SSL/TLS 통신 시 서버 측 인증서의 유효성을 확인하지 않거나 부적절하게 검증하여, 악성 호스트에 연결되거나 중간자 공격에 노출됩니다[cite: 2912, 3236, 7155].</p>
            <div class="row g-4 mb-4 code-container">
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-danger"><span>Python - 취약한 코드</span><span class="badge bg-light text-dark">인증서 검증 안 함</span></div>
                        <pre><code class="language-python"># 취약한 코드 (Python ssl)
import ssl
def connect_with_server():
    context = ssl.SSLContext()
    # CERT_NONE: 상대방을 인증하지 않기 때문에 서버 신뢰성을 보장할 수 없음 [cite: 2919]
    context.verify_mode = ssl.CERT_NONE 
    
    with context.wrap_socket(sock) as ssock:
        ssock.connect((HOST, PORT))
</code></pre>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-success"><span>Python - 안전한 코드</span><span class="badge bg-light text-dark">Fix: 유효성 검증 적용</span></div>
                        <pre><code class="language-python"># 안전한 코드 (Python)
import ssl

def connect_with_server():
    # PROTOCOL_TLS_CLIENT 사용으로 인증서 유효성 검사 (verify_mode=CERT_REQUIRED) [cite: 2921, 2924]
    context = ssl.SSLContext(ssl.PROTOCOL_TLS_CLIENT)
    
    # 서버로부터 전달받은 CA 인증서를 context에 로드 (필수)
    context.load_verify_locations(SERVER_CA_PEM) 
    
    # 호스트 이름(HOST_NAME)이 일치하지 않으면 통신 불가
    with context.wrap_socket(sock, server_hostname=HOST_NAME) as ssock:
        ssock.connect((HOST, PORT))
</code></pre>
                    </div>
                </div>
            </div>

            <h2 class="mt-5 mb-3 text-danger"><i class="fa-solid fa-cookie-bite me-2"></i> 12. 사용자 하드디스크에 저장되는 쿠키를 통한 정보노출</h2>
            <p class="text-secondary">개인정보, 인증 정보 등이 영속적인 쿠키(Persistent Cookie)에 저장되도록 만료 시간을 길게 설정하여 공격자에게 노출됩니다[cite: 2928, 3236, 7154].</p>
            <div class="row g-4 mb-4 code-container">
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-danger"><span>Python - 취약한 코드</span><span class="badge bg-light text-dark">과도한 만료시간</span></div>
                        <pre><code class="language-python"># 취약한 코드 (Python Django)
def remind_user_state(request):
    res = HttpResponse()
    # 쿠키의 만료시간을 1년(60*60*24*365)으로 과도하게 길게 설정하고 있어 안전하지 않다 [cite: 2934]
    res.set_cookie('rememberme', 1, max_age=60*60*24*365)
    return res
</code></pre>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-success"><span>Python - 안전한 코드</span><span class="badge bg-light text-dark">Fix: 최소 만료시간 및 Secure</span></div>
                        <pre><code class="language-python"># 안전한 코드 (Python Django)
def remind_user_state(request):
    res = HttpResponse()
    # 쿠키의 만료시간을 적절하게 부여하고 secure 및 httpOnly 옵션을 활성화 한다. [cite: 2940]
    res.set_cookie('rememberme', 1, max_age=60*60, secure=True, httponly=True)
    return res
</code></pre>
                    </div>
                </div>
            </div>
            
            <h2 class="mt-5 mb-3 text-danger"><i class="fa-solid fa-comment-slash me-2"></i> 13. 주석문 안에 포함된 시스템 주요정보</h2>
            <p class="text-secondary">개발자가 편의를 위해 ID, 패스워드 등 보안 관련 내용을 주석문에 포함하여 소스코드 유출 시 함께 노출됩니다[cite: 2945, 3236, 7154].</p>
            <div class="row g-4 mb-4 code-container">
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-danger"><span>Python - 취약한 코드</span><span class="badge bg-light text-dark">주석 내 중요정보</span></div>
                        <pre><code class="language-python"># 취약한 코드 (Python)
def user_login(id, passwd):
    # 주석문에 포함된 중요 시스템의 인증 정보
    # id = admin
    # passwd = passw0rd
    
    result = login(id, passwd)
    return result
</code></pre>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-success"><span>Python - 안전한 코드</span><span class="badge bg-light text-dark">Fix: 주석 제거</span></div>
                        <pre><code class="language-python"># 안전한 코드 (Python)
def user_login(id, passwd):
    # 주석문에 포함된 민감한 정보는 삭제 [cite: 2954]
    result = login(id, passwd)
    return result
</code></pre>
                    </div>
                </div>
            </div>
            
            <h2 class="mt-5 mb-3 text-danger"><i class="fa-solid fa-lock-open me-2"></i> 14. 솔트 없이 일방향 해시 함수 사용</h2>
            <p class="text-secondary">패스워드 저장 시 솔트(Salt) 없이 해시하여 레인보우 테이블 공격에 취약해집니다[cite: 2957, 3237, 7154].</p>
            <div class="row g-4 mb-4 code-container">
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-danger"><span>Python - 취약한 코드</span><span class="badge bg-light text-dark">솔트 없이 해시</span></div>
                        <pre><code class="language-python"># 취약한 코드 (Python)
import hashlib
def get_hash_from_pwd(pw):
    # salt 없이 생성된 해시값은 강도가 약해 취약하다 [cite: 2964]
    h = hashlib.sha256(pw.encode())
    return h.digest()
</code></pre>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-success"><span>Python - 안전한 코드</span><span class="badge bg-light text-dark">Fix: Salt 사용</span></div>
                        <pre><code class="language-python"># 안전한 코드 (Python)
import hashlib
import secrets

def get_hash_from_pwd(pw):
    # 1. 솔트 값을 사용하면 길이가 짧은 패스워드로도 고강도의 해시를 생성할 수 있다. [cite: 2968]
    salt = secrets.token_hex(32)
    # 2. 솔트와 패스워드를 함께 해시 함수에 적용
    h = hashlib.sha256(salt.encode() + pw.encode())
    return h.digest(), salt
</code></pre>
                    </div>
                </div>
            </div>

            <h2 class="mt-5 mb-3 text-danger"><i class="fa-solid fa-download me-2"></i> 15. 무결성 검사 없는 코드 다운로드</h2>
            <p class="text-secondary">원격에서 소스코드나 실행파일을 다운로드받아 실행 시 무결성 검사를 하지 않아 악의적인 코드가 실행됩니다[cite: 2971, 3237, 7155].</p>
            <div class="row g-4 mb-4 code-container">
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-danger"><span>Python - 취약한 코드</span><span class="badge bg-light text-dark">무결성 검증 누락</span></div>
                        <pre><code class="language-python"># 취약한 코드 (Python)
import requests
def execute_remote_code():
    url = "https://www.somewhere.com/storage/code.py"
    # 원격 코드 다운로드 [cite: 2981]
    file = requests.get(url) 
    # 다운로드한 파일의 무결성 검사 없이 바로 파일에 저장/실행
    with open('save.py', 'wb') as f:
        f.write(file.content)
</code></pre>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-success"><span>Python - 안전한 코드</span><span class="badge bg-light text-dark">Fix: 해시값 비교</span></div>
                        <pre><code class="language-python"># 안전한 코드 (Python)
import requests
import hashlib
# ...
def execute_remote_code():
    # ... (config 파일에서 remote_code_hash 가져오기)
    file = requests.get(url)
    remote_code = file.content
    
    sha = hashlib.sha256()
    sha.update(remote_code)
    
    # 다운로드 받은 파일의 해시값 검증 [cite: 2984]
    if sha.hexdigest() != remote_code_hash:
        raise Exception('파일이 손상되었습니다.')
        
    with open('save.py', 'wb') as f:
        f.write(file.content)
</code></pre>
                    </div>
                </div>
            </div>

            <h2 class="mt-5 mb-3 text-danger"><i class="fa-solid fa-user-clock me-2"></i> 16. 반복된 인증시도 제한 기능 부재</h2>
            <p class="text-secondary">인증 시도 횟수를 제한하지 않아 공격자가 무차별 대입 공격(Brute Force)을 통해 계정 권한을 획득할 수 있습니다[cite: 2987, 3237, 7155].</p>
            <div class="row g-4 mb-4 code-container">
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-danger"><span>Python - 취약한 코드</span><span class="badge bg-light text-dark">시도 횟수 제한 없음</span></div>
                        <pre><code class="language-python"># 취약한 코드 (Python)
def login(request):
    user_id = request.POST.get('user_id', '')
    # ... (패스워드 해시 검증)
    
    # 인증 시도에 따른 제한이 없어 반복적인 인증 시도가 가능 [cite: 2993]
    if sha.hexdigest() == hashed_passwd:
        return render(request, '/index.html', {'state':'login_success'})
    else:
        return render(request, '/login.html', {'state':'login_failed'})
</code></pre>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                        <div class="code-block-header bg-success"><span>Python - 안전한 코드</span><span class="badge bg-light text-dark">Fix: 횟수 제한/잠금</span></div>
                        <pre><code class="language-python"># 안전한 코드 (Python)
LOGIN_TRY_LIMIT = 5

def login_secure(request):
    # ... (패스워드 해시 검증)
    # ... (COUNT 변수 로직)
    
    if COUNT >= LOGIN_TRY_LIMIT:
        # 로그인 실패횟수 초과로 인해 잠금된 계정에 대한 인증 시도 제한 [cite: 2997]
        return render(request, "/account_lock.html", {"state": "account_lock"})
    elif sha.hexdigest() == hashed_passwd:
        # 성공 시 실패 횟수 삭제 [cite: 2995]
        LoginFail.objects.filter(user_id=user_id).delete()
        return render(request, '/index.html', {'state':'login_success'})
    else:
        # 실패 시 횟수 DB 기록 [cite: 2997]
        # ...
</code></pre>
                    </div>
                </div>
            </div>
            
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', (event) => {
        Prism.highlightAll();
    });
</script>

</body>
</html>