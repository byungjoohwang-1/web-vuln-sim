<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¸ˆìœµê¶Œ ì¸ì¦ ìš°íšŒ ì·¨ì•½ì  ì‹¤ì „ ì‹œë®¬ë ˆì´í„°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        .code-font { font-family: 'Courier New', monospace; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
        .animate-blink { animation: blink 1s infinite; }
        @keyframes slideIn { from { transform: translateX(-20px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        .slide-in { animation: slideIn 0.5s ease-out; }
    </style>
</head>
<body class="bg-gray-900 p-4">

    <!-- íƒ€ì´í‹€ -->
    <div class="max-w-7xl mx-auto mb-4">
        <div class="bg-gradient-to-r from-red-600 to-pink-600 text-white p-4 rounded-lg shadow-lg">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <i class="fas fa-user-lock text-3xl"></i>
                    <div>
                        <h1 class="font-bold text-xl">ê¸ˆìœµê¶Œ ì¸ì¦ ìš°íšŒ ì·¨ì•½ì  ì‹¤ì „ ì‹œë‚˜ë¦¬ì˜¤</h1>
                        <p class="text-sm">WEB-SER-019: ë¶ˆì¶©ë¶„í•œ ì´ìš©ì ì¸ì¦ | ìœ„í—˜ë„: 4 (ë†’ìŒ)</p>
                    </div>
                </div>
                <button onclick="resetAll()" class="bg-white text-red-600 px-4 py-2 rounded font-bold hover:bg-gray-100">
                    <i class="fas fa-redo"></i> ì²˜ìŒë¶€í„°
                </button>
            </div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-2 gap-4">
        
        <!-- ì¢Œì¸¡: ê³µê²©ì í™”ë©´ -->
        <div class="space-y-4">
            
            <!-- ê³µê²©ì ë¸Œë¼ìš°ì € -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg border-2 border-red-500">
                <div class="flex items-center gap-3 mb-3">
                    <i class="fas fa-user-secret text-red-400 text-2xl"></i>
                    <div>
                        <h2 class="font-bold text-lg">ğŸ”´ ê³µê²©ì (í•´ì»¤)</h2>
                        <p class="text-sm text-gray-400" id="attackerStatus">ì¸ì¦ ìš°íšŒ ì¤€ë¹„ ì¤‘...</p>
                    </div>
                </div>
                
                <!-- ë¸Œë¼ìš°ì € í™”ë©´ -->
                <div class="bg-white rounded-lg overflow-hidden">
                    <div class="bg-gray-300 px-3 py-2 flex items-center gap-2">
                        <div class="flex gap-1">
                            <div class="w-2 h-2 rounded-full bg-red-500"></div>
                            <div class="w-2 h-2 rounded-full bg-yellow-500"></div>
                            <div class="w-2 h-2 rounded-full bg-green-500"></div>
                        </div>
                        <div class="flex-1 bg-white rounded px-2 py-1 flex items-center gap-2">
                            <i class="fas fa-lock text-green-600 text-xs"></i>
                            <span class="text-xs text-gray-600 code-font flex-1" id="browserUrl">https://xxbank.com</span>
                        </div>
                        <button class="text-gray-600 text-xs"><i class="fas fa-sync"></i></button>
                    </div>
                    
                    <div id="browserScreen" class="p-4 bg-white text-gray-900 min-h-[450px] max-h-[500px] overflow-auto">
                        <div class="text-center text-gray-400 py-20">
                            <i class="fas fa-globe text-6xl mb-4"></i>
                            <p>ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ê³µê²© ê²°ê³¼ -->
            <div id="attackResult" class="hidden bg-red-900 text-white p-4 rounded-lg shadow-lg border-2 border-red-500">
                <div class="flex items-center gap-2 mb-3">
                    <i class="fas fa-skull-crossbones text-red-400 text-xl animate-pulse"></i>
                    <h3 class="font-bold">ğŸ’€ ê³µê²© ì„±ê³µ!</h3>
                </div>
                <div id="attackResultContent" class="bg-black p-3 rounded code-font text-xs"></div>
            </div>

            <!-- ê³µê²© ë‹¨ê³„ -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg">
                <h3 class="font-bold mb-3 flex items-center gap-2">
                    <i class="fas fa-list-ol text-orange-400"></i>
                    ê³µê²© ì§„í–‰ ë‹¨ê³„
                </h3>
                <div id="attackSteps" class="space-y-2 text-sm max-h-[250px] overflow-auto">
                    <div class="text-gray-500">ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”...</div>
                </div>
            </div>

            <!-- ì‹œë‚˜ë¦¬ì˜¤ ì„ íƒ -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg">
                <h3 class="font-bold mb-3 flex items-center gap-2">
                    <i class="fas fa-flask text-red-400"></i>
                    ì‹¤ì „ ê³µê²© ì‹œë‚˜ë¦¬ì˜¤
                </h3>
                <div class="space-y-2">
                    <button onclick="startScenario(1)" 
                            class="w-full text-left bg-red-900 hover:bg-red-800 px-3 py-2 rounded text-sm transition">
                        <i class="fas fa-exchange-alt"></i> <strong>ì‹œë‚˜ë¦¬ì˜¤ 1:</strong> URL ì§ì ‘ ì…ë ¥ - ì†¡ê¸ˆ í˜ì´ì§€
                    </button>
                    <button onclick="startScenario(2)" 
                            class="w-full text-left bg-orange-900 hover:bg-orange-800 px-3 py-2 rounded text-sm transition">
                        <i class="fas fa-key"></i> <strong>ì‹œë‚˜ë¦¬ì˜¤ 2:</strong> ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ - ì¬ì¸ì¦ ìš°íšŒ
                    </button>
                    <button onclick="startScenario(3)" 
                            class="w-full text-left bg-purple-900 hover:bg-purple-800 px-3 py-2 rounded text-sm transition">
                        <i class="fas fa-user-shield"></i> <strong>ì‹œë‚˜ë¦¬ì˜¤ 3:</strong> ê´€ë¦¬ì í˜ì´ì§€ - í´ë¼ì´ì–¸íŠ¸ ê²€ì¦ë§Œ
                    </button>
                </div>
            </div>

            <!-- ì·¨ì•½í•œ ì½”ë“œ -->
            <div class="bg-gray-900 text-white p-4 rounded-lg shadow-lg border border-red-500">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="font-bold text-red-400">
                        <i class="fas fa-bug"></i> ì·¨ì•½í•œ ì½”ë“œ (ì¸ì¦ ë¯¸í¡)
                    </h3>
                    <span class="text-xs bg-red-600 px-2 py-1 rounded">ë¬¸ì œ ì›ì¸</span>
                </div>
                <pre class="code-font text-xs overflow-x-auto max-h-[700px]"><code><span class="text-gray-500">// Java Spring - ì·¨ì•½í•œ ì¸ì¦ ì²´í¬</span>

@Controller
public class TransferController {
    
    @GetMapping("/transfer")
    public String transferPage(Model model) {
        <span class="text-red-400">// âŒ ì¸ì¦ ì²´í¬ ì—†ìŒ!</span>
        <span class="text-red-400">// ëˆ„êµ¬ë‚˜ URL ì§ì ‘ ì…ë ¥ìœ¼ë¡œ ì ‘ê·¼ ê°€ëŠ¥</span>
        return "transfer";
    }
    
    @PostMapping("/transfer")
    public ResponseEntity transfer(
        @RequestBody TransferRequest request
    ) {
        <span class="text-red-400">// âŒ ì„¸ì…˜ ê²€ì¦ ì—†ìŒ!</span>
        transferService.execute(
            request.getFromAccount(),
            request.getToAccount(),
            request.getAmount()
        );
        
        return ResponseEntity.ok("ì†¡ê¸ˆ ì™„ë£Œ");
    }
}

@Controller
public class PasswordController {
    
    @GetMapping("/change-password")
    public String changePasswordPage() {
        <span class="text-red-400">// âŒ ì¬ì¸ì¦ ì—†ìŒ!</span>
        return "change-password";
    }
    
    @PostMapping("/change-password")
    public ResponseEntity changePassword(
        @RequestBody PasswordRequest request
    ) {
        <span class="text-red-400">// âŒ í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì—†ìŒ!</span>
        userService.updatePassword(
            request.getUserId(),
            request.getNewPassword()
        );
        
        return ResponseEntity.ok("ë³€ê²½ ì™„ë£Œ");
    }
}

@Controller
public class AdminController {
    
    @GetMapping("/admin")
    public String adminPage(HttpSession session) {
        <span class="text-red-400">// âŒ í´ë¼ì´ì–¸íŠ¸ ê²€ì¦ë§Œ ì¡´ì¬!</span>
        return "admin";
    }
}

<span class="text-gray-500">// admin.jsp - í´ë¼ì´ì–¸íŠ¸ ê²€ì¦</span>

&lt;script&gt;
    <span class="text-red-400">// âŒ JavaScriptë¡œë§Œ ê´€ë¦¬ì ì²´í¬!</span>
    if (localStorage.getItem('role') !== 'admin') {
        alert('ê´€ë¦¬ìë§Œ ì ‘ê·¼ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
        location.href = '/';
    }
&lt;/script&gt;

&lt;div id="adminPanel"&gt;
    &lt;h1&gt;ê´€ë¦¬ì í˜ì´ì§€&lt;/h1&gt;
    &lt;button onclick="deleteAllUsers()"&gt;
        ì „ì²´ ì‚¬ìš©ì ì‚­ì œ
    &lt;/button&gt;
&lt;/div&gt;

<span class="text-gray-500">// Python Flask - ì·¨ì•½í•œ ì¸ì¦</span>

@app.route('/transfer', methods=['GET', 'POST'])
def transfer():
    <span class="text-red-400"># âŒ ì„¸ì…˜ ì²´í¬ ì—†ìŒ!</span>
    if request.method == 'GET':
        return render_template('transfer.html')
    
    <span class="text-red-400"># âŒ ì¸ì¦ ì—†ì´ ì†¡ê¸ˆ ì²˜ë¦¬</span>
    from_account = request.json['from_account']
    to_account = request.json['to_account']
    amount = request.json['amount']
    
    execute_transfer(from_account, to_account, amount)
    return jsonify({"status": "success"})

@app.route('/change-password', methods=['POST'])
def change_password():
    <span class="text-red-400"># âŒ í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì—†ìŒ!</span>
    user_id = request.json['user_id']
    new_password = request.json['new_password']
    
    update_password(user_id, new_password)
    return jsonify({"status": "success"})

<span class="text-gray-500">// JavaScript/Node.js - ì·¨ì•½í•œ í”Œë¡œìš°</span>

<span class="text-red-400">// âŒ ë‹¨ê³„ë³„ ê²€ì¦ ì—†ìŒ!</span>
app.post('/register/step2', (req, res) => {
    <span class="text-red-400">// step1 ì™„ë£Œ ì—¬ë¶€ í™•ì¸ ì—†ìŒ!</span>
    const { address } = req.body;
    saveAddress(address);
    res.json({ next: '/register/step3' });
});

app.post('/register/step3', (req, res) => {
    <span class="text-red-400">// step2 ì™„ë£Œ ì—¬ë¶€ í™•ì¸ ì—†ìŒ!</span>
    const { ssn } = req.body;
    saveSsn(ssn);
    res.json({ status: 'complete' });
});</code></pre>
            </div>

        </div>

        <!-- ìš°ì¸¡: ì„œë²„ & ë¶„ì„ -->
        <div class="space-y-4">
            
            <!-- ì„œë²„ ë¡œê·¸ -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg border-2 border-green-500">
                <div class="flex items-center gap-3 mb-3">
                    <i class="fas fa-server text-green-400 text-2xl"></i>
                    <div>
                        <h2 class="font-bold text-lg">ğŸŸ¢ ì„œë²„ ì²˜ë¦¬ ë¡œê·¸</h2>
                        <p class="text-sm text-gray-400">ì¸ì¦ ê²€ì¦ ì—†ì´ ì²˜ë¦¬</p>
                    </div>
                </div>
                
                <!-- ì„œë²„ ë¡œê·¸ -->
                <div class="bg-black rounded-lg p-4 min-h-[450px] max-h-[550px] overflow-auto">
                    <div id="serverLog" class="code-font text-xs space-y-1 text-green-400">
                        <div class="text-gray-500">[SERVER] Waiting...</div>
                    </div>
                </div>
                
                <!-- ìƒíƒœ -->
                <div class="mt-3 flex justify-between items-center">
                    <span class="text-xs text-gray-400">ì„œë²„ ìƒíƒœ:</span>
                    <span id="serverStatus" class="text-xs bg-green-600 px-3 py-1 rounded">RUNNING</span>
                </div>
            </div>

            <!-- ë¬¸ì œì  ë¶„ì„ -->
            <div id="problemBox" class="hidden bg-red-900 text-white p-4 rounded-lg shadow-lg">
                <div class="flex items-center gap-2 mb-3">
                    <i class="fas fa-exclamation-triangle text-yellow-400 text-xl animate-blink"></i>
                    <h3 class="font-bold">ğŸš¨ ë¬¸ì œì  ë¶„ì„</h3>
                </div>
                <div id="problemContent" class="text-sm space-y-2"></div>
            </div>

            <!-- ì•ˆì „í•œ ì½”ë“œ -->
            <div class="bg-gray-900 text-white p-4 rounded-lg shadow-lg border border-green-500">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="font-bold text-green-400">
                        <i class="fas fa-shield-halved"></i> ì•ˆì „í•œ ì½”ë“œ (ì¸ì¦ ê²€ì¦)
                    </h3>
                    <span class="text-xs bg-green-600 px-2 py-1 rounded">í•´ê²°ì±…</span>
                </div>
                <pre class="code-font text-xs overflow-x-auto max-h-[1000px]"><code><span class="text-gray-500">// Java Spring - ì•ˆì „í•œ ì¸ì¦ ì²´í¬</span>

<span class="text-green-400">// âœ… ë°©ë²• 1: Spring Security ì‚¬ìš©</span>
@Configuration
@EnableWebSecurity
public class SecurityConfig {
    
    @Bean
    public SecurityFilterChain filterChain(
        HttpSecurity http
    ) throws Exception {
        http
            .authorizeHttpRequests(auth -> auth
                <span class="text-green-400">// ì¸ì¦ í•„ìš”í•œ ê²½ë¡œ ì§€ì •</span>
                .requestMatchers("/transfer/**")
                    .authenticated()
                .requestMatchers("/change-password")
                    .authenticated()
                .requestMatchers("/admin/**")
                    .hasRole("ADMIN")
                .anyRequest().permitAll()
            )
            .formLogin(form -> form
                .loginPage("/login")
                .defaultSuccessUrl("/")
            )
            .sessionManagement(session -> session
                <span class="text-green-400">// ì„¸ì…˜ ê³ ì • ê³µê²© ë°©ì–´</span>
                .sessionFixation()
                    .newSession()
                <span class="text-green-400">// ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ 10ë¶„</span>
                .maximumSessions(1)
                .maxSessionsPreventsLogin(true)
            );
        
        return http.build();
    }
}

<span class="text-green-400">// âœ… ë°©ë²• 2: ì»¤ìŠ¤í…€ ì¸ì¦ ì¸í„°ì…‰í„°</span>
@Component
public class AuthenticationInterceptor 
    implements HandlerInterceptor {
    
    @Override
    public boolean preHandle(
        HttpServletRequest request,
        HttpServletResponse response,
        Object handler
    ) throws Exception {
        
        HttpSession session = request.getSession(false);
        
        <span class="text-green-400">// ì„¸ì…˜ ì¡´ì¬ ì—¬ë¶€ í™•ì¸</span>
        if (session == null) {
            response.sendRedirect("/login");
            return false;
        }
        
        <span class="text-green-400">// ì‚¬ìš©ì ì¸ì¦ ì •ë³´ í™•ì¸</span>
        User user = (User) session.getAttribute("user");
        if (user == null) {
            response.sendRedirect("/login");
            return false;
        }
        
        <span class="text-green-400">// ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì²´í¬ (10ë¶„)</span>
        long lastAccessTime = session.getLastAccessedTime();
        long currentTime = System.currentTimeMillis();
        long timeout = 10 * 60 * 1000; // 10ë¶„
        
        if (currentTime - lastAccessTime > timeout) {
            session.invalidate();
            response.sendRedirect("/login");
            return false;
        }
        
        <span class="text-green-400">// ê´€ë¦¬ì ê¶Œí•œ ì²´í¬ (admin ê²½ë¡œ)</span>
        String path = request.getRequestURI();
        if (path.startsWith("/admin") && 
            !"ADMIN".equals(user.getRole())) {
            response.sendError(
                HttpServletResponse.SC_FORBIDDEN,
                "ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤."
            );
            return false;
        }
        
        return true;
    }
}

@Configuration
public class WebMvcConfig implements WebMvcConfigurer {
    
    @Autowired
    private AuthenticationInterceptor authInterceptor;
    
    @Override
    public void addInterceptors(
        InterceptorRegistry registry
    ) {
        registry.addInterceptor(authInterceptor)
            <span class="text-green-400">// ì¸ì¦ í•„ìš”í•œ ê²½ë¡œ ì§€ì •</span>
            .addPathPatterns("/transfer/**")
            .addPathPatterns("/change-password")
            .addPathPatterns("/admin/**");
    }
}

<span class="text-green-400">// âœ… ì•ˆì „í•œ ì†¡ê¸ˆ ì»¨íŠ¸ë¡¤ëŸ¬</span>
@Controller
@RequiredArgsConstructor
public class SecureTransferController {
    
    private final TransferService transferService;
    
    @GetMapping("/transfer")
    public String transferPage(
        HttpSession session, 
        Model model
    ) {
        <span class="text-green-400">// ì¸ì¦ í™•ì¸</span>
        User user = (User) session.getAttribute("user");
        if (user == null) {
            return "redirect:/login";
        }
        
        model.addAttribute("user", user);
        return "transfer";
    }
    
    @PostMapping("/transfer")
    public ResponseEntity transfer(
        @RequestBody TransferRequest request,
        HttpSession session
    ) {
        <span class="text-green-400">// 1. ì„¸ì…˜ ê²€ì¦</span>
        User user = (User) session.getAttribute("user");
        if (user == null) {
            return ResponseEntity
                .status(HttpStatus.UNAUTHORIZED)
                .body("ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.");
        }
        
        <span class="text-green-400">// 2. ê³„ì¢Œ ì†Œìœ ì í™•ì¸</span>
        if (!user.getId().equals(
            request.getFromAccountOwnerId()
        )) {
            return ResponseEntity
                .status(HttpStatus.FORBIDDEN)
                .body("ë³¸ì¸ ê³„ì¢Œë§Œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.");
        }
        
        <span class="text-green-400">// 3. ì¶”ê°€ ì¸ì¦ (OTP)</span>
        if (!otpService.verify(
            user.getId(), 
            request.getOtp()
        )) {
            return ResponseEntity
                .status(HttpStatus.UNAUTHORIZED)
                .body("OTP ì¸ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
        }
        
        <span class="text-green-400">// 4. ì†¡ê¸ˆ ì‹¤í–‰</span>
        transferService.execute(
            user.getId(),
            request.getFromAccount(),
            request.getToAccount(),
            request.getAmount()
        );
        
        return ResponseEntity.ok("ì†¡ê¸ˆ ì™„ë£Œ");
    }
}

<span class="text-green-400">// âœ… ì•ˆì „í•œ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</span>
@Controller
@RequiredArgsConstructor
public class SecurePasswordController {
    
    private final UserService userService;
    
    @GetMapping("/change-password")
    public String changePasswordPage(
        HttpSession session
    ) {
        <span class="text-green-400">// ì¸ì¦ í™•ì¸</span>
        if (session.getAttribute("user") == null) {
            return "redirect:/login";
        }
        
        <span class="text-green-400">// ì¬ì¸ì¦ í”Œë˜ê·¸ ì´ˆê¸°í™”</span>
        session.removeAttribute("reauth_verified");
        
        return "change-password";
    }
    
    @PostMapping("/verify-current-password")
    public ResponseEntity verifyCurrentPassword(
        @RequestBody Map<String, String> request,
        HttpSession session
    ) {
        User user = (User) session.getAttribute("user");
        String currentPassword = request.get("password");
        
        <span class="text-green-400">// í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ í™•ì¸</span>
        if (userService.verifyPassword(
            user.getId(), 
            currentPassword
        )) {
            <span class="text-green-400">// ì¬ì¸ì¦ ì™„ë£Œ í”Œë˜ê·¸</span>
            session.setAttribute(
                "reauth_verified", 
                true
            );
            session.setAttribute(
                "reauth_time",
                System.currentTimeMillis()
            );
            
            return ResponseEntity.ok("ì¸ì¦ ì™„ë£Œ");
        } else {
            return ResponseEntity
                .status(HttpStatus.UNAUTHORIZED)
                .body("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
        }
    }
    
    @PostMapping("/change-password")
    public ResponseEntity changePassword(
        @RequestBody PasswordRequest request,
        HttpSession session
    ) {
        User user = (User) session.getAttribute("user");
        
        <span class="text-green-400">// 1. ì¬ì¸ì¦ í™•ì¸</span>
        Boolean reauthVerified = (Boolean) session
            .getAttribute("reauth_verified");
        
        if (reauthVerified == null || !reauthVerified) {
            return ResponseEntity
                .status(HttpStatus.UNAUTHORIZED)
                .body("í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë¨¼ì € í™•ì¸í•´ì£¼ì„¸ìš”.");
        }
        
        <span class="text-green-400">// 2. ì¬ì¸ì¦ ì‹œê°„ í™•ì¸ (5ë¶„ ì´ë‚´)</span>
        Long reauthTime = (Long) session
            .getAttribute("reauth_time");
        long currentTime = System.currentTimeMillis();
        
        if (currentTime - reauthTime > 5 * 60 * 1000) {
            session.removeAttribute("reauth_verified");
            return ResponseEntity
                .status(HttpStatus.UNAUTHORIZED)
                .body("ì¬ì¸ì¦ ì‹œê°„ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");
        }
        
        <span class="text-green-400">// 3. ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</span>
        userService.updatePassword(
            user.getId(),
            request.getNewPassword()
        );
        
        <span class="text-green-400">// 4. ì¬ì¸ì¦ í”Œë˜ê·¸ ì œê±°</span>
        session.removeAttribute("reauth_verified");
        session.removeAttribute("reauth_time");
        
        return ResponseEntity.ok("ë³€ê²½ ì™„ë£Œ");
    }
}

<span class="text-gray-500">// Python Flask - ì•ˆì „í•œ ì¸ì¦</span>

from functools import wraps
from flask import session, redirect, request

<span class="text-green-400"># âœ… ì¸ì¦ ë°ì½”ë ˆì´í„°</span>
def login_required(f):
    @wraps(f)
    def decorated_function(*args, **kwargs):
        <span class="text-green-400"># ì„¸ì…˜ í™•ì¸</span>
        if 'user_id' not in session:
            return redirect('/login')
        
        <span class="text-green-400"># ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì²´í¬ (10ë¶„)</span>
        last_activity = session.get('last_activity')
        if last_activity:
            elapsed = time.time() - last_activity
            if elapsed > 600:  # 10ë¶„
                session.clear()
                return redirect('/login')
        
        <span class="text-green-400"># í™œë™ ì‹œê°„ ì—…ë°ì´íŠ¸</span>
        session['last_activity'] = time.time()
        
        return f(*args, **kwargs)
    return decorated_function

<span class="text-green-400"># âœ… ê´€ë¦¬ì ê¶Œí•œ ì²´í¬</span>
def admin_required(f):
    @wraps(f)
    def decorated_function(*args, **kwargs):
        if 'user_id' not in session:
            return redirect('/login')
        
        <span class="text-green-400"># ê´€ë¦¬ì ê¶Œí•œ í™•ì¸</span>
        user = get_user(session['user_id'])
        if user.role != 'ADMIN':
            return jsonify({
                "error": "ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤."
            }), 403
        
        return f(*args, **kwargs)
    return decorated_function

@app.route('/transfer', methods=['GET', 'POST'])
@login_required
def transfer():
    if request.method == 'GET':
        return render_template('transfer.html')
    
    <span class="text-green-400"># ì‚¬ìš©ì í™•ì¸</span>
    user_id = session['user_id']
    from_account = request.json['from_account']
    
    <span class="text-green-400"># ê³„ì¢Œ ì†Œìœ ì í™•ì¸</span>
    account = get_account(from_account)
    if account.owner_id != user_id:
        return jsonify({
            "error": "ë³¸ì¸ ê³„ì¢Œë§Œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤."
        }), 403
    
    <span class="text-green-400"># OTP í™•ì¸</span>
    otp = request.json.get('otp')
    if not verify_otp(user_id, otp):
        return jsonify({
            "error": "OTP ì¸ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."
        }), 401
    
    execute_transfer(
        from_account,
        request.json['to_account'],
        request.json['amount']
    )
    
    return jsonify({"status": "success"})

@app.route('/change-password', methods=['POST'])
@login_required
def change_password():
    user_id = session['user_id']
    
    <span class="text-green-400"># ì¬ì¸ì¦ í™•ì¸</span>
    if not session.get('reauth_verified'):
        return jsonify({
            "error": "í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë¨¼ì € í™•ì¸í•´ì£¼ì„¸ìš”."
        }), 401
    
    <span class="text-green-400"># ì¬ì¸ì¦ ì‹œê°„ í™•ì¸ (5ë¶„)</span>
    reauth_time = session.get('reauth_time')
    if time.time() - reauth_time > 300:
        session.pop('reauth_verified', None)
        return jsonify({
            "error": "ì¬ì¸ì¦ ì‹œê°„ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤."
        }), 401
    
    <span class="text-green-400"># ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</span>
    update_password(
        user_id,
        request.json['new_password']
    )
    
    <span class="text-green-400"># ì¬ì¸ì¦ í”Œë˜ê·¸ ì œê±°</span>
    session.pop('reauth_verified', None)
    session.pop('reauth_time', None)
    
    return jsonify({"status": "success"})

@app.route('/admin')
@admin_required
def admin_page():
    return render_template('admin.html')

<span class="text-gray-500">// JavaScript/Node.js - ì•ˆì „í•œ í”Œë¡œìš°</span>

<span class="text-green-400">// âœ… ì„¸ì…˜ ê¸°ë°˜ í”Œë¡œìš° ê´€ë¦¬</span>
app.post('/register/step2', (req, res) => {
    const session = req.session;
    
    <span class="text-green-400">// step1 ì™„ë£Œ í™•ì¸</span>
    if (!session.step1_completed) {
        return res.status(400).json({
            error: "ì´ì „ ë‹¨ê³„ë¥¼ ë¨¼ì € ì™„ë£Œí•´ì£¼ì„¸ìš”."
        });
    }
    
    const { address } = req.body;
    saveAddress(session.user_id, address);
    
    <span class="text-green-400">// step2 ì™„ë£Œ í‘œì‹œ</span>
    session.step2_completed = true;
    
    res.json({ next: '/register/step3' });
});

app.post('/register/step3', (req, res) => {
    const session = req.session;
    
    <span class="text-green-400">// ì´ì „ ë‹¨ê³„ í™•ì¸</span>
    if (!session.step1_completed || 
        !session.step2_completed) {
        return res.status(400).json({
            error: "ì´ì „ ë‹¨ê³„ë¥¼ ë¨¼ì € ì™„ë£Œí•´ì£¼ì„¸ìš”."
        });
    }
    
    const { ssn } = req.body;
    saveSsn(session.user_id, ssn);
    
    <span class="text-green-400">// í”Œë¡œìš° ì™„ë£Œ - ì„¸ì…˜ ì •ë¦¬</span>
    delete session.step1_completed;
    delete session.step2_completed;
    
    res.json({ status: 'complete' });
});</code></pre>
            </div>

        </div>
    </div>

    <script>
        let isRunning = false;

        function resetAll() {
            isRunning = false;
            
            document.getElementById('attackerStatus').textContent = 'ì¸ì¦ ìš°íšŒ ì¤€ë¹„ ì¤‘...';
            document.getElementById('browserUrl').textContent = 'https://xxbank.com';
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="text-center text-gray-400 py-20">' +
                '<i class="fas fa-globe text-6xl mb-4"></i>' +
                '<p>ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”</p>' +
                '</div>';
            
            document.getElementById('serverLog').innerHTML = 
                '<div class="text-gray-500">[SERVER] Waiting...</div>';
            
            document.getElementById('serverStatus').textContent = 'RUNNING';
            document.getElementById('serverStatus').className = 'text-xs bg-green-600 px-3 py-1 rounded';
            
            document.getElementById('attackSteps').innerHTML = 
                '<div class="text-gray-500">ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”...</div>';
            
            document.getElementById('attackResult').classList.add('hidden');
            document.getElementById('problemBox').classList.add('hidden');
        }

        async function startScenario(scenario) {
            if (isRunning) return;
            isRunning = true;
            
            resetAll();
            await sleep(300);
            
            if (scenario === 1) {
                await scenario1_DirectUrlAccess();
            } else if (scenario === 2) {
                await scenario2_PasswordChangeNoReauth();
            } else if (scenario === 3) {
                await scenario3_ClientSideOnly();
            }
            
            isRunning = false;
        }

        // ì‹œë‚˜ë¦¬ì˜¤ 1: URL ì§ì ‘ ì…ë ¥ - ì†¡ê¸ˆ í˜ì´ì§€
        async function scenario1_DirectUrlAccess() {
            updateStep('ğŸ¯ ì‹œë‚˜ë¦¬ì˜¤ 1: URL ì§ì ‘ ì…ë ¥ìœ¼ë¡œ ì†¡ê¸ˆ í˜ì´ì§€ ì ‘ê·¼');
            await sleep(1000);
            
            updateStep('1ï¸âƒ£ ê³µê²©ìê°€ ë¡œê·¸ì¸í•˜ì§€ ì•Šì€ ìƒíƒœ');
            document.getElementById('attackerStatus').textContent = 'ë¡œê·¸ì¸ ì—†ì´ ì‹œë„...';
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-md mx-auto mt-10 text-center">' +
                '<i class="fas fa-user-slash text-gray-400 text-6xl mb-4"></i>' +
                '<h2 class="text-2xl font-bold mb-2 text-gray-800">ë¡œê·¸ì¸ ì•ˆ í•¨</h2>' +
                '<p class="text-gray-600">í˜„ì¬ ë¡œê·¸ì¸ ìƒíƒœê°€ ì•„ë‹™ë‹ˆë‹¤.</p>' +
                '<p class="text-sm text-gray-500 mt-2">ì„¸ì…˜: <span class="text-red-600">ì—†ìŒ</span></p>' +
                '</div>';
            
            await sleep(2000);
            
            updateStep('2ï¸âƒ£ ì†¡ê¸ˆ í˜ì´ì§€ URLì„ ì§ì ‘ ì…ë ¥');
            document.getElementById('browserUrl').textContent = 'https://xxbank.com/transfer';
            
            await addServerLog('[INFO] GET /transfer', 'text-blue-400');
            await sleep(300);
            await addServerLog('[INFO] Remote IP: 203.0.113.45', 'text-gray-400');
            await sleep(300);
            await addServerLog('[INFO] Session: null', 'text-yellow-400');
            await sleep(500);
            
            updateStep('3ï¸âƒ£ <span class="text-red-500 font-bold">ì¸ì¦ ì²´í¬ ì—†ì´ í˜ì´ì§€ ì œê³µ!</span>');
            
            await addServerLog('[WARN] No authentication check!', 'text-red-400');
            await sleep(300);
            await addServerLog('[INFO] Rendering transfer.jsp', 'text-green-400');
            await sleep(500);
            await addServerLog('[INFO] Response 200 OK', 'text-green-400');
            await sleep(800);
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-2xl mx-auto mt-6">' +
                '<div class="bg-blue-50 border-2 border-blue-300 rounded-lg p-4 mb-4">' +
                '<div class="flex items-center gap-2 text-blue-700">' +
                '<i class="fas fa-info-circle"></i>' +
                '<span class="font-bold">ì¸ì¦ ì—†ì´ ì ‘ê·¼ ì„±ê³µ!</span>' +
                '</div>' +
                '</div>' +
                '<h2 class="text-2xl font-bold mb-6 text-gray-800">ì†¡ê¸ˆí•˜ê¸°</h2>' +
                '<form class="space-y-4">' +
                '<div>' +
                '<label class="block text-sm font-medium text-gray-700 mb-1">ì¶œê¸ˆ ê³„ì¢Œ</label>' +
                '<input type="text" class="w-full border border-gray-300 rounded px-3 py-2" value="110-123-456789" placeholder="ê³„ì¢Œë²ˆí˜¸">' +
                '</div>' +
                '<div>' +
                '<label class="block text-sm font-medium text-gray-700 mb-1">ì…ê¸ˆ ê³„ì¢Œ</label>' +
                '<input type="text" class="w-full border border-gray-300 rounded px-3 py-2" value="110-987-654321" placeholder="ê³„ì¢Œë²ˆí˜¸">' +
                '</div>' +
                '<div>' +
                '<label class="block text-sm font-medium text-gray-700 mb-1">ê¸ˆì•¡</label>' +
                '<input type="text" class="w-full border border-gray-300 rounded px-3 py-2" value="5,000,000" placeholder="ê¸ˆì•¡">' +
                '</div>' +
                '<button class="w-full bg-blue-600 text-white py-3 rounded hover:bg-blue-700 font-bold">' +
                '<i class="fas fa-exchange-alt mr-2"></i>ì†¡ê¸ˆí•˜ê¸°' +
                '</button>' +
                '</form>' +
                '</div>';
            
            await sleep(2000);
            
            updateStep('4ï¸âƒ£ ì†¡ê¸ˆ ìš”ì²­ ì „ì†¡');
            document.getElementById('attackerStatus').textContent = 'ì†¡ê¸ˆ ì‹¤í–‰ ì¤‘...';
            
            await addServerLog('');
            await addServerLog('[INFO] POST /transfer', 'text-blue-400');
            await sleep(300);
            await addServerLog('[INFO] From: 110-123-456789', 'text-gray-400');
            await sleep(300);
            await addServerLog('[INFO] To: 110-987-654321', 'text-gray-400');
            await sleep(300);
            await addServerLog('[INFO] Amount: 5,000,000ì›', 'text-gray-400');
            await sleep(500);
            await addServerLog('[WARN] No session validation!', 'text-red-400');
            await sleep(500);
            await addServerLog('[WARN] No account ownership check!', 'text-red-400');
            await sleep(500);
            await addServerLog('[INFO] Executing transfer...', 'text-yellow-400');
            await sleep(1000);
            await addServerLog('[SUCCESS] Transfer completed!', 'text-green-400');
            await sleep(500);
            
            updateStep('5ï¸âƒ£ <span class="text-green-500 font-bold">ì†¡ê¸ˆ ì„±ê³µ! 5,000,000ì› íƒˆì·¨!</span>');
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-2xl mx-auto mt-10">' +
                '<div class="bg-green-50 border-2 border-green-300 rounded-lg p-6">' +
                '<div class="flex items-center gap-2 mb-4 text-green-700">' +
                '<i class="fas fa-check-circle text-3xl"></i>' +
                '<h3 class="text-2xl font-bold">ì†¡ê¸ˆ ì™„ë£Œ</h3>' +
                '</div>' +
                '<div class="space-y-2 text-gray-700">' +
                '<div class="flex justify-between py-2 border-b">' +
                '<span>ì¶œê¸ˆ ê³„ì¢Œ:</span>' +
                '<span class="font-bold">110-123-456789</span>' +
                '</div>' +
                '<div class="flex justify-between py-2 border-b">' +
                '<span>ì…ê¸ˆ ê³„ì¢Œ:</span>' +
                '<span class="font-bold">110-987-654321 (ê³µê²©ì)</span>' +
                '</div>' +
                '<div class="flex justify-between py-2 border-b">' +
                '<span>ê¸ˆì•¡:</span>' +
                '<span class="font-bold text-red-600 text-xl">5,000,000ì›</span>' +
                '</div>' +
                '</div>' +
                '</div>' +
                '</div>';
            
            document.getElementById('attackResult').classList.remove('hidden');
            document.getElementById('attackResultContent').innerHTML = 
                '<div class="text-cyan-400 mb-2">âš”ï¸ ê³µê²© ë°©ë²•:</div>' +
                '<div class="text-green-400">1. ë¡œê·¸ì¸ ì—†ì´ ì†¡ê¸ˆ í˜ì´ì§€ URL ì§ì ‘ ì…ë ¥</div>' +
                '<div class="text-green-400">2. ì†¡ê¸ˆ í¼ ì‘ì„±</div>' +
                '<div class="text-green-400">3. ì„œë²„ê°€ ì¸ì¦ ì²´í¬ ì—†ì´ ì²˜ë¦¬</div>' +
                '<div class="border-t border-gray-700 my-2"></div>' +
                '<div class="text-yellow-400 mb-2">ğŸ’° í”¼í•´ì•¡:</div>' +
                '<div class="text-red-400 text-lg font-bold">5,000,000ì› íƒˆì·¨</div>';
            
            showResults('scenario1');
        }

        // ì‹œë‚˜ë¦¬ì˜¤ 2: ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ - ì¬ì¸ì¦ ìš°íšŒ
        async function scenario2_PasswordChangeNoReauth() {
            updateStep('ğŸ¯ ì‹œë‚˜ë¦¬ì˜¤ 2: ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ - ì¬ì¸ì¦ ìš°íšŒ');
            await sleep(1000);
            
            updateStep('1ï¸âƒ£ ê³µê²©ìê°€ í”¼í•´ì ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸');
            document.getElementById('attackerStatus').textContent = 'ì„¸ì…˜ íƒˆì·¨ ì™„ë£Œ...';
            
            await addServerLog('[INFO] User logged in', 'text-blue-400');
            await sleep(300);
            await addServerLog('[INFO] User ID: victim_user', 'text-gray-400');
            await sleep(300);
            await addServerLog('[INFO] Session created: SESS123ABC', 'text-green-400');
            await sleep(500);
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-md mx-auto mt-10">' +
                '<div class="bg-green-50 border-2 border-green-300 rounded-lg p-4 mb-4">' +
                '<div class="flex items-center gap-2 text-green-700">' +
                '<i class="fas fa-user-check"></i>' +
                '<span class="font-bold">ë¡œê·¸ì¸ ì„±ê³µ (ì„¸ì…˜ íƒˆì·¨)</span>' +
                '</div>' +
                '</div>' +
                '<div class="text-center">' +
                '<i class="fas fa-user-circle text-blue-600 text-6xl mb-4"></i>' +
                '<h2 class="text-xl font-bold text-gray-800">í”¼í•´ì ê³„ì •</h2>' +
                '<p class="text-gray-600">victim_user</p>' +
                '</div>' +
                '</div>';
            
            await sleep(2000);
            
            updateStep('2ï¸âƒ£ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ í˜ì´ì§€ ì ‘ê·¼');
            document.getElementById('browserUrl').textContent = 'https://xxbank.com/change-password';
            
            await addServerLog('');
            await addServerLog('[INFO] GET /change-password', 'text-blue-400');
            await sleep(300);
            await addServerLog('[INFO] Session: SESS123ABC', 'text-green-400');
            await sleep(500);
            await addServerLog('[WARN] No re-authentication required!', 'text-red-400');
            await sleep(500);
            await addServerLog('[INFO] Rendering page', 'text-green-400');
            await sleep(800);
            
            updateStep('3ï¸âƒ£ <span class="text-red-500 font-bold">ì¬ì¸ì¦ ì—†ì´ ë³€ê²½ í˜ì´ì§€ ì œê³µ!</span>');
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-2xl mx-auto mt-6">' +
                '<div class="bg-red-50 border-2 border-red-300 rounded-lg p-4 mb-4">' +
                '<div class="flex items-center gap-2 text-red-700">' +
                '<i class="fas fa-exclamation-triangle"></i>' +
                '<span class="font-bold">í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì—†ìŒ!</span>' +
                '</div>' +
                '</div>' +
                '<h2 class="text-2xl font-bold mb-6 text-gray-800">ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</h2>' +
                '<form class="space-y-4">' +
                '<div class="bg-gray-100 p-3 rounded">' +
                '<p class="text-sm text-gray-600"><i class="fas fa-info-circle"></i> í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ ë¶ˆí•„ìš”</p>' +
                '</div>' +
                '<div>' +
                '<label class="block text-sm font-medium text-gray-700 mb-1">ìƒˆ ë¹„ë°€ë²ˆí˜¸</label>' +
                '<input type="password" class="w-full border border-gray-300 rounded px-3 py-2" value="hacker1234">' +
                '</div>' +
                '<div>' +
                '<label class="block text-sm font-medium text-gray-700 mb-1">ìƒˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>' +
                '<input type="password" class="w-full border border-gray-300 rounded px-3 py-2" value="hacker1234">' +
                '</div>' +
                '<button class="w-full bg-blue-600 text-white py-3 rounded hover:bg-blue-700 font-bold">' +
                '<i class="fas fa-key mr-2"></i>ë¹„ë°€ë²ˆí˜¸ ë³€ê²½' +
                '</button>' +
                '</form>' +
                '</div>';
            
            await sleep(2000);
            
            updateStep('4ï¸âƒ£ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ìš”ì²­');
            document.getElementById('attackerStatus').textContent = 'ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì¤‘...';
            
            await addServerLog('');
            await addServerLog('[INFO] POST /change-password', 'text-blue-400');
            await sleep(300);
            await addServerLog('[INFO] User: victim_user', 'text-gray-400');
            await sleep(300);
            await addServerLog('[INFO] New password: hacker1234', 'text-yellow-400');
            await sleep(500);
            await addServerLog('[WARN] No current password check!', 'text-red-400');
            await sleep(500);
            await addServerLog('[INFO] Updating password...', 'text-yellow-400');
            await sleep(1000);
            await addServerLog('[SUCCESS] Password changed!', 'text-green-400');
            await sleep(500);
            
            updateStep('5ï¸âƒ£ <span class="text-green-500 font-bold">ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì™„ë£Œ! ê³„ì • íƒˆì·¨!</span>');
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-2xl mx-auto mt-10">' +
                '<div class="bg-green-50 border-2 border-green-300 rounded-lg p-6">' +
                '<div class="flex items-center gap-2 mb-4 text-green-700">' +
                '<i class="fas fa-check-circle text-3xl"></i>' +
                '<h3 class="text-2xl font-bold">ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì™„ë£Œ</h3>' +
                '</div>' +
                '<div class="bg-white p-4 rounded border border-gray-300">' +
                '<p class="text-gray-700 mb-3">ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.</p>' +
                '<div class="bg-red-100 border border-red-300 p-3 rounded">' +
                '<p class="text-red-700 font-bold">âš ï¸ ê³µê²©ìê°€ ê³„ì •ì„ ì™„ì „íˆ ì¥ì•…!</p>' +
                '<p class="text-sm text-red-600 mt-2">ì´ì œ ê³µê²©ìë§Œ ë¡œê·¸ì¸ ê°€ëŠ¥</p>' +
                '</div>' +
                '</div>' +
                '</div>' +
                '</div>';
            
            document.getElementById('attackResult').classList.remove('hidden');
            document.getElementById('attackResultContent').innerHTML = 
                '<div class="text-cyan-400 mb-2">âš”ï¸ ê³µê²© ë°©ë²•:</div>' +
                '<div class="text-green-400">1. ì„¸ì…˜ í•˜ì´ì¬í‚¹ìœ¼ë¡œ ë¡œê·¸ì¸</div>' +
                '<div class="text-green-400">2. ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ í˜ì´ì§€ ì ‘ê·¼</div>' +
                '<div class="text-green-400">3. í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì—†ì´ ë³€ê²½</div>' +
                '<div class="border-t border-gray-700 my-2"></div>' +
                '<div class="text-yellow-400 mb-2">ğŸ’€ í”¼í•´:</div>' +
                '<div class="text-red-400">ê³„ì • ì™„ì „ íƒˆì·¨ (ì˜êµ¬ì )</div>' +
                '<div class="text-red-400">ì›ë˜ ì‚¬ìš©ì ë¡œê·¸ì¸ ë¶ˆê°€</div>';
            
            showResults('scenario2');
        }

        // ì‹œë‚˜ë¦¬ì˜¤ 3: ê´€ë¦¬ì í˜ì´ì§€ - í´ë¼ì´ì–¸íŠ¸ ê²€ì¦ë§Œ
        async function scenario3_ClientSideOnly() {
            updateStep('ğŸ¯ ì‹œë‚˜ë¦¬ì˜¤ 3: ê´€ë¦¬ì í˜ì´ì§€ - í´ë¼ì´ì–¸íŠ¸ ê²€ì¦ë§Œ');
            await sleep(1000);
            
            updateStep('1ï¸âƒ£ ì¼ë°˜ ì‚¬ìš©ìë¡œ ë¡œê·¸ì¸');
            document.getElementById('attackerStatus').textContent = 'ì¼ë°˜ ì‚¬ìš©ì ë¡œê·¸ì¸...';
            
            await addServerLog('[INFO] User logged in', 'text-blue-400');
            await sleep(300);
            await addServerLog('[INFO] User ID: normal_user', 'text-gray-400');
            await sleep(300);
            await addServerLog('[INFO] Role: USER (not ADMIN)', 'text-yellow-400');
            await sleep(500);
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-md mx-auto mt-10 text-center">' +
                '<i class="fas fa-user text-blue-600 text-6xl mb-4"></i>' +
                '<h2 class="text-xl font-bold text-gray-800">ì¼ë°˜ ì‚¬ìš©ì</h2>' +
                '<p class="text-gray-600">normal_user</p>' +
                '<p class="text-sm text-gray-500 mt-2">ê¶Œí•œ: <span class="text-blue-600">USER</span></p>' +
                '</div>';
            
            await sleep(2000);
            
            updateStep('2ï¸âƒ£ ê´€ë¦¬ì í˜ì´ì§€ URL ì§ì ‘ ì…ë ¥');
            document.getElementById('browserUrl').textContent = 'https://xxbank.com/admin';
            document.getElementById('attackerStatus').textContent = 'ê´€ë¦¬ì í˜ì´ì§€ ì ‘ê·¼...';
            
            await addServerLog('');
            await addServerLog('[INFO] GET /admin', 'text-blue-400');
            await sleep(300);
            await addServerLog('[INFO] User: normal_user', 'text-gray-400');
            await sleep(300);
            await addServerLog('[INFO] Role: USER', 'text-yellow-400');
            await sleep(500);
            await addServerLog('[WARN] No server-side authorization!', 'text-red-400');
            await sleep(500);
            await addServerLog('[INFO] Rendering admin.jsp', 'text-green-400');
            await sleep(800);
            
            updateStep('3ï¸âƒ£ <span class="text-red-500 font-bold">ì„œë²„ ê¶Œí•œ ì²´í¬ ì—†ì´ í˜ì´ì§€ ì œê³µ!</span>');
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-3xl mx-auto mt-6">' +
                '<div class="bg-red-50 border-2 border-red-300 rounded-lg p-4 mb-4">' +
                '<div class="flex items-center gap-2 text-red-700">' +
                '<i class="fas fa-shield-alt"></i>' +
                '<span class="font-bold">JavaScript ê²€ì¦ë§Œ ì¡´ì¬ (ìš°íšŒ ê°€ëŠ¥)</span>' +
                '</div>' +
                '</div>' +
                '<div class="bg-gray-100 p-4 rounded mb-4 code-font text-xs">' +
                '<div class="text-gray-600">&lt;script&gt;</div>' +
                '<div class="text-red-600 ml-4">// í´ë¼ì´ì–¸íŠ¸ ê²€ì¦ë§Œ!</div>' +
                '<div class="text-gray-700 ml-4">if (localStorage.getItem(\'role\') !== \'admin\') {</div>' +
                '<div class="text-gray-700 ml-8">alert(\'ê´€ë¦¬ìë§Œ ì ‘ê·¼ ê°€ëŠ¥\');</div>' +
                '<div class="text-gray-700 ml-8">location.href = \'/\';</div>' +
                '<div class="text-gray-700 ml-4">}</div>' +
                '<div class="text-gray-600">&lt;/script&gt;</div>' +
                '</div>' +
                '<div class="bg-white p-4 rounded border-2 border-gray-300">' +
                '<h2 class="text-2xl font-bold mb-4 text-gray-800">' +
                '<i class="fas fa-user-shield text-red-600 mr-2"></i>ê´€ë¦¬ì í˜ì´ì§€' +
                '</h2>' +
                '<div class="text-sm text-gray-500 mb-4">í˜ì´ì§€ ë¡œë“œë¨ (JavaScript ìš°íšŒ ì „)</div>' +
                '</div>' +
                '</div>';
            
            await sleep(2000);
            
            updateStep('4ï¸âƒ£ ê°œë°œì ë„êµ¬ë¡œ JavaScript ë¬´ë ¥í™”');
            document.getElementById('attackerStatus').textContent = 'JavaScript ë¹„í™œì„±í™”...';
            
            await addServerLog('');
            await addServerLog('[CLIENT] Opening DevTools...', 'text-cyan-400');
            await sleep(500);
            await addServerLog('[CLIENT] Disabling JavaScript validation', 'text-yellow-400');
            await sleep(800);
            await addServerLog('[CLIENT] localStorage.setItem("role", "admin")', 'text-red-400');
            await sleep(500);
            await addServerLog('[CLIENT] JavaScript check bypassed!', 'text-green-400');
            await sleep(1000);
            
            updateStep('5ï¸âƒ£ <span class="text-green-500 font-bold">ê´€ë¦¬ì ê¸°ëŠ¥ ì ‘ê·¼ ì„±ê³µ!</span>');
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-3xl mx-auto mt-6">' +
                '<div class="bg-green-50 border-2 border-green-300 rounded-lg p-4 mb-4">' +
                '<div class="flex items-center gap-2 text-green-700">' +
                '<i class="fas fa-check-circle"></i>' +
                '<span class="font-bold">JavaScript ìš°íšŒ ì™„ë£Œ!</span>' +
                '</div>' +
                '</div>' +
                '<div class="bg-white p-6 rounded-lg border-2 border-gray-300">' +
                '<h2 class="text-2xl font-bold mb-6 text-gray-800">' +
                '<i class="fas fa-user-shield text-green-600 mr-2"></i>ê´€ë¦¬ì í˜ì´ì§€' +
                '</h2>' +
                '<div class="grid grid-cols-2 gap-4">' +
                '<button class="bg-red-600 text-white py-3 rounded hover:bg-red-700">' +
                '<i class="fas fa-users-slash mr-2"></i>ì „ì²´ ì‚¬ìš©ì ì‚­ì œ' +
                '</button>' +
                '<button class="bg-orange-600 text-white py-3 rounded hover:bg-orange-700">' +
                '<i class="fas fa-database mr-2"></i>ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…' +
                '</button>' +
                '<button class="bg-purple-600 text-white py-3 rounded hover:bg-purple-700">' +
                '<i class="fas fa-cog mr-2"></i>ì‹œìŠ¤í…œ ì„¤ì •' +
                '</button>' +
                '<button class="bg-blue-600 text-white py-3 rounded hover:bg-blue-700">' +
                '<i class="fas fa-chart-line mr-2"></i>ì „ì²´ ê±°ë˜ ë‚´ì—­' +
                '</button>' +
                '</div>' +
                '<div class="mt-4 bg-green-100 border border-green-300 p-3 rounded">' +
                '<p class="text-green-700 font-bold">âœ… ëª¨ë“  ê´€ë¦¬ì ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥</p>' +
                '</div>' +
                '</div>' +
                '</div>';
            
            document.getElementById('attackResult').classList.remove('hidden');
            document.getElementById('attackResultContent').innerHTML = 
                '<div class="text-cyan-400 mb-2">âš”ï¸ ê³µê²© ë°©ë²•:</div>' +
                '<div class="text-green-400">1. ê´€ë¦¬ì URL ì§ì ‘ ì…ë ¥</div>' +
                '<div class="text-green-400">2. ê°œë°œì ë„êµ¬ í™œì„±í™”</div>' +
                '<div class="text-green-400">3. localStorage ìˆ˜ì • ë˜ëŠ” JS ë¹„í™œì„±í™”</div>' +
                '<div class="text-green-400">4. í´ë¼ì´ì–¸íŠ¸ ê²€ì¦ ìš°íšŒ</div>' +
                '<div class="border-t border-gray-700 my-2"></div>' +
                '<div class="text-yellow-400 mb-2">ğŸ’¥ ê°€ëŠ¥í•œ ê³µê²©:</div>' +
                '<div class="text-red-400">â€¢ ì „ì²´ ì‚¬ìš©ì ì‚­ì œ</div>' +
                '<div class="text-red-400">â€¢ ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼</div>' +
                '<div class="text-red-400">â€¢ ì‹œìŠ¤í…œ ì„¤ì • ë³€ê²½</div>' +
                '<div class="text-red-400">â€¢ ëª¨ë“  ê±°ë˜ ë‚´ì—­ ì¡°íšŒ</div>';
            
            showResults('scenario3');
        }

        function showResults(scenario) {
            document.getElementById('problemBox').classList.remove('hidden');
            
            let problems = '';
            if (scenario === 'scenario1') {
                problems = 
                    '<div class="bg-black bg-opacity-30 p-3 rounded">' +
                    '<p class="font-bold mb-2">âŒ URL ì§ì ‘ ì ‘ê·¼ ë¬¸ì œ:</p>' +
                    '<div class="space-y-1 ml-4">' +
                    '<div>1. ì¸ì¦ ì—†ì´ ì¤‘ìš” ê¸°ëŠ¥ ì ‘ê·¼</div>' +
                    '<div>2. ì„¸ì…˜ ê²€ì¦ ëˆ„ë½</div>' +
                    '<div>3. ê³„ì¢Œ ì†Œìœ ì í™•ì¸ ì—†ìŒ</div>' +
                    '<div>4. OTP ë“± ì¶”ê°€ ì¸ì¦ ì—†ìŒ</div>' +
                    '</div></div>' +
                    '<div class="bg-black bg-opacity-30 p-3 rounded mt-2">' +
                    '<p class="font-bold mb-2">ğŸ’¥ ì˜ˆìƒ í”¼í•´:</p>' +
                    '<div class="space-y-1 ml-4">' +
                    '<div>â€¢ ë¬´ë‹¨ ì†¡ê¸ˆ</div>' +
                    '<div>â€¢ íƒ€ì¸ ê³„ì¢Œ ì ‘ê·¼</div>' +
                    '<div>â€¢ ê¸ˆì „ì  ì†ì‹¤</div>' +
                    '</div></div>';
            } else if (scenario === 'scenario2') {
                problems = 
                    '<div class="bg-black bg-opacity-30 p-3 rounded">' +
                    '<p class="font-bold mb-2">âŒ ì¬ì¸ì¦ ì—†ìŒ ë¬¸ì œ:</p>' +
                    '<div class="space-y-1 ml-4">' +
                    '<div>1. í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì—†ìŒ</div>' +
                    '<div>2. ì¶”ê°€ ì¸ì¦ ìˆ˜ë‹¨ ì—†ìŒ</div>' +
                    '<div>3. ì„¸ì…˜ë§Œìœ¼ë¡œ ì¤‘ìš” ì •ë³´ ë³€ê²½</div>' +
                    '<div>4. ì¬ì¸ì¦ ì‹œê°„ ì œí•œ ì—†ìŒ</div>' +
                    '</div></div>' +
                    '<div class="bg-black bg-opacity-30 p-3 rounded mt-2">' +
                    '<p class="font-bold mb-2">ğŸ’¥ ì˜ˆìƒ í”¼í•´:</p>' +
                    '<div class="space-y-1 ml-4">' +
                    '<div>â€¢ ê³„ì • ì˜êµ¬ íƒˆì·¨</div>' +
                    '<div>â€¢ ì› ì‚¬ìš©ì ë¡œê·¸ì¸ ë¶ˆê°€</div>' +
                    '<div>â€¢ 2ì°¨ í”¼í•´ ë°œìƒ</div>' +
                    '</div></div>';
            } else {
                problems = 
                    '<div class="bg-black bg-opacity-30 p-3 rounded">' +
                    '<p class="font-bold mb-2">âŒ í´ë¼ì´ì–¸íŠ¸ ê²€ì¦ë§Œ ì¡´ì¬:</p>' +
                    '<div class="space-y-1 ml-4">' +
                    '<div>1. JavaScriptë¡œë§Œ ê¶Œí•œ ì²´í¬</div>' +
                    '<div>2. ì„œë²„ ì¸¡ ê²€ì¦ ì—†ìŒ</div>' +
                    '<div>3. ê°œë°œì ë„êµ¬ë¡œ ìš°íšŒ ê°€ëŠ¥</div>' +
                    '<div>4. localStorage ì¡°ì‘ ê°€ëŠ¥</div>' +
                    '</div></div>' +
                    '<div class="bg-black bg-opacity-30 p-3 rounded mt-2">' +
                    '<p class="font-bold mb-2">ğŸ’¥ ì˜ˆìƒ í”¼í•´:</p>' +
                    '<div class="space-y-1 ml-4">' +
                    '<div>â€¢ ê´€ë¦¬ì ê¶Œí•œ íšë“</div>' +
                    '<div>â€¢ ì „ì²´ ì‹œìŠ¤í…œ ì¥ì•…</div>' +
                    '<div>â€¢ ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼</div>' +
                    '<div>â€¢ ëŒ€ëŸ‰ ì •ë³´ ìœ ì¶œ</div>' +
                    '</div></div>';
            }
            
            document.getElementById('problemContent').innerHTML = problems;
        }

        function updateStep(html) {
            const steps = document.getElementById('attackSteps');
            const div = document.createElement('div');
            div.className = 'p-2 bg-gray-700 rounded text-sm slide-in';
            div.innerHTML = html;
            steps.appendChild(div);
            steps.scrollTop = steps.scrollHeight;
        }

        async function addServerLog(message, colorClass = 'text-green-400') {
            const div = document.createElement('div');
            div.className = colorClass;
            div.textContent = message;
            const container = document.getElementById('serverLog');
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
            await sleep(50);
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
    </script>
</body>
</html>