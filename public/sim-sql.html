<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>SQL Injection Simulation</title>
    <!-- [KR] ì„¤ì • íŒŒì¼ ë¡œë“œ / [EN] Load configuration file -->
    <script src="config.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; max-width: 800px; margin: 0 auto;}
        .container { display: flex; gap: 20px; }
        .box { flex: 1; border: 1px solid #ddd; padding: 20px; border-radius: 8px; }
        .vuln { background-color: #ffe6e6; }
        .secure { background-color: #e6fffa; }
        input { width: 100%; padding: 8px; margin: 10px 0; box-sizing: border-box; }
        button { padding: 8px 16px; cursor: pointer; }
        
        /* ì½”ë“œ ê°€ì´ë“œ ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .code-section { margin-top: 40px; border-top: 2px solid #eee; padding-top: 20px; }
        details { background: #f9f9f9; margin-bottom: 10px; border-radius: 5px; border: 1px solid #ddd; }
        summary { padding: 10px; cursor: pointer; font-weight: bold; }
        pre { background: #333; color: #fff; padding: 15px; overflow-x: auto; }
        .comment { color: #999; }
    </style>
</head>
<body>
    <a href="index.html">â† Main Menu</a>
    <h1>ğŸ’‰ SQL ì‚½ì… (SQL Injection)</h1>

    <div style="background:#f4f7f9; padding:15px; margin-bottom:20px; border-left:5px solid #007bff;">
        <h3>ğŸ“˜ ì·¨ì•½ì  ê°œìš” (Overview)</h3>
        <p><strong>[KR]</strong> ì…ë ¥ê°’ì— SQL ì¿¼ë¦¬ ë¬¸ë²•(ì˜ˆ: ' OR '1'='1)ì„ ì‚½ì…í•˜ì—¬, ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¡°ì‘í•˜ëŠ” ê³µê²©ì…ë‹ˆë‹¤.</p>
        <p><strong>[EN]</strong> An attack that inserts SQL query syntax (e.g., ' OR '1'='1) into input to manipulate the database.</p>
    </div>
    
    <div class="container">
        <!-- ì·¨ì•½í•œ ëª¨ë“œ (Vulnerable) -->
        <div class="box vuln">
            <h2>ğŸš« ì·¨ì•½í•œ ëª¨ë“œ (Vulnerable)</h2>
            <p>[KR] ê³µê²©: <code>admin' OR '1'='1</code> ì…ë ¥</p>
            <p>[EN] Attack: Input <code>admin' OR '1'='1</code></p>
            <!-- ê¸°ë³¸ê°’ìœ¼ë¡œ ê³µê²© êµ¬ë¬¸ì„ ë„£ì–´ë‘  -->
            <input type="text" id="vulnInput" value="admin' OR '1'='1">
            <button onclick="runTest('vulnerableSQL', 'vulnInput')">Run Attack</button>
        </div>

        <!-- ì•ˆì „í•œ ëª¨ë“œ (Secure) -->
        <div class="box secure">
            <h2>âœ… ì•ˆì „í•œ ëª¨ë“œ (Secure)</h2>
            <p>[KR] ë°©ì–´: íŒŒë¼ë¯¸í„° ë°”ì¸ë”© ì ìš©</p>
            <p>[EN] Defense: Use Parameter Binding</p>
            <input type="text" id="secureInput" value="admin' OR '1'='1">
            <button onclick="runTest('secureSQL', 'secureInput')">Run Secure</button>
        </div>
    </div>

    <!-- í•˜ë‹¨ ì½”ë“œ ì˜ˆì œ ì„¹ì…˜ -->
    <div class="code-section">
        <h2>ğŸ“š ì–¸ì–´ë³„ ì‹œíì–´ ì½”ë”© ê°€ì´ë“œ (Secure Coding Guide)</h2>
        
        <!-- Python ì˜ˆì œ -->
        <details>
            <summary>ğŸ Python (Django/Flask)</summary>
            <pre><code><span class="comment"># [KR] ì›ì‹œ SQL ì‚¬ìš© ì‹œ ì¸ìí™”ëœ ì¿¼ë¦¬(Parameterized Query)ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.</span>
<span class="comment"># [EN] Use parameterized queries when using raw SQL.</span>

<span class="comment"># âŒ ì·¨ì•½ (Vulnerable): ë¬¸ìì—´ í¬ë§·íŒ… (String formatting)</span>
<span class="comment"># sql = "SELECT * FROM users WHERE id = '" + user_id + "'"</span>

<span class="comment"># âœ… ì•ˆì „ (Secure): %s í”Œë ˆì´ìŠ¤í™€ë” ë° íŠœí”Œ ë°”ì¸ë”© (Tuple binding)</span>
sql = "SELECT * FROM users WHERE id = %s"
cursor.execute(sql, (user_id,))</code></pre>
        </details>

        <!-- Java ì˜ˆì œ -->
        <details>
            <summary>â˜• Java (JDBC)</summary>
            <pre><code><span class="comment">// [KR] PreparedStatementë¥¼ ì‚¬ìš©í•˜ì—¬ ì»´íŒŒì¼ëœ ì¿¼ë¦¬ ê°ì²´ë¥¼ ì‚¬ìš©í•œë‹¤.</span>
<span class="comment">// [EN] Use PreparedStatement to use compiled query objects.</span>

String sql = "SELECT * FROM users WHERE id = ?";

<span class="comment">// âœ… ì•ˆì „ (Secure): ? ë¬¸ìë¡œ ë°”ì¸ë”© ë³€ìˆ˜ ì‚¬ìš© (? placeholder)</span>
PreparedStatement pstmt = con.prepareStatement(sql);
pstmt.setString(1, userId);
ResultSet rs = pstmt.executeQuery();</code></pre>
        </details>
    </div>

    <script>
        function runTest(funcName, inputId) {
            const inputVal = document.getElementById(inputId).value;
            // SQL êµ¬ë¬¸(ë”°ì˜´í‘œ ë“±)ì´ URL íŒŒë¼ë¯¸í„°ë¡œ ì˜ ì „ë‹¬ë˜ë„ë¡ ì¸ì½”ë”©
            const encodedInput = encodeURIComponent(inputVal);
            // config.jsì˜ BASE_URL ì‚¬ìš©
            const url = `${BASE_URL}/${funcName}?id=${encodedInput}`;
            window.open(url, '_blank');
        }
    </script>
</body>
</html>