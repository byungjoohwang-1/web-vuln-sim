<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¸ˆìœµê¶Œ ë¶ˆí•„ìš”í•œ HTTP Method ì•…ìš© ì‹œë®¬ë ˆì´í„°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        .code-font { font-family: 'Courier New', monospace; }
    </style>
</head>
<body class="bg-gray-100 p-4">

    <!-- í‰ê°€ê¸°ì¤€ ë°°ë„ˆ -->
    <div class="max-w-7xl mx-auto mb-4">
        <div class="bg-red-600 text-white p-4 rounded-lg shadow-lg">
            <div class="flex items-center gap-3">
                <i class="fas fa-clipboard-check text-2xl"></i>
                <div>
                    <h1 class="font-bold text-lg">ì „ìê¸ˆìœµê¸°ë°˜ì‹œì„¤ ë³´ì•ˆ ì·¨ì•½ì  í‰ê°€ê¸°ì¤€ - WEB-SER-049</h1>
                    <p class="text-sm">ë¶ˆí•„ìš”í•œ HTTP Method ì•…ìš© (WM) | ìœ„í—˜ë„: 2 (ë‚®ìŒ) | í†µì œêµ¬ë¶„: 5.5.1 HTTP ë©”ì„œë“œ ì œí•œ</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <div class="max-w-7xl mx-auto">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
            
            <!-- ì¢Œì¸¡: ì·¨ì•½í•œ ì‹œìŠ¤í…œ -->
            <div class="space-y-4">
                
                <!-- ì€í–‰ í—¤ë” -->
                <div class="bg-blue-600 text-white p-4 rounded-lg shadow-lg">
                    <div class="flex items-center gap-3">
                        <i class="fas fa-building-columns text-2xl"></i>
                        <div>
                            <h2 class="text-xl font-bold">ì¼€ì´ë±…í¬</h2>
                            <p class="text-sm">ì¸í„°ë„·ë±…í‚¹ API ì„œë²„</p>
                        </div>
                    </div>
                    <div class="mt-2 bg-red-500 px-3 py-1 rounded text-sm">
                        <i class="fas fa-exclamation-triangle"></i> ì·¨ì•½ì : ë¶ˆí•„ìš”í•œ HTTP Method í—ˆìš©
                    </div>
                </div>

                <!-- HTTP Method í…ŒìŠ¤íŠ¸ -->
                <div class="bg-white p-5 rounded-lg shadow-lg">
                    <h3 class="font-bold text-lg mb-3 flex items-center gap-2">
                        <i class="fas fa-network-wired text-blue-600"></i>
                        HTTP Method í…ŒìŠ¤í„°
                    </h3>
                    
                    <label class="block text-sm font-bold mb-2">Target URL</label>
                    <input type="text" id="targetUrl" 
                           class="w-full p-2 border border-gray-300 rounded mb-3 code-font text-sm" 
                           value="/api/users/12345"
                           readonly>
                    
                    <label class="block text-sm font-bold mb-2">HTTP Method</label>
                    <select id="httpMethod" class="w-full p-2 border border-gray-300 rounded mb-3">
                        <option value="GET">GET</option>
                        <option value="POST">POST</option>
                        <option value="PUT">PUT</option>
                        <option value="DELETE">DELETE</option>
                        <option value="OPTIONS">OPTIONS</option>
                        <option value="TRACE">TRACE</option>
                        <option value="HEAD">HEAD</option>
                    </select>
                    
                    <button onclick="testMethod()" 
                            class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded">
                        <i class="fas fa-paper-plane"></i> ìš”ì²­ ì „ì†¡
                    </button>
                </div>

                <!-- ì„œë²„ ì‘ë‹µ -->
                <div class="bg-gray-900 text-green-400 p-4 rounded-lg shadow-lg">
                    <h3 class="font-bold mb-3 flex items-center gap-2 text-white">
                        <i class="fas fa-server"></i>
                        ì„œë²„ ì‘ë‹µ
                    </h3>
                    <div id="serverResponse" class="code-font text-xs bg-black p-3 rounded min-h-[150px]">
                        <div class="text-gray-500">HTTP Methodë¥¼ ì„ íƒí•˜ê³  ìš”ì²­ì„ ì „ì†¡í•˜ì„¸ìš”</div>
                    </div>
                </div>

                <!-- ê³µê²© ì‹œë‚˜ë¦¬ì˜¤ ë²„íŠ¼ -->
                <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg">
                    <h3 class="font-bold mb-3 flex items-center gap-2">
                        <i class="fas fa-flask text-red-400"></i>
                        ê³µê²© ì‹œë‚˜ë¦¬ì˜¤
                    </h3>
                    <div class="space-y-2">
                        <button onclick="attackScenario(1)" 
                                class="w-full text-left bg-red-900 hover:bg-red-800 px-3 py-2 rounded text-sm">
                            <i class="fas fa-trash"></i> ì‹œë‚˜ë¦¬ì˜¤ 1: DELETEë¡œ ë°ì´í„° ì‚­ì œ
                        </button>
                        <button onclick="attackScenario(2)" 
                                class="w-full text-left bg-orange-900 hover:bg-orange-800 px-3 py-2 rounded text-sm">
                            <i class="fas fa-edit"></i> ì‹œë‚˜ë¦¬ì˜¤ 2: PUTìœ¼ë¡œ ë°ì´í„° ë³€ì¡°
                        </button>
                        <button onclick="attackScenario(3)" 
                                class="w-full text-left bg-purple-900 hover:bg-purple-800 px-3 py-2 rounded text-sm">
                            <i class="fas fa-eye"></i> ì‹œë‚˜ë¦¬ì˜¤ 3: TRACEë¡œ ì •ë³´ ìˆ˜ì§‘
                        </button>
                        <button onclick="attackScenario(4)" 
                                class="w-full text-left bg-yellow-900 hover:bg-yellow-800 px-3 py-2 rounded text-sm">
                            <i class="fas fa-list"></i> ì‹œë‚˜ë¦¬ì˜¤ 4: OPTIONSë¡œ í—ˆìš© ë©”ì„œë“œ í™•ì¸
                        </button>
                    </div>
                </div>

                <!-- ì·¨ì•½í•œ ì½”ë“œ -->
                <div class="bg-gray-900 text-white p-4 rounded-lg shadow-lg">
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="font-bold text-red-400">
                            <i class="fas fa-skull-crossbones"></i> ì·¨ì•½í•œ ì„¤ì •
                        </h3>
                        <span class="text-xs bg-red-600 px-2 py-1 rounded">ìœ„í—˜</span>
                    </div>
                    <pre class="code-font text-xs overflow-x-auto"><code><span class="text-gray-500">// âŒ ëª¨ë“  HTTP Method í—ˆìš©</span>

<span class="text-gray-500">// Spring Controller</span>
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    <span class="text-red-400">// Method ì œí•œ ì—†ìŒ!</span>
    @RequestMapping("/{id}")
    public User getUser(@PathVariable Long id) {
        return userService.findById(id);
    }
    
    <span class="text-red-400">// DELETE í—ˆìš©</span>
    @DeleteMapping("/{id}")
    public void deleteUser(@PathVariable Long id) {
        <span class="text-red-400">// ê¶Œí•œ ì²´í¬ ì—†ìŒ!</span>
        userService.delete(id);
    }
    
    <span class="text-red-400">// PUT í—ˆìš©</span>
    @PutMapping("/{id}")
    public User updateUser(@PathVariable Long id,
                          @RequestBody User user) {
        <span class="text-red-400">// ì†Œìœ ì í™•ì¸ ì—†ìŒ!</span>
        return userService.update(id, user);
    }
}

<span class="text-gray-500">// Apache ì„¤ì • - Method ì œí•œ ì—†ìŒ</span>
&lt;Directory /var/www/html&gt;
    <span class="text-red-400">&lt;!-- ëª¨ë“  Method í—ˆìš© --&gt;</span>
    AllowOverride All
    Require all granted
&lt;/Directory&gt;

<span class="text-gray-500">// web.xml - TRACE í™œì„±í™”</span>
<span class="text-red-400">&lt;!-- TRACE method ë¹„í™œì„±í™” ì•ˆ ë¨ --&gt;</span></code></pre>
                </div>

            </div>

            <!-- ìš°ì¸¡: ê²°ê³¼ ë° ì•ˆì „í•œ ì½”ë“œ -->
            <div class="space-y-4">
                
                <!-- ê³µê²© ì‹¤í–‰ ê²°ê³¼ -->
                <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                    <div class="bg-gray-800 text-white px-4 py-3 flex justify-between items-center">
                        <h3 class="font-bold">
                            <i class="fas fa-terminal"></i> ê³µê²© ì‹¤í–‰ ê²°ê³¼
                        </h3>
                        <span id="statusBadge" class="text-xs bg-green-500 text-gray-900 px-3 py-1 rounded">
                            ëŒ€ê¸°ì¤‘
                        </span>
                    </div>
                    <div id="attackResult" class="p-5 min-h-[300px] bg-white">
                        <div class="text-center text-gray-400 py-10">
                            <i class="fas fa-exchange-alt text-5xl mb-3 opacity-30"></i>
                            <p class="text-sm">ê³µê²© ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
                        </div>
                    </div>
                </div>

                <!-- ê³µê²© ë‹¨ê³„ -->
                <div id="attackStages" class="hidden bg-red-100 border-l-4 border-red-600 p-4 rounded-lg">
                    <h4 class="font-bold text-red-700 mb-2 flex items-center gap-2">
                        <i class="fas fa-list-ol"></i> ê³µê²© ì§„í–‰ ë‹¨ê³„
                    </h4>
                    <div id="stagesContent" class="text-sm text-red-700 space-y-1"></div>
                </div>

                <!-- í„°ë¯¸ë„ ì¶œë ¥ -->
                <div id="terminalBox" class="hidden bg-black text-green-400 p-4 rounded-lg shadow-lg">
                    <div class="font-bold mb-2 text-xs">
                        <i class="fas fa-terminal"></i> ATTACKER CONSOLE
                    </div>
                    <div id="terminalLines" class="code-font text-xs space-y-1 max-h-[200px] overflow-y-auto"></div>
                </div>

                <!-- ì•ˆì „í•œ ì½”ë“œ -->
                <div class="bg-gray-900 text-white p-4 rounded-lg shadow-lg">
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="font-bold text-green-400">
                            <i class="fas fa-shield-halved"></i> ì•ˆì „í•œ ì„¤ì •
                        </h3>
                        <span class="text-xs bg-green-600 px-2 py-1 rounded">ê¶Œì¥</span>
                    </div>
                    <pre class="code-font text-xs overflow-x-auto max-h-[350px]"><code><span class="text-green-400">// âœ… HTTP Method ëª…ì‹œì  ì œí•œ</span>

<span class="text-gray-500">// 1. Spring - í•„ìš”í•œ Methodë§Œ í—ˆìš©</span>
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    <span class="text-green-400">// GETë§Œ í—ˆìš©</span>
    @GetMapping("/{id}")
    public User getUser(@PathVariable Long id) {
        return userService.findById(id);
    }
    
    <span class="text-green-400">// DELETE - ê¶Œí•œ ê²€ì¦ í•„ìˆ˜</span>
    @DeleteMapping("/{id}")
    @PreAuthorize("hasRole('ADMIN')")
    public void deleteUser(@PathVariable Long id,
                          Authentication auth) {
        
        <span class="text-green-400">// ë³¸ì¸ ë˜ëŠ” ê´€ë¦¬ìë§Œ ì‚­ì œ ê°€ëŠ¥</span>
        User currentUser = (User) auth.getPrincipal();
        if (!currentUser.isAdmin() && 
            !currentUser.getId().equals(id)) {
            throw new AccessDeniedException();
        }
        
        userService.delete(id);
    }
    
    <span class="text-green-400">// PUT - ì†Œìœ ì í™•ì¸</span>
    @PutMapping("/{id}")
    public User updateUser(@PathVariable Long id,
                          @RequestBody User user,
                          Authentication auth) {
        
        User currentUser = (User) auth.getPrincipal();
        
        <span class="text-green-400">// ë³¸ì¸ ë°ì´í„°ë§Œ ìˆ˜ì • ê°€ëŠ¥</span>
        if (!currentUser.getId().equals(id)) {
            throw new AccessDeniedException();
        }
        
        return userService.update(id, user);
    }
}

<span class="text-gray-500">// 2. Spring Security - Method ì œí•œ</span>
@Configuration
public class SecurityConfig {
    
    @Bean
    public SecurityFilterChain filterChain(
        HttpSecurity http) throws Exception {
        
        http
            .authorizeHttpRequests(auth -> auth
                <span class="text-green-400">// ì½ê¸°ëŠ” ì¸ì¦ëœ ì‚¬ìš©ì</span>
                .requestMatchers(HttpMethod.GET, "/api/**")
                    .authenticated()
                
                <span class="text-green-400">// ì“°ê¸°ëŠ” ê´€ë¦¬ìë§Œ</span>
                .requestMatchers(HttpMethod.POST, "/api/**")
                    .hasRole("ADMIN")
                .requestMatchers(HttpMethod.PUT, "/api/**")
                    .hasRole("ADMIN")
                .requestMatchers(HttpMethod.DELETE, "/api/**")
                    .hasRole("ADMIN")
                
                <span class="text-green-400">// TRACE, OPTIONS ì°¨ë‹¨</span>
                .requestMatchers(HttpMethod.TRACE, "/**")
                    .denyAll()
                .requestMatchers(HttpMethod.OPTIONS, "/**")
                    .denyAll()
            );
        
        return http.build();
    }
}

<span class="text-gray-500">// 3. Apache - Method ì œí•œ</span>
&lt;Directory /var/www/html&gt;
    <span class="text-green-400">&lt;!-- GET, POSTë§Œ í—ˆìš© --&gt;</span>
    &lt;LimitExcept GET POST&gt;
        Require all denied
    &lt;/LimitExcept&gt;
    
    <span class="text-green-400">&lt;!-- TRACE ë¹„í™œì„±í™” --&gt;</span>
    TraceEnable off
&lt;/Directory&gt;

<span class="text-gray-500">// 4. Nginx - Method ì œí•œ</span>
server {
    location /api {
        <span class="text-green-400"># GET, POSTë§Œ í—ˆìš©</span>
        limit_except GET POST {
            deny all;
        }
        
        <span class="text-green-400"># TRACE ì°¨ë‹¨</span>
        if ($request_method = TRACE) {
            return 405;
        }
        
        proxy_pass http://backend;
    }
}

<span class="text-gray-500">// 5. Filterë¡œ Method ê²€ì¦</span>
@Component
public class HttpMethodFilter extends OncePerRequestFilter {
    
    private static final Set<String> ALLOWED_METHODS = 
        Set.of("GET", "POST");
    
    @Override
    protected void doFilterInternal(
        HttpServletRequest request,
        HttpServletResponse response,
        FilterChain chain) throws IOException {
        
        String method = request.getMethod();
        
        <span class="text-green-400">// í—ˆìš©ëœ Methodì¸ì§€ í™•ì¸</span>
        if (!ALLOWED_METHODS.contains(method)) {
            response.sendError(
                HttpServletResponse.SC_METHOD_NOT_ALLOWED,
                "Method " + method + " not allowed"
            );
            return;
        }
        
        <span class="text-green-400">// TRACE íŠ¹ë³„ ì°¨ë‹¨</span>
        if ("TRACE".equals(method)) {
            response.sendError(
                HttpServletResponse.SC_FORBIDDEN,
                "TRACE method is disabled"
            );
            return;
        }
        
        chain.doFilter(request, response);
    }
}

<span class="text-gray-500">// 6. WebDAV ë¹„í™œì„±í™”</span>
&lt;IfModule mod_dav.c&gt;
    <span class="text-green-400"># WebDAV ì™„ì „ ë¹„í™œì„±í™”</span>
    DavLockDB /dev/null
    Dav Off
&lt;/IfModule&gt;</code></pre>
                </div>

                <!-- ë°©ì–´ ì²´í¬ë¦¬ìŠ¤íŠ¸ -->
                <div class="bg-white p-4 rounded-lg shadow-lg">
                    <h3 class="font-bold mb-3 flex items-center gap-2">
                        <i class="fas fa-list-check text-red-600"></i>
                        HTTP Method ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸
                    </h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>í•„ìš”í•œ Methodë§Œ:</strong> GET, POSTë§Œ í—ˆìš©</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>TRACE ì°¨ë‹¨:</strong> XST ê³µê²© ë°©ì–´</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>OPTIONS ì œí•œ:</strong> ì •ë³´ ë…¸ì¶œ ë°©ì§€</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>DELETE/PUT ê¶Œí•œ:</strong> ê´€ë¦¬ìë§Œ í—ˆìš©</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>WebDAV ë¹„í™œì„±í™”:</strong> ë¶ˆí•„ìš”í•œ ê¸°ëŠ¥ ì œê±°</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>405 ì‘ë‹µ:</strong> í—ˆìš©ë˜ì§€ ì•Šì€ Method</div>
                        </div>
                    </div>
                </div>

                <!-- í—ˆìš© Method ë§¤íŠ¸ë¦­ìŠ¤ -->
                <div class="bg-white p-4 rounded-lg shadow-lg">
                    <h3 class="font-bold mb-3 flex items-center gap-2">
                        <i class="fas fa-table text-blue-600"></i>
                        HTTP Method í—ˆìš© ë§¤íŠ¸ë¦­ìŠ¤
                    </h3>
                    <table class="w-full text-xs border">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="border p-2 text-left">Method</th>
                                <th class="border p-2">ì¼ë°˜ ì‚¬ìš©ì</th>
                                <th class="border p-2">ê´€ë¦¬ì</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="border p-2 font-bold">GET</td>
                                <td class="border p-2 text-center text-green-600">âœ“ í—ˆìš©</td>
                                <td class="border p-2 text-center text-green-600">âœ“ í—ˆìš©</td>
                            </tr>
                            <tr>
                                <td class="border p-2 font-bold">POST</td>
                                <td class="border p-2 text-center text-green-600">âœ“ í—ˆìš©</td>
                                <td class="border p-2 text-center text-green-600">âœ“ í—ˆìš©</td>
                            </tr>
                            <tr class="bg-red-50">
                                <td class="border p-2 font-bold">PUT</td>
                                <td class="border p-2 text-center text-red-600">âœ— ì°¨ë‹¨</td>
                                <td class="border p-2 text-center text-yellow-600">â–³ ì œí•œì </td>
                            </tr>
                            <tr class="bg-red-50">
                                <td class="border p-2 font-bold">DELETE</td>
                                <td class="border p-2 text-center text-red-600">âœ— ì°¨ë‹¨</td>
                                <td class="border p-2 text-center text-yellow-600">â–³ ì œí•œì </td>
                            </tr>
                            <tr class="bg-red-50">
                                <td class="border p-2 font-bold">TRACE</td>
                                <td class="border p-2 text-center text-red-600">âœ— ì°¨ë‹¨</td>
                                <td class="border p-2 text-center text-red-600">âœ— ì°¨ë‹¨</td>
                            </tr>
                            <tr class="bg-red-50">
                                <td class="border p-2 font-bold">OPTIONS</td>
                                <td class="border p-2 text-center text-red-600">âœ— ì°¨ë‹¨</td>
                                <td class="border p-2 text-center text-red-600">âœ— ì°¨ë‹¨</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- í‰ê°€ íŒì • -->
                <div id="judgementBox" class="hidden bg-gray-900 text-white p-4 rounded-lg">
                    <h3 class="font-bold text-indigo-400 mb-2 text-sm">
                        <i class="fas fa-gavel"></i> í‰ê°€ íŒì •
                    </h3>
                    <div class="text-xs space-y-1">
                        <div><strong>í‰ê°€í•­ëª©:</strong> WEB-SER-049 ë¶ˆí•„ìš”í•œ HTTP Method</div>
                        <div><strong>íŒì •:</strong> <span id="judgement" class="text-red-400">ì·¨ì•½</span></div>
                        <div><strong>ê·¼ê±°:</strong> <span id="evidence"></span></div>
                    </div>
                </div>

                <!-- í”¼í•´ ì‹œë‚˜ë¦¬ì˜¤ -->
                <div id="damageBox" class="hidden bg-red-700 text-white p-4 rounded-lg">
                    <h3 class="font-bold mb-3">
                        <i class="fas fa-fire"></i> ì‹¤ì œ í”¼í•´ ì‚¬ë¡€
                    </h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex gap-2">
                            <span class="font-bold">1.</span>
                            <div><strong>ë°ì´í„° ì‚­ì œ</strong><br>DELETEë¡œ ì‚¬ìš©ì ì •ë³´ ì‚­ì œ</div>
                        </div>
                        <div class="flex gap-2">
                            <span class="font-bold">2.</span>
                            <div><strong>ë°ì´í„° ë³€ì¡°</strong><br>PUTìœ¼ë¡œ ê¶Œí•œ ìƒìŠ¹</div>
                        </div>
                        <div class="flex gap-2">
                            <span class="font-bold">3.</span>
                            <div><strong>ì •ë³´ ìˆ˜ì§‘</strong><br>OPTIONSë¡œ ì„œë²„ ì •ë³´ ë…¸ì¶œ</div>
                        </div>
                        <div class="flex gap-2">
                            <span class="font-bold">4.</span>
                            <div><strong>XST ê³µê²©</strong><br>TRACEë¡œ ì¿ í‚¤ íƒˆì·¨</div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        function testMethod() {
            var method = document.getElementById('httpMethod').value;
            var url = document.getElementById('targetUrl').value;
            var response = document.getElementById('serverResponse');
            
            response.innerHTML = '<div class="text-yellow-400">ìš”ì²­ ì „ì†¡ ì¤‘...</div>';
            
            setTimeout(function() {
                if (method === 'GET') {
                    response.innerHTML = 
                        '<div class="text-green-400">' + method + ' ' + url + ' HTTP/1.1</div>' +
                        '<div class="text-gray-400">Status: 200 OK</div>' +
                        '<div class="mt-2 text-green-400">Response:</div>' +
                        '<div class="text-gray-400">{</div>' +
                        '<div class="text-gray-400 ml-2">"id": 12345,</div>' +
                        '<div class="text-gray-400 ml-2">"name": "í™ê¸¸ë™",</div>' +
                        '<div class="text-gray-400 ml-2">"balance": 1234000</div>' +
                        '<div class="text-gray-400">}</div>';
                } else if (method === 'DELETE' || method === 'PUT') {
                    response.innerHTML = 
                        '<div class="text-red-400">' + method + ' ' + url + ' HTTP/1.1</div>' +
                        '<div class="text-red-400">Status: 200 OK</div>' +
                        '<div class="mt-2 text-red-400">âš ï¸ Method í—ˆìš©ë¨!</div>' +
                        '<div class="text-red-400">ê¶Œí•œ ì²´í¬ ì—†ìŒ</div>';
                } else if (method === 'OPTIONS') {
                    response.innerHTML = 
                        '<div class="text-yellow-400">' + method + ' ' + url + ' HTTP/1.1</div>' +
                        '<div class="text-gray-400">Status: 200 OK</div>' +
                        '<div class="mt-2 text-yellow-400">Allow:</div>' +
                        '<div class="text-red-400">GET, POST, PUT, DELETE, OPTIONS, TRACE</div>' +
                        '<div class="text-red-400 mt-2">âš ï¸ ëª¨ë“  Method ë…¸ì¶œ!</div>';
                } else if (method === 'TRACE') {
                    response.innerHTML = 
                        '<div class="text-red-400">' + method + ' ' + url + ' HTTP/1.1</div>' +
                        '<div class="text-gray-400">Status: 200 OK</div>' +
                        '<div class="mt-2 text-red-400">TRACE ì‘ë‹µ:</div>' +
                        '<div class="text-red-400">Cookie: JSESSIONID=ABC123...</div>' +
                        '<div class="text-red-400 mt-2">âš ï¸ XST ê³µê²© ê°€ëŠ¥!</div>';
                } else {
                    response.innerHTML = 
                        '<div class="text-gray-400">' + method + ' ' + url + ' HTTP/1.1</div>' +
                        '<div class="text-gray-400">Status: 200 OK</div>';
                }
            }, 500);
        }

        async function attackScenario(type) {
            document.getElementById('serverResponse').innerHTML = 
                '<div class="text-gray-500">HTTP Methodë¥¼ ì„ íƒí•˜ê³  ìš”ì²­ì„ ì „ì†¡í•˜ì„¸ìš”</div>';
            
            var result = document.getElementById('attackResult');
            var badge = document.getElementById('statusBadge');
            
            document.getElementById('attackStages').classList.remove('hidden');
            document.getElementById('terminalBox').classList.remove('hidden');
            document.getElementById('judgementBox').classList.remove('hidden');
            document.getElementById('damageBox').classList.remove('hidden');
            document.getElementById('terminalLines').innerHTML = '';
            
            if (type === 1) {
                // ì‹œë‚˜ë¦¬ì˜¤ 1: DELETE
                document.getElementById('stagesContent').innerHTML = 
                    '<div>1. OPTIONSë¡œ í—ˆìš© Method í™•ì¸</div>' +
                    '<div>2. DELETE Method ì§€ì› í™•ì¸</div>' +
                    '<div>3. íƒ€ì¸ ê³„ì • IDë¡œ DELETE ìš”ì²­</div>' +
                    '<div>4. ë°ì´í„° ì‚­ì œ ì„±ê³µ!</div>';
                
                document.getElementById('httpMethod').value = 'OPTIONS';
                
                addTerminalLine('> OPTIONS ìš”ì²­ìœ¼ë¡œ í—ˆìš© Method í™•ì¸...');
                await sleep(500);
                addTerminalLine('> curl -X OPTIONS https://bank.com/api/users/12345');
                await sleep(800);
                
                testMethod();
                await sleep(1000);
                
                addTerminalLine('> [!] DELETE Method í—ˆìš©ë¨!', 'text-red-400');
                await sleep(500);
                
                document.getElementById('httpMethod').value = 'DELETE';
                
                addTerminalLine('> DELETE ìš”ì²­ ì „ì†¡...', 'text-yellow-400');
                await sleep(500);
                addTerminalLine('> curl -X DELETE https://bank.com/api/users/12345');
                await sleep(800);
                
                testMethod();
                await sleep(1000);
                
                addTerminalLine('> [!] ì‚¬ìš©ì ì‚­ì œ ì™„ë£Œ!', 'text-red-400');
                
                result.innerHTML = 
                    '<div class="bg-red-50 border-l-4 border-red-500 p-4">' +
                    '<h4 class="font-bold text-red-700 mb-3">ğŸš¨ DELETEë¡œ ë°ì´í„° ì‚­ì œ</h4>' +
                    '<div class="bg-gray-900 text-green-400 p-3 rounded mb-3 code-font text-xs">' +
                    '<div class="text-white">$ curl -X DELETE \\</div>' +
                    '<div class="ml-2">https://bank.com/api/users/12345</div>' +
                    '<div class="mt-2 text-red-400">HTTP/1.1 200 OK</div>' +
                    '<div class="text-red-400">{"message": "User deleted"}</div>' +
                    '</div>' +
                    '<div class="bg-white p-3 rounded mb-3 border">' +
                    '<p class="text-sm font-bold mb-2">ì‚­ì œëœ ë°ì´í„°:</p>' +
                    '<div class="text-xs space-y-1">' +
                    '<div>ì‚¬ìš©ì ID: 12345</div>' +
                    '<div>ì´ë¦„: í™ê¸¸ë™</div>' +
                    '<div>ê³„ì¢Œ: 110-123-456789</div>' +
                    '<div>ì”ì•¡: 1,234,000ì›</div>' +
                    '</div></div>' +
                    '<div class="bg-red-900 text-red-100 p-3 rounded text-sm">' +
                    '<p class="font-bold">ğŸ’€ í”¼í•´</p>' +
                    '<p>ê¶Œí•œ ì—†ì´ íƒ€ì¸ ê³„ì • ì‚­ì œ</p>' +
                    '<p>ë³µêµ¬ ë¶ˆê°€ëŠ¥í•œ ë°ì´í„° ì†ì‹¤</p>' +
                    '</div></div>';
                
                document.getElementById('evidence').textContent = 'DELETE Method ë¬´ì œí•œ í—ˆìš©';
                badge.textContent = 'ì·¨ì•½';
                badge.className = 'text-xs bg-red-500 text-white px-3 py-1 rounded';
                
            } else if (type === 2) {
                // ì‹œë‚˜ë¦¬ì˜¤ 2: PUT
                document.getElementById('stagesContent').innerHTML = 
                    '<div>1. PUT Method ì§€ì› í™•ì¸</div>' +
                    '<div>2. íƒ€ì¸ ê³„ì • ì •ë³´ ì¡°íšŒ</div>' +
                    '<div>3. PUTìœ¼ë¡œ ê¶Œí•œ ë³€ì¡°</div>' +
                    '<div>4. ì¼ë°˜ ì‚¬ìš©ì â†’ ê´€ë¦¬ì ìŠ¹ê²©!</div>';
                
                document.getElementById('httpMethod').value = 'GET';
                
                addTerminalLine('> ëŒ€ìƒ ê³„ì • ì¡°íšŒ...');
                await sleep(500);
                addTerminalLine('> curl https://bank.com/api/users/12345');
                await sleep(800);
                addTerminalLine('> {"id":12345, "role":"user", "balance":1234000}', 'text-gray-400');
                await sleep(500);
                
                document.getElementById('httpMethod').value = 'PUT';
                
                addTerminalLine('> PUT ìš”ì²­ìœ¼ë¡œ role ë³€ì¡°...', 'text-yellow-400');
                await sleep(500);
                addTerminalLine('> curl -X PUT https://bank.com/api/users/12345 \\', 'text-red-400');
                addTerminalLine('  -d \'{"role":"admin"}\'', 'text-red-400');
                await sleep(1000);
                
                testMethod();
                await sleep(1000);
                
                addTerminalLine('> [!] ê´€ë¦¬ì ê¶Œí•œ íšë“!', 'text-red-400');
                
                result.innerHTML = 
                    '<div class="bg-red-50 border-l-4 border-red-500 p-4">' +
                    '<h4 class="font-bold text-red-700 mb-3">ğŸš¨ PUTìœ¼ë¡œ ê¶Œí•œ ìƒìŠ¹</h4>' +
                    '<div class="bg-white p-3 rounded mb-3 border">' +
                    '<p class="text-sm font-bold mb-2">ë³€ì¡° ê³¼ì •:</p>' +
                    '<table class="w-full text-xs">' +
                    '<tr class="border-b bg-gray-50"><th class="text-left py-1">í•­ëª©</th><th class="text-left py-1">Before</th><th class="text-left py-1">After</th></tr>' +
                    '<tr class="border-b"><td class="py-1">role</td><td class="py-1">user</td><td class="py-1 text-red-600">admin</td></tr>' +
                    '<tr class="border-b"><td class="py-1">ê¶Œí•œ</td><td class="py-1">ì¼ë°˜</td><td class="py-1 text-red-600">ê´€ë¦¬ì</td></tr>' +
                    '<tr><td class="py-1">balance</td><td class="py-1">1,234,000</td><td class="py-1 text-red-600">999,999,999</td></tr>' +
                    '</table></div>' +
                    '<div class="bg-gray-900 text-green-400 p-3 rounded code-font text-xs mb-3">' +
                    '<div class="text-white">$ curl -X PUT \\</div>' +
                    '<div class="ml-2">https://bank.com/api/users/12345 \\</div>' +
                    '<div class="ml-2">-d \'{"role":"admin","balance":999999999}\'</div>' +
                    '<div class="mt-2 text-red-400">{"status":"updated"}</div>' +
                    '</div>' +
                    '<div class="bg-red-900 text-red-100 p-3 rounded text-sm">' +
                    '<p class="font-bold">ğŸ’€ ê¶Œí•œ ìƒìŠ¹ ì™„ë£Œ</p>' +
                    '<p>ì¼ë°˜ ì‚¬ìš©ì â†’ ê´€ë¦¬ì</p>' +
                    '<p>ì „ì²´ ì‹œìŠ¤í…œ ì ‘ê·¼ ê°€ëŠ¥</p>' +
                    '</div></div>';
                
                document.getElementById('evidence').textContent = 'PUT Method ê¶Œí•œ ê²€ì¦ ë¶€ì¬';
                badge.textContent = 'ì¹˜ëª…ì ';
                badge.className = 'text-xs bg-red-600 text-white px-3 py-1 rounded';
                
            } else if (type === 3) {
                // ì‹œë‚˜ë¦¬ì˜¤ 3: TRACE
                document.getElementById('stagesContent').innerHTML = 
                    '<div>1. TRACE Method ì§€ì› í™•ì¸</div>' +
                    '<div>2. TRACE ìš”ì²­ ì „ì†¡</div>' +
                    '<div>3. ìš”ì²­ í—¤ë”ê°€ ì‘ë‹µì— ë°˜í™˜ë¨</div>' +
                    '<div>4. Cookie ì •ë³´ íƒˆì·¨ (XST)!</div>';
                
                document.getElementById('httpMethod').value = 'TRACE';
                
                addTerminalLine('> TRACE Method í…ŒìŠ¤íŠ¸...');
                await sleep(500);
                addTerminalLine('> curl -X TRACE https://bank.com/api/users \\', 'text-yellow-400');
                addTerminalLine('  -H "Cookie: JSESSIONID=ABC123..."', 'text-yellow-400');
                await sleep(1000);
                
                testMethod();
                await sleep(1000);
                
                addTerminalLine('> [!] TRACE ì‘ë‹µì— Cookie í¬í•¨!', 'text-red-400');
                await sleep(500);
                addTerminalLine('> XSS + TRACE = XST ê³µê²© ê°€ëŠ¥', 'text-red-400');
                
                result.innerHTML = 
                    '<div class="bg-red-50 border-l-4 border-red-500 p-4">' +
                    '<h4 class="font-bold text-red-700 mb-3">ğŸš¨ TRACEë¡œ ì •ë³´ ìˆ˜ì§‘ (XST)</h4>' +
                    '<div class="bg-gray-900 text-green-400 p-3 rounded mb-3 code-font text-xs">' +
                    '<div class="text-white">$ curl -X TRACE \\</div>' +
                    '<div class="ml-2">https://bank.com/api/users \\</div>' +
                    '<div class="ml-2">-H "Cookie: JSESSIONID=ABC123..."</div>' +
                    '<div class="mt-2 text-yellow-400">Response:</div>' +
                    '<div class="text-gray-400">TRACE /api/users HTTP/1.1</div>' +
                    '<div class="text-red-400">Cookie: JSESSIONID=ABC123DEF456</div>' +
                    '<div class="text-red-400">Authorization: Bearer eyJ...</div>' +
                    '</div>' +
                    '<div class="bg-yellow-100 border border-yellow-400 p-3 rounded mb-3 text-sm">' +
                    '<p class="font-bold text-yellow-800 mb-2">âš ï¸ XST (Cross-Site Tracing) ê³µê²©</p>' +
                    '<p class="text-yellow-800 text-xs">XSS + TRACE = HttpOnly ì¿ í‚¤ ìš°íšŒ</p>' +
                    '<div class="bg-gray-900 text-green-400 p-2 rounded mt-2 code-font text-xs">' +
                    '<div>var xhr = new XMLHttpRequest();</div>' +
                    '<div>xhr.open(\'TRACE\', url);</div>' +
                    '<div class="text-red-400">// HttpOnly ì¿ í‚¤ë„ íƒˆì·¨!</div>' +
                    '</div></div>' +
                    '<div class="bg-red-900 text-red-100 p-3 rounded text-sm">' +
                    '<p class="font-bold">ğŸ’€ ë³´ì•ˆ ìœ„í˜‘</p>' +
                    '<p>HttpOnly ì¿ í‚¤ ë³´í˜¸ ìš°íšŒ</p>' +
                    '<p>ì„¸ì…˜ í•˜ì´ì¬í‚¹ ê°€ëŠ¥</p>' +
                    '</div></div>';
                
                document.getElementById('evidence').textContent = 'TRACE Method í™œì„±í™”';
                badge.textContent = 'ìœ„í—˜';
                badge.className = 'text-xs bg-orange-500 text-white px-3 py-1 rounded';
                
            } else if (type === 4) {
                // ì‹œë‚˜ë¦¬ì˜¤ 4: OPTIONS
                document.getElementById('stagesContent').innerHTML = 
                    '<div>1. OPTIONS ìš”ì²­ ì „ì†¡</div>' +
                    '<div>2. í—ˆìš©ëœ ëª¨ë“  Method í™•ì¸</div>' +
                    '<div>3. ì„œë²„ ì •ë³´ ìˆ˜ì§‘</div>' +
                    '<div>4. ê³µê²© ë²¡í„° íŒŒì•…!</div>';
                
                document.getElementById('httpMethod').value = 'OPTIONS';
                
                addTerminalLine('> OPTIONS ìš”ì²­ ì „ì†¡...');
                await sleep(500);
                addTerminalLine('> curl -X OPTIONS -i https://bank.com/api/users');
                await sleep(1000);
                
                testMethod();
                await sleep(1000);
                
                addTerminalLine('> [!] ì„œë²„ ì •ë³´ ìˆ˜ì§‘ ì™„ë£Œ', 'text-red-400');
                await sleep(300);
                addTerminalLine('> í—ˆìš© Method: GET, POST, PUT, DELETE, TRACE', 'text-red-400');
                await sleep(300);
                addTerminalLine('> Server: Apache/2.4.41', 'text-yellow-400');
                await sleep(300);
                addTerminalLine('> ê³µê²© ë²¡í„° ë¶„ì„ ì™„ë£Œ', 'text-red-400');
                
                result.innerHTML = 
                    '<div class="bg-red-50 border-l-4 border-red-500 p-4">' +
                    '<h4 class="font-bold text-red-700 mb-3">ğŸš¨ OPTIONSë¡œ ì •ë³´ ìˆ˜ì§‘</h4>' +
                    '<div class="bg-gray-900 text-green-400 p-3 rounded mb-3 code-font text-xs">' +
                    '<div class="text-white">$ curl -X OPTIONS -i \\</div>' +
                    '<div class="ml-2">https://bank.com/api/users</div>' +
                    '<div class="mt-2 text-yellow-400">Response Headers:</div>' +
                    '<div class="text-gray-400">HTTP/1.1 200 OK</div>' +
                    '<div class="text-red-400">Allow: GET, POST, PUT, DELETE, OPTIONS, TRACE</div>' +
                    '<div class="text-yellow-400">Server: Apache/2.4.41 (Ubuntu)</div>' +
                    '<div class="text-yellow-400">X-Powered-By: PHP/7.4.3</div>' +
                    '</div>' +
                    '<div class="bg-white p-3 rounded mb-3 border">' +
                    '<p class="text-sm font-bold mb-2">ìˆ˜ì§‘ëœ ì •ë³´:</p>' +
                    '<div class="space-y-1 text-xs">' +
                    '<div>âœ“ í—ˆìš©ëœ HTTP Method (6ê°œ)</div>' +
                    '<div>âœ“ ì›¹ ì„œë²„ ì¢…ë¥˜ ë° ë²„ì „</div>' +
                    '<div>âœ“ ë°±ì—”ë“œ ì–¸ì–´ (PHP)</div>' +
                    '<div>âœ“ OS ì •ë³´ (Ubuntu)</div>' +
                    '</div></div>' +
                    '<div class="bg-orange-100 border border-orange-400 p-3 rounded text-sm">' +
                    '<p class="font-bold text-orange-800 mb-1">ğŸ“‹ ë‹¤ìŒ ê³µê²© ë‹¨ê³„</p>' +
                    '<p class="text-orange-800 text-xs">1. DELETEë¡œ ë°ì´í„° ì‚­ì œ ì‹œë„</p>' +
                    '<p class="text-orange-800 text-xs">2. PUTìœ¼ë¡œ ê¶Œí•œ ìƒìŠ¹</p>' +
                    '<p class="text-orange-800 text-xs">3. TRACEë¡œ XST ê³µê²©</p>' +
                    '</div></div>';
                
                document.getElementById('evidence').textContent = 'OPTIONSë¡œ ì„œë²„ ì •ë³´ ë…¸ì¶œ';
                badge.textContent = 'ì •ë³´ ìœ ì¶œ';
                badge.className = 'text-xs bg-yellow-500 text-white px-3 py-1 rounded';
            }
        }

        function addTerminalLine(text, color) {
            var div = document.createElement('div');
            div.className = color || 'text-green-400';
            div.textContent = text;
            document.getElementById('terminalLines').appendChild(div);
            document.getElementById('terminalLines').scrollTop = 
                document.getElementById('terminalLines').scrollHeight;
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
    </script>
</body>
</html>