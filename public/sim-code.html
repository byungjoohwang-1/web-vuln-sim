<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ì½”ë“œ ì‚½ì… ì‹¤ìŠµ</title>
    <script src="config.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; max-width: 800px; margin: 0 auto;}
        .container { display: flex; gap: 20px; }
        .box { flex: 1; border: 1px solid #ddd; padding: 20px; border-radius: 8px; }
        .vuln { background-color: #ffe6e6; }
        .secure { background-color: #e6fffa; }
        input { width: 100%; padding: 8px; margin: 10px 0; box-sizing: border-box; }
        button { padding: 8px 16px; cursor: pointer; }
        
        .code-section { margin-top: 40px; border-top: 2px solid #eee; padding-top: 20px; }
        .guide-box { background-color: #f4f7f9; padding: 15px; border-left: 5px solid #007bff; margin-bottom: 20px; }
        details { background: #f9f9f9; margin-bottom: 10px; border-radius: 5px; border: 1px solid #ddd; }
        summary { padding: 10px; cursor: pointer; font-weight: bold; list-style: none; }
        summary:hover { background-color: #f0f0f0; }
        pre { background: #333; color: #fff; padding: 15px; overflow-x: auto; margin: 0; border-radius: 0 0 5px 5px; }
        code { font-family: monospace; }
        .comment { color: #999; }
    </style>
</head>
<body>
    <a href="index.html">â† ë©”ì¸ìœ¼ë¡œ</a>
    <h1>ğŸ’» ì½”ë“œ ì‚½ì… (Code Injection)</h1>

    <div class="guide-box">
        <h3>ğŸ“˜ ì·¨ì•½ì  ê°œìš”</h3>
        <p>ì…ë ¥ê°’ì„ ê²€ì¦ ì—†ì´ <code>eval()</code>, <code>exec()</code> í•¨ìˆ˜ì— ì „ë‹¬í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤. ê³µê²©ìëŠ” ì‹œìŠ¤í…œ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ê±°ë‚˜ ì„œë²„ë¥¼ ì¥ì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
    </div>
    
    <div class="container">
        <!-- ì·¨ì•½í•œ ëª¨ë“œ -->
        <div class="box vuln">
            <h2>ğŸš« ì·¨ì•½í•œ ëª¨ë“œ</h2>
            <p>ê¸°ëŠ¥: ìˆ˜ì‹ ê³„ì‚°ê¸° (eval ì‚¬ìš©)</p>
            <p>ê³µê²©: ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œ ì…ë ¥</p>
            <!-- ê³µê²© ì˜ˆì‹œ: ë‹¨ìˆœ ê³„ì‚° ëŒ€ì‹  ì„ì˜ì˜ ë¬¸ìì—´ ë°˜í™˜ ì½”ë“œ ì‚½ì… -->
            <input type="text" id="vulnInput" value="10 * 10; return 'ì‹œìŠ¤í…œ ì¥ì•… ì™„ë£Œ'">
            <button onclick="runTest('vulnerableCode', 'vulnInput')">ê³µê²© ì‹¤í–‰</button>
        </div>

        <!-- ì•ˆì „í•œ ëª¨ë“œ -->
        <div class="box secure">
            <h2>âœ… ì•ˆì „í•œ ëª¨ë“œ</h2>
            <p>ë°©ì–´: ì…ë ¥ê°’ ê²€ì¦ (ìˆ«ì/ì—°ì‚°ìë§Œ í—ˆìš©)</p>
            <input type="text" id="secureInput" value="10 * 10; return 'ì‹œìŠ¤í…œ ì¥ì•… ì™„ë£Œ'">
            <button onclick="runTest('secureCode', 'secureInput')">ë°©ì–´ í…ŒìŠ¤íŠ¸</button>
        </div>
    </div>

    <!-- ì–¸ì–´ë³„ ê°€ì´ë“œ ì„¹ì…˜ -->
    <div class="code-section">
        <h2>ğŸ“š ì–¸ì–´ë³„ ì‹œíì–´ ì½”ë”© ê°€ì´ë“œ</h2>
        <p>ì œê³µí•´ì£¼ì‹  ê°€ì´ë“œ ë¬¸ì„œì— ê¸°ë°˜í•œ ì–¸ì–´ë³„ ë°©ì–´ ê¸°ë²•ì…ë‹ˆë‹¤.</p>

        <!-- Python ì˜ˆì œ -->
        <details>
            <summary>ğŸ Python (Django/Flask)</summary>
            <pre><code><span class="comment"># [Python ê°€ì´ë“œ] eval(), exec() ì‚¬ìš© ì‹œ ì…ë ¥ê°’ ê²€ì¦ í•„ìˆ˜</span>

<span class="comment"># âŒ ì·¨ì•½í•œ ì½”ë“œ: eval() ì§ì ‘ ì‚¬ìš©</span>
<span class="comment"># result = eval(user_input)</span>

<span class="comment"># âœ… ì•ˆì „í•œ ì½”ë“œ: í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê²€ì¦ ë˜ëŠ” ast.literal_eval ì‚¬ìš©</span>
import ast

def calculate(user_input):
    try:
        <span class="comment"># ast.literal_evalì€ íŒŒì´ì¬ í‘œí˜„ì‹ë§Œ ì•ˆì „í•˜ê²Œ í‰ê°€í•¨ (í•¨ìˆ˜ ì‹¤í–‰ ë¶ˆê°€)</span>
        result = ast.literal_eval(user_input)
        return result
    except:
        return "Error"</code></pre>
        </details>

        <!-- Java ì˜ˆì œ -->
        <details>
            <summary>â˜• Java (ScriptEngine)</summary>
            <pre><code><span class="comment">// [Java ê°€ì´ë“œ] ScriptEngine.eval() ì‚¬ìš© ì‹œ ì…ë ¥ê°’ ê²€ì¦ í•„ìˆ˜</span>

<span class="comment"># âŒ ì·¨ì•½í•œ ì½”ë“œ</span>
<span class="comment"># engine.eval(userInput);</span>

<span class="comment"># âœ… ì•ˆì „í•œ ì½”ë“œ: ì •ê·œì‹ìœ¼ë¡œ ì…ë ¥ê°’ íŒ¨í„´ ê²€ì‚¬</span>
if (userInput.matches("^[0-9+\\-*/().\\s]+$")) {
    engine.eval(userInput);
} else {
    throw new IllegalArgumentException("í—ˆìš©ë˜ì§€ ì•Šì€ ì…ë ¥ì…ë‹ˆë‹¤.");
}</code></pre>
        </details>
    </div>

    <script>
        function runTest(funcName, inputId) {
            const inputVal = document.getElementById(inputId).value;
            // ì½”ë“œ ë¬¸ìê°€ URLë¡œ ì˜ ì „ë‹¬ë˜ë„ë¡ ì¸ì½”ë”©
            const encodedInput = encodeURIComponent(inputVal);
            const url = `${BASE_URL}/${funcName}?exp=${encodedInput}`;
            window.open(url, '_blank');
        }
    </script>
</body>
</html>