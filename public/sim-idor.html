<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>IDOR Simulation</title>
    <!-- ì„¤ì • íŒŒì¼ ë¡œë“œ -->
    <script src="config.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; max-width: 800px; margin: 0 auto;}
        .container { display: flex; gap: 20px; }
        .box { flex: 1; border: 1px solid #ddd; padding: 20px; border-radius: 8px; }
        .vuln { background-color: #ffe6e6; }
        .secure { background-color: #e6fffa; }
        input { width: 100%; padding: 8px; margin: 10px 0; box-sizing: border-box; }
        button { padding: 8px 16px; cursor: pointer; }
        
        /* ê°€ì´ë“œ ìŠ¤íƒ€ì¼ */
        .code-section { margin-top: 40px; border-top: 2px solid #eee; padding-top: 20px; }
        details { background: #f9f9f9; margin-bottom: 10px; border-radius: 5px; border: 1px solid #ddd; }
        summary { padding: 10px; cursor: pointer; font-weight: bold; }
        pre { background: #333; color: #fff; padding: 15px; overflow-x: auto; }
        .comment { color: #999; }
    </style>
</head>
<body>
    <a href="index.html">â† Main Menu</a>
    <h1>ğŸš« ë¶€ì ì ˆí•œ ì¸ê°€ (IDOR)</h1>

    <div style="background:#f4f7f9; padding:15px; margin-bottom:20px; border-left:5px solid #007bff;">
        <h3>ğŸ“˜ ì·¨ì•½ì  ê°œìš” (Overview)</h3>
        <p><strong>[KR]</strong> ì‚¬ìš©ìê°€ ìì‹ ì˜ ê¶Œí•œ ë°–ì˜ ë°ì´í„°(íƒ€ì¸ì˜ ì£¼ë¬¸ë‚´ì—­ ë“±)ì— ì ‘ê·¼í•  ë•Œ, ì„œë²„ê°€ ì†Œìœ ê¶Œì„ ê²€ì¦í•˜ì§€ ì•Šì•„ ë°œìƒí•˜ëŠ” ì·¨ì•½ì ì…ë‹ˆë‹¤.</p>
        <p><strong>[EN]</strong> Occurs when an application provides direct access to objects based on user-supplied input without authorization checks.</p>
    </div>
    
    <div class="container">
        <!-- ì·¨ì•½í•œ ëª¨ë“œ -->
        <div class="box vuln">
            <h2>ğŸš« ì·¨ì•½í•œ ëª¨ë“œ (Vulnerable)</h2>
            <p>ìƒí™©: ë‚˜ëŠ” <strong>userA</strong> (ì£¼ë¬¸ë²ˆí˜¸ 100ë²ˆ ì£¼ì¸)</p>
            <p>[KR] ê³µê²©: ì£¼ë¬¸ë²ˆí˜¸ë¥¼ <strong>101</strong>(userBì˜ ê²ƒ)ë¡œ ë³€ì¡°</p>
            <input type="text" id="vulnInput" value="101">
            <button onclick="runTest('vulnerableIDOR', 'vulnInput')">Run Attack</button>
        </div>

        <!-- ì•ˆì „í•œ ëª¨ë“œ -->
        <div class="box secure">
            <h2>âœ… ì•ˆì „í•œ ëª¨ë“œ (Secure)</h2>
            <p>[KR] ë°©ì–´: ì†Œìœ ì ì¼ì¹˜ ì—¬ë¶€ ê²€ì¦</p>
            <p>[EN] Defense: Check ownership</p>
            <input type="text" id="secureInput" value="101">
            <button onclick="runTest('secureIDOR', 'secureInput')">Run Secure</button>
        </div>
    </div>

    <div class="code-section">
        <h2>ğŸ“š ì–¸ì–´ë³„ ì‹œíì–´ ì½”ë”© ê°€ì´ë“œ (Secure Coding Guide)</h2>
        
        <!-- Python ì˜ˆì œ -->
        <details>
            <summary>ğŸ Python (Django)</summary>
            <pre><code><span class="comment"># [KR] ê°ì²´ ì ‘ê·¼ ì‹œ ì†Œìœ ì(request.user)ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ ë°˜ë“œì‹œ í™•ì¸í•œë‹¤.</span>
<span class="comment"># [EN] Verify that the requesting user owns the object.</span>

def view_order(request, order_id):
    order = Order.objects.get(id=order_id)

    <span class="comment"># âŒ ì·¨ì•½ (Vulnerable): ê·¸ëƒ¥ ë°˜í™˜</span>
    <span class="comment"># return render(request, 'order.html', {'order': order})</span>

    <span class="comment"># âœ… ì•ˆì „ (Secure): ì†Œìœ ì ê²€ì¦</span>
    if order.owner != request.user:
        return HttpResponseForbidden("ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.")
    
    return render(request, 'order.html', {'order': order})</code></pre>
        </details>

        <!-- Java ì˜ˆì œ -->
        <details>
            <summary>â˜• Java (Spring Boot)</summary>
            <pre><code><span class="comment">// [KR] Service ê³„ì¸µì—ì„œ í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì™€ ë°ì´í„° ì†Œìœ ìë¥¼ ë¹„êµí•œë‹¤.</span>
<span class="comment">// [EN] Compare current user with data owner in Service layer.</span>

public Order getOrder(Long orderId, String username) {
    Order order = orderRepository.findById(orderId);
    
    <span class="comment">// âœ… ì•ˆì „ (Secure)</span>
    if (!order.getOwner().equals(username)) {
        throw new AccessDeniedException("ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.");
    }
    return order;
}</code></pre>
        </details>
    </div>

    <script>
        function runTest(funcName, inputId) {
            const inputVal = document.getElementById(inputId).value;
            // IDORëŠ” ë³´í†µ IDê°’ ê·¸ëŒ€ë¡œ í˜¸ì¶œí•©ë‹ˆë‹¤.
            const url = `${BASE_URL}/${funcName}?id=${inputVal}`;
            window.open(url, '_blank');
        }
    </script>
</body>
</html>