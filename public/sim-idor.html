<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¶€ì ì ˆí•œ ì¸ê°€ (IDOR) ì‹œë®¬ë ˆì´ì…˜</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        .simulation-box { min-height: 180px; }
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-slate-50 min-h-screen flex flex-col items-center justify-center p-4">

    <div class="max-w-5xl w-full bg-white rounded-2xl shadow-xl overflow-hidden">
        <!-- Header -->
        <div class="bg-orange-600 p-6 text-white flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="bg-white/20 p-2 rounded-lg">
                    <i class="fas fa-id-card text-2xl"></i>
                </div>
                <div>
                    <h1 class="text-2xl font-bold">ë¶€ì ì ˆí•œ ì¸ê°€ (IDOR)</h1>
                    <p class="text-orange-100 text-sm">Insecure Direct Object References Simulation</p>
                </div>
            </div>
            <div class="bg-white/20 px-4 py-2 rounded-lg text-sm">
                <i class="fas fa-user-lock mr-1"></i> íŒŒë¼ë¯¸í„° ë³€ì¡°ë¥¼ í†µí•œ íƒ€ì¸ ì •ë³´ ì ‘ê·¼
            </div>
        </div>

        <!-- Context & Explanation -->
        <div class="p-8 border-b border-gray-100 bg-gray-50">
            <div class="grid md:grid-cols-3 gap-8">
                <div class="md:col-span-2">
                    <h2 class="text-xl font-bold text-gray-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-info-circle text-blue-500"></i> ì‹œë‚˜ë¦¬ì˜¤ ìƒí™© (Scenario)
                    </h2>
                    <p class="text-gray-600 leading-relaxed mb-4">
                        í˜„ì¬ ë‹¹ì‹ ì€ <strong>'User A' (ë‚´ ID: 100)</strong>ë¡œ ë¡œê·¸ì¸ë˜ì–´ ìˆìŠµë‹ˆë‹¤.<br>
                        ì„œë²„ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì£¼ë¬¸ ì •ë³´ê°€ ì €ì¥ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
                    </p>
                    <ul class="space-y-2 text-sm bg-white p-4 rounded-lg border border-gray-200">
                        <li class="flex items-center text-green-700 font-semibold">
                            <span class="w-20 text-gray-500">ID: 100</span> 
                            <i class="fas fa-check-circle mr-2"></i> ë‚´ ì£¼ë¬¸ (ê²Œì´ë° ë…¸íŠ¸ë¶) - ì ‘ê·¼ í—ˆìš©
                        </li>
                        <li class="flex items-center text-red-700 opacity-75">
                            <span class="w-20 text-gray-500">ID: 101</span> 
                            <i class="fas fa-times-circle mr-2"></i> User Bì˜ ì£¼ë¬¸ (ë¹„ë°€ ë¬¸ì„œ) - <strong>ì ‘ê·¼ ë¶ˆê°€í•´ì•¼ í•¨</strong>
                        </li>
                        <li class="flex items-center text-red-700 opacity-75">
                            <span class="w-20 text-gray-500">ID: 102</span> 
                            <i class="fas fa-times-circle mr-2"></i> User Cì˜ ì£¼ë¬¸ (ê°œì¸ ì‚¬ì§„) - <strong>ì ‘ê·¼ ë¶ˆê°€í•´ì•¼ í•¨</strong>
                        </li>
                    </ul>
                </div>
                <div class="bg-orange-50 border-l-4 border-orange-400 p-4 rounded-r-lg flex flex-col justify-center">
                    <h3 class="text-sm font-bold text-orange-800 mb-2">ê³µê²© ëª©í‘œ (Goal)</h3>
                    <p class="text-sm text-orange-700 mb-3">
                        ë‚´ ì£¼ë¬¸ ë²ˆí˜¸(100)ë¥¼ <strong>101</strong>ë¡œ ë³€ì¡°í•˜ì—¬ ë‹¤ë¥¸ ì‚¬ëŒì˜ ì£¼ë¬¸ ì •ë³´ë¥¼ í›”ì³ë³´ì„¸ìš”.
                    </p>
                    <div class="text-center">
                        <i class="fas fa-user-secret text-4xl text-orange-300"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- Simulation Area -->
        <div class="grid md:grid-cols-2 divide-y md:divide-y-0 md:divide-x divide-gray-200">
            
            <!-- Vulnerable Side -->
            <div class="p-8 bg-red-50/30 relative">
                <div class="absolute top-4 right-4 text-red-200 text-6xl opacity-20 pointer-events-none">
                    <i class="fas fa-unlock-alt"></i>
                </div>
                <h3 class="text-lg font-bold text-red-600 mb-2 flex items-center gap-2">
                    <i class="fas fa-times-circle"></i> ì·¨ì•½í•œ ëª¨ë“œ (Vulnerable)
                </h3>
                <p class="text-xs text-gray-500 mb-6">ì„œë²„ê°€ IDë§Œ í™•ì¸í•˜ê³  <strong>ì†Œìœ ê¶Œ(Ownership)</strong>ì€ ê²€ì¦í•˜ì§€ ì•ŠìŒ</p>
                
                <div class="bg-white p-4 rounded-lg border border-red-200 shadow-sm mb-4">
                    <label class="block text-xs font-bold text-gray-500 uppercase mb-1">URL Parameter / Input</label>
                    <div class="flex items-center border border-gray-300 rounded bg-gray-50 px-3 py-2">
                        <span class="text-gray-400 text-sm mr-2">/order/view?id=</span>
                        <input type="number" id="vulnInput" value="100" class="bg-transparent outline-none w-full font-mono font-bold text-gray-700">
                    </div>
                </div>
                
                <button onclick="runVulnerable()" class="w-full bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-4 rounded-lg transition-all transform active:scale-95 shadow-md mb-6 flex items-center justify-center gap-2">
                    <i class="fas fa-search"></i> ì¡°íšŒ ìš”ì²­ (Request)
                </button>

                <div class="border-2 border-dashed border-red-300 rounded-lg bg-white simulation-box p-4 relative overflow-hidden">
                    <span class="absolute top-2 right-2 text-[10px] text-gray-400 font-mono uppercase">Server Response</span>
                    <div id="vulnOutput" class="mt-6 flex items-center justify-center h-full text-gray-400">
                        ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...
                    </div>
                </div>
            </div>

            <!-- Secure Side -->
            <div class="p-8 bg-green-50/30 relative">
                <div class="absolute top-4 right-4 text-green-200 text-6xl opacity-20 pointer-events-none">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <h3 class="text-lg font-bold text-green-600 mb-2 flex items-center gap-2">
                    <i class="fas fa-check-circle"></i> ì•ˆì „í•œ ëª¨ë“œ (Secure)
                </h3>
                <p class="text-xs text-gray-500 mb-6">ì„œë²„ê°€ <strong>í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì™€ ë°ì´í„° ì†Œìœ ìê°€ ì¼ì¹˜í•˜ëŠ”ì§€</strong> ê²€ì¦í•¨</p>
                
                <div class="bg-white p-4 rounded-lg border border-green-200 shadow-sm mb-4">
                    <label class="block text-xs font-bold text-gray-500 uppercase mb-1">URL Parameter / Input</label>
                    <div class="flex items-center border border-gray-300 rounded bg-gray-50 px-3 py-2">
                        <span class="text-gray-400 text-sm mr-2">/order/view?id=</span>
                        <input type="number" id="secureInput" value="100" class="bg-transparent outline-none w-full font-mono font-bold text-gray-700">
                    </div>
                </div>

                <button onclick="runSecure()" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg transition-all transform active:scale-95 shadow-md mb-6 flex items-center justify-center gap-2">
                    <i class="fas fa-shield-check"></i> ì•ˆì „í•œ ì¡°íšŒ ìš”ì²­ (Request)
                </button>

                <div class="border-2 border-dashed border-green-300 rounded-lg bg-white simulation-box p-4 relative overflow-hidden">
                    <span class="absolute top-2 right-2 text-[10px] text-gray-400 font-mono uppercase">Server Response</span>
                    <div id="secureOutput" class="mt-6 flex items-center justify-center h-full text-gray-400">
                        ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...
                    </div>
                </div>
            </div>
        </div>

        <!-- Code Reference -->
        <div class="bg-slate-900 p-6 text-gray-300">
            <h4 class="font-bold text-white mb-4 flex items-center gap-2">
                <i class="fas fa-code"></i> ë°±ì—”ë“œ ë¡œì§ ë¹„êµ (Backend Logic Comparison)
            </h4>
            <div class="grid md:grid-cols-2 gap-6 text-sm font-mono">
                <div class="bg-black/30 p-4 rounded border border-red-900/50">
                    <p class="text-red-400 font-bold mb-2">// Vulnerable (Java/Python)</p>
                    <p class="text-gray-400">
                        // ê²€ì¦ ì—†ìŒ: IDë¡œë§Œ ì¡°íšŒ<br>
                        return db.getOrder(id);
                    </p>
                </div>
                <div class="bg-black/30 p-4 rounded border border-green-900/50">
                    <p class="text-green-400 font-bold mb-2">// Secure (Java/Python)</p>
                    <p class="text-gray-400">
                        // ì†Œìœ ê¶Œ ê²€ì¦ ë¡œì§ ì¶”ê°€<br>
                        Order o = db.getOrder(id);<br>
                        if (o.owner != currentUser.id) <span class="text-yellow-300">throw AccessDenied;</span><br>
                        return o;
                    </p>
                </div>
            </div>
             <div class="mt-6 flex justify-center">
                <a href="security_functions.html" class="text-white hover:text-orange-300 font-medium text-sm flex items-center gap-2 transition-colors">
                    <i class="fas fa-arrow-left"></i> ë³´ì•ˆ ê¸°ëŠ¥ ê°€ì´ë“œë¡œ ëŒì•„ê°€ê¸°
                </a>
            </div>
        </div>
    </div>

    <script>
        // Mock Data Database
        const mockDB = {
            100: { owner: 'User A', content: 'ğŸ’» ê²Œì´ë° ë…¸íŠ¸ë¶ (RTX 4090)', price: '$3,500', icon: 'fa-laptop' },
            101: { owner: 'User B', content: 'ğŸ“„ ëŒ€ì™¸ë¹„ í”„ë¡œì íŠ¸ ê¸°íšì•ˆ', price: 'CONFIDENTIAL', icon: 'fa-file-contract' },
            102: { owner: 'User C', content: 'ğŸ“¸ ê°œì¸ ì—¬í–‰ ì‚¬ì§„.zip', price: 'PRIVATE', icon: 'fa-images' },
            999: { owner: 'System', content: 'ë°ì´í„° ì—†ìŒ', price: '-', icon: 'fa-question' }
        };

        const CURRENT_USER = 'User A';

        function getData(id) {
            return mockDB[id] || null;
        }

        function renderResult(elementId, data, isSuccess, message) {
            const el = document.getElementById(elementId);
            el.innerHTML = '';
            
            const wrapper = document.createElement('div');
            wrapper.className = 'w-full fade-in';

            if (isSuccess) {
                // Success Display (Data Revealed)
                wrapper.innerHTML = `
                    <div class="bg-green-50 border border-green-200 rounded p-3 mb-2">
                        <div class="flex justify-between items-center mb-1">
                            <span class="text-xs font-bold text-green-700 bg-green-200 px-2 py-0.5 rounded">HTTP 200 OK</span>
                            <span class="text-xs text-gray-500">Owner: ${data.owner}</span>
                        </div>
                        <div class="flex items-center gap-3 mt-3">
                            <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center text-green-600">
                                <i class="fas ${data.icon}"></i>
                            </div>
                            <div>
                                <div class="font-bold text-gray-800">${data.content}</div>
                                <div class="text-xs text-gray-500">${data.price}</div>
                            </div>
                        </div>
                    </div>
                    <p class="text-xs text-center ${data.owner === CURRENT_USER ? 'text-green-600' : 'text-red-600 font-bold'}">
                        ${message}
                    </p>
                `;
            } else {
                // Error Display (Access Denied)
                wrapper.innerHTML = `
                    <div class="bg-red-50 border border-red-200 rounded p-4 text-center">
                        <div class="text-red-500 text-3xl mb-2"><i class="fas fa-ban"></i></div>
                        <div class="font-bold text-red-700">HTTP 403 Forbidden</div>
                        <div class="text-xs text-red-500 mt-1">ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.</div>
                    </div>
                     <p class="text-xs text-center text-green-600 mt-2 font-bold">
                        ${message}
                    </p>
                `;
            }
            el.appendChild(wrapper);
        }

        function runVulnerable() {
            const id = document.getElementById('vulnInput').value;
            const data = getData(id);

            if (!data) {
                document.getElementById('vulnOutput').innerHTML = '<span class="text-gray-400">ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤ (404 Not Found)</span>';
                return;
            }

            // Vulnerable Logic: Just return data if ID exists
            let message = "";
            if (data.owner !== CURRENT_USER) {
                message = `âš ï¸ ê²½ê³ : ${CURRENT_USER}ê°€ ${data.owner}ì˜ ë°ì´í„°ë¥¼ ë¬´ë‹¨ ì¡°íšŒí–ˆìŠµë‹ˆë‹¤! (ì·¨ì•½ì  ë°œìƒ)`;
            } else {
                message = "ë³¸ì¸ì˜ ë°ì´í„°ë¥¼ ì •ìƒì ìœ¼ë¡œ ì¡°íšŒí–ˆìŠµë‹ˆë‹¤.";
            }
            
            renderResult('vulnOutput', data, true, message);
        }

        function runSecure() {
            const id = document.getElementById('secureInput').value;
            const data = getData(id);

            if (!data) {
                document.getElementById('secureOutput').innerHTML = '<span class="text-gray-400">ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤ (404 Not Found)</span>';
                return;
            }

            // Secure Logic: Check Ownership
            if (data.owner !== CURRENT_USER) {
                // Block access if owner doesn't match
                renderResult('secureOutput', null, false, "âœ… ë°©ì–´ ì„±ê³µ: íƒ€ì¸ì˜ ë°ì´í„° ì ‘ê·¼ì„ ì„œë²„ê°€ ì°¨ë‹¨í–ˆìŠµë‹ˆë‹¤.");
            } else {
                // Allow access if owner matches
                renderResult('secureOutput', data, true, "âœ… ì¸ì¦ ì„±ê³µ: ë³¸ì¸ì˜ ë°ì´í„°ì…ë‹ˆë‹¤.");
            }
        }
    </script>
</body>
</html>