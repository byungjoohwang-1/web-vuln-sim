<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¸ˆìœµê¶Œ IDOR ì‹¤ì „ ì‹œë®¬ë ˆì´í„°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        .code-font { font-family: 'Courier New', monospace; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
        .animate-blink { animation: blink 1s infinite; }
    </style>
</head>
<body class="bg-gray-900 p-4">

    <!-- íƒ€ì´í‹€ -->
    <div class="max-w-7xl mx-auto mb-4">
        <div class="bg-gradient-to-r from-red-600 to-orange-600 text-white p-4 rounded-lg shadow-lg">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <i class="fas fa-shield-virus text-3xl"></i>
                    <div>
                        <h1 class="font-bold text-xl">ê¸ˆìœµê¶Œ IDOR ê³µê²© ì‹¤ì „ ì‹œë‚˜ë¦¬ì˜¤</h1>
                        <p class="text-sm">WEB-SER-003: ë¶€ì ì ˆí•œ ì´ìš©ì ì¸ê°€ | ìœ„í—˜ë„: 5 (ë§¤ìš° ë†’ìŒ)</p>
                    </div>
                </div>
                <button onclick="resetAll()" class="bg-white text-red-600 px-4 py-2 rounded font-bold hover:bg-gray-100">
                    <i class="fas fa-redo"></i> ì²˜ìŒë¶€í„°
                </button>
            </div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-2 gap-4">
        
        <!-- ì¢Œì¸¡: ê³µê²©ì í™”ë©´ -->
        <div class="space-y-4">
            
            <!-- ê³µê²©ì ê´€ì  -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg border-2 border-red-500">
                <div class="flex items-center gap-3 mb-3">
                    <i class="fas fa-user-secret text-red-400 text-2xl"></i>
                    <div>
                        <h2 class="font-bold text-lg">ğŸ”´ ê³µê²©ì í™”ë©´</h2>
                        <p class="text-sm text-gray-400">í•´ì»¤ê°€ ë³´ëŠ” ë¸Œë¼ìš°ì €</p>
                    </div>
                </div>
                
                <!-- ê³µê²©ì ë¸Œë¼ìš°ì € -->
                <div class="bg-gray-900 rounded-lg overflow-hidden">
                    <!-- ë¸Œë¼ìš°ì € í¬ë¡¬ -->
                    <div class="bg-gray-700 px-3 py-2 flex items-center gap-2">
                        <div class="flex gap-1">
                            <div class="w-2 h-2 rounded-full bg-red-500"></div>
                            <div class="w-2 h-2 rounded-full bg-yellow-500"></div>
                            <div class="w-2 h-2 rounded-full bg-green-500"></div>
                        </div>
                        <input type="text" id="attackerUrl" 
                               class="flex-1 bg-gray-800 text-white px-3 py-1 rounded text-xs code-font" 
                               value="https://xxbank.com/mypage"
                               readonly>
                    </div>
                    
                    <!-- ë¸Œë¼ìš°ì € ë‚´ìš© -->
                    <div id="attackerScreen" class="p-6 bg-white text-black min-h-[300px]">
                        <div class="text-center py-8">
                            <i class="fas fa-play-circle text-6xl text-blue-600 mb-4"></i>
                            <p class="text-gray-600">ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ê³µê²© ë‹¨ê³„ -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg">
                <h3 class="font-bold mb-3 flex items-center gap-2">
                    <i class="fas fa-list-ol text-orange-400"></i>
                    ê³µê²© ì§„í–‰ ë‹¨ê³„
                </h3>
                <div id="attackSteps" class="space-y-2 text-sm">
                    <div class="text-gray-500">ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”...</div>
                </div>
            </div>

            <!-- ì‹œë‚˜ë¦¬ì˜¤ ì„ íƒ -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg">
                <h3 class="font-bold mb-3 flex items-center gap-2">
                    <i class="fas fa-flask text-red-400"></i>
                    ì‹¤ì „ ê³µê²© ì‹œë‚˜ë¦¬ì˜¤
                </h3>
                <div class="space-y-2">
                    <button onclick="startScenario(1)" 
                            class="w-full text-left bg-red-900 hover:bg-red-800 px-3 py-2 rounded text-sm transition">
                        <i class="fas fa-wallet"></i> <strong>ì‹œë‚˜ë¦¬ì˜¤ 1:</strong> íƒ€ì¸ ê³„ì¢Œë²ˆí˜¸ íƒˆì·¨
                    </button>
                    <button onclick="startScenario(2)" 
                            class="w-full text-left bg-orange-900 hover:bg-orange-800 px-3 py-2 rounded text-sm transition">
                        <i class="fas fa-list"></i> <strong>ì‹œë‚˜ë¦¬ì˜¤ 2:</strong> ê±°ë˜ë‚´ì—­ ëŒ€ëŸ‰ ìˆ˜ì§‘
                    </button>
                    <button onclick="startScenario(3)" 
                            class="w-full text-left bg-purple-900 hover:bg-purple-800 px-3 py-2 rounded text-sm transition">
                        <i class="fas fa-database"></i> <strong>ì‹œë‚˜ë¦¬ì˜¤ 3:</strong> ì „ì²´ ê³ ê° DB íƒˆì·¨
                    </button>
                </div>
            </div>

            <!-- ì·¨ì•½í•œ ì½”ë“œ -->
            <div class="bg-gray-900 text-white p-4 rounded-lg shadow-lg border border-red-500">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="font-bold text-red-400">
                        <i class="fas fa-bug"></i> ì·¨ì•½í•œ ì„œë²„ ì½”ë“œ
                    </h3>
                    <span class="text-xs bg-red-600 px-2 py-1 rounded">ë¬¸ì œ ì›ì¸</span>
                </div>
                <pre class="code-font text-xs overflow-x-auto"><code><span class="text-gray-500">// Controller.java</span>
@GetMapping("/account")
public Account getAccount(@RequestParam Long id) {
    
    <span class="text-red-400">// âŒ ë¬¸ì œì  1: ì„¸ì…˜ í™•ì¸ë„ ì•ˆí•¨!</span>
    <span class="text-red-400">// âŒ ë¬¸ì œì  2: ê¶Œí•œ ê²€ì¦ ì—†ìŒ!</span>
    
    return accountRepository.findById(id);
}

<span class="text-gray-500">// SQL ì‹¤í–‰ë¨</span>
SELECT * FROM accounts WHERE id = ?
<span class="text-red-400">-- userId ì¡°ê±´ ì—†ìŒ! (ì¹˜ëª…ì )</span></code></pre>
            </div>

        </div>

        <!-- ìš°ì¸¡: ì„œë²„ í™”ë©´ -->
        <div class="space-y-4">
            
            <!-- ì„œë²„ ê´€ì  -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg border-2 border-green-500">
                <div class="flex items-center gap-3 mb-3">
                    <i class="fas fa-server text-green-400 text-2xl"></i>
                    <div>
                        <h2 class="font-bold text-lg">ğŸŸ¢ ì„œë²„ ë‚´ë¶€</h2>
                        <p class="text-sm text-gray-400">XXì€í–‰ ì„œë²„ ì²˜ë¦¬ ê³¼ì •</p>
                    </div>
                </div>
                
                <!-- ì„œë²„ ì²˜ë¦¬ ê³¼ì • -->
                <div class="bg-gray-900 rounded-lg p-4 min-h-[300px] max-h-[400px] overflow-auto">
                    <div id="serverLog" class="code-font text-xs space-y-1 text-green-400">
                        <div class="text-gray-500">[SERVER] Waiting for request...</div>
                    </div>
                </div>
                
                <!-- ì„œë²„ ìƒíƒœ -->
                <div class="mt-3 flex justify-between items-center">
                    <span class="text-xs text-gray-400">ì„œë²„ ìƒíƒœ:</span>
                    <span id="serverStatus" class="text-xs bg-blue-600 px-3 py-1 rounded">IDLE</span>
                </div>
            </div>

            <!-- SQL ì¿¼ë¦¬ ì‹¤í–‰ -->
            <div id="sqlBox" class="hidden bg-indigo-900 text-white p-4 rounded-lg shadow-lg">
                <div class="flex items-center gap-2 mb-3">
                    <i class="fas fa-database text-cyan-400"></i>
                    <h3 class="font-bold">ì‹¤í–‰ëœ SQL ì¿¼ë¦¬</h3>
                </div>
                <div class="bg-gray-900 p-3 rounded">
                    <pre id="sqlQuery" class="code-font text-xs text-cyan-400"></pre>
                </div>
            </div>

            <!-- ë¬¸ì œì  ë¶„ì„ -->
            <div id="problemBox" class="hidden bg-red-900 text-white p-4 rounded-lg shadow-lg">
                <div class="flex items-center gap-2 mb-3">
                    <i class="fas fa-exclamation-triangle text-yellow-400 text-xl animate-blink"></i>
                    <h3 class="font-bold">ğŸš¨ ë¬¸ì œì  ë¶„ì„</h3>
                </div>
                <div id="problemContent" class="text-sm space-y-2"></div>
            </div>

            <!-- ì¡°íšŒ ê²°ê³¼ -->
            <div id="resultBox" class="hidden bg-gray-800 text-white p-4 rounded-lg shadow-lg">
                <h3 class="font-bold mb-3 flex items-center gap-2">
                    <i class="fas fa-database"></i>
                    ì¡°íšŒëœ ë°ì´í„°
                </h3>
                <div id="resultContent" class="bg-gray-900 p-3 rounded code-font text-xs"></div>
            </div>

            <!-- ì•ˆì „í•œ ì½”ë“œ -->
            <div class="bg-gray-900 text-white p-4 rounded-lg shadow-lg border border-green-500">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="font-bold text-green-400">
                        <i class="fas fa-shield-halved"></i> ì•ˆì „í•œ ì„œë²„ ì½”ë“œ
                    </h3>
                    <span class="text-xs bg-green-600 px-2 py-1 rounded">í•´ê²°ì±…</span>
                </div>
                <pre class="code-font text-xs overflow-x-auto max-h-[300px]"><code><span class="text-gray-500">// Controller.java</span>
@GetMapping("/account")
public Account getAccount(
    @RequestParam Long id,
    @AuthenticationPrincipal User user) {
    
    <span class="text-green-400">// âœ… 1ë‹¨ê³„: ì¸ì¦ í™•ì¸ (Spring Security)</span>
    if (user == null) {
        throw new UnauthorizedException();
    }
    
    Account account = accountRepository
        .findById(id)
        .orElseThrow();
    
    <span class="text-green-400">// âœ… 2ë‹¨ê³„: ê¶Œí•œ ê²€ì¦ (í•µì‹¬!)</span>
    if (!account.getUserId().equals(user.getId())) {
        <span class="text-green-400">// ë¡œê¹… ì¶”ê°€</span>
        logger.warn("Unauthorized access attempt: " +
            "user={}, account={}", 
            user.getId(), id);
        
        throw new ForbiddenException();
    }
    
    return account;
}

<span class="text-gray-500">// ë˜ëŠ” Repositoryì—ì„œ í•´ê²° (ë” ì•ˆì „)</span>
accountRepository.findByIdAndUserId(id, user.getId())

<span class="text-gray-500">// SQL ì‹¤í–‰ë¨</span>
SELECT * FROM accounts 
WHERE id = ? <span class="text-green-400">AND user_id = ?</span>
<span class="text-green-400">-- user_id ì¡°ê±´ í•„ìˆ˜!</span></code></pre>
            </div>

        </div>
    </div>

    <script>
        const DB = {
            accounts: [
                { id: 1001, userId: 'user001', name: 'í™ê¸¸ë™', accountNo: '110-123-456789', balance: 5000000 },
                { id: 1002, userId: 'user002', name: 'ê¹€ì˜í¬', accountNo: '110-234-567890', balance: 12500000 },
                { id: 1003, userId: 'user003', name: 'ì´ì² ìˆ˜', accountNo: '110-345-678901', balance: 8300000 },
                { id: 1004, userId: 'user004', name: 'ë°•ë¯¼ìˆ˜', accountNo: '110-456-789012', balance: 3200000 },
                { id: 1005, userId: 'user005', name: 'ì •ìˆ˜ì§„', accountNo: '110-567-890123', balance: 15700000 }
            ]
        };

        let isRunning = false;

        function resetAll() {
            isRunning = false;
            document.getElementById('attackerUrl').value = 'https://xxbank.com/mypage';
            document.getElementById('attackerScreen').innerHTML = 
                '<div class="text-center py-8">' +
                '<i class="fas fa-play-circle text-6xl text-blue-600 mb-4"></i>' +
                '<p class="text-gray-600">ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>' +
                '</div>';
            document.getElementById('serverLog').innerHTML = 
                '<div class="text-gray-500">[SERVER] Waiting for request...</div>';
            document.getElementById('serverStatus').textContent = 'IDLE';
            document.getElementById('serverStatus').className = 'text-xs bg-blue-600 px-3 py-1 rounded';
            document.getElementById('attackSteps').innerHTML = 
                '<div class="text-gray-500">ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”...</div>';
            document.getElementById('sqlBox').classList.add('hidden');
            document.getElementById('problemBox').classList.add('hidden');
            document.getElementById('resultBox').classList.add('hidden');
        }

        async function startScenario(scenario) {
            if (isRunning) return;
            isRunning = true;
            
            resetAll();
            await sleep(300);
            
            if (scenario === 1) {
                await scenario1_AccountTheft();
            } else if (scenario === 2) {
                await scenario2_BulkCollection();
            } else if (scenario === 3) {
                await scenario3_DatabaseDump();
            }
            
            isRunning = false;
        }

        // ì‹œë‚˜ë¦¬ì˜¤ 1: íƒ€ì¸ ê³„ì¢Œë²ˆí˜¸ íƒˆì·¨
        async function scenario1_AccountTheft() {
            updateStep('ğŸ¯ ì‹œë‚˜ë¦¬ì˜¤ 1: íƒ€ì¸ ê³„ì¢Œë²ˆí˜¸ íƒˆì·¨ ì‹œì‘');
            
            // ê³µê²©ì: 1ë‹¨ê³„ - ë¡œê·¸ì¸
            await sleep(1000);
            updateStep('1ï¸âƒ£ ê³µê²©ìê°€ ìì‹ ì˜ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ (user001)');
            document.getElementById('attackerUrl').value = 'https://xxbank.com/login';
            document.getElementById('attackerScreen').innerHTML = 
                '<div class="max-w-md mx-auto mt-8">' +
                '<h2 class="text-xl font-bold mb-4">XXì€í–‰ ë¡œê·¸ì¸</h2>' +
                '<div class="space-y-3">' +
                '<input type="text" value="user001" class="w-full p-2 border rounded" readonly>' +
                '<input type="password" value="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" class="w-full p-2 border rounded" readonly>' +
                '<button class="w-full bg-blue-600 text-white py-2 rounded">ë¡œê·¸ì¸</button>' +
                '</div></div>';
            
            await addServerLog('[REQUEST] POST /login', 'text-blue-400');
            await sleep(300);
            await addServerLog('[AUTH] Credentials: user001 / ********', 'text-gray-400');
            await sleep(500);
            await addServerLog('[AUTH] Authentication successful âœ“', 'text-green-400');
            await sleep(300);
            await addServerLog('[SESSION] Creating session: JSESSIONID=abc123...', 'text-yellow-400');
            await sleep(300);
            await addServerLog('[RESPONSE] 200 OK - Login successful', 'text-green-400');
            await sleep(1000);
            
            // ê³µê²©ì: 2ë‹¨ê³„ - ë‚´ ê³„ì¢Œ í™•ì¸
            updateStep('2ï¸âƒ£ ìì‹ ì˜ ë§ˆì´í˜ì´ì§€ì—ì„œ URL êµ¬ì¡° íŒŒì•…');
            document.getElementById('attackerUrl').value = 'https://xxbank.com/account?id=1001';
            document.getElementById('attackerScreen').innerHTML = 
                '<div class="p-6">' +
                '<h2 class="text-xl font-bold mb-4">ë‚´ ê³„ì¢Œ ì •ë³´</h2>' +
                '<div class="bg-blue-50 p-4 rounded">' +
                '<div class="grid grid-cols-2 gap-2 text-sm">' +
                '<div class="font-bold">ê³„ì¢Œë²ˆí˜¸:</div><div>110-123-456789</div>' +
                '<div class="font-bold">ì˜ˆê¸ˆì£¼:</div><div>í™ê¸¸ë™</div>' +
                '<div class="font-bold">ì”ì•¡:</div><div class="text-blue-600 font-bold">5,000,000ì›</div>' +
                '</div></div>' +
                '<div class="mt-4 p-3 bg-yellow-100 border border-yellow-400 rounded">' +
                '<p class="text-sm">ğŸ’¡ <strong>ê³µê²©ì ë°œê²¬:</strong> URLì— <code class="bg-white px-2 py-1">id=1001</code> íŒŒë¼ë¯¸í„°ê°€ ìˆë‹¤!</p>' +
                '</div></div>';
            
            await addServerLog('[REQUEST] GET /account?id=1001', 'text-blue-400');
            await sleep(300);
            await addServerLog('[SESSION] User: user001 (authenticated)', 'text-green-400');
            await sleep(500);
            
            document.getElementById('sqlBox').classList.remove('hidden');
            document.getElementById('sqlQuery').textContent = 
                'SELECT * FROM accounts WHERE id = 1001;';
            
            await addServerLog('[SQL] SELECT * FROM accounts WHERE id = 1001', 'text-cyan-400');
            await sleep(600);
            await addServerLog('[DATABASE] 1 row returned', 'text-cyan-400');
            await sleep(300);
            await addServerLog('[RESPONSE] 200 OK - Account data sent', 'text-green-400');
            await sleep(1500);
            
            // ê³µê²©ì: 3ë‹¨ê³„ - íŒŒë¼ë¯¸í„° ë³€ì¡°
            updateStep('3ï¸âƒ£ <span class="text-red-400">URLì˜ id ê°’ì„ 1002ë¡œ ë³€ì¡°!</span>');
            document.getElementById('attackerUrl').value = 'https://xxbank.com/account?id=1002';
            document.getElementById('attackerUrl').classList.add('bg-red-900', 'text-white');
            
            document.getElementById('attackerScreen').innerHTML = 
                '<div class="p-6">' +
                '<div class="bg-red-100 border-2 border-red-500 p-4 rounded mb-4 animate-pulse">' +
                '<p class="text-red-700 font-bold text-center">' +
                '<i class="fas fa-skull-crossbones"></i> ê³µê²© ì¤‘...</p>' +
                '</div>' +
                '<div class="text-center py-8">' +
                '<div class="animate-spin text-6xl text-red-600 mb-4">âš ï¸</div>' +
                '<p class="text-gray-600">íƒ€ì¸ ê³„ì¢Œ ì¡°íšŒ ì‹œë„ ì¤‘...</p>' +
                '</div></div>';
            
            await sleep(1000);
            updateServerStatus('ATTACKED', 'bg-red-600 animate-pulse');
            
            await addServerLog('[REQUEST] GET /account?id=1002', 'text-blue-400');
            await sleep(300);
            await addServerLog('[SESSION] User: user001 (authenticated)', 'text-green-400');
            await sleep(300);
            await addServerLog('[WARNING] User requesting different account!', 'text-yellow-400');
            await sleep(500);
            await addServerLog('[AUTHORIZATION] Checking permissions...', 'text-yellow-400');
            await sleep(800);
            await addServerLog('[CRITICAL] âŒ NO AUTHORIZATION CHECK!', 'text-red-500 font-bold');
            await sleep(500);
            await addServerLog('[VULNERABILITY] IDOR detected - Skipping auth', 'text-red-500 font-bold');
            await sleep(800);
            
            document.getElementById('sqlQuery').innerHTML = 
                '<span class="text-red-400">-- âŒ ì·¨ì•½í•œ ì¿¼ë¦¬: user_id ì¡°ê±´ ì—†ìŒ!</span>\n' +
                'SELECT * FROM accounts WHERE id = 1002;\n\n' +
                '<span class="text-green-400">-- âœ… ì•ˆì „í•œ ì¿¼ë¦¬ëŠ” ì´ë ‡ê²Œ:</span>\n' +
                'SELECT * FROM accounts\n' +
                'WHERE id = 1002 AND user_id = \'user001\';';
            
            await addServerLog('[SQL] SELECT * FROM accounts WHERE id = 1002', 'text-cyan-400');
            await sleep(600);
            await addServerLog('[DATABASE] 1 row returned (ê¹€ì˜í¬ account)', 'text-cyan-400');
            await sleep(500);
            await addServerLog('[DANGER] Returning unauthorized data!', 'text-red-500 font-bold');
            await sleep(300);
            await addServerLog('[RESPONSE] 200 OK - Sending victim\'s data', 'text-red-400');
            await sleep(1000);
            
            // ê³µê²© ì„±ê³µ!
            updateStep('4ï¸âƒ£ <span class="text-red-500 font-bold">âœ“ ê³µê²© ì„±ê³µ! íƒ€ì¸ ê³„ì¢Œ ì •ë³´ íƒˆì·¨</span>');
            
            document.getElementById('attackerUrl').classList.remove('bg-red-900', 'text-white');
            document.getElementById('attackerScreen').innerHTML = 
                '<div class="p-6">' +
                '<div class="bg-green-100 border-2 border-green-500 p-4 rounded mb-4">' +
                '<p class="text-green-700 font-bold text-center">' +
                '<i class="fas fa-check-circle"></i> ì¡°íšŒ ì„±ê³µ!</p>' +
                '</div>' +
                '<h2 class="text-xl font-bold mb-4">ê³„ì¢Œ ì •ë³´</h2>' +
                '<div class="bg-red-50 border-2 border-red-500 p-4 rounded">' +
                '<div class="grid grid-cols-2 gap-2 text-sm">' +
                '<div class="font-bold">ê³„ì¢Œë²ˆí˜¸:</div><div class="text-red-600">110-234-567890</div>' +
                '<div class="font-bold">ì˜ˆê¸ˆì£¼:</div><div class="text-red-600">ê¹€ì˜í¬</div>' +
                '<div class="font-bold">ì”ì•¡:</div><div class="text-red-600 font-bold text-lg">12,500,000ì›</div>' +
                '</div></div>' +
                '<div class="mt-4 p-3 bg-red-100 border border-red-500 rounded">' +
                '<p class="text-sm text-red-700">ğŸš¨ <strong>ê¶Œí•œ ì—†ëŠ” ê³„ì¢Œ ì¡°íšŒ ì„±ê³µ!</strong><br>' +
                'ê³µê²©ìê°€ ê¹€ì˜í¬ë‹˜ì˜ ê³„ì¢Œë²ˆí˜¸ì™€ ì”ì•¡ì„ ì•Œê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.</p>' +
                '</div></div>';
            
            // ë¬¸ì œì  ë¶„ì„
            document.getElementById('problemBox').classList.remove('hidden');
            document.getElementById('problemContent').innerHTML = 
                '<div class="bg-black bg-opacity-30 p-3 rounded">' +
                '<p class="font-bold mb-2">âŒ ë°œê²¬ëœ ë¬¸ì œì :</p>' +
                '<div class="space-y-1 ml-4">' +
                '<div>1. ì„¸ì…˜ë§Œ í™•ì¸í•˜ê³  ë¦¬ì†ŒìŠ¤ ì†Œìœ ìëŠ” í™•ì¸ ì•ˆí•¨</div>' +
                '<div>2. SQL ì¿¼ë¦¬ì— user_id ì¡°ê±´ì´ ì—†ìŒ</div>' +
                '<div>3. ê¶Œí•œ ê²€ì¦ ë¡œì§ì´ ì™„ì „íˆ ëˆ„ë½ë¨</div>' +
                '<div>4. ê°ì‚¬ ë¡œê·¸ë„ ì—†ì–´ ê³µê²© íƒì§€ ë¶ˆê°€</div>' +
                '</div></div>' +
                '<div class="bg-black bg-opacity-30 p-3 rounded mt-2">' +
                '<p class="font-bold mb-2">ğŸ’¥ ì˜ˆìƒ í”¼í•´:</p>' +
                '<div class="space-y-1 ml-4">' +
                '<div>â€¢ IDë¥¼ 1~999999ê¹Œì§€ ë°˜ë³µí•˜ë©´ ì „ì²´ ê³ ê° DB íƒˆì·¨</div>' +
                '<div>â€¢ ê³„ì¢Œë²ˆí˜¸ë¡œ í”¼ì‹± ê³µê²© ê°€ëŠ¥</div>' +
                '<div>â€¢ ì”ì•¡ ì •ë³´ë¡œ íƒ€ê²Ÿ ì„ ì • ê°€ëŠ¥</div>' +
                '</div></div>';
            
            document.getElementById('resultBox').classList.remove('hidden');
            document.getElementById('resultContent').innerHTML = 
                '<span class="text-red-400">// ê³µê²©ìê°€ íšë“í•œ ë°ì´í„°</span>\n' +
                JSON.stringify(DB.accounts[1], null, 2);
        }

        // ì‹œë‚˜ë¦¬ì˜¤ 2: ê±°ë˜ë‚´ì—­ ëŒ€ëŸ‰ ìˆ˜ì§‘
        async function scenario2_BulkCollection() {
            updateStep('ğŸ¯ ì‹œë‚˜ë¦¬ì˜¤ 2: ê±°ë˜ë‚´ì—­ ëŒ€ëŸ‰ ìˆ˜ì§‘ ì‹œì‘');
            await sleep(1000);
            
            updateStep('1ï¸âƒ£ ê³µê²©ìê°€ ë¡œê·¸ì¸ í›„ ìë™í™” ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰');
            document.getElementById('attackerScreen').innerHTML = 
                '<div class="p-6">' +
                '<h2 class="text-xl font-bold mb-4">ìë™í™” ê³µê²© ìŠ¤í¬ë¦½íŠ¸</h2>' +
                '<div class="bg-gray-900 text-green-400 p-4 rounded code-font text-xs">' +
                '<div>$ python3 idor_exploit.py</div>' +
                '<div class="mt-2 text-yellow-400">[*] Starting IDOR attack...</div>' +
                '<div>[*] Target: https://xxbank.com/account</div>' +
                '<div>[*] Range: id=1000 to 1005</div>' +
                '<div class="mt-2 text-cyan-400">[+] Session: JSESSIONID=abc123</div>' +
                '</div></div>';
            
            await addServerLog('[SERVER] Multiple requests incoming...', 'text-yellow-400');
            await sleep(800);
            
            updateStep('2ï¸âƒ£ <span class="text-red-400">ID 1000~1005 ìˆœì°¨ì ìœ¼ë¡œ ìš”ì²­</span>');
            
            for (let id = 1001; id <= 1005; id++) {
                document.getElementById('attackerUrl').value = `https://xxbank.com/account?id=${id}`;
                
                await addServerLog(`[REQUEST] GET /account?id=${id}`, 'text-blue-400');
                await sleep(200);
                await addServerLog(`[SQL] SELECT * FROM accounts WHERE id = ${id}`, 'text-cyan-400');
                await sleep(200);
                
                if (id <= 1005) {
                    const account = DB.accounts.find(a => a.id === id);
                    await addServerLog(`[DATABASE] Found: ${account.name} (${account.accountNo})`, 'text-red-400');
                    
                    // ê³µê²©ì í™”ë©´ì— ëˆ„ì  í‘œì‹œ
                    const currentContent = document.getElementById('attackerScreen').querySelector('.bg-gray-900');
                    const newLine = document.createElement('div');
                    newLine.className = 'text-green-400';
                    newLine.textContent = `[âœ“] ID ${id}: ${account.name} | ${account.accountNo} | ${account.balance.toLocaleString()}ì›`;
                    currentContent.appendChild(newLine);
                }
                
                await sleep(300);
            }
            
            updateStep('3ï¸âƒ£ <span class="text-red-500 font-bold">âœ“ 5ê°œ ê³„ì¢Œ ì •ë³´ ìˆ˜ì§‘ ì™„ë£Œ!</span>');
            
            await addServerLog('[CRITICAL] 5 unauthorized queries executed!', 'text-red-500 font-bold');
            await sleep(500);
            
            document.getElementById('problemBox').classList.remove('hidden');
            document.getElementById('problemContent').innerHTML = 
                '<div class="bg-black bg-opacity-30 p-3 rounded">' +
                '<p class="font-bold mb-2">âŒ ëŒ€ëŸ‰ ìˆ˜ì§‘ ê³µê²© ì„±ê³µ:</p>' +
                '<div class="space-y-1 ml-4">' +
                '<div>â€¢ ì´ 5ê°œ ê³„ì¢Œ ì •ë³´ íƒˆì·¨</div>' +
                '<div>â€¢ Rate limiting ì—†ìŒ (ë¬´ì œí•œ ìš”ì²­)</div>' +
                '<div>â€¢ ìº¡ì°¨(CAPTCHA) ì—†ìŒ</div>' +
                '<div>â€¢ ì´ìƒ íŒ¨í„´ íƒì§€ ì—†ìŒ</div>' +
                '</div></div>' +
                '<div class="bg-black bg-opacity-30 p-3 rounded mt-2">' +
                '<p class="font-bold mb-2">ğŸ’¥ ì‹¤ì œ í”¼í•´ ì‹œë‚˜ë¦¬ì˜¤:</p>' +
                '<div class="space-y-1 ml-4">' +
                '<div>â€¢ í•˜ë£»ë°¤ì— 10ë§Œ ê°œ ê³„ì¢Œ ì •ë³´ ìˆ˜ì§‘ ê°€ëŠ¥</div>' +
                '<div>â€¢ ê³ ì•¡ ìì‚°ê°€ ë¦¬ìŠ¤íŠ¸ ì‘ì„±</div>' +
                '<div>â€¢ íƒ€ê²Ÿ í”¼ì‹± ê³µê²©ì— í™œìš©</div>' +
                '</div></div>';
            
            document.getElementById('resultBox').classList.remove('hidden');
            document.getElementById('resultContent').textContent = 
                '// ìˆ˜ì§‘ëœ 5ê°œ ê³„ì¢Œ ì •ë³´\n' +
                JSON.stringify(DB.accounts, null, 2);
            
            updateServerStatus('COMPROMISED', 'bg-red-600');
        }

        // ì‹œë‚˜ë¦¬ì˜¤ 3: ì „ì²´ DB íƒˆì·¨
        async function scenario3_DatabaseDump() {
            updateStep('ğŸ¯ ì‹œë‚˜ë¦¬ì˜¤ 3: ì „ì²´ ê³ ê° DB íƒˆì·¨');
            await sleep(1000);
            
            updateStep('1ï¸âƒ£ ê³µê²©ìê°€ ìë™í™” ë„êµ¬ë¡œ ëŒ€ëŸ‰ ìš”ì²­ ì¤€ë¹„');
            document.getElementById('attackerScreen').innerHTML = 
                '<div class="p-6">' +
                '<h2 class="text-xl font-bold mb-4 text-red-600">DB ë¤í”„ ë„êµ¬ ì‹¤í–‰</h2>' +
                '<div class="bg-gray-900 text-green-400 p-4 rounded code-font text-xs">' +
                '<div class="text-red-400">$ ./bank_dumper --target xxbank.com --threads 50</div>' +
                '<div class="mt-2">[*] IDOR vulnerability confirmed</div>' +
                '<div>[*] Starting parallel extraction...</div>' +
                '<div>[*] Thread pool: 50 workers</div>' +
                '<div>[*] Estimated accounts: 100,000+</div>' +
                '<div class="mt-2 text-yellow-400">[!] Press ENTER to start</div>' +
                '</div></div>';
            
            await sleep(1500);
            updateStep('2ï¸âƒ£ <span class="text-red-400">50ê°œ ì“°ë ˆë“œë¡œ ë³‘ë ¬ ìš”ì²­ ì‹œì‘</span>');
            
            await addServerLog('[ALERT] High traffic detected!', 'text-red-400');
            await sleep(300);
            await addServerLog('[ALERT] 500+ requests/second', 'text-red-400');
            await sleep(300);
            await addServerLog('[CRITICAL] No rate limiting!', 'text-red-500 font-bold');
            await sleep(500);
            
            document.getElementById('attackerScreen').innerHTML = 
                '<div class="p-6">' +
                '<h2 class="text-xl font-bold mb-4 text-red-600">ì§„í–‰ ì¤‘...</h2>' +
                '<div class="bg-gray-900 text-green-400 p-4 rounded code-font text-xs">' +
                '<div>[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘] 78%</div>' +
                '<div class="mt-2">Extracted: 78,432 accounts</div>' +
                '<div>Speed: 523 accounts/sec</div>' +
                '<div>Remaining: ~42 seconds</div>' +
                '<div class="mt-2 text-cyan-400">Writing to: customer_db.json</div>' +
                '</div></div>';
            
            await sleep(2000);
            updateStep('3ï¸âƒ£ <span class="text-red-500 font-bold">âœ“ ì „ì²´ ê³ ê° DB íƒˆì·¨ ì™„ë£Œ!</span>');
            
            await addServerLog('[DISASTER] Full database extracted!', 'text-red-500 font-bold');
            await sleep(500);
            await addServerLog('[IMPACT] 100,000+ customer records stolen', 'text-red-500 font-bold');
            
            document.getElementById('attackerScreen').innerHTML = 
                '<div class="p-6">' +
                '<div class="bg-green-100 border-2 border-green-500 p-4 rounded mb-4">' +
                '<p class="text-green-700 font-bold text-center text-xl">' +
                '<i class="fas fa-check-circle"></i> ì¶”ì¶œ ì™„ë£Œ!</p>' +
                '</div>' +
                '<div class="bg-gray-900 text-green-400 p-4 rounded code-font text-xs">' +
                '<div class="text-green-400">[âœ“] Extraction complete!</div>' +
                '<div class="mt-2">Total accounts: 100,247</div>' +
                '<div>Total balance: â‚©1,247,532,000,000</div>' +
                '<div>Execution time: 3m 24s</div>' +
                '<div class="mt-2 text-yellow-400">Saved: customer_db.json (245 MB)</div>' +
                '<div class="mt-2 text-red-400">âš  Exfiltrating data via TOR...</div>' +
                '</div></div>';
            
            document.getElementById('problemBox').classList.remove('hidden');
            document.getElementById('problemContent').innerHTML = 
                '<div class="bg-black bg-opacity-30 p-3 rounded">' +
                '<p class="font-bold mb-2">ğŸ”¥ ì¬ì•™ì  ë³´ì•ˆ ì‚¬ê³ :</p>' +
                '<div class="space-y-1 ml-4 text-sm">' +
                '<div>â€¢ 10ë§Œ+ ê³ ê° ê°œì¸ì •ë³´ ìœ ì¶œ</div>' +
                '<div>â€¢ ê³„ì¢Œë²ˆí˜¸, ì”ì•¡ ì „ë¶€ ë…¸ì¶œ</div>' +
                '<div>â€¢ Rate limiting ì—†ì–´ íƒì§€ ì‹¤íŒ¨</div>' +
                '<div>â€¢ WAF/IPS ìš°íšŒë¨</div>' +
                '<div>â€¢ ê°ì‚¬ ë¡œê·¸ ë¶€ì¬ë¡œ ì¶”ì  ë¶ˆê°€</div>' +
                '</div></div>' +
                '<div class="bg-black bg-opacity-30 p-3 rounded mt-2">' +
                '<p class="font-bold mb-2">ğŸ’° ì˜ˆìƒ í”¼í•´ì•¡:</p>' +
                '<div class="space-y-1 ml-4 text-sm">' +
                '<div>â€¢ ê°œì¸ì •ë³´ë³´í˜¸ë²• ìœ„ë°˜: ê³¼ì§•ê¸ˆ ìˆ˜ì‹­ì–µ</div>' +
                '<div>â€¢ ì˜ì—…ì •ì§€ ê°€ëŠ¥ì„±</div>' +
                '<div>â€¢ ì§‘ë‹¨ ì†Œì†¡ ë¦¬ìŠ¤í¬</div>' +
                '<div>â€¢ ë¸Œëœë“œ ì´ë¯¸ì§€ ì¶”ë½</div>' +
                '</div></div>';
            
            updateServerStatus('BREACHED', 'bg-red-600 animate-blink');
        }

        function updateStep(html) {
            const steps = document.getElementById('attackSteps');
            const div = document.createElement('div');
            div.className = 'p-2 bg-gray-700 rounded text-sm';
            div.innerHTML = html;
            steps.appendChild(div);
            steps.scrollTop = steps.scrollHeight;
        }

        async function addServerLog(message, colorClass) {
            const div = document.createElement('div');
            div.className = colorClass || 'text-gray-400';
            div.textContent = '> ' + message;
            const container = document.getElementById('serverLog');
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
            await sleep(100);
        }

        function updateServerStatus(text, className) {
            document.getElementById('serverStatus').textContent = text;
            document.getElementById('serverStatus').className = 'text-xs text-white px-3 py-1 rounded ' + className;
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
    </script>
</body>
</html>