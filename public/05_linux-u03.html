<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>U-03 ê³„ì • ì ê¸ˆ ì„ê³„ê°’ ì„¤ì • - ì‹¤ìŠµ ì‹œë®¬ë ˆì´í„°</title>
    <!-- Prism for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', 'Malgun Gothic', sans-serif; background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); min-height: 100vh; padding: 20px; color: #333; }
        .container { max-width: 1600px; margin: 0 auto; }
        
        /* í—¤ë” ìŠ¤íƒ€ì¼ */
        .header { background: white; padding: 30px; border-radius: 15px; margin-bottom: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); text-align: center; border-bottom: 5px solid #0d6efd; }
        .header h1 { color: #0d6efd; font-size: 32px; margin-bottom: 10px; font-weight: 800; }
        .header p { color: #666; font-size: 16px; }
        
        /* íƒ­ ìŠ¤íƒ€ì¼ */
        .mode-tabs { display: flex; gap: 15px; margin-bottom: 20px; }
        .mode-tab { flex: 1; padding: 20px; background: rgba(255, 255, 255, 0.9); border: none; border-radius: 12px; cursor: pointer; transition: all 0.3s; box-shadow: 0 5px 15px rgba(0,0,0,0.05); text-align: left; position: relative; overflow: hidden; }
        .mode-tab:hover { transform: translateY(-3px); }
        .mode-tab.active { background: linear-gradient(135deg, #0d6efd 0%, #0a58ca 100%); color: white; }
        .mode-icon { font-size: 32px; margin-bottom: 10px; }
        .mode-title { font-size: 18px; font-weight: bold; margin-bottom: 5px; }
        .mode-desc { font-size: 13px; opacity: 0.8; }
        
        /* ì»¨í…ì¸  ì˜ì—­ */
        .content-wrapper { display: none; }
        .content-wrapper.active { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* ì²´í¬ë¦¬ìŠ¤íŠ¸ */
        .progress-indicator { background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .progress-title { font-size: 16px; font-weight: bold; margin-bottom: 15px; color: #2c3e50; }
        .checklist { list-style: none; padding: 0; display: flex; gap: 15px; flex-wrap: wrap; }
        .checklist-item { padding: 8px 15px; background: #f8f9fa; border-radius: 20px; display: flex; align-items: center; gap: 8px; font-size: 14px; border: 1px solid #e9ecef; transition: all 0.3s; }
        .checklist-item.completed { background: #d4edda; border-color: #c3e6cb; color: #155724; font-weight: bold; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }

        /* ë©”ì¸ íŒ¨ë„ */
        .main-content { display: grid; grid-template-columns: 1.2fr 0.8fr; gap: 20px; margin-bottom: 20px; }
        .panel { background: white; border-radius: 15px; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); display: flex; flex-direction: column; height: 100%; }
        
        .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 3px solid #f0f0f0; }
        .panel-title { font-size: 20px; font-weight: bold; color: #2c3e50; display: flex; align-items: center; gap: 10px; }
        
        .status-badge { padding: 6px 16px; border-radius: 20px; font-size: 13px; font-weight: bold; }
        .status-vulnerable { background: #dc3545; color: white; }
        .status-secure { background: #198754; color: white; }
        .status-editing { background: #ffc107; color: #000; }

        /* ì—ë””í„° */
        .code-editor { background: #2d2d2d; border-radius: 8px; overflow: hidden; display: flex; flex-direction: column; flex-grow: 1; min-height: 500px; box-shadow: inset 0 0 20px rgba(0,0,0,0.5); }
        .editor-toolbar { background: #404040; padding: 10px 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #505050; }
        .toolbar-title { color: #fff; font-size: 13px; font-weight: bold; font-family: 'Consolas', monospace; }
        .toolbar-hint { color: #ffc107; font-size: 12px; margin-left: 15px; flex: 1; }
        
        .edit-toggle-btn { background: #0d6efd; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: bold; transition: all 0.3s; }
        .edit-toggle-btn.editing { background: #198754; }

        .code-display { background: #2d2d2d; padding: 15px; overflow: auto; flex-grow: 1; color: #f8f8f2; }
        .code-display pre { margin: 0; font-family: 'Consolas', 'Monaco', monospace; font-size: 14px; line-height: 1.6; }
        
        .code-textarea { width: 100%; height: 100%; background: #2d2d2d; color: #f8f8f2; border: none; padding: 15px; font-family: 'Consolas', 'Monaco', monospace; font-size: 14px; line-height: 1.6; resize: none; outline: none; flex-grow: 1; display: none; }
        .code-textarea:focus { outline: none; background: #333; }

        /* ë²„íŠ¼ ê·¸ë£¹ */
        .control-panel { display: flex; gap: 15px; margin-top: 20px; }
        .btn { flex: 1; padding: 12px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; justify-content: center; gap: 5px; }
        .btn-analyze { background: #dc3545; color: white; }
        .btn-validate { background: #198754; color: white; }
        .btn-hint { background: #ffc107; color: #000; }
        .btn-reset { background: #6c757d; color: white; }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }

        /* í”¼ë“œë°± ë° íŒíŠ¸ */
        .feedback { margin-top: 20px; }
        .feedback-item { padding: 15px; margin-bottom: 10px; border-radius: 8px; animation: slideIn 0.3s ease-out; }
        .feedback-error { background: #fff5f5; border-left: 4px solid #dc3545; color: #842029; }
        .feedback-success { background: #d4edda; border-left: 4px solid #198754; color: #0f5132; }
        .feedback-warning { background: #fff3cd; border-left: 4px solid #ffc107; color: #664d03; }
        
        .hint-panel { background: #fff8dc; border: 2px solid #ffc107; border-radius: 10px; padding: 20px; margin-top: 20px; display: none; }
        .hint-panel.active { display: block; animation: slideIn 0.3s ease-out; }
        .hint-step { background: white; padding: 12px; margin-bottom: 10px; border-radius: 6px; border-left: 3px solid #ffc107; }
        .hint-code { background: #2d2d2d; color: #f8f8f2; padding: 8px; border-radius: 4px; font-family: 'Consolas', monospace; font-size: 13px; margin-top: 5px; border: 1px solid #444; }

        .info-section { margin-bottom: 20px; }
        .info-title { font-size: 18px; font-weight: bold; margin-bottom: 10px; color: #0d6efd; display: flex; align-items: center; gap: 8px; }
        .info-content { color: #555; line-height: 1.6; font-size: 15px; }
        
        .kisa-badge { display: inline-block; padding: 4px 8px; background: #6c757d; color: white; border-radius: 4px; font-size: 12px; margin-bottom: 5px; }

        @keyframes slideIn { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }
        @media (max-width: 1200px) { .main-content { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="container">
        <!-- í—¤ë” -->
        <div class="header">
            <span class="kisa-badge">ì£¼ìš”ì •ë³´í†µì‹ ê¸°ë°˜ì‹œì„¤ ê¸°ìˆ ì  ì·¨ì•½ì  ê°€ì´ë“œ</span>
            <h1>ğŸ›¡ï¸ U-03 ê³„ì • ì ê¸ˆ ì„ê³„ê°’ ì„¤ì •</h1>
            <p>ë¡œê·¸ì¸ ì‹¤íŒ¨ íšŸìˆ˜ê°€ ì¼ì • ì„ê³„ê°’ì„ ì´ˆê³¼í•  ê²½ìš° ê³„ì •ì„ ìë™ìœ¼ë¡œ ì ê°€ ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²©ì„ ë°©ì–´í•©ë‹ˆë‹¤.</p>
        </div>

        <!-- íƒ­ ë©”ë‰´ (pam_tally2 vs pam_faillock) -->
        <div class="mode-tabs">
            <button class="mode-tab active" onclick="switchMode('tally2')">
                <div class="mode-icon"><i class="fa-solid fa-server"></i></div>
                <div class="mode-title">RHEL/CentOS 7</div>
                <div class="mode-desc">pam_tally2.so ëª¨ë“ˆ ì‚¬ìš©</div>
            </button>
            <button class="mode-tab" onclick="switchMode('faillock')">
                <div class="mode-icon"><i class="fa-solid fa-shield-halved"></i></div>
                <div class="mode-title">RHEL/CentOS 8+</div>
                <div class="mode-desc">pam_faillock.so ëª¨ë“ˆ ì‚¬ìš©</div>
            </button>
        </div>

        <!-- =========================
             1. pam_tally2 ëª¨ë“œ (/etc/pam.d/system-auth)
             ========================= -->
        <div id="tally2-mode" class="content-wrapper active">
            <div class="progress-indicator">
                <div class="progress-title">âœ… ì ê²€ ì§„í–‰ë„</div>
                <ul class="checklist" id="progressChecklistTally2">
                    <li class="checklist-item"><span class="checklist-icon">â¬œ</span> PAM ì„¤ì • í™•ì¸</li>
                    <li class="checklist-item"><span class="checklist-icon">â¬œ</span> ì·¨ì•½í•œ ì„¤ì • ì‹ë³„</li>
                    <li class="checklist-item"><span class="checklist-icon">â¬œ</span> ì„ê³„ê°’ ì„¤ì • ì™„ë£Œ</li>
                </ul>
            </div>

            <div class="main-content">
                <!-- ì™¼ìª½: ì—ë””í„° íŒ¨ë„ -->
                <div class="panel">
                    <div class="panel-header">
                        <span class="panel-title"><i class="fa-regular fa-file-code"></i> /etc/pam.d/system-auth</span>
                        <span class="status-badge status-vulnerable" id="statusTally2">ì·¨ì•½í•¨</span>
                    </div>

                    <div class="code-editor">
                        <div class="editor-toolbar">
                            <span class="toolbar-title">system-auth</span>
                            <span class="toolbar-hint">ğŸ’¡ auth í•­ëª©ì— pam_tally2.so deny=5 ì„¤ì •ì„ ì¶”ê°€í•˜ì„¸ìš”.</span>
                            <button class="edit-toggle-btn" id="editBtnTally2" onclick="toggleEdit('tally2')">âœï¸ í¸ì§‘ (vi)</button>
                        </div>
                        <div class="code-display">
                            <pre><code class="language-bash" id="codeDisplayTally2">#%PAM-1.0
# This file is auto-generated.
# User changes will be destroyed the next time authconfig is run.
auth        required      pam_env.so
auth        sufficient    pam_unix.so nullok try_first_pass
auth        requisite     pam_succeed_if.so uid >= 1000 quiet_success
auth        required      pam_deny.so

# [ì·¨ì•½] pam_tally2.so ì„¤ì •ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŒ (ê³„ì • ì ê¸ˆ ë¯¸ì„¤ì •)

account     required      pam_unix.so
account     sufficient    pam_localuser.so
account     sufficient    pam_succeed_if.so uid < 1000 quiet
account     required      pam_permit.so</code></pre>
                        </div>
                        <textarea class="code-textarea" id="editorTally2" spellcheck="false">#%PAM-1.0
# This file is auto-generated.
# User changes will be destroyed the next time authconfig is run.
auth        required      pam_env.so
auth        sufficient    pam_unix.so nullok try_first_pass
auth        requisite     pam_succeed_if.so uid >= 1000 quiet_success
auth        required      pam_deny.so

# [ì·¨ì•½] pam_tally2.so ì„¤ì •ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŒ (ê³„ì • ì ê¸ˆ ë¯¸ì„¤ì •)

account     required      pam_unix.so
account     sufficient    pam_localuser.so
account     sufficient    pam_succeed_if.so uid < 1000 quiet
account     required      pam_permit.so</textarea>
                    </div>

                    <div class="control-panel">
                        <button class="btn btn-analyze" onclick="analyzeTally2()">ğŸ” ì§„ë‹¨í•˜ê¸°</button>
                        <button class="btn btn-validate" onclick="validateTally2()" id="validateBtnTally2" disabled>âœ… ì´í–‰ê²€ì¦</button>
                        <button class="btn btn-hint" onclick="toggleHint('tally2')">ğŸ’¡ ê°€ì´ë“œ</button>
                        <button class="btn btn-reset" onclick="resetTally2()">ğŸ”„ ì´ˆê¸°í™”</button>
                    </div>

                    <div class="feedback" id="feedbackTally2"></div>

                    <div class="hint-panel" id="hintPanelTally2">
                        <div class="info-title">ğŸ’¡ KISA ì¡°ì¹˜ ê°€ì´ë“œ (CentOS 7 / pam_tally2)</div>
                        <div class="hint-step">
                            <strong>1. auth ì„¤ì • ì¶”ê°€</strong>
                            <p>ë¡œê·¸ì¸ ì‹¤íŒ¨ íšŸìˆ˜ë¥¼ ê¸°ë¡í•˜ê³  ì œí•œí•˜ê¸° ìœ„í•´ <code>auth</code> ì„¹ì…˜ì˜ ìƒë‹¨ì— ë‹¤ìŒ ë¼ì¸ì„ ì¶”ê°€í•©ë‹ˆë‹¤.</p>
                            <div class="hint-code">
auth required pam_tally2.so deny=5 unlock_time=120 no_magic_root
                            </div>
                            <small class="text-muted">* deny: ì‹¤íŒ¨ í—ˆìš© íšŸìˆ˜ (ë³´í†µ 5~10íšŒ)<br>* unlock_time: ì ê¸ˆ ì§€ì† ì‹œê°„(ì´ˆ)</small>
                        </div>
                        <div class="hint-step">
                            <strong>2. account ì„¤ì • ì¶”ê°€</strong>
                            <p>ê³„ì • ì ‘ì† ì‹œë„ ì‹œ ì ê¸ˆ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ <code>account</code> ì„¹ì…˜ì— ë‹¤ìŒ ë¼ì¸ì„ ì¶”ê°€í•©ë‹ˆë‹¤.</p>
                            <div class="hint-code">
account required pam_tally2.so
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ì˜¤ë¥¸ìª½: ì„¤ëª… íŒ¨ë„ -->
                <div class="panel">
                    <div class="panel-header">
                        <span class="panel-title">ğŸ“Š ì·¨ì•½ì  ìƒì„¸ ë¶„ì„</span>
                    </div>
                    <div>
                        <div class="info-section">
                            <div class="info-title"><i class="fa-solid fa-bullseye"></i> ì ê²€ ëª©ì </div>
                            <div class="info-content">
                                ë¡œê·¸ì¸ ì‹¤íŒ¨ íšŸìˆ˜ ì œí•œ(ì„ê³„ê°’ ì„¤ì •)ì„ í†µí•´ ê³µê²©ìê°€ ìë™í™”ëœ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë¬´ì‘ìœ„ë¡œ ëŒ€ì…í•˜ëŠ” ê³µê²©(Brute Force Attack)ì„ ì°¨ë‹¨í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤.
                            </div>
                        </div>
                        <div class="info-section">
                            <div class="info-title"><i class="fa-solid fa-triangle-exclamation"></i> ìœ„í—˜ì„±</div>
                            <div class="info-content">
                                <p style="color: #dc3545; font-weight: bold;">[ìƒ] ë§¤ìš° ìœ„í—˜</p>
                                <p>ì„ê³„ê°’ì´ ì„¤ì •ë˜ì–´ ìˆì§€ ì•Šìœ¼ë©´ ê³µê²©ìëŠ” ì‹œê°„ì´ ë¬´ì œí•œìœ¼ë¡œ ì£¼ì–´ì§€ëŠ” í•œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì•Œì•„ë‚¼ ë•Œê¹Œì§€ ê³„ì†í•´ì„œ ë¡œê·¸ì¸ì„ ì‹œë„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                            </div>
                        </div>
                        <div class="info-section">
                            <div class="info-title"><i class="fa-solid fa-check-double"></i> íŒë‹¨ ê¸°ì¤€</div>
                            <div class="info-content">
                                <ul style="list-style-type: disc; margin-left: 20px;">
                                    <li><strong>ì–‘í˜¸:</strong> ê³„ì • ì ê¸ˆ ì„ê³„ê°’ì´ 10íšŒ ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìˆëŠ” ê²½ìš°</li>
                                    <li><strong>ì·¨ì•½:</strong> ê³„ì • ì ê¸ˆ ì„ê³„ê°’ì´ ì„¤ì •ë˜ì–´ ìˆì§€ ì•Šê±°ë‚˜ 10íšŒë¥¼ ì´ˆê³¼í•˜ëŠ” ê²½ìš°</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- =========================
             2. pam_faillock ëª¨ë“œ (/etc/pam.d/password-auth)
             ========================= -->
        <div id="faillock-mode" class="content-wrapper">
            <div class="progress-indicator">
                <div class="progress-title">âœ… ì ê²€ ì§„í–‰ë„</div>
                <ul class="checklist" id="progressChecklistFaillock">
                    <li class="checklist-item"><span class="checklist-icon">â¬œ</span> PAM ì„¤ì • í™•ì¸</li>
                    <li class="checklist-item"><span class="checklist-icon">â¬œ</span> ì·¨ì•½í•œ ì„¤ì • ì‹ë³„</li>
                    <li class="checklist-item"><span class="checklist-icon">â¬œ</span> ì„ê³„ê°’ ì„¤ì • ì™„ë£Œ</li>
                </ul>
            </div>

            <div class="main-content">
                <!-- ì™¼ìª½: ì—ë””í„° íŒ¨ë„ -->
                <div class="panel">
                    <div class="panel-header">
                        <span class="panel-title"><i class="fa-regular fa-file-code"></i> /etc/pam.d/password-auth</span>
                        <span class="status-badge status-vulnerable" id="statusFaillock">ì·¨ì•½í•¨</span>
                    </div>

                    <div class="code-editor">
                        <div class="editor-toolbar">
                            <span class="toolbar-title">password-auth</span>
                            <span class="toolbar-hint">ğŸ’¡ pam_faillock.so deny=5 ì„¤ì •ì„ ì¶”ê°€í•˜ì„¸ìš”.</span>
                            <button class="edit-toggle-btn" id="editBtnFaillock" onclick="toggleEdit('faillock')">âœï¸ í¸ì§‘ (vi)</button>
                        </div>
                        <div class="code-display">
                            <pre><code class="language-bash" id="codeDisplayFaillock">#%PAM-1.0
# User changes will be destroyed the next time authselect is run.
auth        required                                     pam_env.so
auth        required                                     pam_faildelay.so delay=2000000

# [ì·¨ì•½] pam_faillock (preauth) ì„¤ì • ë¶€ì¬

auth        sufficient                                   pam_unix.so nullok try_first_pass
auth        requisite                                    pam_succeed_if.so uid >= 1000 quiet_success
auth        required                                     pam_deny.so

# [ì·¨ì•½] pam_faillock (authfail) ì„¤ì • ë¶€ì¬

account     required                                     pam_unix.so
account     sufficient                                   pam_localuser.so</code></pre>
                        </div>
                        <textarea class="code-textarea" id="editorFaillock" spellcheck="false">#%PAM-1.0
# User changes will be destroyed the next time authselect is run.
auth        required                                     pam_env.so
auth        required                                     pam_faildelay.so delay=2000000

# [ì·¨ì•½] pam_faillock (preauth) ì„¤ì • ë¶€ì¬

auth        sufficient                                   pam_unix.so nullok try_first_pass
auth        requisite                                    pam_succeed_if.so uid >= 1000 quiet_success
auth        required                                     pam_deny.so

# [ì·¨ì•½] pam_faillock (authfail) ì„¤ì • ë¶€ì¬

account     required                                     pam_unix.so
account     sufficient                                   pam_localuser.so</textarea>
                    </div>

                    <div class="control-panel">
                        <button class="btn btn-analyze" onclick="analyzeFaillock()">ğŸ” ì§„ë‹¨í•˜ê¸°</button>
                        <button class="btn btn-validate" onclick="validateFaillock()" id="validateBtnFaillock" disabled>âœ… ì´í–‰ê²€ì¦</button>
                        <button class="btn btn-hint" onclick="toggleHint('faillock')">ğŸ’¡ ê°€ì´ë“œ</button>
                        <button class="btn btn-reset" onclick="resetFaillock()">ğŸ”„ ì´ˆê¸°í™”</button>
                    </div>

                    <div class="feedback" id="feedbackFaillock"></div>

                    <div class="hint-panel" id="hintPanelFaillock">
                        <div class="info-title">ğŸ’¡ KISA ì¡°ì¹˜ ê°€ì´ë“œ (CentOS 8+ / pam_faillock)</div>
                        <div class="hint-step">
                            <strong>1. preauth ì„¤ì • (ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì „)</strong>
                            <p><code>pam_unix.so</code>ë³´ë‹¤ <strong>ì•ì—</strong> ë‹¤ìŒ ë¼ì¸ì„ ì¶”ê°€í•˜ì—¬ ì´ì „ ì‹¤íŒ¨ ê¸°ë¡ì„ í™•ì¸í•©ë‹ˆë‹¤.</p>
                            <div class="hint-code">
auth required pam_faillock.so preauth silent deny=5 unlock_time=600
                            </div>
                        </div>
                        <div class="hint-step">
                            <strong>2. authfail ì„¤ì • (ë¹„ë°€ë²ˆí˜¸ ì‹¤íŒ¨ ì‹œ)</strong>
                            <p><code>pam_unix.so</code> ë’¤, <code>pam_deny.so</code> ì•ì— ë‹¤ìŒ ë¼ì¸ì„ ì¶”ê°€í•˜ì—¬ ì‹¤íŒ¨ë¥¼ ê¸°ë¡í•©ë‹ˆë‹¤.</p>
                            <div class="hint-code">
auth required pam_faillock.so authfail deny=5 unlock_time=600
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ì˜¤ë¥¸ìª½: ì„¤ëª… íŒ¨ë„ -->
                <div class="panel">
                    <div class="panel-header">
                        <span class="panel-title">ğŸ“Š ì·¨ì•½ì  ìƒì„¸ ë¶„ì„</span>
                    </div>
                    <div>
                        <div class="info-section">
                            <div class="info-title"><i class="fa-solid fa-bullseye"></i> ì ê²€ ëª©ì </div>
                            <div class="info-content">
                                RHEL 8 ì´ìƒì—ì„œëŠ” <code>pam_tally2</code>ê°€ ë” ì´ìƒ ì‚¬ìš©ë˜ì§€ ì•Šìœ¼ë©°, <code>pam_faillock</code> ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì—¬ ê³„ì • ì ê¸ˆ ì •ì±…ì„ êµ¬í˜„í•´ì•¼ í•©ë‹ˆë‹¤.
                            </div>
                        </div>
                        <div class="info-section">
                            <div class="info-title"><i class="fa-solid fa-triangle-exclamation"></i> ì£¼ìš” ì°¨ì´ì </div>
                            <div class="info-content">
                                <p><code>pam_faillock</code>ì€ ì„ì‹œ ì‹¤íŒ¨ ê¸°ë¡ì„ <code>/var/run/faillock</code> ë””ë ‰í„°ë¦¬ì— ì €ì¥í•˜ë©°, ì¸ì¦ ì„±ê³µ ì‹œ ì‹¤íŒ¨ ê¸°ë¡ì„ ìë™ìœ¼ë¡œ ì´ˆê¸°í™”í•˜ì§€ ì•Šì„ ìˆ˜ë„ ìˆëŠ” ë“± <code>pam_tally2</code>ë³´ë‹¤ ë”ìš± ì •êµí•œ ì œì–´ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    
    <script>
        // === ê³µí†µ ìœ í‹¸ë¦¬í‹° ===
        function switchMode(mode) {
            document.querySelectorAll('.mode-tab').forEach(tab => tab.classList.remove('active'));
            event.currentTarget.classList.add('active');
            
            document.querySelectorAll('.content-wrapper').forEach(w => w.classList.remove('active'));
            document.getElementById(mode + '-mode').classList.add('active');
        }

        function toggleHint(mode) {
            const panelId = mode === 'tally2' ? 'hintPanelTally2' : 'hintPanelFaillock';
            document.getElementById(panelId).classList.toggle('active');
        }

        function updateChecklist(listId, index, isCompleted) {
            const list = document.getElementById(listId);
            const items = list.getElementsByTagName('li');
            if (items[index]) {
                const icon = items[index].querySelector('.checklist-icon');
                if (isCompleted) {
                    items[index].classList.add('completed');
                    icon.textContent = 'âœ…';
                } else {
                    items[index].classList.remove('completed');
                    icon.textContent = 'â¬œ';
                }
            }
        }

        function setStatus(suffix, status) {
            const el = document.getElementById(`status${suffix}`);
            if(status === 'vulnerable') {
                el.textContent = 'ì·¨ì•½í•¨';
                el.className = 'status-badge status-vulnerable';
            } else if (status === 'secure') {
                el.textContent = 'ì–‘í˜¸';
                el.className = 'status-badge status-secure';
            } else {
                el.textContent = 'ìˆ˜ì • ì¤‘';
                el.className = 'status-badge status-editing';
            }
        }

        function toggleEdit(mode) {
            const isTally2 = mode === 'tally2';
            const suffix = isTally2 ? 'Tally2' : 'Faillock';
            
            const displayEl = document.querySelector(`#codeDisplay${suffix}`).parentElement;
            const editorEl = document.getElementById(`editor${suffix}`);
            const btn = document.getElementById(`editBtn${suffix}`);
            const codeEl = document.getElementById(`codeDisplay${suffix}`);

            // ê°„ë‹¨í•œ ìƒíƒœ í† ê¸€ ë¡œì§
            const isEditing = btn.classList.contains('editing');

            if (!isEditing) {
                displayEl.style.display = 'none';
                editorEl.style.display = 'block';
                editorEl.value = codeEl.textContent;
                editorEl.focus();
                btn.innerHTML = '<i class="fa-solid fa-save"></i> ì €ì¥ (:wq)';
                btn.classList.add('editing');
            } else {
                displayEl.style.display = 'block';
                editorEl.style.display = 'none';
                codeEl.textContent = editorEl.value;
                if(window.Prism) Prism.highlightElement(codeEl);
                btn.innerHTML = 'âœï¸ í¸ì§‘ (vi)';
                btn.classList.remove('editing');
                setStatus(suffix, 'editing');
            }
        }

        // === 1. pam_tally2 Logic ===
        function analyzeTally2() {
            updateChecklist('progressChecklistTally2', 0, true);
            const code = document.getElementById('editorTally2').value;
            
            // deny ì„¤ì •ì´ ì—†ìœ¼ë©´ ì·¨ì•½
            const isVulnerable = !code.includes('pam_tally2.so') || !code.includes('deny=');

            if (isVulnerable) {
                updateChecklist('progressChecklistTally2', 1, true);
                document.getElementById('feedbackTally2').innerHTML = 
                    `<div class="feedback-item feedback-error">
                        <strong>ğŸš¨ ì·¨ì•½ì  ë°œê²¬ (VULNERABLE)</strong>
                        <p>ê³„ì • ì ê¸ˆ ëª¨ë“ˆ(pam_tally2.so) ì„¤ì •ì´ ì—†ê±°ë‚˜ deny(ì„ê³„ê°’) ì„¤ì •ì´ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                     </div>`;
                document.getElementById('validateBtnTally2').disabled = false;
                setStatus('Tally2', 'vulnerable');
            }
        }

        function validateTally2() {
            const code = document.getElementById('editorTally2').value;
            
            // deny=5 (ë˜ëŠ” 10 ì´í•˜) ê°€ ìˆëŠ”ì§€ í™•ì¸
            const match = code.match(/pam_tally2\.so.*deny=(\d+)/);
            
            let isSecure = false;
            if (match && parseInt(match[1]) <= 10) {
                isSecure = true;
            }

            if (isSecure) {
                updateChecklist('progressChecklistTally2', 2, true);
                document.getElementById('feedbackTally2').innerHTML = 
                    `<div class="feedback-item feedback-success">
                        <strong>ğŸ‰ ì¡°ì¹˜ ì™„ë£Œ (SECURE)</strong>
                        <p>ê³„ì • ì ê¸ˆ ì„ê³„ê°’ì´ ${match[1]}íšŒë¡œ ì•ˆì „í•˜ê²Œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                     </div>`;
                setStatus('Tally2', 'secure');
            } else {
                updateChecklist('progressChecklistTally2', 2, false);
                document.getElementById('feedbackTally2').innerHTML = 
                    `<div class="feedback-item feedback-warning">
                        <strong>âš ï¸ ì¡°ì¹˜ ë¯¸í¡</strong>
                        <p><code>auth required pam_tally2.so deny=5</code> ì™€ ê°™ì´ ì„ê³„ê°’(10íšŒ ì´í•˜)ì„ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.</p>
                     </div>`;
                setStatus('Tally2', 'editing');
            }
        }

        function resetTally2() {
            const initialCode = `#%PAM-1.0
# This file is auto-generated.
# User changes will be destroyed the next time authconfig is run.
auth        required      pam_env.so
auth        sufficient    pam_unix.so nullok try_first_pass
auth        requisite     pam_succeed_if.so uid >= 1000 quiet_success
auth        required      pam_deny.so

# [ì·¨ì•½] pam_tally2.so ì„¤ì •ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŒ (ê³„ì • ì ê¸ˆ ë¯¸ì„¤ì •)

account     required      pam_unix.so
account     sufficient    pam_localuser.so
account     sufficient    pam_succeed_if.so uid < 1000 quiet
account     required      pam_permit.so`;
            document.getElementById('editorTally2').value = initialCode;
            document.getElementById('codeDisplayTally2').textContent = initialCode;
            if(window.Prism) Prism.highlightElement(document.getElementById('codeDisplayTally2'));
            
            document.getElementById('feedbackTally2').innerHTML = '';
            document.getElementById('validateBtnTally2').disabled = true;
            setStatus('Tally2', 'vulnerable');
            for(let i=0; i<3; i++) updateChecklist('progressChecklistTally2', i, false);
        }

        // === 2. pam_faillock Logic ===
        function analyzeFaillock() {
            updateChecklist('progressChecklistFaillock', 0, true);
            const code = document.getElementById('editorFaillock').value;
            
            const isVulnerable = !code.includes('pam_faillock.so') || !code.includes('deny=');

            if (isVulnerable) {
                updateChecklist('progressChecklistFaillock', 1, true);
                document.getElementById('feedbackFaillock').innerHTML = 
                    `<div class="feedback-item feedback-error">
                        <strong>ğŸš¨ ì·¨ì•½ì  ë°œê²¬ (VULNERABLE)</strong>
                        <p>RHEL 8 ì´ìƒì—ì„œëŠ” <code>pam_faillock.so</code> ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì—¬ ê³„ì • ì ê¸ˆ ì •ì±…ì„ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.</p>
                     </div>`;
                document.getElementById('validateBtnFaillock').disabled = false;
                setStatus('Faillock', 'vulnerable');
            }
        }

        function validateFaillock() {
            const code = document.getElementById('editorFaillock').value;
            
            // preauth ì™€ authfail ë‘ êµ°ë° ì„¤ì • í™•ì¸ ë° deny ê°’ í™•ì¸
            const hasPreauth = /pam_faillock\.so.*preauth/.test(code);
            const hasAuthfail = /pam_faillock\.so.*authfail/.test(code);
            const match = code.match(/pam_faillock\.so.*deny=(\d+)/);
            
            let isSecure = false;
            if (hasPreauth && hasAuthfail && match && parseInt(match[1]) <= 10) {
                isSecure = true;
            }

            if (isSecure) {
                updateChecklist('progressChecklistFaillock', 2, true);
                document.getElementById('feedbackFaillock').innerHTML = 
                    `<div class="feedback-item feedback-success">
                        <strong>ğŸ‰ ì¡°ì¹˜ ì™„ë£Œ (SECURE)</strong>
                        <p>pam_faillock ëª¨ë“ˆì´ ì˜¬ë°”ë¥´ê²Œ êµ¬ì„±ë˜ì—ˆìœ¼ë©° ì„ê³„ê°’(${match[1]}íšŒ)ì´ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                     </div>`;
                setStatus('Faillock', 'secure');
            } else {
                updateChecklist('progressChecklistFaillock', 2, false);
                document.getElementById('feedbackFaillock').innerHTML = 
                    `<div class="feedback-item feedback-warning">
                        <strong>âš ï¸ ì¡°ì¹˜ ë¯¸í¡</strong>
                        <p><code>preauth</code> ë° <code>authfail</code> ì„¤ì •ê³¼ <code>deny=5</code> ì˜µì…˜ì´ ëª¨ë‘ í•„ìš”í•©ë‹ˆë‹¤.</p>
                     </div>`;
                 setStatus('Faillock', 'editing');
            }
        }

        function resetFaillock() {
            const initialCode = `#%PAM-1.0
# User changes will be destroyed the next time authselect is run.
auth        required                                     pam_env.so
auth        required                                     pam_faildelay.so delay=2000000

# [ì·¨ì•½] pam_faillock (preauth) ì„¤ì • ë¶€ì¬

auth        sufficient                                   pam_unix.so nullok try_first_pass
auth        requisite                                    pam_succeed_if.so uid >= 1000 quiet_success
auth        required                                     pam_deny.so

# [ì·¨ì•½] pam_faillock (authfail) ì„¤ì • ë¶€ì¬

account     required                                     pam_unix.so
account     sufficient                                   pam_localuser.so`;
            document.getElementById('editorFaillock').value = initialCode;
            document.getElementById('codeDisplayFaillock').textContent = initialCode;
            if(window.Prism) Prism.highlightElement(document.getElementById('codeDisplayFaillock'));

            document.getElementById('feedbackFaillock').innerHTML = '';
            document.getElementById('validateBtnFaillock').disabled = true;
            setStatus('Faillock', 'vulnerable');
            for(let i=0; i<3; i++) updateChecklist('progressChecklistFaillock', i, false);
        }
    </script>
</body>
</html>