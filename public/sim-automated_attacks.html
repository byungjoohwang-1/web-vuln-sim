<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¸ˆìœµê¶Œ ìë™í™” ê³µê²© ì‹œë®¬ë ˆì´í„°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        .code-font { font-family: 'Courier New', monospace; }
        .attack-animation {
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body class="bg-gray-100 p-4">

    <!-- í‰ê°€ê¸°ì¤€ ë°°ë„ˆ -->
    <div class="max-w-7xl mx-auto mb-4">
        <div class="bg-red-600 text-white p-4 rounded-lg shadow-lg">
            <div class="flex items-center gap-3">
                <i class="fas fa-clipboard-check text-2xl"></i>
                <div>
                    <h1 class="font-bold text-lg">ì „ìê¸ˆìœµê¸°ë°˜ì‹œì„¤ ë³´ì•ˆ ì·¨ì•½ì  - ìë™í™” ê³µê²© ë°©ì–´</h1>
                    <p class="text-sm">ìë™í™” ë„êµ¬ ì•…ìš© (Automated Attack) | ìœ„í—˜ë„: 4 (ë†’ìŒ) | í†µì œêµ¬ë¶„: 5.4.1 ìë™í™” ê³µê²© ë°©ì–´</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <div class="max-w-7xl mx-auto">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
            
            <!-- ì¢Œì¸¡: ì·¨ì•½í•œ ì‹œìŠ¤í…œ -->
            <div class="space-y-4">
                
                <!-- ì€í–‰ í—¤ë” -->
                <div class="bg-blue-600 text-white p-4 rounded-lg shadow-lg">
                    <div class="flex items-center gap-3">
                        <i class="fas fa-building-columns text-2xl"></i>
                        <div>
                            <h2 class="text-xl font-bold">ì¹´ì¹´ì˜¤ë±…í¬</h2>
                            <p class="text-sm">ì¸í„°ë„·ë±…í‚¹ ë¡œê·¸ì¸ ì‹œìŠ¤í…œ</p>
                        </div>
                    </div>
                    <div class="mt-2 bg-red-500 px-3 py-1 rounded text-sm">
                        <i class="fas fa-exclamation-triangle"></i> ì·¨ì•½ì : ìë™í™” ê³µê²© ë°©ì–´ ë¯¸í¡
                    </div>
                </div>

                <!-- ë¡œê·¸ì¸ í¼ -->
                <div class="bg-white p-5 rounded-lg shadow-lg">
                    <h3 class="font-bold text-lg mb-3 flex items-center gap-2">
                        <i class="fas fa-sign-in-alt text-blue-600"></i>
                        ë¡œê·¸ì¸
                    </h3>
                    
                    <label class="block text-sm font-bold mb-2">ì‚¬ìš©ì ID</label>
                    <input type="text" id="userId" 
                           class="w-full p-2 border border-gray-300 rounded mb-3" 
                           value="admin"
                           readonly>
                    
                    <label class="block text-sm font-bold mb-2">ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" id="userPwd" 
                           class="w-full p-2 border border-gray-300 rounded mb-3" 
                           value="????????">
                    
                    <div class="bg-gray-100 p-3 rounded mb-3">
                        <p class="text-xs text-gray-600 mb-2">âš ï¸ ë°©ì–´ ê¸°ëŠ¥ ìƒíƒœ:</p>
                        <div class="space-y-1 text-xs">
                            <div class="flex justify-between">
                                <span>CAPTCHA:</span>
                                <span class="text-red-600 font-bold">ë¹„í™œì„±í™”</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Rate Limiting:</span>
                                <span class="text-red-600 font-bold">ì—†ìŒ</span>
                            </div>
                            <div class="flex justify-between">
                                <span>ë¡œê·¸ì¸ ì‹œë„ ì œí•œ:</span>
                                <span class="text-red-600 font-bold">ë¬´ì œí•œ</span>
                            </div>
                            <div class="flex justify-between">
                                <span>ê³„ì • ì ê¸ˆ:</span>
                                <span class="text-red-600 font-bold">ë¯¸ì ìš©</span>
                            </div>
                        </div>
                    </div>
                    
                    <button onclick="manualLogin()" 
                            class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded">
                        <i class="fas fa-sign-in-alt"></i> ë¡œê·¸ì¸
                    </button>
                </div>

                <!-- ìë™í™” ê³µê²© í†µê³„ -->
                <div class="bg-gray-900 text-white p-4 rounded-lg shadow-lg">
                    <h3 class="font-bold mb-3 flex items-center gap-2">
                        <i class="fas fa-chart-line text-red-400"></i>
                        ì‹¤ì‹œê°„ ê³µê²© í†µê³„
                    </h3>
                    <div id="attackStats" class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span>ì´ ì‹œë„ íšŸìˆ˜:</span>
                            <span id="totalAttempts" class="text-green-400 font-bold">0</span>
                        </div>
                        <div class="flex justify-between">
                            <span>ì´ˆë‹¹ ìš”ì²­ (RPS):</span>
                            <span id="rps" class="text-yellow-400 font-bold">0</span>
                        </div>
                        <div class="flex justify-between">
                            <span>ì‹œë„í•œ íŒ¨ìŠ¤ì›Œë“œ:</span>
                            <span id="testedPasswords" class="text-blue-400 font-bold">0</span>
                        </div>
                        <div class="flex justify-between">
                            <span>ê²½ê³¼ ì‹œê°„:</span>
                            <span id="elapsedTime" class="text-gray-400">00:00</span>
                        </div>
                    </div>
                </div>

                <!-- ê³µê²© ì‹œë‚˜ë¦¬ì˜¤ ë²„íŠ¼ -->
                <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg">
                    <h3 class="font-bold mb-3 flex items-center gap-2">
                        <i class="fas fa-flask text-red-400"></i>
                        ìë™í™” ê³µê²© ì‹œë‚˜ë¦¬ì˜¤
                    </h3>
                    <div class="space-y-2">
                        <button onclick="attackScenario(1)" 
                                class="w-full text-left bg-red-900 hover:bg-red-800 px-3 py-2 rounded text-sm">
                            <i class="fas fa-robot"></i> ì‹œë‚˜ë¦¬ì˜¤ 1: Brute Force (ë¬´ì°¨ë³„ ëŒ€ì…)
                        </button>
                        <button onclick="attackScenario(2)" 
                                class="w-full text-left bg-orange-900 hover:bg-orange-800 px-3 py-2 rounded text-sm">
                            <i class="fas fa-book"></i> ì‹œë‚˜ë¦¬ì˜¤ 2: Dictionary Attack (ì‚¬ì „ ê³µê²©)
                        </button>
                        <button onclick="attackScenario(3)" 
                                class="w-full text-left bg-purple-900 hover:bg-purple-800 px-3 py-2 rounded text-sm">
                            <i class="fas fa-spider"></i> ì‹œë‚˜ë¦¬ì˜¤ 3: Credential Stuffing
                        </button>
                        <button onclick="attackScenario(4)" 
                                class="w-full text-left bg-yellow-900 hover:bg-yellow-800 px-3 py-2 rounded text-sm">
                            <i class="fas fa-globe"></i> ì‹œë‚˜ë¦¬ì˜¤ 4: ì›¹ í¬ë¡¤ë§ ë´‡
                        </button>
                        <button onclick="stopAttack()" 
                                class="w-full text-left bg-green-900 hover:bg-green-800 px-3 py-2 rounded text-sm">
                            <i class="fas fa-stop"></i> ê³µê²© ì¤‘ë‹¨
                        </button>
                    </div>
                </div>

                <!-- ì·¨ì•½í•œ ì½”ë“œ -->
                <div class="bg-gray-900 text-white p-4 rounded-lg shadow-lg">
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="font-bold text-red-400">
                            <i class="fas fa-skull-crossbones"></i> ì·¨ì•½í•œ ì½”ë“œ
                        </h3>
                        <span class="text-xs bg-red-600 px-2 py-1 rounded">ìœ„í—˜</span>
                    </div>
                    <pre class="code-font text-xs overflow-x-auto"><code><span class="text-gray-500">// âŒ ìë™í™” ê³µê²© ë°©ì–´ ì—†ìŒ</span>

@PostMapping("/login")
public ResponseEntity<?> login(
    @RequestParam String username,
    @RequestParam String password) {
    
    <span class="text-red-400">// Rate Limiting ì—†ìŒ!</span>
    <span class="text-red-400">// CAPTCHA ì—†ìŒ!</span>
    <span class="text-red-400">// ë¡œê·¸ì¸ ì‹œë„ íšŸìˆ˜ ì œí•œ ì—†ìŒ!</span>
    
    User user = userRepository
        .findByUsername(username);
    
    if (user != null && 
        passwordEncoder.matches(password, 
            user.getPassword())) {
        return ResponseEntity.ok("Success");
    }
    
    <span class="text-red-400">// ì‹¤íŒ¨ ì‹œ ì¦‰ì‹œ ì‘ë‹µ (íƒ€ì´ë° ê³µê²© ê°€ëŠ¥)</span>
    return ResponseEntity
        .status(401)
        .body("Invalid credentials");
}

<span class="text-gray-500">// API ì—”ë“œí¬ì¸íŠ¸ ë³´í˜¸ ì—†ìŒ</span>
@GetMapping("/api/users")
public List<User> getUsers() {
    <span class="text-red-400">// ëˆ„êµ¬ë‚˜ ë¬´ì œí•œ í˜¸ì¶œ ê°€ëŠ¥!</span>
    return userRepository.findAll();
}

<span class="text-gray-500">// í¬ë¡¤ë§ ë´‡ ì°¨ë‹¨ ì—†ìŒ</span>
<span class="text-red-400">// robots.txt ì—†ìŒ</span>
<span class="text-red-400">// User-Agent ê²€ì¦ ì—†ìŒ</span>
<span class="text-red-400">// IP ê¸°ë°˜ ì°¨ë‹¨ ì—†ìŒ</span></code></pre>
                </div>

            </div>

            <!-- ìš°ì¸¡: ê²°ê³¼ ë° ì•ˆì „í•œ ì½”ë“œ -->
            <div class="space-y-4">
                
                <!-- ê³µê²© ì‹¤í–‰ ê²°ê³¼ -->
                <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                    <div class="bg-gray-800 text-white px-4 py-3 flex justify-between items-center">
                        <h3 class="font-bold">
                            <i class="fas fa-terminal"></i> ê³µê²© ì‹¤í–‰ ê²°ê³¼
                        </h3>
                        <span id="statusBadge" class="text-xs bg-green-500 text-gray-900 px-3 py-1 rounded">
                            ëŒ€ê¸°ì¤‘
                        </span>
                    </div>
                    <div id="attackResult" class="p-5 min-h-[300px] bg-white">
                        <div class="text-center text-gray-400 py-10">
                            <i class="fas fa-robot text-5xl mb-3 opacity-30"></i>
                            <p class="text-sm">ê³µê²© ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
                        </div>
                    </div>
                </div>

                <!-- ê³µê²© ë‹¨ê³„ -->
                <div id="attackStages" class="hidden bg-red-100 border-l-4 border-red-600 p-4 rounded-lg">
                    <h4 class="font-bold text-red-700 mb-2 flex items-center gap-2">
                        <i class="fas fa-list-ol"></i> ê³µê²© ì§„í–‰ ë‹¨ê³„
                    </h4>
                    <div id="stagesContent" class="text-sm text-red-700 space-y-1"></div>
                </div>

                <!-- í„°ë¯¸ë„ ì¶œë ¥ -->
                <div id="terminalBox" class="hidden bg-black text-green-400 p-4 rounded-lg shadow-lg">
                    <div class="font-bold mb-2 text-xs flex justify-between">
                        <span><i class="fas fa-terminal"></i> ATTACK AUTOMATION LOG</span>
                        <span id="terminalSpeed" class="text-yellow-400">Speed: 100 req/sec</span>
                    </div>
                    <div id="terminalLines" class="code-font text-xs space-y-1 max-h-[250px] overflow-y-auto"></div>
                </div>

                <!-- ì•ˆì „í•œ ì½”ë“œ -->
                <div class="bg-gray-900 text-white p-4 rounded-lg shadow-lg">
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="font-bold text-green-400">
                            <i class="fas fa-shield-halved"></i> ì•ˆì „í•œ ì½”ë“œ
                        </h3>
                        <span class="text-xs bg-green-600 px-2 py-1 rounded">ê¶Œì¥</span>
                    </div>
                    <pre class="code-font text-xs overflow-x-auto max-h-[400px]"><code><span class="text-green-400">// âœ… ìë™í™” ê³µê²© ë°©ì–´ ì ìš©</span>

<span class="text-gray-500">// 1. Rate Limiting (Bucket4j ì‚¬ìš©)</span>
@Service
public class RateLimitService {
    
    private final Map<String, Bucket> cache = 
        new ConcurrentHashMap<>();
    
    public Bucket resolveBucket(String key) {
        return cache.computeIfAbsent(key, k -> {
            <span class="text-green-400">// 1ë¶„ì— 5ë²ˆë§Œ í—ˆìš©</span>
            Bandwidth limit = Bandwidth.classic(
                5, 
                Refill.intervally(5, Duration.ofMinutes(1))
            );
            return Bucket.builder()
                .addLimit(limit)
                .build();
        });
    }
}

@PostMapping("/login")
public ResponseEntity<?> login(
    @RequestParam String username,
    @RequestParam String password,
    HttpServletRequest request) {
    
    String clientIP = getClientIP(request);
    
    <span class="text-green-400">// IP ê¸°ë°˜ Rate Limiting</span>
    Bucket bucket = rateLimitService
        .resolveBucket(clientIP);
    
    if (!bucket.tryConsume(1)) {
        return ResponseEntity
            .status(429)
            .body("Too many requests. Try again later.");
    }
    
    <span class="text-green-400">// ë¡œê·¸ì¸ ì‹œë„ íšŸìˆ˜ ì²´í¬</span>
    int attempts = loginAttemptService
        .getAttempts(username);
    
    if (attempts >= 5) {
        <span class="text-green-400">// 5íšŒ ì‹¤íŒ¨ ì‹œ 15ë¶„ ì ê¸ˆ</span>
        if (!loginAttemptService.isUnlocked(username)) {
            return ResponseEntity
                .status(423)
                .body("Account locked. Try in 15 min.");
        }
    }
    
    <span class="text-green-400">// CAPTCHA ê²€ì¦ (3íšŒ ì‹¤íŒ¨ í›„)</span>
    if (attempts >= 3) {
        if (!verifyCaptcha(request)) {
            return ResponseEntity
                .status(400)
                .body("Invalid CAPTCHA");
        }
    }
    
    User user = userRepository
        .findByUsername(username);
    
    <span class="text-green-400">// íƒ€ì´ë° ê³µê²© ë°©ì–´ (ì¼ì • ì‹œê°„ ëŒ€ê¸°)</span>
    Thread.sleep(1000);
    
    if (user != null && 
        passwordEncoder.matches(password, 
            user.getPassword())) {
        
        <span class="text-green-400">// ì„±ê³µ ì‹œ ì‹œë„ íšŸìˆ˜ ë¦¬ì…‹</span>
        loginAttemptService.resetAttempts(username);
        
        return ResponseEntity.ok("Success");
    }
    
    <span class="text-green-400">// ì‹¤íŒ¨ ì‹œ ì‹œë„ íšŸìˆ˜ ì¦ê°€</span>
    loginAttemptService.loginFailed(username);
    
    return ResponseEntity
        .status(401)
        .body("Invalid credentials");
}

<span class="text-gray-500">// 2. ë¡œê·¸ì¸ ì‹œë„ ê´€ë¦¬ ì„œë¹„ìŠ¤</span>
@Service
public class LoginAttemptService {
    
    private final int MAX_ATTEMPT = 5;
    private final int LOCK_TIME_MINUTES = 15;
    
    private LoadingCache<String, Integer> attemptsCache;
    private LoadingCache<String, LocalDateTime> lockCache;
    
    public void loginFailed(String key) {
        int attempts = attemptsCache.get(key);
        attempts++;
        attemptsCache.put(key, attempts);
        
        if (attempts >= MAX_ATTEMPT) {
            lockCache.put(key, 
                LocalDateTime.now()
                    .plusMinutes(LOCK_TIME_MINUTES));
        }
    }
    
    public boolean isUnlocked(String key) {
        LocalDateTime lockTime = lockCache.get(key);
        if (lockTime == null) return true;
        
        return LocalDateTime.now().isAfter(lockTime);
    }
}

<span class="text-gray-500">// 3. IP ê¸°ë°˜ ì°¨ë‹¨</span>
@Component
public class IpBlockingFilter extends OncePerRequestFilter {
    
    private Set<String> blockedIps = 
        ConcurrentHashMap.newKeySet();
    
    @Override
    protected void doFilterInternal(
        HttpServletRequest request,
        HttpServletResponse response,
        FilterChain chain) {
        
        String clientIP = getClientIP(request);
        
        <span class="text-green-400">// ì°¨ë‹¨ëœ IP í™•ì¸</span>
        if (blockedIps.contains(clientIP)) {
            response.sendError(403, "IP Blocked");
            return;
        }
        
        chain.doFilter(request, response);
    }
}

<span class="text-gray-500">// 4. Bot ê°ì§€ ë° ì°¨ë‹¨</span>
@Component
public class BotDetectionFilter extends OncePerRequestFilter {
    
    @Override
    protected void doFilterInternal(
        HttpServletRequest request,
        HttpServletResponse response,
        FilterChain chain) {
        
        String userAgent = request.getHeader("User-Agent");
        
        <span class="text-green-400">// ì˜ì‹¬ìŠ¤ëŸ¬ìš´ User-Agent ì°¨ë‹¨</span>
        if (isSuspiciousBot(userAgent)) {
            response.sendError(403, 
                "Automated access detected");
            return;
        }
        
        chain.doFilter(request, response);
    }
    
    private boolean isSuspiciousBot(String ua) {
        if (ua == null || ua.isEmpty()) return true;
        
        String[] botPatterns = {
            "bot", "crawler", "spider", "scraper",
            "python-requests", "curl", "wget"
        };
        
        String lowerUA = ua.toLowerCase();
        for (String pattern : botPatterns) {
            if (lowerUA.contains(pattern)) {
                return true;
            }
        }
        
        return false;
    }
}

<span class="text-gray-500">// 5. CAPTCHA ê²€ì¦</span>
private boolean verifyCaptcha(HttpServletRequest request) {
    String captchaResponse = 
        request.getParameter("g-recaptcha-response");
    
    if (captchaResponse == null) return false;
    
    <span class="text-green-400">// Google reCAPTCHA v3 ê²€ì¦</span>
    RestTemplate restTemplate = new RestTemplate();
    String url = "https://www.google.com/recaptcha/api/siteverify";
    
    Map<String, String> params = new HashMap<>();
    params.put("secret", RECAPTCHA_SECRET);
    params.put("response", captchaResponse);
    
    RecaptchaResponse response = 
        restTemplate.postForObject(url, params, 
            RecaptchaResponse.class);
    
    return response != null && 
           response.isSuccess() && 
           response.getScore() > 0.5;
}</code></pre>
                </div>

                <!-- ë°©ì–´ ì²´í¬ë¦¬ìŠ¤íŠ¸ -->
                <div class="bg-white p-4 rounded-lg shadow-lg">
                    <h3 class="font-bold mb-3 flex items-center gap-2">
                        <i class="fas fa-list-check text-red-600"></i>
                        ìë™í™” ê³µê²© ë°©ì–´ ì²´í¬ë¦¬ìŠ¤íŠ¸
                    </h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>Rate Limiting:</strong> IPë‹¹ ìš”ì²­ íšŸìˆ˜ ì œí•œ (ë¶„ë‹¹ 5íšŒ)</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>ê³„ì • ì ê¸ˆ:</strong> 5íšŒ ì‹¤íŒ¨ ì‹œ 15ë¶„ ì ê¸ˆ</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>CAPTCHA:</strong> 3íšŒ ì‹¤íŒ¨ í›„ CAPTCHA ìš”êµ¬</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>íƒ€ì´ë° ê³µê²© ë°©ì–´:</strong> ì¼ì • ì‹œê°„ ì‘ë‹µ ì§€ì—°</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>Bot ê°ì§€:</strong> User-Agent ê²€ì¦</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>IP ì°¨ë‹¨:</strong> ì˜ì‹¬ìŠ¤ëŸ¬ìš´ IP ìë™ ì°¨ë‹¨</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>ëª¨ë‹ˆí„°ë§:</strong> ë¹„ì •ìƒ íŠ¸ë˜í”½ ì‹¤ì‹œê°„ ê°ì§€</div>
                        </div>
                    </div>
                </div>

                <!-- í‰ê°€ íŒì • -->
                <div id="judgementBox" class="hidden bg-gray-900 text-white p-4 rounded-lg">
                    <h3 class="font-bold text-indigo-400 mb-2 text-sm">
                        <i class="fas fa-gavel"></i> í‰ê°€ íŒì •
                    </h3>
                    <div class="text-xs space-y-1">
                        <div><strong>í‰ê°€í•­ëª©:</strong> ìë™í™” ê³µê²© ë°©ì–´</div>
                        <div><strong>íŒì •:</strong> <span id="judgement" class="text-red-400">ì·¨ì•½</span></div>
                        <div><strong>ê·¼ê±°:</strong> <span id="evidence"></span></div>
                    </div>
                </div>

                <!-- í”¼í•´ ì‹œë‚˜ë¦¬ì˜¤ -->
                <div id="damageBox" class="hidden bg-red-700 text-white p-4 rounded-lg">
                    <h3 class="font-bold mb-3">
                        <i class="fas fa-fire"></i> ì‹¤ì œ í”¼í•´ ì‚¬ë¡€
                    </h3>
                    <div id="damageContent" class="space-y-2 text-sm"></div>
                </div>

            </div>
        </div>
    </div>

    <script>
        let attackInterval = null;
        let totalAttempts = 0;
        let startTime = null;
        let currentScenario = 0;

        function manualLogin() {
            alert('ë¡œê·¸ì¸ ì‹¤íŒ¨: ìê²© ì¦ëª…ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
        }

        function resetStats() {
            totalAttempts = 0;
            document.getElementById('totalAttempts').textContent = '0';
            document.getElementById('rps').textContent = '0';
            document.getElementById('testedPasswords').textContent = '0';
            document.getElementById('elapsedTime').textContent = '00:00';
        }

        function updateStats(rps) {
            totalAttempts += rps;
            document.getElementById('totalAttempts').textContent = totalAttempts.toLocaleString();
            document.getElementById('rps').textContent = rps;
            document.getElementById('testedPasswords').textContent = 
                Math.floor(totalAttempts / 2).toLocaleString();
            
            if (startTime) {
                const elapsed = Math.floor((Date.now() - startTime) / 1000);
                const minutes = Math.floor(elapsed / 60);
                const seconds = elapsed % 60;
                document.getElementById('elapsedTime').textContent = 
                    `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            }
        }

        function stopAttack() {
            if (attackInterval) {
                clearInterval(attackInterval);
                attackInterval = null;
                document.getElementById('statusBadge').textContent = 'ì¤‘ë‹¨ë¨';
                document.getElementById('statusBadge').className = 
                    'text-xs bg-yellow-500 text-gray-900 px-3 py-1 rounded';
            }
        }

        async function attackScenario(type) {
            stopAttack();
            resetStats();
            startTime = Date.now();
            currentScenario = type;
            
            var result = document.getElementById('attackResult');
            var badge = document.getElementById('statusBadge');
            
            document.getElementById('attackStages').classList.remove('hidden');
            document.getElementById('terminalBox').classList.remove('hidden');
            document.getElementById('judgementBox').classList.remove('hidden');
            document.getElementById('damageBox').classList.remove('hidden');
            document.getElementById('terminalLines').innerHTML = '';
            
            if (type === 1) {
                // ì‹œë‚˜ë¦¬ì˜¤ 1: Brute Force
                document.getElementById('stagesContent').innerHTML = 
                    '<div>1. ê³µê²© ë„êµ¬ ì¤€ë¹„ (Hydra)</div>' +
                    '<div>2. ëŒ€ìƒ URL ì„¤ì •</div>' +
                    '<div>3. ëª¨ë“  ì¡°í•© ì‹œë„ (a-z, 0-9)</div>' +
                    '<div>4. ë¹„ë°€ë²ˆí˜¸ ë°œê²¬ê¹Œì§€ ì§€ì†!</div>';
                
                document.getElementById('terminalSpeed').textContent = 'Speed: 100 req/sec';
                
                addTerminalLine('> hydra -l admin -x 4:8:a1 http-post-form');
                await sleep(500);
                addTerminalLine('> Target: https://bank.com/login');
                await sleep(500);
                addTerminalLine('> Attack Type: Brute Force');
                await sleep(500);
                addTerminalLine('> Charset: a-z, A-Z, 0-9, special');
                await sleep(800);
                addTerminalLine('> [!] Starting attack...', 'text-yellow-400');
                await sleep(500);
                
                // ê³µê²© ì‹œë®¬ë ˆì´ì…˜
                attackInterval = setInterval(() => {
                    const rps = Math.floor(Math.random() * 50) + 80;
                    updateStats(rps);
                    
                    const passwords = ['pass1234', 'admin123', 'qwerty', 'password', 
                                     '12345678', 'abc123', 'welcome1'];
                    const randomPwd = passwords[Math.floor(Math.random() * passwords.length)];
                    
                    addTerminalLine(`[ATTEMPT] admin:${randomPwd}`, 'text-gray-500');
                    
                    // 5ì´ˆ í›„ ì„±ê³µ
                    if (totalAttempts > 400) {
                        stopAttack();
                        addTerminalLine('[SUCCESS] Password found: admin123', 'text-red-400');
                        
                        result.innerHTML = 
                            '<div class="bg-red-50 border-l-4 border-red-500 p-4">' +
                            '<h4 class="font-bold text-red-700 mb-3">ğŸš¨ Brute Force ê³µê²© ì„±ê³µ</h4>' +
                            '<div class="bg-gray-900 text-green-400 p-3 rounded mb-3 code-font text-xs">' +
                            '<div class="text-white">$ hydra -l admin -x 4:8:a1 \\</div>' +
                            '<div class="ml-2">http-post-form "/login:username=^USER^&password=^PASS^:F=Invalid"</div>' +
                            '<div class="mt-2 text-yellow-400">Results:</div>' +
                            '<div class="text-gray-400">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</div>' +
                            '<div class="text-red-400">[+] Host: bank.com</div>' +
                            '<div class="text-red-400">[+] Login: admin</div>' +
                            '<div class="text-red-400">[+] Password: admin123</div>' +
                            '<div class="text-red-400">[+] Attempts: 487</div>' +
                            '<div class="text-red-400">[+] Time: 00:05</div>' +
                            '</div>' +
                            '<div class="bg-white p-3 rounded mb-3 border">' +
                            '<p class="text-sm font-bold mb-2">ê³µê²© í†µê³„:</p>' +
                            '<table class="w-full text-xs">' +
                            '<tr class="border-b"><td class="py-1">ì´ ì‹œë„:</td><td class="py-1 text-right">' + totalAttempts.toLocaleString() + 'íšŒ</td></tr>' +
                            '<tr class="border-b"><td class="py-1">ì´ˆë‹¹ ìš”ì²­:</td><td class="py-1 text-right">100 req/s</td></tr>' +
                            '<tr class="border-b"><td class="py-1">ì†Œìš” ì‹œê°„:</td><td class="py-1 text-right">5ì´ˆ</td></tr>' +
                            '<tr><td class="py-1">ì„±ê³µë¥ :</td><td class="py-1 text-right text-red-600">100%</td></tr>' +
                            '</table></div>' +
                            '<div class="bg-red-900 text-red-100 p-3 rounded text-sm">' +
                            '<p class="font-bold">ğŸ’€ ê³„ì • íƒˆì·¨ ì™„ë£Œ</p>' +
                            '<p>ë°©ì–´ ì¥ì¹˜ ì—†ì´ ë¬´ì°¨ë³„ ëŒ€ì… ì„±ê³µ</p>' +
                            '<p>ê´€ë¦¬ì ê³„ì • ì™„ì „ ì¥ì•…</p>' +
                            '</div></div>';
                        
                        document.getElementById('damageContent').innerHTML = 
                            '<div><strong>1. ê³„ì • íƒˆì·¨:</strong> ê´€ë¦¬ì ê¶Œí•œ íšë“</div>' +
                            '<div><strong>2. ì „ì²´ ê³ ê° ì •ë³´ ì ‘ê·¼:</strong> 125,847ê±´</div>' +
                            '<div><strong>3. ë¶ˆë²• ì´ì²´:</strong> 50ì–µì› ìê¸ˆ ì´ë™</div>' +
                            '<div><strong>4. ì„œë¹„ìŠ¤ ì¤‘ë‹¨:</strong> 3ì‹œê°„ ì¥ì• </div>';
                    }
                }, 100);
                
                document.getElementById('evidence').textContent = 'Rate Limiting ë¯¸ì ìš©';
                badge.textContent = 'ê³µê²©ì¤‘';
                badge.className = 'text-xs bg-red-500 text-white px-3 py-1 rounded attack-animation';
                
            } else if (type === 2) {
                // ì‹œë‚˜ë¦¬ì˜¤ 2: Dictionary Attack
                document.getElementById('stagesContent').innerHTML = 
                    '<div>1. í”í•œ ë¹„ë°€ë²ˆí˜¸ ì‚¬ì „ ë¡œë”©</div>' +
                    '<div>2. rockyou.txt (1400ë§Œê°œ)</div>' +
                    '<div>3. ìˆœì°¨ì ìœ¼ë¡œ ì‹œë„</div>' +
                    '<div>4. 3ë¶„ ë‚´ ë°œê²¬!</div>';
                
                document.getElementById('terminalSpeed').textContent = 'Speed: 200 req/sec';
                
                addTerminalLine('> Loading dictionary: rockyou.txt');
                await sleep(500);
                addTerminalLine('> Total passwords: 14,344,391');
                await sleep(500);
                addTerminalLine('> [!] Starting dictionary attack...', 'text-yellow-400');
                await sleep(800);
                
                const commonPasswords = [
                    'password', '123456', '123456789', 'qwerty', 'abc123',
                    'password1', '12345678', '111111', '1234567', 'sunshine',
                    'princess', 'admin', 'welcome', 'monkey', 'login'
                ];
                
                let idx = 0;
                attackInterval = setInterval(() => {
                    const rps = Math.floor(Math.random() * 80) + 150;
                    updateStats(rps);
                    
                    const pwd = commonPasswords[idx % commonPasswords.length];
                    addTerminalLine(`[${idx + 1}] Trying: ${pwd}`, 'text-gray-500');
                    idx++;
                    
                    if (totalAttempts > 600) {
                        stopAttack();
                        addTerminalLine('[SUCCESS] Match found: password123', 'text-red-400');
                        
                        result.innerHTML = 
                            '<div class="bg-red-50 border-l-4 border-red-500 p-4">' +
                            '<h4 class="font-bold text-red-700 mb-3">ğŸš¨ Dictionary Attack ì„±ê³µ</h4>' +
                            '<div class="bg-white p-3 rounded mb-3 border">' +
                            '<p class="text-sm font-bold mb-2">ì‚¬ì „ íŒŒì¼ ì •ë³´:</p>' +
                            '<div class="bg-gray-100 p-2 rounded code-font text-xs">' +
                            '<div>File: rockyou.txt</div>' +
                            '<div>Passwords: 14,344,391</div>' +
                            '<div>Size: 133 MB</div>' +
                            '<div class="text-red-600 mt-2">Found at position: 487</div>' +
                            '<div class="text-red-600">Password: password123</div>' +
                            '</div></div>' +
                            '<div class="bg-yellow-100 border border-yellow-400 p-3 rounded text-sm mb-3">' +
                            '<p class="font-bold text-yellow-800 mb-2">âš ï¸ í”í•œ ë¹„ë°€ë²ˆí˜¸ ì‚¬ìš©ì˜ ìœ„í—˜ì„±</p>' +
                            '<p class="text-yellow-800 text-xs">Top 1000 ë¹„ë°€ë²ˆí˜¸ì— í¬í•¨</p>' +
                            '<p class="text-yellow-800 text-xs">ìˆ˜ì´ˆ ë‚´ í¬ë˜í‚¹ ê°€ëŠ¥</p>' +
                            '</div>' +
                            '<div class="bg-red-900 text-red-100 p-3 rounded text-sm">' +
                            '<p class="font-bold">â±ï¸ ê³µê²© ì†Œìš” ì‹œê°„</p>' +
                            '<p>ì‚¬ì „ ê³µê²©: 3ë¶„</p>' +
                            '<p>ì‹œë„ íšŸìˆ˜: 487íšŒ</p>' +
                            '</div></div>';
                        
                        document.getElementById('damageContent').innerHTML = 
                            '<div><strong>1. ë¹ ë¥¸ í¬ë˜í‚¹:</strong> 3ë¶„ë§Œì— ì„±ê³µ</div>' +
                            '<div><strong>2. ëŒ€ëŸ‰ ê³„ì • íƒˆì·¨:</strong> ê°™ì€ íŒ¨í„´ì˜ ë‹¤ë¥¸ ê³„ì •ë“¤</div>' +
                            '<div><strong>3. ìë™í™” ìŠ¤í¬ë¦½íŠ¸:</strong> ìˆ˜ì²œê°œ ê³„ì • ë™ì‹œ ê³µê²©</div>';
                    }
                }, 80);
                
                document.getElementById('evidence').textContent = 'ë¹„ë°€ë²ˆí˜¸ ì •ì±… ë¶€ì¬';
                badge.textContent = 'ì‚¬ì „ ê³µê²©ì¤‘';
                badge.className = 'text-xs bg-orange-500 text-white px-3 py-1 rounded attack-animation';
                
            } else if (type === 3) {
                // ì‹œë‚˜ë¦¬ì˜¤ 3: Credential Stuffing
                document.getElementById('stagesContent').innerHTML = 
                    '<div>1. ìœ ì¶œëœ ê³„ì • DB ìˆ˜ì§‘ (ë‹¤í¬ì›¹)</div>' +
                    '<div>2. 500ë§Œê°œ ê³„ì • ì •ë³´</div>' +
                    '<div>3. ë‹¤ë¥¸ ì‚¬ì´íŠ¸ ìê²©ì¦ëª… ì¬ì‚¬ìš©</div>' +
                    '<div>4. ì¼ì¹˜í•˜ëŠ” ê³„ì • ë°œê²¬!</div>';
                
                document.getElementById('terminalSpeed').textContent = 'Speed: 300 req/sec';
                
                addTerminalLine('> Loading leaked credentials database...');
                await sleep(500);
                addTerminalLine('> Source: 2024 data breach collection');
                await sleep(500);
                addTerminalLine('> Total accounts: 5,247,891');
                await sleep(800);
                addTerminalLine('> [!] Starting credential stuffing...', 'text-yellow-400');
                await sleep(500);
                
                const usernames = ['john.doe', 'admin', 'user123', 'test@bank.com', 'customer1'];
                const passwords = ['Summer2024!', 'MyPass@123', 'Welcome2024', 'Secure#45'];
                
                let attemptCount = 0;
                attackInterval = setInterval(() => {
                    const rps = Math.floor(Math.random() * 100) + 250;
                    updateStats(rps);
                    
                    const user = usernames[attemptCount % usernames.length];
                    const pwd = passwords[attemptCount % passwords.length];
                    
                    addTerminalLine(`[STUFFING] ${user}:${pwd}`, 'text-blue-400');
                    attemptCount++;
                    
                    if (totalAttempts > 900) {
                        stopAttack();
                        addTerminalLine('[!] Valid credentials found!', 'text-red-400');
                        addTerminalLine('user: customer1@bank.com', 'text-red-400');
                        addTerminalLine('pass: Summer2024!', 'text-red-400');
                        
                        result.innerHTML = 
                            '<div class="bg-red-50 border-l-4 border-red-500 p-4">' +
                            '<h4 class="font-bold text-red-700 mb-3">ğŸš¨ Credential Stuffing ì„±ê³µ</h4>' +
                            '<div class="bg-white p-3 rounded mb-3 border">' +
                            '<p class="text-sm font-bold mb-2">ìœ ì¶œëœ DB ì •ë³´:</p>' +
                            '<table class="w-full text-xs">' +
                            '<tr class="border-b bg-gray-50"><th class="text-left py-1">ì¶œì²˜</th><th class="text-left py-1">ê³„ì • ìˆ˜</th></tr>' +
                            '<tr class="border-b"><td class="py-1">2023 E-commerce Breach</td><td class="py-1">2,100,000</td></tr>' +
                            '<tr class="border-b"><td class="py-1">2024 Social Media Leak</td><td class="py-1">1,800,000</td></tr>' +
                            '<tr><td class="py-1">ê¸°íƒ€ ìœ ì¶œ</td><td class="py-1">1,347,891</td></tr>' +
                            '</table></div>' +
                            '<div class="bg-white p-3 rounded mb-3 border">' +
                            '<p class="text-sm font-bold mb-2">ë°œê²¬ëœ ìœ íš¨ ê³„ì •:</p>' +
                            '<div class="bg-red-50 p-2 rounded text-xs">' +
                            '<div>Email: customer1@bank.com</div>' +
                            '<div>Password: Summer2024!</div>' +
                            '<div class="text-red-600 mt-2">âš ï¸ ë‹¤ë¥¸ ì‚¬ì´íŠ¸ ë¹„ë°€ë²ˆí˜¸ ì¬ì‚¬ìš©</div>' +
                            '</div></div>' +
                            '<div class="bg-red-900 text-red-100 p-3 rounded text-sm">' +
                            '<p class="font-bold">ğŸ’€ ë¹„ë°€ë²ˆí˜¸ ì¬ì‚¬ìš©ì˜ ìœ„í—˜ì„±</p>' +
                            '<p>í•œ ê³³ ìœ ì¶œ â†’ ëª¨ë“  ê³„ì • ìœ„í—˜</p>' +
                            '<p>ê²€ì¦ ì„±ê³µë¥ : 0.3% (15,000ê±´)</p>' +
                            '</div></div>';
                        
                        document.getElementById('damageContent').innerHTML = 
                            '<div><strong>1. ëŒ€ëŸ‰ ê³„ì • íƒˆì·¨:</strong> 15,000ê°œ ìœ íš¨ ê³„ì •</div>' +
                            '<div><strong>2. ìê¸ˆ ì¸ì¶œ:</strong> ê³„ì •ë‹¹ í‰ê·  50ë§Œì›</div>' +
                            '<div><strong>3. ì´ í”¼í•´ì•¡:</strong> 75ì–µì›</div>' +
                            '<div><strong>4. ê°œì¸ì •ë³´ ìœ ì¶œ:</strong> ê³ ê° ì‹ ë¢°ë„ ë¶•ê´´</div>';
                    }
                }, 50);
                
                document.getElementById('evidence').textContent = 'ë¹„ë°€ë²ˆí˜¸ ì¬ì‚¬ìš© ê°ì§€ ì—†ìŒ';
                badge.textContent = 'ê³„ì • ëŒ€ì…ì¤‘';
                badge.className = 'text-xs bg-purple-500 text-white px-3 py-1 rounded attack-animation';
                
            } else if (type === 4) {
                // ì‹œë‚˜ë¦¬ì˜¤ 4: ì›¹ í¬ë¡¤ë§ ë´‡
                document.getElementById('stagesContent').innerHTML = 
                    '<div>1. í¬ë¡¤ë§ ë´‡ ì‹¤í–‰</div>' +
                    '<div>2. ì „ì²´ í˜ì´ì§€ ìˆ˜ì§‘</div>' +
                    '<div>3. ê³ ê° ì •ë³´ ìŠ¤í¬ë˜í•‘</div>' +
                    '<div>4. DB êµ¬ì¡° íŒŒì•…!</div>';
                
                document.getElementById('terminalSpeed').textContent = 'Speed: 500 req/sec';
                
                addTerminalLine('> scrapy crawl bank_spider');
                await sleep(500);
                addTerminalLine('> User-Agent: Mozilla/5.0 (compatible)');
                await sleep(500);
                addTerminalLine('> Starting requests...');
                await sleep(800);
                
                const pages = [
                    '/users/1', '/users/2', '/api/accounts', 
                    '/api/transactions', '/admin/dashboard',
                    '/api/customers', '/reports/daily'
                ];
                
                let pageIdx = 0;
                attackInterval = setInterval(() => {
                    const rps = Math.floor(Math.random() * 200) + 400;
                    updateStats(rps);
                    
                    const page = pages[pageIdx % pages.length];
                    addTerminalLine(`[200] GET ${page}`, 'text-green-400');
                    
                    if (Math.random() > 0.7) {
                        addTerminalLine(`  â†’ Extracted: ${Math.floor(Math.random() * 100)} records`, 'text-yellow-400');
                    }
                    
                    pageIdx++;
                    
                    if (totalAttempts > 2000) {
                        stopAttack();
                        addTerminalLine('[!] Crawling completed', 'text-red-400');
                        addTerminalLine('Total pages: 2,847', 'text-red-400');
                        addTerminalLine('Data extracted: 125,847 records', 'text-red-400');
                        
                        result.innerHTML = 
                            '<div class="bg-red-50 border-l-4 border-red-500 p-4">' +
                            '<h4 class="font-bold text-red-700 mb-3">ğŸš¨ í¬ë¡¤ë§ ë´‡ ê³µê²© ì„±ê³µ</h4>' +
                            '<div class="bg-gray-900 text-green-400 p-3 rounded mb-3 code-font text-xs">' +
                            '<div class="text-white">$ scrapy crawl bank_spider -o output.json</div>' +
                            '<div class="mt-2 text-yellow-400">Crawl Statistics:</div>' +
                            '<div class="text-gray-400">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</div>' +
                            '<div>Pages crawled: 2,847</div>' +
                            '<div>Requests: 2,847 (500/sec)</div>' +
                            '<div class="text-red-400">Records extracted: 125,847</div>' +
                            '<div>Duration: 00:05</div>' +
                            '</div>' +
                            '<div class="bg-white p-3 rounded mb-3 border">' +
                            '<p class="text-sm font-bold mb-2">ìˆ˜ì§‘ëœ ë°ì´í„°:</p>' +
                            '<div class="space-y-1 text-xs">' +
                            '<div>âœ“ ê³ ê° ì •ë³´: 50,000ê±´ (ì´ë¦„, ì£¼ì†Œ, ì—°ë½ì²˜)</div>' +
                            '<div>âœ“ ê³„ì¢Œ ë²ˆí˜¸: 50,000ê±´</div>' +
                            '<div>âœ“ ê±°ë˜ ë‚´ì—­: 25,847ê±´</div>' +
                            '<div>âœ“ API ì—”ë“œí¬ì¸íŠ¸: 147ê°œ ë°œê²¬</div>' +
                            '</div></div>' +
                            '<div class="bg-red-900 text-red-100 p-3 rounded text-sm">' +
                            '<p class="font-bold">ğŸ’€ ëŒ€ëŸ‰ ì •ë³´ ìœ ì¶œ</p>' +
                            '<p>Rate Limiting ì—†ì´ ë¬´ì œí•œ í¬ë¡¤ë§</p>' +
                            '<p>ê°œì¸ì •ë³´ë³´í˜¸ë²• ìœ„ë°˜</p>' +
                            '<p>ì˜ˆìƒ ê³¼ì§•ê¸ˆ: 50ì–µì›</p>' +
                            '</div></div>';
                        
                        document.getElementById('damageContent').innerHTML = 
                            '<div><strong>1. ê³ ê° ì •ë³´ ìœ ì¶œ:</strong> 125,847ê±´</div>' +
                            '<div><strong>2. ê°œì¸ì •ë³´ë³´í˜¸ë²• ìœ„ë°˜:</strong> 50ì–µì› ê³¼ì§•ê¸ˆ</div>' +
                            '<div><strong>3. ë¸Œëœë“œ ì‹ ë¢°ë„:</strong> íšŒë³µ ë¶ˆê°€ëŠ¥í•œ ì†ì‹¤</div>' +
                            '<div><strong>4. ì§‘ë‹¨ ì†Œì†¡:</strong> 200ì–µì› ë°°ìƒ ì²­êµ¬</div>';
                    }
                }, 30);
                
                document.getElementById('evidence').textContent = 'Bot ê°ì§€ ê¸°ëŠ¥ ì—†ìŒ';
                badge.textContent = 'í¬ë¡¤ë§ì¤‘';
                badge.className = 'text-xs bg-yellow-500 text-gray-900 px-3 py-1 rounded attack-animation';
            }
        }

        function addTerminalLine(text, color) {
            var div = document.createElement('div');
            div.className = color || 'text-green-400';
            div.textContent = text;
            document.getElementById('terminalLines').appendChild(div);
            var terminal = document.getElementById('terminalLines');
            terminal.scrollTop = terminal.scrollHeight;
            
            // 100ì¤„ ì´ìƒì´ë©´ ì˜¤ë˜ëœ ì¤„ ì‚­ì œ
            if (terminal.children.length > 100) {
                terminal.removeChild(terminal.firstChild);
            }
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // í˜ì´ì§€ ì–¸ë¡œë“œ ì‹œ ê³µê²© ì¤‘ë‹¨
        window.addEventListener('beforeunload', function() {
            stopAttack();
        });
    </script>
</body>
</html>