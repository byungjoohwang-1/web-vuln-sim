<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¸ˆìœµê¶Œ SSRF ëª¨ì˜í•´í‚¹ ì‹œë®¬ë ˆì´í„°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        .code-font { font-family: 'Courier New', monospace; }
    </style>
</head>
<body class="bg-gray-100 p-4">

    <!-- í‰ê°€ê¸°ì¤€ ë°°ë„ˆ -->
    <div class="max-w-7xl mx-auto mb-4">
        <div class="bg-orange-600 text-white p-4 rounded-lg shadow-lg">
            <div class="flex items-center gap-3">
                <i class="fas fa-clipboard-check text-2xl"></i>
                <div>
                    <h1 class="font-bold text-lg">ì „ìê¸ˆìœµê¸°ë°˜ì‹œì„¤ ë³´ì•ˆ ì·¨ì•½ì  í‰ê°€ê¸°ì¤€ - WEB-SER-046</h1>
                    <p class="text-sm">ì„œë²„ ì‚¬ì´ë“œ ìš”ì²­ ìœ„ì¡° (SSRF) | ìœ„í—˜ë„: 4 (ë†’ìŒ) | í†µì œêµ¬ë¶„: 5.8.4 ì„œë¹„ìŠ¤ ë³´í˜¸</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <div class="max-w-7xl mx-auto">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
            
            <!-- ì¢Œì¸¡: ì·¨ì•½í•œ ì‹œìŠ¤í…œ -->
            <div class="space-y-4">
                
                <!-- ì€í–‰ í—¤ë” -->
                <div class="bg-blue-600 text-white p-4 rounded-lg shadow-lg">
                    <div class="flex items-center gap-3">
                        <i class="fas fa-building-columns text-2xl"></i>
                        <div>
                            <h2 class="text-xl font-bold">OOì€í–‰</h2>
                            <p class="text-sm">ìì‚°ê´€ë¦¬ í¬í„¸ - ëŒ€ì¶œìƒí’ˆ ì´ë¯¸ì§€ ì¡°íšŒ ì„œë¹„ìŠ¤</p>
                        </div>
                    </div>
                    <div class="mt-2 bg-orange-500 px-3 py-1 rounded text-sm">
                        <i class="fas fa-exclamation-triangle"></i> ì·¨ì•½ì : URL íŒŒë¼ë¯¸í„° ê²€ì¦ ë¯¸í¡
                    </div>
                </div>

                <!-- ì…ë ¥ í¼ -->
                <div class="bg-white p-5 rounded-lg shadow-lg">
                    <h3 class="font-bold text-lg mb-3 flex items-center gap-2">
                        <i class="fas fa-image text-orange-600"></i>
                        ìƒí’ˆ ì´ë¯¸ì§€ í”„ë¡ì‹œ ì„œë¹„ìŠ¤
                    </h3>
                    
                    <p class="text-sm text-gray-600 mb-3">
                        ì™¸ë¶€ ë§ˆì¼€íŒ… ì´ë¯¸ì§€ë¥¼ ì„œë²„ì—ì„œ ëŒ€ì‹  ë‹¤ìš´ë¡œë“œí•˜ì—¬ í‘œì‹œí•©ë‹ˆë‹¤
                    </p>
                    
                    <label class="block text-sm font-bold mb-2">ì´ë¯¸ì§€ URL</label>
                    <input type="text" id="ssrfInput" 
                           class="w-full p-2 border border-gray-300 rounded mb-3 code-font text-sm" 
                           value="https://cdn.shinhan.com/products/loan_banner.jpg"
                           placeholder="https://example.com/image.jpg">
                    
                    <div class="flex justify-between">
                        <button onclick="resetInput()" 
                                class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded">
                            <i class="fas fa-redo"></i> ì´ˆê¸°í™”
                        </button>
                        <button onclick="submitSSRF()" 
                                class="bg-orange-600 hover:bg-orange-700 text-white px-6 py-2 rounded">
                            <i class="fas fa-download"></i> ì´ë¯¸ì§€ ê°€ì ¸ì˜¤ê¸°
                        </button>
                    </div>
                </div>

                <!-- ê³µê²© ì‹œë‚˜ë¦¬ì˜¤ ë²„íŠ¼ -->
                <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg">
                    <h3 class="font-bold mb-3 flex items-center gap-2">
                        <i class="fas fa-flask text-orange-400"></i>
                        SSRF ê³µê²© ì‹œë‚˜ë¦¬ì˜¤
                    </h3>
                    <div class="space-y-2">
                        <button onclick="setPayload(1)" 
                                class="w-full text-left bg-red-900 hover:bg-red-800 px-3 py-2 rounded text-sm">
                            <i class="fas fa-server"></i> ì‹œë‚˜ë¦¬ì˜¤ 1: ë‚´ë¶€ ê´€ë¦¬ì í˜ì´ì§€ ì ‘ê·¼
                        </button>
                        <button onclick="setPayload(2)" 
                                class="w-full text-left bg-orange-900 hover:bg-orange-800 px-3 py-2 rounded text-sm">
                            <i class="fas fa-cloud"></i> ì‹œë‚˜ë¦¬ì˜¤ 2: AWS ë©”íƒ€ë°ì´í„° íƒˆì·¨
                        </button>
                        <button onclick="setPayload(3)" 
                                class="w-full text-left bg-purple-900 hover:bg-purple-800 px-3 py-2 rounded text-sm">
                            <i class="fas fa-database"></i> ì‹œë‚˜ë¦¬ì˜¤ 3: ë‚´ë¶€ DB ìŠ¤ìº”
                        </button>
                        <button onclick="setPayload(4)" 
                                class="w-full text-left bg-yellow-900 hover:bg-yellow-800 px-3 py-2 rounded text-sm">
                            <i class="fas fa-file"></i> ì‹œë‚˜ë¦¬ì˜¤ 4: ë¯¼ê° íŒŒì¼ ì½ê¸°
                        </button>
                    </div>
                </div>

                <!-- ì·¨ì•½í•œ ì½”ë“œ -->
                <div class="bg-gray-900 text-white p-4 rounded-lg shadow-lg">
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="font-bold text-red-400">
                            <i class="fas fa-skull-crossbones"></i> ì·¨ì•½í•œ Java ì½”ë“œ
                        </h3>
                        <span class="text-xs bg-red-600 px-2 py-1 rounded">ìœ„í—˜</span>
                    </div>
                    <pre class="code-font text-xs overflow-x-auto"><code><span class="text-gray-500">// âŒ ì·¨ì•½í•œ ì½”ë“œ - URL ê²€ì¦ ì—†ìŒ</span>
@RestController
public class ImageProxyController {
    
    @GetMapping("/api/proxy/image")
    public ResponseEntity&lt;byte[]&gt; getImage(
        @RequestParam String url) {
        
        <span class="text-red-400">// URL ê²€ì¦ ì—†ì´ ë°”ë¡œ ìš”ì²­!</span>
        RestTemplate restTemplate = new RestTemplate();
        byte[] imageBytes = restTemplate
            .getForObject(url, byte[].class);
        
        return ResponseEntity.ok(imageBytes);
    }
}</code></pre>
                </div>

            </div>

            <!-- ìš°ì¸¡: ê²°ê³¼ ë° ì•ˆì „í•œ ì½”ë“œ -->
            <div class="space-y-4">
                
                <!-- ì„œë²„ ì‘ë‹µ ê²°ê³¼ -->
                <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                    <div class="bg-gray-800 text-white px-4 py-3 flex justify-between items-center">
                        <h3 class="font-bold">
                            <i class="fas fa-terminal"></i> ì„œë²„ ì‘ë‹µ
                        </h3>
                        <span id="statusBadge" class="text-xs bg-green-500 text-gray-900 px-3 py-1 rounded code-font">
                            IDLE
                        </span>
                    </div>
                    <div id="serverResponse" class="p-5 min-h-[300px] bg-gray-900 text-green-400 code-font text-xs overflow-auto">
                        <div class="text-gray-500">
                            > Waiting for request...
                        </div>
                    </div>
                </div>

                <!-- ê³µê²© ë‹¨ê³„ -->
                <div id="attackStages" class="hidden bg-orange-100 border-l-4 border-orange-600 p-4 rounded-lg">
                    <h4 class="font-bold text-orange-700 mb-2 flex items-center gap-2">
                        <i class="fas fa-list-ol"></i> ê³µê²© ì§„í–‰ ë‹¨ê³„
                    </h4>
                    <div id="stagesContent" class="text-sm text-orange-700 space-y-1"></div>
                </div>

                <!-- ì•ˆì „í•œ ì½”ë“œ -->
                <div class="bg-gray-900 text-white p-4 rounded-lg shadow-lg">
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="font-bold text-green-400">
                            <i class="fas fa-shield-halved"></i> ì•ˆì „í•œ Java ì½”ë“œ
                        </h3>
                        <span class="text-xs bg-green-600 px-2 py-1 rounded">ê¶Œì¥</span>
                    </div>
                    <pre class="code-font text-xs overflow-x-auto max-h-[400px]"><code><span class="text-green-400">// âœ… ì•ˆì „í•œ ì½”ë“œ - í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê²€ì¦</span>
@RestController
public class SecureImageProxyController {
    
    <span class="text-green-400">// í—ˆìš©ëœ ë„ë©”ì¸ ëª©ë¡</span>
    private static final Set&lt;String&gt; ALLOWED_DOMAINS = 
        Set.of("cdn.shinhan.com", "images.shinhan.com");
    
    <span class="text-green-400">// ì°¨ë‹¨í•  IP ëŒ€ì—­ (ë‚´ë¶€ë§, ë©”íƒ€ë°ì´í„°)</span>
    private static final Set&lt;String&gt; BLOCKED_IPS = Set.of(
        "127.0.0.1", "localhost", 
        "169.254.169.254", "metadata.google.internal",
        "10.", "172.16.", "192.168."
    );
    
    @GetMapping("/api/proxy/image")
    public ResponseEntity&lt;byte[]&gt; getImage(
        @RequestParam String url) throws Exception {
        
        <span class="text-green-400">// 1. URL í˜•ì‹ ê²€ì¦</span>
        if (!url.startsWith("https://")) {
            throw new IllegalArgumentException(
                "HTTPSë§Œ í—ˆìš©ë©ë‹ˆë‹¤");
        }
        
        <span class="text-green-400">// 2. ë„ë©”ì¸ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê²€ì¦</span>
        URL urlObj = new URL(url);
        String host = urlObj.getHost();
        
        boolean isAllowed = ALLOWED_DOMAINS.stream()
            .anyMatch(domain -> host.equals(domain) || 
                      host.endsWith("." + domain));
        
        if (!isAllowed) {
            throw new SecurityException(
                "í—ˆìš©ë˜ì§€ ì•Šì€ ë„ë©”ì¸: " + host);
        }
        
        <span class="text-green-400">// 3. IP ì£¼ì†Œë¡œ ë³€í™˜í•˜ì—¬ ë‚´ë¶€ë§ ì²´í¬</span>
        InetAddress address = InetAddress.getByName(host);
        String ip = address.getHostAddress();
        
        <span class="text-green-400">// ì‚¬ì„¤ IP ëŒ€ì—­ ì°¨ë‹¨</span>
        if (address.isSiteLocalAddress() || 
            address.isLoopbackAddress() ||
            address.isLinkLocalAddress()) {
            throw new SecurityException(
                "ë‚´ë¶€ IP ì ‘ê·¼ ì°¨ë‹¨: " + ip);
        }
        
        <span class="text-green-400">// ì¶”ê°€ IP ë¸”ë™ë¦¬ìŠ¤íŠ¸ ì²´í¬</span>
        for (String blocked : BLOCKED_IPS) {
            if (ip.startsWith(blocked)) {
                throw new SecurityException(
                    "ì°¨ë‹¨ëœ IP: " + ip);
            }
        }
        
        <span class="text-green-400">// 4. Timeout ì„¤ì • (5ì´ˆ)</span>
        RestTemplate restTemplate = new RestTemplate();
        SimpleClientHttpRequestFactory factory = 
            new SimpleClientHttpRequestFactory();
        factory.setConnectTimeout(5000);
        factory.setReadTimeout(5000);
        restTemplate.setRequestFactory(factory);
        
        <span class="text-green-400">// 5. ì•ˆì „í•˜ê²Œ ìš”ì²­</span>
        byte[] imageBytes = restTemplate
            .getForObject(url, byte[].class);
        
        <span class="text-green-400">// 6. ì‘ë‹µ í¬ê¸° ì œí•œ (10MB)</span>
        if (imageBytes.length > 10 * 1024 * 1024) {
            throw new IllegalArgumentException(
                "ì´ë¯¸ì§€ í¬ê¸° ì´ˆê³¼");
        }
        
        return ResponseEntity.ok(imageBytes);
    }
}</code></pre>
                </div>

                <!-- ë°©ì–´ ì²´í¬ë¦¬ìŠ¤íŠ¸ -->
                <div class="bg-white p-4 rounded-lg shadow-lg">
                    <h3 class="font-bold mb-3 flex items-center gap-2">
                        <i class="fas fa-list-check text-orange-600"></i>
                        SSRF ë°©ì–´ ì²´í¬ë¦¬ìŠ¤íŠ¸
                    </h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>ë„ë©”ì¸ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸:</strong> í—ˆìš©ëœ ë„ë©”ì¸ë§Œ ì ‘ê·¼</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>ë‚´ë¶€ IP ì°¨ë‹¨:</strong> 127.0.0.1, 10.x, 192.168.x ì°¨ë‹¨</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>ë©”íƒ€ë°ì´í„° ì°¨ë‹¨:</strong> 169.254.169.254 ì°¨ë‹¨</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>í”„ë¡œí† ì½œ ì œí•œ:</strong> HTTPSë§Œ í—ˆìš©</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>Timeout ì„¤ì •:</strong> 5ì´ˆ ì œí•œ</div>
                        </div>
                    </div>
                </div>

                <!-- í‰ê°€ íŒì • -->
                <div id="judgementBox" class="hidden bg-gray-900 text-white p-4 rounded-lg">
                    <h3 class="font-bold text-indigo-400 mb-2 text-sm">
                        <i class="fas fa-gavel"></i> í‰ê°€ íŒì •
                    </h3>
                    <div class="text-xs space-y-1">
                        <div><strong>í‰ê°€í•­ëª©:</strong> WEB-SER-046 SSRF</div>
                        <div><strong>íŒì •:</strong> <span id="judgement"></span></div>
                        <div><strong>ê·¼ê±°:</strong> <span id="evidence"></span></div>
                    </div>
                </div>

                <!-- í”¼í•´ ì‹œë‚˜ë¦¬ì˜¤ -->
                <div id="damageBox" class="hidden bg-orange-700 text-white p-4 rounded-lg">
                    <h3 class="font-bold mb-3">
                        <i class="fas fa-fire"></i> ê¸ˆìœµê¶Œ SSRF í”¼í•´ ì‚¬ë¡€
                    </h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex gap-2">
                            <span class="font-bold">1.</span>
                            <div><strong>ë‚´ë¶€ ê´€ë¦¬ì í˜ì´ì§€ ì ‘ê·¼</strong><br>ê³ ê° ì •ë³´ ì¡°íšŒ, ê¶Œí•œ íƒˆì·¨</div>
                        </div>
                        <div class="flex gap-2">
                            <span class="font-bold">2.</span>
                            <div><strong>AWS í¬ë ˆë´ì…œ íƒˆì·¨</strong><br>S3 ë²„í‚· ì ‘ê·¼, DB ì ‘ê·¼</div>
                        </div>
                        <div class="flex gap-2">
                            <span class="font-bold">3.</span>
                            <div><strong>ë‚´ë¶€ í¬íŠ¸ ìŠ¤ìº”</strong><br>ë„¤íŠ¸ì›Œí¬ êµ¬ì¡° íŒŒì•…</div>
                        </div>
                        <div class="flex gap-2">
                            <span class="font-bold">4.</span>
                            <div><strong>ë¯¼ê° íŒŒì¼ ì½ê¸°</strong><br>ì„¤ì • íŒŒì¼, í‚¤ íŒŒì¼ íƒˆì·¨</div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        function getPayload(type) {
            if (type === 1) {
                return "http://127.0.0.1:8080/admin/dashboard";
            } else if (type === 2) {
                return "http://169.254.169.254/latest/meta-data/iam/security-credentials/";
            } else if (type === 3) {
                return "http://10.10.1.100:3306";
            } else if (type === 4) {
                return "file:///etc/passwd";
            }
            return '';
        }

        function resetInput() {
            document.getElementById('ssrfInput').value = 'https://cdn.shinhan.com/products/loan_banner.jpg';
            document.getElementById('serverResponse').innerHTML = '<div class="text-gray-500">> Waiting for request...</div>';
            document.getElementById('attackStages').classList.add('hidden');
            document.getElementById('judgementBox').classList.add('hidden');
            document.getElementById('damageBox').classList.add('hidden');
            document.getElementById('statusBadge').textContent = 'IDLE';
            document.getElementById('statusBadge').className = 'text-xs bg-green-500 text-gray-900 px-3 py-1 rounded code-font';
        }

        function setPayload(type) {
            document.getElementById('ssrfInput').value = getPayload(type);
            var input = document.getElementById('ssrfInput');
            input.classList.add('bg-yellow-100');
            setTimeout(function() {
                input.classList.remove('bg-yellow-100');
            }, 300);
        }

        async function submitSSRF() {
            var url = document.getElementById('ssrfInput').value;
            var responseBox = document.getElementById('serverResponse');
            var badge = document.getElementById('statusBadge');
            
            document.getElementById('attackStages').classList.add('hidden');
            document.getElementById('judgementBox').classList.add('hidden');
            document.getElementById('damageBox').classList.add('hidden');

            badge.textContent = 'FETCHING...';
            badge.className = 'text-xs bg-yellow-500 text-gray-900 px-3 py-1 rounded code-font animate-pulse';
            responseBox.innerHTML = '<span class="text-yellow-400 animate-pulse">> Connecting to ' + escapeHtml(url) + '...</span>';
            
            await sleep(1000);

            var response = '';
            var isVulnerable = false;
            var attackType = '';

            // ê³µê²© ì‹œë‚˜ë¦¬ì˜¤ íŒë³„
            if (url.indexOf('127.0.0.1') !== -1 || url.indexOf('localhost') !== -1) {
                if (url.indexOf('admin') !== -1 || url.indexOf('8080') !== -1) {
                    attackType = 'ë‚´ë¶€ ê´€ë¦¬ì í˜ì´ì§€';
                    response = 'HTTP/1.1 200 OK\n';
                    response += 'Date: Mon, 08 Dec 2024 10:00:00 GMT\n';
                    response += 'Server: Apache/2.4.41 (Ubuntu)\n';
                    response += 'Content-Type: text/html\n\n';
                    response += '<html>\n<body>\n';
                    response += '  <h1>ğŸ” ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</h1>\n';
                    response += '  <hr>\n';
                    response += '  <h2>ê³ ê° ì •ë³´ ê´€ë¦¬</h2>\n';
                    response += '  <table>\n';
                    response += '    <tr><td>ê³ ê°ëª…</td><td>ê³„ì¢Œë²ˆí˜¸</td><td>ì”ì•¡</td></tr>\n';
                    response += '    <tr><td>ê¹€ì² ìˆ˜</td><td>110-123-456789</td><td>50,000,000ì›</td></tr>\n';
                    response += '    <tr><td>ì´ì˜í¬</td><td>110-987-654321</td><td>120,000,000ì›</td></tr>\n';
                    response += '  </table>\n';
                    response += '  <button>ì „ì²´ ê³ ê° ë‹¤ìš´ë¡œë“œ</button>\n';
                    response += '</body>\n</html>';
                    isVulnerable = true;
                } else {
                    response = 'HTTP/1.1 403 Forbidden\n';
                    response += 'Server: Internal-Gateway\n\n';
                    response += 'Access denied. Try /admin';
                }
            } else if (url.indexOf('169.254.169.254') !== -1) {
                attackType = 'AWS ë©”íƒ€ë°ì´í„°';
                response = 'HTTP/1.1 200 OK\n';
                response += 'Content-Type: application/json\n\n';
                response += '{\n';
                response += '  "Code": "Success",\n';
                response += '  "LastUpdated": "2024-12-08T10:00:00Z",\n';
                response += '  "Type": "AWS-HMAC",\n';
                response += '  "AccessKeyId": "AKIAIOSFODNN7EXAMPLE",\n';
                response += '  "SecretAccessKey": "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY",\n';
                response += '  "Token": "AQoEXAMPLEH4aoAH0gNCAPyJ...",\n';
                response += '  "Expiration": "2024-12-08T16:00:00Z"\n';
                response += '}';
                isVulnerable = true;
            } else if (url.indexOf('10.') !== -1 || url.indexOf('192.168.') !== -1) {
                attackType = 'ë‚´ë¶€ DB ìŠ¤ìº”';
                response = '> Connecting to ' + escapeHtml(url) + '\n';
                response += '> MySQL Server detected\n';
                response += '> Port: 3306 OPEN\n';
                response += '> Version: MySQL 8.0.28\n';
                response += '> Databases: customers, transactions, accounts\n';
                response += '> [!] ë‚´ë¶€ë§ ì„œë²„ ì •ë³´ ë…¸ì¶œ!';
                isVulnerable = true;
            } else if (url.indexOf('file://') !== -1) {
                attackType = 'ë¯¼ê° íŒŒì¼ ì½ê¸°';
                response = 'root:x:0:0:root:/root:/bin/bash\n';
                response += 'daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\n';
                response += 'shinhan:x:1000:1000::/home/shinhan:/bin/bash\n';
                response += 'mysql:x:108:113:MySQL Server:/var/lib/mysql:/bin/false\n';
                response += '\n[!] ì‹œìŠ¤í…œ íŒŒì¼ ì ‘ê·¼ ì„±ê³µ!';
                isVulnerable = true;
            } else if (url.indexOf('https://') === 0) {
                response = 'HTTP/1.1 200 OK\n';
                response += 'Content-Type: image/jpeg\n';
                response += 'Content-Length: 45023\n\n';
                response += '[Binary Image Data]\n';
                response += 'âœ“ ì •ìƒì ì¸ ì™¸ë¶€ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ';
            } else {
                response = 'Error: Invalid protocol or unreachable host\n';
                response += 'Only HTTPS is allowed';
            }

            // ê²°ê³¼ í‘œì‹œ
            if (isVulnerable) {
                document.getElementById('attackStages').classList.remove('hidden');
                document.getElementById('stagesContent').innerHTML = 
                    '<div>1. ì„œë²„ì—ì„œ URL íŒŒë¼ë¯¸í„° ê²€ì¦ ì—†ì´ ìš”ì²­</div>' +
                    '<div>2. ' + attackType + ' ì ‘ê·¼ ì‹œë„</div>' +
                    '<div>3. ë‚´ë¶€ ë¦¬ì†ŒìŠ¤ ì‘ë‹µ ìˆ˜ì‹ </div>' +
                    '<div>4. ê³µê²©ìì—ê²Œ ë¯¼ê°ì •ë³´ ë…¸ì¶œ</div>';

                responseBox.innerHTML = '<span class="text-red-400 font-bold">[!] SSRF ê³µê²© ì„±ê³µ!</span>\n\n' + escapeHtml(response);
                badge.textContent = '200 OK (LEAKED)';
                badge.className = 'text-xs bg-red-500 text-white px-3 py-1 rounded code-font';
                
                document.getElementById('judgementBox').classList.remove('hidden');
                document.getElementById('judgement').innerHTML = '<span class="text-red-400">ì·¨ì•½</span>';
                document.getElementById('evidence').textContent = 'URL íŒŒë¼ë¯¸í„° ê²€ì¦ ì—†ìŒ';
                document.getElementById('damageBox').classList.remove('hidden');
            } else if (response.indexOf('Error') !== -1) {
                responseBox.innerHTML = '<span class="text-red-400">' + escapeHtml(response) + '</span>';
                badge.textContent = 'ERROR';
                badge.className = 'text-xs bg-red-500 text-white px-3 py-1 rounded code-font';
            } else {
                responseBox.innerHTML = '<span class="text-green-400">' + escapeHtml(response) + '</span>';
                badge.textContent = '200 OK';
                badge.className = 'text-xs bg-green-500 text-gray-900 px-3 py-1 rounded code-font';
                
                document.getElementById('judgementBox').classList.remove('hidden');
                document.getElementById('judgement').innerHTML = '<span class="text-green-400">ì–‘í˜¸</span>';
                document.getElementById('evidence').textContent = 'ì•ˆì „í•œ ì™¸ë¶€ URL';
            }
        }

        function escapeHtml(text) {
            var div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function sleep(ms) {
            return new Promise(function(resolve) {
                setTimeout(resolve, ms);
            });
        }
    </script>
</body>
</html>