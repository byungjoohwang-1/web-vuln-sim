<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>SSRF Simulation</title>
    <script src="config.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; max-width: 800px; margin: 0 auto;}
        .container { display: flex; gap: 20px; }
        .box { flex: 1; border: 1px solid #ddd; padding: 20px; border-radius: 8px; }
        .vuln { background-color: #ffe6e6; }
        .secure { background-color: #e6fffa; }
        input { width: 100%; padding: 8px; margin: 10px 0; box-sizing: border-box; }
        button { padding: 8px 16px; cursor: pointer; }
        
        .code-section { margin-top: 40px; border-top: 2px solid #eee; padding-top: 20px; }
        details { background: #f9f9f9; margin-bottom: 10px; border-radius: 5px; border: 1px solid #ddd; }
        summary { padding: 10px; cursor: pointer; font-weight: bold; }
        pre { background: #333; color: #fff; padding: 15px; overflow-x: auto; }
    </style>
</head>
<body>
    <a href="index.html">â† Main Menu</a>
    <h1>ğŸŒ ì„œë²„ ì‚¬ì´ë“œ ìš”ì²­ ìœ„ì¡° (SSRF)</h1>

    <div style="background:#f4f7f9; padding:15px; margin-bottom:20px; border-left:5px solid #007bff;">
        <h3>ğŸ“˜ ì·¨ì•½ì  ê°œìš” (Overview)</h3>
        <p><strong>[KR]</strong> ê³µê²©ìê°€ ì„œë²„ë¥¼ ì¡°ì¢…í•˜ì—¬ ì„œë²„ê°€ ê¶Œí•œì„ ê°€ì§„ ë‚´ë¶€ ì‹œìŠ¤í…œ(Localhost)ì´ë‚˜ ì™¸ë¶€ì˜ ì„ì˜ ì‹œìŠ¤í…œì— ìš”ì²­ì„ ë³´ë‚´ê²Œ ë§Œë“œëŠ” ê³µê²©ì…ë‹ˆë‹¤.</p>
        <p><strong>[EN]</strong> An attack where the attacker induces the server to make requests to an unintended location (e.g., internal network).</p>
    </div>
    
    <div class="container">
        <!-- ì·¨ì•½í•œ ëª¨ë“œ -->
        <div class="box vuln">
            <h2>ğŸš« ì·¨ì•½í•œ ëª¨ë“œ</h2>
            <p>ê¸°ëŠ¥: URL ë¯¸ë¦¬ë³´ê¸°</p>
            <p>[KR] ê³µê²©: <code>http://localhost/admin</code> ì…ë ¥ (ë‚´ë¶€ë§ ì ‘ê·¼)</p>
            <input type="text" id="vulnInput" value="http://localhost/admin">
            <button onclick="runTest('vulnerableSSRF', 'vulnInput')">Run Attack</button>
        </div>

        <!-- ì•ˆì „í•œ ëª¨ë“œ -->
        <div class="box secure">
            <h2>âœ… ì•ˆì „í•œ ëª¨ë“œ</h2>
            <p>[KR] ë°©ì–´: ë„ë©”ì¸ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸(Allowlist) ê²€ì¦</p>
            <input type="text" id="secureInput" value="http://localhost/admin">
            <button onclick="runTest('secureSSRF', 'secureInput')">Run Secure</button>
        </div>
    </div>

    <div class="code-section">
        <h2>ğŸ“š ì–¸ì–´ë³„ ì‹œíì–´ ì½”ë”© ê°€ì´ë“œ</h2>
        
        <!-- Python ì˜ˆì œ -->
        <details>
            <summary>ğŸ Python (Requests)</summary>
            <pre><code><span style="color:#999"># [KR] ì…ë ¥ëœ URLì˜ í˜¸ìŠ¤íŠ¸ê°€ í—ˆìš©ëœ ëª©ë¡ì— ìˆëŠ”ì§€ í™•ì¸í•œë‹¤.</span>
<span style="color:#999"># [EN] Verify that the URL host is in the allowed list.</span>

from urllib.parse import urlparse

url = request.args.get('url')
parsed = urlparse(url)

<span style="color:#999"># âœ… ì•ˆì „: í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê²€ì¦</span>
if parsed.hostname not in ['google.com', 'example.com']:
    return "Error: Invalid Domain"

response = requests.get(url)</code></pre>
        </details>

        <!-- Java ì˜ˆì œ -->
        <details>
            <summary>â˜• Java</summary>
            <pre><code><span style="color:#999"># [KR] URL í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡œí† ì½œê³¼ í˜¸ìŠ¤íŠ¸ë¥¼ ê²€ì¦í•œë‹¤.</span>
<span style="color:#999"># [EN] Validate protocol and host using URL class.</span>

URL url = new URL(inputUrl);

<span style="color:#999"># âœ… ì•ˆì „: ë¡œì»¬ IP ëŒ€ì—­ ì ‘ê·¼ ì°¨ë‹¨</span>
if (url.getHost().equals("127.0.0.1") || url.getHost().equals("localhost")) {
    throw new SecurityException("Access to local network is denied.");
}</code></pre>
        </details>
    </div>

    <script>
        function runTest(funcName, inputId) {
            const inputVal = document.getElementById(inputId).value;
            const encodedInput = encodeURIComponent(inputVal);
            const url = `${BASE_URL}/${funcName}?url=${encodedInput}`;
            window.open(url, '_blank');
        }
    </script>
</body>
</html>