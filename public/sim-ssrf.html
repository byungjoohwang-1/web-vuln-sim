<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSRF Simulation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Noto+Sans+KR:wght@300;400;500;700&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        .code-font { font-family: 'JetBrains Mono', monospace; }
        
        /* Terminal Styling */
        .terminal-window {
            background-color: #1e293b;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        .terminal-header {
            background-color: #0f172a;
            padding: 0.5rem 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .dot { width: 12px; height: 12px; border-radius: 50%; display: inline-block; margin-right: 6px; }
        .dot-red { background-color: #ef4444; }
        .dot-yellow { background-color: #f59e0b; }
        .dot-green { background-color: #22c55e; }
    </style>
</head>
<body class="bg-white p-8">

    <div class="max-w-4xl mx-auto space-y-6">
        
        <!-- Header Section -->
        <div>
            <div class="flex items-center gap-3 mb-2">
                <div class="p-2 bg-emerald-100 text-emerald-600 rounded-lg">
                    <i class="fas fa-network-wired text-xl"></i>
                </div>
                <h1 class="text-2xl font-bold text-slate-800">SSRF (Server-Side Request Forgery)</h1>
            </div>
            <p class="text-slate-500 text-sm">
                ê³µê²©ìê°€ ì„œë²„ë¥¼ ìœ ë„í•˜ì—¬, ì„œë²„ê°€ ì§ì ‘ ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ ë¦¬ì†ŒìŠ¤ë‚˜ ì™¸ë¶€ ì‹œìŠ¤í…œì— ìš”ì²­ì„ ë³´ë‚´ë„ë¡ ì¡°ì‘í•˜ëŠ” ì·¨ì•½ì ì…ë‹ˆë‹¤.
            </p>
        </div>

        <!-- Simulation Interface -->
        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
            <div class="flex justify-between items-start mb-4">
                <div>
                    <h3 class="text-lg font-bold">ì´ë¯¸ì§€ í”„ë¡ì‹œ ì„œë¹„ìŠ¤</h3>
                    <p class="text-sm text-slate-500">ì´ë¯¸ì§€ URLì„ ì…ë ¥í•˜ë©´ ì„œë²„ê°€ ëŒ€ì‹  ë‹¤ìš´ë¡œë“œí•˜ì—¬ ë³´ì—¬ì¤ë‹ˆë‹¤.</p>
                </div>
                <span class="bg-red-100 text-red-800 text-xs px-2 py-1 rounded font-bold">High Risk</span>
            </div>

            <!-- Input Area -->
            <div class="flex gap-2 mb-6">
                <div class="flex-1 relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <span class="text-slate-400 font-mono text-sm">Target:</span>
                    </div>
                    <input type="text" id="ssrf-input" class="w-full pl-16 p-2 border border-slate-300 rounded focus:ring-2 focus:ring-emerald-500 outline-none code-font text-sm" value="https://example.com/image.png">
                </div>
                <button onclick="simSSRF()" class="bg-slate-800 text-white px-6 py-2 rounded hover:bg-slate-700 flex items-center gap-2 transition-colors">
                    <i class="fas fa-bolt text-yellow-400"></i> Fetch
                </button>
            </div>

            <!-- Scenario Hints -->
             <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                <div class="p-3 bg-slate-50 rounded border border-slate-200 cursor-pointer hover:bg-emerald-50 hover:border-emerald-200 transition group" onclick="setPayload('http://localhost/admin')">
                    <div class="flex justify-between items-center mb-1">
                        <span class="text-xs font-bold text-slate-600 group-hover:text-emerald-700">Scenario 1: Internal Admin</span>
                        <i class="fas fa-arrow-right text-slate-300 group-hover:text-emerald-500 text-xs"></i>
                    </div>
                    <code class="text-emerald-600 text-xs break-all bg-white px-1 py-0.5 rounded border border-slate-200">http://localhost/admin</code>
                </div>
                <div class="p-3 bg-slate-50 rounded border border-slate-200 cursor-pointer hover:bg-emerald-50 hover:border-emerald-200 transition group" onclick="setPayload('http://169.254.169.254/latest/meta-data/')">
                    <div class="flex justify-between items-center mb-1">
                        <span class="text-xs font-bold text-slate-600 group-hover:text-emerald-700">Scenario 2: AWS Metadata</span>
                        <i class="fas fa-arrow-right text-slate-300 group-hover:text-emerald-500 text-xs"></i>
                    </div>
                    <code class="text-emerald-600 text-xs break-all bg-white px-1 py-0.5 rounded border border-slate-200">http://169.254.169.254/...</code>
                </div>
            </div>

            <!-- Result Terminal -->
            <div class="terminal-window">
                 <div class="terminal-header">
                    <div class="flex items-center">
                        <div class="dot dot-red"></div>
                        <div class="dot dot-yellow"></div>
                        <div class="dot dot-green"></div>
                        <span class="text-xs text-slate-400 font-mono ml-3">server_response.log</span>
                    </div>
                    <span id="ssrf-status" class="text-xs text-slate-500 font-mono">IDLE</span>
                </div>
                <div id="ssrf-result" class="p-4 code-font text-sm text-slate-300 min-h-[150px] overflow-auto whitespace-pre-wrap">Waiting for request...</div>
            </div>
        </div>
        
        <!-- Explanation Box -->
        <div class="bg-blue-50 border border-blue-100 p-4 rounded-lg flex gap-3">
            <i class="fas fa-info-circle text-blue-500 mt-1"></i>
            <div class="text-sm text-blue-800">
                <p class="font-bold mb-1">SSRFê°€ ì™œ ìœ„í—˜í•œê°€ìš”?</p>
                <p>ì›¹ ì„œë²„ëŠ” ë°©í™”ë²½ ë‚´ë¶€ì— ìœ„ì¹˜í•˜ì—¬ ë‚´ë¶€ë§ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ê¶Œí•œ(Privilege)ì„ ê°€ì§„ ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤. ê³µê²©ìëŠ” SSRFë¥¼ í†µí•´ ì´ ì‹ ë¢° ê´€ê³„ë¥¼ ì•…ìš©í•˜ì—¬ ì™¸ë¶€ì—ì„œ ì ‘ê·¼í•  ìˆ˜ ì—†ëŠ” ë‚´ë¶€ ì‹œìŠ¤í…œ(DB, ê´€ë¦¬ì í˜ì´ì§€ ë“±)ì„ ìŠ¤ìº”í•˜ê±°ë‚˜ ë°ì´í„°ë¥¼ íƒˆì·¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            </div>
        </div>

    </div>

    <script>
        function setPayload(val) {
            document.getElementById('ssrf-input').value = val;
            // Add slight highlight effect
            const input = document.getElementById('ssrf-input');
            input.classList.add('bg-yellow-50');
            setTimeout(() => input.classList.remove('bg-yellow-50'), 300);
        }

        function simSSRF() {
            const url = document.getElementById('ssrf-input').value;
            const resultBox = document.getElementById('ssrf-result');
            const statusBox = document.getElementById('ssrf-status');
            
            // UI Loading State
            resultBox.innerHTML = `<span class="text-yellow-400 animate-pulse">> Connecting to ${url}...</span>`;
            statusBox.innerText = "FETCHING...";
            statusBox.className = "text-xs text-yellow-500 font-mono font-bold animate-pulse";

            setTimeout(() => {
                let response = "";
                let isCritical = false;

                // --- Simulation Logic (Mocking Server Behavior) ---
                
                // 1. Localhost / Loopback Logic
                if (url.includes('localhost') || url.includes('127.0.0.1')) {
                    if (url.includes('admin')) {
                        response = `HTTP/1.1 200 OK\nDate: Mon, 25 Oct 2024 10:00:00 GMT\nServer: Apache/2.4.41 (Ubuntu)\nContent-Type: text/html\n\n<html>\n<body>\n  <h1>ğŸ” Internal Admin Dashboard</h1>\n  <hr>\n  <p>Welcome, Administrator.</p>\n  <p><strong>Secret Key:</strong> SUPER_SECRET_ADMIN_KEY_1234</p>\n  <button>Restart Server</button>\n  <button>Delete Database</button>\n</body>\n</html>`;
                        isCritical = true;
                    } else {
                        response = `HTTP/1.1 403 Forbidden\nServer: Internal-Gateway\n\nAccess to root is denied. Try /admin for dashboard.`;
                    }
                } 
                // 2. AWS Metadata Service Logic
                else if (url.includes('169.254.169.254')) { 
                    response = `HTTP/1.1 200 OK\nContent-Type: application/json\n\n{\n  "instance-id": "i-0123456789abcdef0",\n  "ami-id": "ami-0abcdef1234567890",\n  "security-groups": "launch-wizard-1",\n  "iam": {\n    "security-credentials": {\n      "role-name": "s3-admin-role",\n      "AccessKeyId": "AKIAIOSFODNN7EXAMPLE",\n      "SecretAccessKey": "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"\n    }\n  }\n}`;
                    isCritical = true;
                } 
                // 3. Normal External URL
                else if (url.startsWith('http')) {
                    response = `HTTP/1.1 200 OK\nContent-Type: image/png\nContent-Length: 4502\n\n[Binary Image Data Omitted]\n(Successfully fetched external image)`;
                } 
                // 4. Invalid Protocol
                else {
                    response = `Error: Protocol not supported or Host unreachable.\nOnly HTTP/HTTPS protocols are allowed.`;
                }

                // --- Render Result ---
                if(isCritical) {
                    resultBox.innerHTML = `<span class="text-green-400 font-bold">[SUCCESS] Response received from internal service:</span>\n\n${escapeHtml(response)}`;
                    statusBox.innerText = "200 OK (LEAKED)";
                    statusBox.className = "text-xs text-red-500 font-mono font-bold";
                } else if (response.startsWith("Error")) {
                    resultBox.innerHTML = `<span class="text-red-400">${response}</span>`;
                    statusBox.innerText = "ERROR";
                    statusBox.className = "text-xs text-red-500 font-mono";
                } else {
                    resultBox.innerHTML = `<span class="text-slate-300">${escapeHtml(response)}</span>`;
                    statusBox.innerText = "200 OK";
                    statusBox.className = "text-xs text-green-500 font-mono";
                }

            }, 800); // 0.8s Simulated delay
        }

        // Helper to prevent inner HTML rendering of the 'response' code
        function escapeHtml(text) {
            return text
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }
    </script>
</body>
</html>