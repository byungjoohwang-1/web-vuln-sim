<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¸ˆìœµê¶Œ LDAP Injection ì‹¤ì „ ì‹œë®¬ë ˆì´í„°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        .code-font { font-family: 'Courier New', monospace; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
        .animate-blink { animation: blink 1s infinite; }
        @keyframes slideIn { from { transform: translateX(-20px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        .slide-in { animation: slideIn 0.5s ease-out; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .animate-pulse-slow { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
    </style>
</head>
<body class="bg-gray-900 p-4">

    <!-- íƒ€ì´í‹€ -->
    <div class="max-w-7xl mx-auto mb-4">
        <div class="bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-4 rounded-lg shadow-lg">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <i class="fas fa-network-wired text-3xl"></i>
                    <div>
                        <h1 class="font-bold text-xl">ê¸ˆìœµê¶Œ LDAP Injection ì‹¤ì „ ì‹œë‚˜ë¦¬ì˜¤</h1>
                        <p class="text-sm">ê°€ì´ë“œ 49 ì œ1ì¥-10: LDAP ì‚½ì… | ìœ„í—˜ë„: 5 (ë§¤ìš° ë†’ìŒ)</p>
                    </div>
                </div>
                <button onclick="resetAll()" class="bg-white text-purple-600 px-4 py-2 rounded font-bold hover:bg-gray-100">
                    <i class="fas fa-redo"></i> ì²˜ìŒë¶€í„°
                </button>
            </div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-2 gap-4">
        
        <!-- ì¢Œì¸¡: ê³µê²©ì í™”ë©´ -->
        <div class="space-y-4">
            
            <!-- ê³µê²©ì ë¸Œë¼ìš°ì € -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg border-2 border-purple-500">
                <div class="flex items-center gap-3 mb-3">
                    <i class="fas fa-user-secret text-purple-400 text-2xl"></i>
                    <div>
                        <h2 class="font-bold text-lg">ğŸ”´ ê³µê²©ì (ì„ì§ì› ì¸ì¦ ì‹œìŠ¤í…œ ê³µê²©)</h2>
                        <p class="text-sm text-gray-400" id="attackerStatus">LDAP Injection ì¤€ë¹„ ì¤‘...</p>
                    </div>
                </div>
                
                <!-- ë¸Œë¼ìš°ì € í™”ë©´ -->
                <div class="bg-white rounded-lg overflow-hidden">
                    <div class="bg-gray-300 px-3 py-2 flex items-center gap-2">
                        <div class="flex gap-1">
                            <div class="w-2 h-2 rounded-full bg-red-500"></div>
                            <div class="w-2 h-2 rounded-full bg-yellow-500"></div>
                            <div class="w-2 h-2 rounded-full bg-green-500"></div>
                        </div>
                        <div class="flex-1 bg-white rounded px-2 py-1 flex items-center gap-2">
                            <i class="fas fa-lock text-green-600 text-xs"></i>
                            <span class="text-xs text-gray-600 code-font flex-1" id="browserUrl">https://intranet.xxbank.com/login</span>
                        </div>
                        <button class="text-gray-600 text-xs"><i class="fas fa-sync"></i></button>
                    </div>
                    
                    <div id="browserScreen" class="p-4 bg-white text-gray-900 min-h-[450px] max-h-[500px] overflow-auto">
                        <div class="text-center text-gray-400 py-20">
                            <i class="fas fa-network-wired text-6xl mb-4"></i>
                            <p>ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- LDAP ì¿¼ë¦¬ ë¶„ì„ -->
            <div id="ldapQuery" class="hidden bg-indigo-900 text-white p-4 rounded-lg shadow-lg border-2 border-indigo-500">
                <div class="flex items-center gap-2 mb-3">
                    <i class="fas fa-code text-indigo-400 text-xl animate-pulse-slow"></i>
                    <h3 class="font-bold">ğŸ” LDAP ì¿¼ë¦¬ ë¶„ì„</h3>
                </div>
                <div id="ldapQueryContent" class="bg-black p-3 rounded code-font text-xs"></div>
            </div>

            <!-- ê³µê²© ê²°ê³¼ -->
            <div id="attackResult" class="hidden bg-red-900 text-white p-4 rounded-lg shadow-lg border-2 border-red-500">
                <div class="flex items-center gap-2 mb-3">
                    <i class="fas fa-database text-red-400 text-xl animate-pulse"></i>
                    <h3 class="font-bold">ğŸ’€ LDAP ì„œë²„ ì‘ë‹µ</h3>
                </div>
                <div id="attackResultContent" class="bg-black p-3 rounded code-font text-xs max-h-[300px] overflow-auto"></div>
            </div>

            <!-- ê³µê²© ë‹¨ê³„ -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg">
                <h3 class="font-bold mb-3 flex items-center gap-2">
                    <i class="fas fa-list-ol text-purple-400"></i>
                    ê³µê²© ì§„í–‰ ë‹¨ê³„
                </h3>
                <div id="attackSteps" class="space-y-2 text-sm max-h-[250px] overflow-auto">
                    <div class="text-gray-500">ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”...</div>
                </div>
            </div>

            <!-- ì‹œë‚˜ë¦¬ì˜¤ ì„ íƒ -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg">
                <h3 class="font-bold mb-3 flex items-center gap-2">
                    <i class="fas fa-flask text-purple-400"></i>
                    ì‹¤ì „ ê³µê²© ì‹œë‚˜ë¦¬ì˜¤
                </h3>
                <div class="space-y-2">
                    <button onclick="startScenario(1)" 
                            class="w-full text-left bg-red-900 hover:bg-red-800 px-3 py-2 rounded text-sm transition">
                        <i class="fas fa-user-shield"></i> <strong>ì‹œë‚˜ë¦¬ì˜¤ 1:</strong> ì¸ì¦ ìš°íšŒ - ê´€ë¦¬ì ê³„ì • íƒˆì·¨
                    </button>
                    <button onclick="startScenario(2)" 
                            class="w-full text-left bg-orange-900 hover:bg-orange-800 px-3 py-2 rounded text-sm transition">
                        <i class="fas fa-users"></i> <strong>ì‹œë‚˜ë¦¬ì˜¤ 2:</strong> ì •ë³´ ëŒ€ëŸ‰ ì¡°íšŒ - ì „ì²´ ì„ì§ì› ì •ë³´
                    </button>
                    <button onclick="startScenario(3)" 
                            class="w-full text-left bg-purple-900 hover:bg-purple-800 px-3 py-2 rounded text-sm transition">
                        <i class="fas fa-user-cog"></i> <strong>ì‹œë‚˜ë¦¬ì˜¤ 3:</strong> ì†ì„± ì¡°ì‘ - ê¶Œí•œ ë³€ì¡°
                    </button>
                </div>
            </div>

            <!-- ì·¨ì•½í•œ ì½”ë“œ -->
            <div class="bg-gray-900 text-white p-4 rounded-lg shadow-lg border border-red-500">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="font-bold text-red-400">
                        <i class="fas fa-bug"></i> ì·¨ì•½í•œ ì½”ë“œ (LDAP Injection)
                    </h3>
                    <span class="text-xs bg-red-600 px-2 py-1 rounded">ë¬¸ì œ ì›ì¸</span>
                </div>
                <pre class="code-font text-xs overflow-x-auto max-h-[700px]"><code><span class="text-gray-500">// Java - ì·¨ì•½í•œ LDAP ì¿¼ë¦¬</span>

@Service
public class LdapAuthService {
    
    @Autowired
    private LdapTemplate ldapTemplate;
    
    public User authenticate(String username, String password) {
        <span class="text-red-400">// âŒ ì‚¬ìš©ì ì…ë ¥ì„ ì§ì ‘ ì—°ê²°!</span>
        String filter = "(uid=" + username + ")";
        
        <span class="text-red-400">// âŒ LDAP Injection ì·¨ì•½!</span>
        List<User> users = ldapTemplate.search(
            "ou=people,dc=xxbank,dc=com",
            filter,
            new UserAttributesMapper()
        );
        
        if (users.isEmpty()) {
            throw new AuthenticationException("User not found");
        }
        
        User user = users.get(0);
        
        <span class="text-red-400">// âŒ ë¹„ë°€ë²ˆí˜¸ ê²€ì¦ë„ ìš°íšŒ ê°€ëŠ¥</span>
        if (user.getPassword().equals(password)) {
            return user;
        }
        
        throw new AuthenticationException("Invalid password");
    }
}

<span class="text-gray-500">// Python LDAP - ì·¨ì•½í•œ ì½”ë“œ</span>

import ldap

def ldap_authenticate(username, password):
    <span class="text-red-400"># âŒ ì…ë ¥ê°’ ê²€ì¦ ì—†ìŒ!</span>
    ldap_filter = f"(uid={username})"
    
    conn = ldap.initialize('ldap://ldap.xxbank.com')
    
    <span class="text-red-400"># âŒ LDAP Injection ì·¨ì•½</span>
    result = conn.search_s(
        'ou=people,dc=xxbank,dc=com',
        ldap.SCOPE_SUBTREE,
        ldap_filter
    )
    
    if not result:
        raise Exception("User not found")
    
    dn, attrs = result[0]
    
    <span class="text-red-400"># âŒ ë¹„ë°€ë²ˆí˜¸ ê²€ì¦</span>
    try:
        conn.simple_bind_s(dn, password)
        return attrs
    except:
        raise Exception("Authentication failed")

<span class="text-gray-500">// Node.js - ì·¨ì•½í•œ LDAP</span>

const ldap = require('ldapjs');

function authenticateUser(username, password) {
    const client = ldap.createClient({
        url: 'ldap://ldap.xxbank.com'
    });
    
    <span class="text-red-400">// âŒ í•„í„°ì— ì§ì ‘ ì…ë ¥!</span>
    const filter = `(uid=${username})`;
    
    const opts = {
        filter: filter,
        scope: 'sub'
    };
    
    <span class="text-red-400">// âŒ LDAP Injection ê°€ëŠ¥</span>
    client.search(
        'ou=people,dc=xxbank,dc=com',
        opts,
        (err, res) => {
            res.on('searchEntry', (entry) => {
                // ì‚¬ìš©ì ì •ë³´ ë°˜í™˜
            });
        }
    );
}

<span class="text-gray-500">// ê³µê²© ì˜ˆì‹œ</span>

<span class="text-red-400">// ì¸ì¦ ìš°íšŒ</span>
username: admin)(&(password=*))
filter: (uid=admin)(&(password=*)))
ê²°ê³¼: ê´€ë¦¬ì ê³„ì • ì¸ì¦ ì„±ê³µ!

<span class="text-red-400">// ì „ì²´ ì¡°íšŒ</span>
username: *
filter: (uid=*)
ê²°ê³¼: ëª¨ë“  ì‚¬ìš©ì ì •ë³´ ë…¸ì¶œ!

<span class="text-red-400">// ì†ì„± ì¡°ì‘</span>
username: *)(|(uid=*
filter: (uid=*)(|(uid=*))
ê²°ê³¼: OR ì¡°ê±´ìœ¼ë¡œ ëª¨ë“  ì‚¬ìš©ì ì¡°íšŒ</code></pre>
            </div>

        </div>

        <!-- ìš°ì¸¡: ì„œë²„ & ë¶„ì„ -->
        <div class="space-y-4">
            
            <!-- LDAP ì„œë²„ ë¡œê·¸ -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg border-2 border-green-500">
                <div class="flex items-center gap-3 mb-3">
                    <i class="fas fa-server text-green-400 text-2xl"></i>
                    <div>
                        <h2 class="font-bold text-lg">ğŸŸ¢ LDAP ì„œë²„ (Active Directory)</h2>
                        <p class="text-sm text-gray-400">ì„ì§ì› ì¸ì¦ ë° ì •ë³´ ê´€ë¦¬</p>
                    </div>
                </div>
                
                <!-- LDAP ì„œë²„ ë¡œê·¸ -->
                <div class="bg-black rounded-lg p-4 min-h-[450px] max-h-[550px] overflow-auto">
                    <div id="ldapLog" class="code-font text-xs space-y-1 text-green-400">
                        <div class="text-gray-500">[LDAP] Waiting for connection...</div>
                    </div>
                </div>
                
                <!-- ìƒíƒœ -->
                <div class="mt-3 flex justify-between items-center">
                    <span class="text-xs text-gray-400">LDAP ì„œë²„ ìƒíƒœ:</span>
                    <span id="ldapStatus" class="text-xs bg-green-600 px-3 py-1 rounded">RUNNING</span>
                </div>
            </div>

            <!-- ë¬¸ì œì  ë¶„ì„ -->
            <div id="problemBox" class="hidden bg-red-900 text-white p-4 rounded-lg shadow-lg">
                <div class="flex items-center gap-2 mb-3">
                    <i class="fas fa-exclamation-triangle text-yellow-400 text-xl animate-blink"></i>
                    <h3 class="font-bold">ğŸš¨ ë¬¸ì œì  ë¶„ì„</h3>
                </div>
                <div id="problemContent" class="text-sm space-y-2"></div>
            </div>

            <!-- ì•ˆì „í•œ ì½”ë“œ -->
            <div class="bg-gray-900 text-white p-4 rounded-lg shadow-lg border border-green-500">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="font-bold text-green-400">
                        <i class="fas fa-shield-halved"></i> ì•ˆì „í•œ ì½”ë“œ (LDAP Injection ë°©ì–´)
                    </h3>
                    <span class="text-xs bg-green-600 px-2 py-1 rounded">í•´ê²°ì±…</span>
                </div>
                <pre class="code-font text-xs overflow-x-auto max-h-[1000px]"><code><span class="text-gray-500">// Java - ì•ˆì „í•œ LDAP ì¿¼ë¦¬</span>

@Service
public class SecureLdapAuthService {
    
    @Autowired
    private LdapTemplate ldapTemplate;
    
    public User authenticate(String username, String password) {
        
        <span class="text-green-400">// âœ… ì…ë ¥ê°’ ê²€ì¦</span>
        if (!isValidUsername(username)) {
            throw new IllegalArgumentException(
                "Invalid username format"
            );
        }
        
        <span class="text-green-400">// âœ… íŒŒë¼ë¯¸í„° ë°”ì¸ë”© ì‚¬ìš©</span>
        LdapQuery query = LdapQueryBuilder
            .query()
            .base("ou=people,dc=xxbank,dc=com")
            .where("uid").is(username);  // ìë™ ì´ìŠ¤ì¼€ì´í”„
        
        <span class="text-green-400">// âœ… ì•ˆì „í•œ ê²€ìƒ‰</span>
        List<User> users = ldapTemplate.search(
            query,
            new UserAttributesMapper()
        );
        
        if (users.isEmpty()) {
            <span class="text-green-400">// ì¼ë°˜ì ì¸ ì—ëŸ¬ ë©”ì‹œì§€</span>
            throw new AuthenticationException(
                "ì¸ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."
            );
        }
        
        User user = users.get(0);
        
        <span class="text-green-400">// âœ… LDAP bindë¡œ ë¹„ë°€ë²ˆí˜¸ ê²€ì¦</span>
        try {
            ldapTemplate.authenticate(
                query,
                password
            );
            return user;
        } catch (Exception e) {
            throw new AuthenticationException(
                "ì¸ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."
            );
        }
    }
    
    <span class="text-green-400">// âœ… ì…ë ¥ê°’ ê²€ì¦ í•¨ìˆ˜</span>
    private boolean isValidUsername(String username) {
        if (username == null || username.isEmpty()) {
            return false;
        }
        
        <span class="text-green-400">// ì˜ë¬¸, ìˆ«ì, ì–¸ë”ìŠ¤ì½”ì–´ë§Œ í—ˆìš©</span>
        return username.matches("^[a-zA-Z0-9_]{3,20}$");
    }
}

<span class="text-gray-500">// Spring Security LDAP - ê¶Œì¥ ë°©ë²•</span>

@Configuration
@EnableWebSecurity
public class SecurityConfig {
    
    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) 
        throws Exception {
        
        http
            .authorizeHttpRequests(auth -> auth
                .anyRequest().authenticated()
            )
            .formLogin(Customizer.withDefaults())
            <span class="text-green-400">// âœ… Spring Security LDAP ì‚¬ìš©</span>
            .ldapAuthentication()
                .userDnPatterns("uid={0},ou=people")
                .contextSource()
                    .url("ldap://ldap.xxbank.com:389/dc=xxbank,dc=com")
                    .and()
                .passwordCompare()
                    .passwordAttribute("userPassword");
        
        return http.build();
    }
}

<span class="text-gray-500">// Python - ì•ˆì „í•œ LDAP</span>

import ldap
import ldap.filter

def secure_ldap_authenticate(username, password):
    
    <span class="text-green-400"># âœ… ì…ë ¥ê°’ ê²€ì¦</span>
    if not is_valid_username(username):
        raise ValueError("Invalid username format")
    
    <span class="text-green-400"># âœ… LDAP í•„í„° ì´ìŠ¤ì¼€ì´í”„</span>
    escaped_username = ldap.filter.escape_filter_chars(
        username
    )
    
    ldap_filter = f"(uid={escaped_username})"
    
    conn = ldap.initialize('ldap://ldap.xxbank.com')
    
    <span class="text-green-400"># âœ… ì•ˆì „í•œ ê²€ìƒ‰</span>
    result = conn.search_s(
        'ou=people,dc=xxbank,dc=com',
        ldap.SCOPE_SUBTREE,
        ldap_filter,
        attrlist=['uid', 'cn', 'mail']  # í•„ìš”í•œ ì†ì„±ë§Œ
    )
    
    if not result:
        raise Exception("ì¸ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")
    
    dn, attrs = result[0]
    
    <span class="text-green-400"># âœ… LDAP bindë¡œ ê²€ì¦</span>
    try:
        conn.simple_bind_s(dn, password)
        return {
            'uid': attrs.get('uid', [b''])[0].decode(),
            'name': attrs.get('cn', [b''])[0].decode(),
            'email': attrs.get('mail', [b''])[0].decode()
        }
    except ldap.INVALID_CREDENTIALS:
        raise Exception("ì¸ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")
    finally:
        conn.unbind()

def is_valid_username(username):
    <span class="text-green-400"># ì˜ë¬¸, ìˆ«ì, ì–¸ë”ìŠ¤ì½”ì–´ë§Œ í—ˆìš©</span>
    import re
    pattern = r'^[a-zA-Z0-9_]{3,20}$'
    return bool(re.match(pattern, username))

<span class="text-gray-500">// Node.js - ì•ˆì „í•œ LDAP</span>

const ldap = require('ldapjs');

function secureLdapAuth(username, password, callback) {
    
    <span class="text-green-400">// âœ… ì…ë ¥ê°’ ê²€ì¦</span>
    if (!isValidUsername(username)) {
        return callback(new Error('Invalid username'));
    }
    
    const client = ldap.createClient({
        url: 'ldap://ldap.xxbank.com'
    });
    
    <span class="text-green-400">// âœ… LDAP ì´ìŠ¤ì¼€ì´í”„</span>
    const escapedUsername = ldap.filters
        .escape(username);
    
    <span class="text-green-400">// âœ… í•„í„° ê°ì²´ ì‚¬ìš© (ê¶Œì¥)</span>
    const filter = new ldap.EqualityFilter({
        attribute: 'uid',
        value: escapedUsername
    });
    
    const opts = {
        filter: filter,
        scope: 'sub',
        <span class="text-green-400">// í•„ìš”í•œ ì†ì„±ë§Œ ìš”ì²­</span>
        attributes: ['uid', 'cn', 'mail']
    };
    
    client.search(
        'ou=people,dc=xxbank,dc=com',
        opts,
        (err, res) => {
            if (err) {
                return callback(err);
            }
            
            res.on('searchEntry', (entry) => {
                const dn = entry.objectName;
                
                <span class="text-green-400">// âœ… bindë¡œ ë¹„ë°€ë²ˆí˜¸ ê²€ì¦</span>
                client.bind(dn, password, (bindErr) => {
                    if (bindErr) {
                        return callback(
                            new Error('ì¸ì¦ ì‹¤íŒ¨')
                        );
                    }
                    
                    callback(null, entry.object);
                });
            });
            
            res.on('error', (err) => {
                callback(err);
            });
        }
    );
}

function isValidUsername(username) {
    <span class="text-green-400">// ì˜ë¬¸, ìˆ«ì, ì–¸ë”ìŠ¤ì½”ì–´ë§Œ</span>
    return /^[a-zA-Z0-9_]{3,20}$/.test(username);
}

<span class="text-gray-500">// LDAP ì´ìŠ¤ì¼€ì´í”„ í•„ìˆ˜ ë¬¸ì</span>

<span class="text-green-400">// íŠ¹ìˆ˜ ë¬¸ì ì´ìŠ¤ì¼€ì´í”„</span>
* â†’ \2a
( â†’ \28
) â†’ \29
\ â†’ \5c
NUL â†’ \00
/ â†’ \2f

<span class="text-green-400">// ì˜ˆì‹œ: admin*) â†’ admin\2a\29</span>

<span class="text-gray-500">// ë°©ì–´ ì²´í¬ë¦¬ìŠ¤íŠ¸</span>

<span class="text-green-400">âœ… ì…ë ¥ê°’ ê²€ì¦ (í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸)</span>
âœ… LDAP í•„í„° ì´ìŠ¤ì¼€ì´í”„
âœ… íŒŒë¼ë¯¸í„° ë°”ì¸ë”© ì‚¬ìš©
âœ… ìµœì†Œ ê¶Œí•œ ì›ì¹™
âœ… ì—ëŸ¬ ë©”ì‹œì§€ ì¼ë°˜í™”
âœ… ë¡œê¹… ë° ëª¨ë‹ˆí„°ë§
âœ… ê³„ì • ì ê¸ˆ ì •ì±…
âœ… TLS/SSL ì•”í˜¸í™”</code></pre>
            </div>

        </div>
    </div>

    <script>
        let isRunning = false;

        function resetAll() {
            isRunning = false;
            
            document.getElementById('attackerStatus').textContent = 'LDAP Injection ì¤€ë¹„ ì¤‘...';
            document.getElementById('browserUrl').textContent = 'https://intranet.xxbank.com/login';
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="text-center text-gray-400 py-20">' +
                '<i class="fas fa-network-wired text-6xl mb-4"></i>' +
                '<p>ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”</p>' +
                '</div>';
            
            document.getElementById('ldapLog').innerHTML = 
                '<div class="text-gray-500">[LDAP] Waiting for connection...</div>';
            
            document.getElementById('ldapStatus').textContent = 'RUNNING';
            document.getElementById('ldapStatus').className = 'text-xs bg-green-600 px-3 py-1 rounded';
            
            document.getElementById('attackSteps').innerHTML = 
                '<div class="text-gray-500">ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”...</div>';
            
            document.getElementById('ldapQuery').classList.add('hidden');
            document.getElementById('attackResult').classList.add('hidden');
            document.getElementById('problemBox').classList.add('hidden');
        }

        async function startScenario(scenario) {
            if (isRunning) return;
            isRunning = true;
            
            resetAll();
            await sleep(300);
            
            if (scenario === 1) {
                await scenario1_AuthenticationBypass();
            } else if (scenario === 2) {
                await scenario2_MassDataRetrieval();
            } else if (scenario === 3) {
                await scenario3_AttributeManipulation();
            }
            
            isRunning = false;
        }

        // ì‹œë‚˜ë¦¬ì˜¤ 1: ì¸ì¦ ìš°íšŒ - ê´€ë¦¬ì ê³„ì • íƒˆì·¨
        async function scenario1_AuthenticationBypass() {
            updateStep('ğŸ¯ ì‹œë‚˜ë¦¬ì˜¤ 1: LDAP ì¸ì¦ ìš°íšŒ - ê´€ë¦¬ì ê³„ì • íƒˆì·¨');
            await sleep(1000);
            
            updateStep('1ï¸âƒ£ XXì€í–‰ ì¸íŠ¸ë¼ë„· ë¡œê·¸ì¸ í˜ì´ì§€ ì ‘ì†');
            document.getElementById('attackerStatus').textContent = 'ë¡œê·¸ì¸ í˜ì´ì§€ ì ‘ì†...';
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-md mx-auto mt-10">' +
                '<div class="text-center mb-6">' +
                '<i class="fas fa-building text-blue-600 text-4xl mb-2"></i>' +
                '<h2 class="text-2xl font-bold text-gray-800">XXì€í–‰ ì¸íŠ¸ë¼ë„·</h2>' +
                '<p class="text-sm text-gray-600">ì„ì§ì› ì „ìš©</p>' +
                '</div>' +
                '<form class="space-y-4 bg-gray-50 p-6 rounded-lg">' +
                '<div>' +
                '<label class="block text-sm font-medium text-gray-700 mb-1">ì‚¬ë²ˆ</label>' +
                '<input type="text" class="w-full border border-gray-300 rounded px-3 py-2" placeholder="ì‚¬ë²ˆ ì…ë ¥">' +
                '</div>' +
                '<div>' +
                '<label class="block text-sm font-medium text-gray-700 mb-1">ë¹„ë°€ë²ˆí˜¸</label>' +
                '<input type="password" class="w-full border border-gray-300 rounded px-3 py-2" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥">' +
                '</div>' +
                '<button class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700">ë¡œê·¸ì¸</button>' +
                '</form>' +
                '</div>';
            
            await sleep(2000);
            
            updateStep('2ï¸âƒ£ LDAP Injection í˜ì´ë¡œë“œ ì‚½ì…');
            document.getElementById('attackerStatus').textContent = 'Injection ê³µê²© ì¤‘...';
            
            await addLdapLog('[INFO] LDAP connection established', 'text-blue-400');
            await sleep(300);
            await addLdapLog('[INFO] Base DN: ou=people,dc=xxbank,dc=com', 'text-gray-400');
            await sleep(500);
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-md mx-auto mt-10">' +
                '<div class="text-center mb-6">' +
                '<i class="fas fa-building text-blue-600 text-4xl mb-2"></i>' +
                '<h2 class="text-2xl font-bold text-gray-800">XXì€í–‰ ì¸íŠ¸ë¼ë„·</h2>' +
                '</div>' +
                '<form class="space-y-4 bg-red-50 p-6 rounded-lg border-2 border-red-300">' +
                '<div>' +
                '<label class="block text-sm font-medium text-gray-700 mb-1">ì‚¬ë²ˆ</label>' +
                '<input type="text" class="w-full border border-red-300 rounded px-3 py-2 code-font text-sm bg-yellow-50" value="admin)(&(password=*))"> ' +
                '<p class="text-xs text-red-600 mt-1">âš ï¸ LDAP Injection í˜ì´ë¡œë“œ</p>' +
                '</div>' +
                '<div>' +
                '<label class="block text-sm font-medium text-gray-700 mb-1">ë¹„ë°€ë²ˆí˜¸</label>' +
                '<input type="password" class="w-full border border-gray-300 rounded px-3 py-2" value="anything">' +
                '<p class="text-xs text-gray-500 mt-1">ì•„ë¬´ ê°’ì´ë‚˜ ì…ë ¥</p>' +
                '</div>' +
                '<button class="w-full bg-red-600 text-white py-2 rounded hover:bg-red-700">ë¡œê·¸ì¸ ì‹œë„</button>' +
                '</form>' +
                '</div>';
            
            await sleep(2000);
            
            updateStep('3ï¸âƒ£ <span class="text-red-500 font-bold">LDAP í•„í„° ì¡°ì‘ ì„±ê³µ!</span>');
            
            document.getElementById('ldapQuery').classList.remove('hidden');
            document.getElementById('ldapQueryContent').innerHTML = 
                '<div class="text-cyan-400 mb-2">ğŸ“ ì›ë˜ LDAP í•„í„°:</div>' +
                '<div class="text-green-400">(uid=admin)</div>' +
                '<div class="border-t border-gray-700 my-2"></div>' +
                '<div class="text-yellow-400 mb-2">ğŸ’€ ì¡°ì‘ëœ LDAP í•„í„°:</div>' +
                '<div class="text-red-400">(uid=admin)(&(password=*))</div>' +
                '<div class="border-t border-gray-700 my-2"></div>' +
                '<div class="text-orange-400 mb-2">ğŸ” í•´ì„:</div>' +
                '<div class="text-gray-300 text-xs">' +
                '<div>â€¢ (uid=admin) : ì‚¬ë²ˆì´ adminì¸ ì‚¬ìš©ì</div>' +
                '<div>â€¢ )( : ì²« ë²ˆì§¸ ì¡°ê±´ ì¢…ë£Œ</div>' +
                '<div>â€¢ &(password=*) : AND ë¹„ë°€ë²ˆí˜¸ê°€ ì¡´ì¬</div>' +
                '<div class="text-red-400 mt-2">â†’ ë¹„ë°€ë²ˆí˜¸ ê²€ì¦ ìš°íšŒ!</div>' +
                '</div>';
            
            await addLdapLog('');
            await addLdapLog('[SEARCH] Filter: (uid=admin)(&(password=*))', 'text-yellow-400');
            await sleep(500);
            await addLdapLog('[WARN] Malformed filter detected!', 'text-orange-400');
            await sleep(300);
            await addLdapLog('[PROCESSING] Parsing filter...', 'text-cyan-400');
            await sleep(800);
            await addLdapLog('[QUERY] Searching in ou=people,dc=xxbank,dc=com', 'text-blue-400');
            await sleep(500);
            await addLdapLog('[RESULT] Found 1 entry', 'text-green-400');
            await sleep(300);
            await addLdapLog('[ENTRY] dn: uid=admin,ou=people,dc=xxbank,dc=com', 'text-green-400');
            await sleep(300);
            await addLdapLog('[ATTR] cn: ì‹œìŠ¤í…œ ê´€ë¦¬ì', 'text-green-400');
            await sleep(300);
            await addLdapLog('[ATTR] role: ADMINISTRATOR', 'text-red-400');
            await sleep(300);
            await addLdapLog('[ATTR] department: ITë³´ì•ˆíŒ€', 'text-green-400');
            await sleep(300);
            await addLdapLog('[ATTR] mail: admin@xxbank.com', 'text-green-400');
            await sleep(500);
            await addLdapLog('[SUCCESS] Authentication successful!', 'text-green-400');
            await sleep(1000);
            
            updateStep('4ï¸âƒ£ <span class="text-green-500 font-bold">ê´€ë¦¬ì ê¶Œí•œ íšë“!</span>');
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-3xl mx-auto mt-6">' +
                '<div class="bg-green-50 border-2 border-green-300 rounded-lg p-6 mb-4">' +
                '<div class="flex items-center gap-2 mb-4 text-green-700">' +
                '<i class="fas fa-check-circle text-3xl"></i>' +
                '<h3 class="text-2xl font-bold">ì¸ì¦ ì„±ê³µ</h3>' +
                '</div>' +
                '<div class="bg-white p-4 rounded border border-gray-300">' +
                '<div class="flex items-center gap-3 mb-4">' +
                '<i class="fas fa-user-shield text-red-600 text-4xl"></i>' +
                '<div>' +
                '<p class="text-xl font-bold text-gray-800">ì‹œìŠ¤í…œ ê´€ë¦¬ì</p>' +
                '<p class="text-sm text-gray-600">ITë³´ì•ˆíŒ€</p>' +
                '</div>' +
                '</div>' +
                '<div class="grid grid-cols-2 gap-3 text-sm">' +
                '<div class="bg-gray-100 p-2 rounded">' +
                '<span class="text-gray-600">ì‚¬ë²ˆ:</span> ' +
                '<span class="font-bold">admin</span>' +
                '</div>' +
                '<div class="bg-red-100 p-2 rounded">' +
                '<span class="text-gray-600">ê¶Œí•œ:</span> ' +
                '<span class="font-bold text-red-600">ADMINISTRATOR</span>' +
                '</div>' +
                '<div class="bg-gray-100 p-2 rounded col-span-2">' +
                '<span class="text-gray-600">ì´ë©”ì¼:</span> ' +
                '<span class="font-bold">admin@xxbank.com</span>' +
                '</div>' +
                '</div>' +
                '</div>' +
                '</div>' +
                '<div class="grid grid-cols-3 gap-3">' +
                '<button class="bg-red-600 text-white py-3 rounded hover:bg-red-700">' +
                '<i class="fas fa-users mr-2"></i>ì‚¬ìš©ì ê´€ë¦¬' +
                '</button>' +
                '<button class="bg-orange-600 text-white py-3 rounded hover:bg-orange-700">' +
                '<i class="fas fa-database mr-2"></i>DB ì ‘ê·¼' +
                '</button>' +
                '<button class="bg-purple-600 text-white py-3 rounded hover:bg-purple-700">' +
                '<i class="fas fa-cog mr-2"></i>ì‹œìŠ¤í…œ ì„¤ì •' +
                '</button>' +
                '</div>' +
                '</div>';
            
            document.getElementById('attackResult').classList.remove('hidden');
            document.getElementById('attackResultContent').innerHTML = 
                '<div class="text-cyan-400 mb-2">ğŸ‘¤ íƒˆì·¨í•œ ê´€ë¦¬ì ì •ë³´:</div>' +
                '<div class="text-green-400">DN: uid=admin,ou=people,dc=xxbank,dc=com</div>' +
                '<div class="text-green-400">Name: ì‹œìŠ¤í…œ ê´€ë¦¬ì</div>' +
                '<div class="text-red-400 font-bold">Role: ADMINISTRATOR</div>' +
                '<div class="text-green-400">Department: ITë³´ì•ˆíŒ€</div>' +
                '<div class="text-green-400">Email: admin@xxbank.com</div>' +
                '<div class="border-t border-gray-700 my-2"></div>' +
                '<div class="text-yellow-400 mb-2">ğŸ”“ íšë“í•œ ê¶Œí•œ:</div>' +
                '<div class="text-gray-300 text-xs">' +
                '<div>â€¢ ì „ì²´ ì‚¬ìš©ì ê³„ì • ê´€ë¦¬</div>' +
                '<div>â€¢ ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼</div>' +
                '<div>â€¢ ì‹œìŠ¤í…œ ì„¤ì • ë³€ê²½</div>' +
                '<div>â€¢ ë°±ì—… íŒŒì¼ ì ‘ê·¼</div>' +
                '<div>â€¢ ë¡œê·¸ ì‚­ì œ/ë³€ì¡°</div>' +
                '</div>';
            
            showResults('scenario1');
        }

        // ì‹œë‚˜ë¦¬ì˜¤ 2: ì •ë³´ ëŒ€ëŸ‰ ì¡°íšŒ
        async function scenario2_MassDataRetrieval() {
            updateStep('ğŸ¯ ì‹œë‚˜ë¦¬ì˜¤ 2: LDAP ì •ë³´ ëŒ€ëŸ‰ ì¡°íšŒ - ì „ì²´ ì„ì§ì› ì •ë³´');
            await sleep(1000);
            
            updateStep('1ï¸âƒ£ ì§ì› ê²€ìƒ‰ í˜ì´ì§€ ì ‘ì†');
            document.getElementById('attackerStatus').textContent = 'ì§ì› ê²€ìƒ‰ í˜ì´ì§€...';
            document.getElementById('browserUrl').textContent = 'https://intranet.xxbank.com/search';
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-2xl mx-auto mt-10">' +
                '<h2 class="text-2xl font-bold mb-6 text-gray-800">ì„ì§ì› ê²€ìƒ‰</h2>' +
                '<div class="bg-gray-50 p-6 rounded-lg">' +
                '<div class="mb-4">' +
                '<label class="block text-sm font-medium text-gray-700 mb-2">ê²€ìƒ‰ì–´</label>' +
                '<input type="text" class="w-full border border-gray-300 rounded px-3 py-2" placeholder="ì´ë¦„ ë˜ëŠ” ë¶€ì„œëª…">' +
                '</div>' +
                '<button class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700">' +
                '<i class="fas fa-search mr-2"></i>ê²€ìƒ‰' +
                '</button>' +
                '</div>' +
                '</div>';
            
            await sleep(2000);
            
            updateStep('2ï¸âƒ£ ì™€ì¼ë“œì¹´ë“œ(*) ì…ë ¥ìœ¼ë¡œ ì „ì²´ ì¡°íšŒ ì‹œë„');
            document.getElementById('attackerStatus').textContent = 'ì™€ì¼ë“œì¹´ë“œ ê³µê²©...';
            
            await addLdapLog('[INFO] Search request received', 'text-blue-400');
            await sleep(500);
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-2xl mx-auto mt-10">' +
                '<h2 class="text-2xl font-bold mb-6 text-gray-800">ì„ì§ì› ê²€ìƒ‰</h2>' +
                '<div class="bg-red-50 p-6 rounded-lg border-2 border-red-300">' +
                '<div class="mb-4">' +
                '<label class="block text-sm font-medium text-gray-700 mb-2">ê²€ìƒ‰ì–´</label>' +
                '<input type="text" class="w-full border border-red-300 rounded px-3 py-2 code-font bg-yellow-50" value="*">' +
                '<p class="text-xs text-red-600 mt-1">âš ï¸ ì™€ì¼ë“œì¹´ë“œë¡œ ì „ì²´ ì¡°íšŒ</p>' +
                '</div>' +
                '<button class="bg-red-600 text-white px-6 py-2 rounded hover:bg-red-700">' +
                '<i class="fas fa-search mr-2"></i>ê²€ìƒ‰ ì‹¤í–‰' +
                '</button>' +
                '</div>' +
                '</div>';
            
            await sleep(2000);
            
            updateStep('3ï¸âƒ£ <span class="text-red-500 font-bold">LDAP í•„í„° ì¡°ì‘ìœ¼ë¡œ ì „ì²´ ë°ì´í„° ì¡°íšŒ!</span>');
            
            document.getElementById('ldapQuery').classList.remove('hidden');
            document.getElementById('ldapQueryContent').innerHTML = 
                '<div class="text-cyan-400 mb-2">ğŸ“ ì›ë˜ LDAP í•„í„°:</div>' +
                '<div class="text-green-400">(cn=í™ê¸¸ë™)</div>' +
                '<div class="border-t border-gray-700 my-2"></div>' +
                '<div class="text-yellow-400 mb-2">ğŸ’€ ì¡°ì‘ëœ LDAP í•„í„°:</div>' +
                '<div class="text-red-400">(cn=*)</div>' +
                '<div class="border-t border-gray-700 my-2"></div>' +
                '<div class="text-orange-400 mb-2">ğŸ” ì˜ë¯¸:</div>' +
                '<div class="text-gray-300 text-xs">' +
                '<div>â€¢ * = ëª¨ë“  ê°’ ë§¤ì¹­</div>' +
                '<div>â€¢ (cn=*) = ì´ë¦„ì´ ì¡´ì¬í•˜ëŠ” ëª¨ë“  ì‚¬ìš©ì</div>' +
                '<div class="text-red-400 mt-2">â†’ ì „ì²´ ì„ì§ì› ì •ë³´ ë…¸ì¶œ!</div>' +
                '</div>';
            
            await addLdapLog('');
            await addLdapLog('[SEARCH] Filter: (cn=*)', 'text-yellow-400');
            await sleep(500);
            await addLdapLog('[WARN] Wildcard search detected!', 'text-orange-400');
            await sleep(300);
            await addLdapLog('[QUERY] Searching all entries...', 'text-cyan-400');
            await sleep(1000);
            await addLdapLog('[RESULT] Found 1,247 entries', 'text-red-400');
            await sleep(500);
            await addLdapLog('[ENTRY 1] uid=kim001, cn=ê¹€ì² ìˆ˜, dept=ì˜ì—…1íŒ€', 'text-green-400');
            await sleep(200);
            await addLdapLog('[ENTRY 2] uid=lee002, cn=ì´ì˜í¬, dept=ITê°œë°œíŒ€', 'text-green-400');
            await sleep(200);
            await addLdapLog('[ENTRY 3] uid=park003, cn=ë°•ë¯¼ìˆ˜, dept=ì¬ë¬´íŒ€', 'text-green-400');
            await sleep(200);
            await addLdapLog('[ENTRY 4] uid=choi004, cn=ìµœì§€ì˜, dept=ì¸ì‚¬íŒ€', 'text-green-400');
            await sleep(200);
            await addLdapLog('[ENTRY 5] uid=jung005, cn=ì •ìˆ˜í˜„, dept=ë¦¬ìŠ¤í¬ê´€ë¦¬íŒ€', 'text-green-400');
            await sleep(300);
            await addLdapLog('... (1,242 more entries)', 'text-gray-400');
            await sleep(500);
            await addLdapLog('[SUCCESS] Data retrieved successfully', 'text-green-400');
            await sleep(1000);
            
            updateStep('4ï¸âƒ£ <span class="text-green-500 font-bold">1,247ëª… ì „ì²´ ì„ì§ì› ì •ë³´ íšë“!</span>');
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-3xl mx-auto mt-6">' +
                '<div class="bg-green-50 border-2 border-green-300 rounded-lg p-4 mb-4">' +
                '<div class="flex items-center gap-2 text-green-700">' +
                '<i class="fas fa-check-circle text-2xl"></i>' +
                '<span class="font-bold">ê²€ìƒ‰ ì™„ë£Œ: 1,247ëª…</span>' +
                '</div>' +
                '</div>' +
                '<div class="bg-white rounded-lg border border-gray-300 max-h-[400px] overflow-auto">' +
                '<table class="w-full text-sm">' +
                '<thead class="bg-gray-100 sticky top-0">' +
                '<tr>' +
                '<th class="px-3 py-2 text-left">ì‚¬ë²ˆ</th>' +
                '<th class="px-3 py-2 text-left">ì´ë¦„</th>' +
                '<th class="px-3 py-2 text-left">ë¶€ì„œ</th>' +
                '<th class="px-3 py-2 text-left">ì§ê¸‰</th>' +
                '<th class="px-3 py-2 text-left">ì´ë©”ì¼</th>' +
                '</tr>' +
                '</thead>' +
                '<tbody class="divide-y">' +
                '<tr class="hover:bg-gray-50">' +
                '<td class="px-3 py-2 code-font text-xs">kim001</td>' +
                '<td class="px-3 py-2">ê¹€ì² ìˆ˜</td>' +
                '<td class="px-3 py-2">ì˜ì—…1íŒ€</td>' +
                '<td class="px-3 py-2">ì°¨ì¥</td>' +
                '<td class="px-3 py-2 text-xs">kim001@xxbank.com</td>' +
                '</tr>' +
                '<tr class="hover:bg-gray-50">' +
                '<td class="px-3 py-2 code-font text-xs">lee002</td>' +
                '<td class="px-3 py-2">ì´ì˜í¬</td>' +
                '<td class="px-3 py-2">ITê°œë°œíŒ€</td>' +
                '<td class="px-3 py-2">ê³¼ì¥</td>' +
                '<td class="px-3 py-2 text-xs">lee002@xxbank.com</td>' +
                '</tr>' +
                '<tr class="hover:bg-gray-50">' +
                '<td class="px-3 py-2 code-font text-xs">park003</td>' +
                '<td class="px-3 py-2">ë°•ë¯¼ìˆ˜</td>' +
                '<td class="px-3 py-2">ì¬ë¬´íŒ€</td>' +
                '<td class="px-3 py-2">ë¶€ì¥</td>' +
                '<td class="px-3 py-2 text-xs">park003@xxbank.com</td>' +
                '</tr>' +
                '<tr class="hover:bg-gray-50">' +
                '<td class="px-3 py-2 code-font text-xs">choi004</td>' +
                '<td class="px-3 py-2">ìµœì§€ì˜</td>' +
                '<td class="px-3 py-2">ì¸ì‚¬íŒ€</td>' +
                '<td class="px-3 py-2">ëŒ€ë¦¬</td>' +
                '<td class="px-3 py-2 text-xs">choi004@xxbank.com</td>' +
                '</tr>' +
                '<tr class="hover:bg-gray-50 bg-red-50">' +
                '<td class="px-3 py-2 code-font text-xs">admin</td>' +
                '<td class="px-3 py-2 font-bold">ì‹œìŠ¤í…œê´€ë¦¬ì</td>' +
                '<td class="px-3 py-2 text-red-600">ITë³´ì•ˆíŒ€</td>' +
                '<td class="px-3 py-2 text-red-600 font-bold">ê´€ë¦¬ì</td>' +
                '<td class="px-3 py-2 text-xs">admin@xxbank.com</td>' +
                '</tr>' +
                '<tr class="bg-gray-50">' +
                '<td colspan="5" class="px-3 py-3 text-center text-gray-500">' +
                '... 1,242ëª… ë” ë³´ê¸° ...' +
                '</td>' +
                '</tr>' +
                '</tbody>' +
                '</table>' +
                '</div>' +
                '</div>';
            
            document.getElementById('attackResult').classList.remove('hidden');
            document.getElementById('attackResultContent').innerHTML = 
                '<div class="text-cyan-400 mb-2">ğŸ“Š ìˆ˜ì§‘í•œ ë°ì´í„°:</div>' +
                '<div class="text-green-400">ì´ ì„ì§ì›: 1,247ëª…</div>' +
                '<div class="border-t border-gray-700 my-2"></div>' +
                '<div class="text-yellow-400 mb-2">ğŸ” ë…¸ì¶œëœ ì •ë³´:</div>' +
                '<div class="text-gray-300 text-xs space-y-1">' +
                '<div>â€¢ ì‚¬ë²ˆ (uid)</div>' +
                '<div>â€¢ ì´ë¦„ (cn)</div>' +
                '<div>â€¢ ë¶€ì„œ (department)</div>' +
                '<div>â€¢ ì§ê¸‰ (title)</div>' +
                '<div>â€¢ ì´ë©”ì¼ (mail)</div>' +
                '<div>â€¢ ì „í™”ë²ˆí˜¸ (telephoneNumber)</div>' +
                '<div>â€¢ ì§ì† ìƒì‚¬ (manager)</div>' +
                '</div>' +
                '<div class="border-t border-gray-700 my-2"></div>' +
                '<div class="text-orange-400 mb-2">âš¡ 2ì°¨ ê³µê²© ê°€ëŠ¥:</div>' +
                '<div class="text-gray-300 text-xs">' +
                '<div>â€¢ ìŠ¤í”¼ì–´ í”¼ì‹± (ì´ë©”ì¼ íƒ€ê²ŸíŒ…)</div>' +
                '<div>â€¢ ì¡°ì§ë„ íŒŒì•… (ê¶Œí•œ êµ¬ì¡°)</div>' +
                '<div>â€¢ ì‚¬íšŒê³µí•™ ê³µê²©</div>' +
                '</div>';
            
            showResults('scenario2');
        }

        // ì‹œë‚˜ë¦¬ì˜¤ 3: ì†ì„± ì¡°ì‘
        async function scenario3_AttributeManipulation() {
            updateStep('ğŸ¯ ì‹œë‚˜ë¦¬ì˜¤ 3: LDAP ì†ì„± ì¡°ì‘ - ê¶Œí•œ ë³€ì¡°');
            await sleep(1000);
            
            updateStep('1ï¸âƒ£ ì¼ë°˜ ì‚¬ìš©ìë¡œ ë¡œê·¸ì¸');
            document.getElementById('attackerStatus').textContent = 'ì¼ë°˜ ê³„ì • ë¡œê·¸ì¸...';
            
            await addLdapLog('[INFO] Login request', 'text-blue-400');
            await sleep(300);
            await addLdapLog('[AUTH] User: user123', 'text-gray-400');
            await sleep(300);
            await addLdapLog('[SUCCESS] Authentication successful', 'text-green-400');
            await sleep(500);
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-md mx-auto mt-10 text-center">' +
                '<i class="fas fa-user text-blue-600 text-6xl mb-4"></i>' +
                '<h2 class="text-xl font-bold text-gray-800">ì¼ë°˜ ì‚¬ìš©ì</h2>' +
                '<p class="text-gray-600">user123 (ì˜ì—…íŒ€)</p>' +
                '<div class="mt-4 bg-gray-100 p-3 rounded">' +
                '<p class="text-sm text-gray-600">ê¶Œí•œ: <span class="text-blue-600 font-bold">USER</span></p>' +
                '</div>' +
                '</div>';
            
            await sleep(2000);
            
            updateStep('2ï¸âƒ£ í”„ë¡œí•„ ìˆ˜ì • í˜ì´ì§€ì—ì„œ LDAP Injection');
            document.getElementById('attackerStatus').textContent = 'ì†ì„± ì¡°ì‘ ì‹œë„...';
            document.getElementById('browserUrl').textContent = 'https://intranet.xxbank.com/profile';
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-2xl mx-auto mt-6">' +
                '<h2 class="text-2xl font-bold mb-6 text-gray-800">í”„ë¡œí•„ ìˆ˜ì •</h2>' +
                '<div class="bg-red-50 p-6 rounded-lg border-2 border-red-300">' +
                '<div class="grid grid-cols-2 gap-4 mb-4">' +
                '<div>' +
                '<label class="block text-sm font-medium text-gray-700 mb-1">ì´ë¦„</label>' +
                '<input type="text" class="w-full border border-gray-300 rounded px-3 py-2" value="í™ê¸¸ë™">' +
                '</div>' +
                '<div>' +
                '<label class="block text-sm font-medium text-gray-700 mb-1">ë¶€ì„œ</label>' +
                '<input type="text" class="w-full border border-red-300 rounded px-3 py-2 code-font text-sm bg-yellow-50" value="ì˜ì—…íŒ€)(role=ADMIN">' +
                '<p class="text-xs text-red-600 mt-1">âš ï¸ Injection í˜ì´ë¡œë“œ</p>' +
                '</div>' +
                '</div>' +
                '<button class="bg-red-600 text-white px-6 py-2 rounded hover:bg-red-700">ì €ì¥</button>' +
                '</div>' +
                '</div>';
            
            await sleep(2000);
            
            updateStep('3ï¸âƒ£ <span class="text-red-500 font-bold">LDAP ìˆ˜ì • í•„í„° ì¡°ì‘!</span>');
            
            document.getElementById('ldapQuery').classList.remove('hidden');
            document.getElementById('ldapQueryContent').innerHTML = 
                '<div class="text-cyan-400 mb-2">ğŸ“ ì›ë˜ LDAP ìˆ˜ì • ì¿¼ë¦¬:</div>' +
                '<div class="text-green-400 text-xs">(&(uid=user123)(department=ì˜ì—…íŒ€))</div>' +
                '<div class="border-t border-gray-700 my-2"></div>' +
                '<div class="text-yellow-400 mb-2">ğŸ’€ ì¡°ì‘ëœ ì¿¼ë¦¬:</div>' +
                '<div class="text-red-400 text-xs">(&(uid=user123)(department=ì˜ì—…íŒ€)(role=ADMIN))</div>' +
                '<div class="border-t border-gray-700 my-2"></div>' +
                '<div class="text-orange-400 mb-2">ğŸ” ì˜ë¯¸:</div>' +
                '<div class="text-gray-300 text-xs">' +
                '<div>â€¢ ë¶€ì„œ í•„ë“œë¥¼ ë‹«ê³ </div>' +
                '<div>â€¢ role ì†ì„± ì¶”ê°€ ì‚½ì…</div>' +
                '<div class="text-red-400 mt-2">â†’ ê¶Œí•œì„ ADMINìœ¼ë¡œ ë³€ì¡°!</div>' +
                '</div>';
            
            await addLdapLog('');
            await addLdapLog('[MODIFY] Request received', 'text-blue-400');
            await sleep(500);
            await addLdapLog('[FILTER] (&(uid=user123)(department=ì˜ì—…íŒ€)(role=ADMIN))', 'text-yellow-400');
            await sleep(500);
            await addLdapLog('[WARN] Suspicious attribute modification!', 'text-orange-400');
            await sleep(300);
            await addLdapLog('[PROCESSING] Parsing modification...', 'text-cyan-400');
            await sleep(800);
            await addLdapLog('[MODIFY] DN: uid=user123,ou=people,dc=xxbank,dc=com', 'text-blue-400');
            await sleep(300);
            await addLdapLog('[MODIFY] department: ì˜ì—…íŒ€', 'text-green-400');
            await sleep(300);
            await addLdapLog('[MODIFY] role: USER â†’ ADMIN', 'text-red-400');
            await sleep(500);
            await addLdapLog('[SUCCESS] Modification completed!', 'text-green-400');
            await sleep(1000);
            
            updateStep('4ï¸âƒ£ <span class="text-green-500 font-bold">ê¶Œí•œ ìƒìŠ¹ ì„±ê³µ!</span>');
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-2xl mx-auto mt-6">' +
                '<div class="bg-green-50 border-2 border-green-300 rounded-lg p-6 mb-4">' +
                '<div class="flex items-center gap-2 mb-4 text-green-700">' +
                '<i class="fas fa-check-circle text-3xl"></i>' +
                '<h3 class="text-2xl font-bold">í”„ë¡œí•„ ìˆ˜ì • ì™„ë£Œ</h3>' +
                '</div>' +
                '<div class="bg-white p-4 rounded border border-gray-300">' +
                '<div class="grid grid-cols-2 gap-3 mb-4">' +
                '<div class="bg-gray-100 p-3 rounded">' +
                '<p class="text-xs text-gray-600">ì´ì „ ê¶Œí•œ</p>' +
                '<p class="text-lg font-bold text-gray-800">USER</p>' +
                '</div>' +
                '<div class="bg-red-100 p-3 rounded">' +
                '<p class="text-xs text-gray-600">í˜„ì¬ ê¶Œí•œ</p>' +
                '<p class="text-lg font-bold text-red-600">ADMIN</p>' +
                '</div>' +
                '</div>' +
                '<div class="bg-yellow-50 border border-yellow-300 p-3 rounded">' +
                '<p class="text-sm text-yellow-800">' +
                '<i class="fas fa-exclamation-triangle mr-2"></i>' +
                'ê¶Œí•œì´ ê´€ë¦¬ìë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤!' +
                '</p>' +
                '</div>' +
                '</div>' +
                '</div>' +
                '<div class="text-center text-gray-500 text-sm mb-4">í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì„¸ìš”</div>' +
                '<div class="grid grid-cols-3 gap-3">' +
                '<button class="bg-red-600 text-white py-3 rounded">' +
                '<i class="fas fa-users mr-2"></i>ì‚¬ìš©ì ê´€ë¦¬' +
                '</button>' +
                '<button class="bg-orange-600 text-white py-3 rounded">' +
                '<i class="fas fa-database mr-2"></i>DB ì ‘ê·¼' +
                '</button>' +
                '<button class="bg-purple-600 text-white py-3 rounded">' +
                '<i class="fas fa-cog mr-2"></i>ì‹œìŠ¤í…œ ì„¤ì •' +
                '</button>' +
                '</div>' +
                '</div>';
            
            document.getElementById('attackResult').classList.remove('hidden');
            document.getElementById('attackResultContent').innerHTML = 
                '<div class="text-cyan-400 mb-2">ğŸ”¼ ê¶Œí•œ ìƒìŠ¹:</div>' +
                '<div class="text-gray-400">USER â†’ <span class="text-red-400 font-bold">ADMIN</span></div>' +
                '<div class="border-t border-gray-700 my-2"></div>' +
                '<div class="text-yellow-400 mb-2">ğŸ”“ íšë“í•œ ê¶Œí•œ:</div>' +
                '<div class="text-gray-300 text-xs space-y-1">' +
                '<div>â€¢ ê´€ë¦¬ì í˜ì´ì§€ ì ‘ê·¼</div>' +
                '<div>â€¢ ì „ì²´ ì‚¬ìš©ì ì¡°íšŒ/ìˆ˜ì •</div>' +
                '<div>â€¢ ì‹œìŠ¤í…œ ì„¤ì • ë³€ê²½</div>' +
                '<div>â€¢ ê°ì‚¬ ë¡œê·¸ ì ‘ê·¼</div>' +
                '</div>' +
                '<div class="border-t border-gray-700 my-2"></div>' +
                '<div class="text-orange-400 mb-2">âš¡ ì¶”ê°€ ê³µê²© ê°€ëŠ¥:</div>' +
                '<div class="text-gray-300 text-xs">' +
                '<div>â€¢ ë‹¤ë¥¸ ì‚¬ìš©ì ê¶Œí•œ ì¡°ì‘</div>' +
                '<div>â€¢ ë°±ë„ì–´ ê³„ì • ìƒì„±</div>' +
                '<div>â€¢ ê°ì‚¬ ë¡œê·¸ ì‚­ì œ</div>' +
                '</div>';
            
            showResults('scenario3');
        }

        function showResults(scenario) {
            document.getElementById('problemBox').classList.remove('hidden');
            
            let problems = '';
            if (scenario === 'scenario1') {
                problems = 
                    '<div class="bg-black bg-opacity-30 p-3 rounded">' +
                    '<p class="font-bold mb-2">âŒ ì¸ì¦ ìš°íšŒ ë¬¸ì œ:</p>' +
                    '<div class="space-y-1 ml-4">' +
                    '<div>1. ì‚¬ìš©ì ì…ë ¥ì„ LDAP í•„í„°ì— ì§ì ‘ ì—°ê²°</div>' +
                    '<div>2. íŠ¹ìˆ˜ë¬¸ì ì´ìŠ¤ì¼€ì´í”„ ì—†ìŒ</div>' +
                    '<div>3. )(&(password=*)) ì‚½ì…ìœ¼ë¡œ ìš°íšŒ</div>' +
                    '<div>4. ë¹„ë°€ë²ˆí˜¸ ê²€ì¦ ë¬´ë ¥í™”</div>' +
                    '</div></div>' +
                    '<div class="bg-black bg-opacity-30 p-3 rounded mt-2">' +
                    '<p class="font-bold mb-2">ğŸ’¥ ì˜ˆìƒ í”¼í•´:</p>' +
                    '<div class="space-y-1 ml-4">' +
                    '<div>â€¢ ê´€ë¦¬ì ê³„ì • íƒˆì·¨</div>' +
                    '<div>â€¢ ì „ì²´ ì‹œìŠ¤í…œ ì¥ì•…</div>' +
                    '<div>â€¢ ì„ì§ì› ì •ë³´ ìœ ì¶œ</div>' +
                    '<div>â€¢ ê°ì‚¬ ë¡œê·¸ ì‚­ì œ</div>' +
                    '</div></div>';
            } else if (scenario === 'scenario2') {
                problems = 
                    '<div class="bg-black bg-opacity-30 p-3 rounded">' +
                    '<p class="font-bold mb-2">âŒ ëŒ€ëŸ‰ ì¡°íšŒ ë¬¸ì œ:</p>' +
                    '<div class="space-y-1 ml-4">' +
                    '<div>1. ì™€ì¼ë“œì¹´ë“œ(*) ì…ë ¥ í—ˆìš©</div>' +
                    '<div>2. ê²€ìƒ‰ ê²°ê³¼ ì œí•œ ì—†ìŒ</div>' +
                    '<div>3. (cn=*) í•„í„°ë¡œ ì „ì²´ ì¡°íšŒ</div>' +
                    '<div>4. ë¯¼ê°ì •ë³´ í•„í„°ë§ ì—†ìŒ</div>' +
                    '</div></div>' +
                    '<div class="bg-black bg-opacity-30 p-3 rounded mt-2">' +
                    '<p class="font-bold mb-2">ğŸ’¥ ì˜ˆìƒ í”¼í•´:</p>' +
                    '<div class="space-y-1 ml-4">' +
                    '<div>â€¢ 1,247ëª… ì „ì²´ ì •ë³´ ìœ ì¶œ</div>' +
                    '<div>â€¢ ì¡°ì§ë„ íŒŒì•…</div>' +
                    '<div>â€¢ ìŠ¤í”¼ì–´ í”¼ì‹± íƒ€ê²ŸíŒ…</div>' +
                    '<div>â€¢ ì‚¬íšŒê³µí•™ ê³µê²© ìë£Œ</div>' +
                    '</div></div>';
            } else {
                problems = 
                    '<div class="bg-black bg-opacity-30 p-3 rounded">' +
                    '<p class="font-bold mb-2">âŒ ì†ì„± ì¡°ì‘ ë¬¸ì œ:</p>' +
                    '<div class="space-y-1 ml-4">' +
                    '<div>1. ìˆ˜ì • í•„í„° ê²€ì¦ ì—†ìŒ</div>' +
                    '<div>2. role ì†ì„± ì‚½ì… ê°€ëŠ¥</div>' +
                    '<div>3. ê¶Œí•œ ë³€ì¡° ì°¨ë‹¨ ì—†ìŒ</div>' +
                    '<div>4. ì†ì„± ë³€ê²½ ìŠ¹ì¸ ì ˆì°¨ ì—†ìŒ</div>' +
                    '</div></div>' +
                    '<div class="bg-black bg-opacity-30 p-3 rounded mt-2">' +
                    '<p class="font-bold mb-2">ğŸ’¥ ì˜ˆìƒ í”¼í•´:</p>' +
                    '<div class="space-y-1 ml-4">' +
                    '<div>â€¢ ê¶Œí•œ ìƒìŠ¹ (USER â†’ ADMIN)</div>' +
                    '<div>â€¢ ê´€ë¦¬ì ê¸°ëŠ¥ ì ‘ê·¼</div>' +
                    '<div>â€¢ ë°±ë„ì–´ ê³„ì • ìƒì„±</div>' +
                    '<div>â€¢ ì˜êµ¬ì  ì‹œìŠ¤í…œ ì¥ì•…</div>' +
                    '</div></div>';
            }
            
            document.getElementById('problemContent').innerHTML = problems;
        }

        function updateStep(html) {
            const steps = document.getElementById('attackSteps');
            const div = document.createElement('div');
            div.className = 'p-2 bg-gray-700 rounded text-sm slide-in';
            div.innerHTML = html;
            steps.appendChild(div);
            steps.scrollTop = steps.scrollHeight;
        }

        async function addLdapLog(message, colorClass = 'text-green-400') {
            const div = document.createElement('div');
            div.className = colorClass;
            div.textContent = message;
            const container = document.getElementById('ldapLog');
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
            await sleep(50);
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
    </script>
</body>
</html>