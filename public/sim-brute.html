<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¸ˆìœµê¶Œ Brute Force ì‹¤ì „ ì‹œë®¬ë ˆì´í„°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        .code-font { font-family: 'Courier New', monospace; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
        .animate-blink { animation: blink 1s infinite; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
        .animate-shake { animation: shake 0.3s; }
    </style>
</head>
<body class="bg-gray-900 p-4">

    <!-- íƒ€ì´í‹€ -->
    <div class="max-w-7xl mx-auto mb-4">
        <div class="bg-gradient-to-r from-red-600 to-orange-600 text-white p-4 rounded-lg shadow-lg">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <i class="fas fa-lock text-3xl"></i>
                    <div>
                        <h1 class="font-bold text-xl">ê¸ˆìœµê¶Œ Brute Force ê³µê²© ì‹¤ì „ ì‹œë‚˜ë¦¬ì˜¤</h1>
                        <p class="text-sm">WEB-SER-032: ì¸ì¦ ì˜¤ë¥˜ íšŸìˆ˜ ì œí•œ | ìœ„í—˜ë„: 5 (ë§¤ìš° ë†’ìŒ) | ì „ìê¸ˆìœµ: 5íšŒ ì´ë‚´ ì œí•œ í•„ìˆ˜</p>
                    </div>
                </div>
                <button onclick="resetAll()" class="bg-white text-red-600 px-4 py-2 rounded font-bold hover:bg-gray-100">
                    <i class="fas fa-redo"></i> ì²˜ìŒë¶€í„°
                </button>
            </div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-2 gap-4">
        
        <!-- ì¢Œì¸¡: ê³µê²©ì í™”ë©´ -->
        <div class="space-y-4">
            
            <!-- ê³µê²©ì ê´€ì  -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg border-2 border-red-500">
                <div class="flex items-center gap-3 mb-3">
                    <i class="fas fa-user-secret text-red-400 text-2xl"></i>
                    <div>
                        <h2 class="font-bold text-lg">ğŸ”´ ê³µê²©ì í™”ë©´</h2>
                        <p class="text-sm text-gray-400">ìë™í™” ë„êµ¬ë¡œ ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²©</p>
                    </div>
                </div>
                
                <!-- ê³µê²©ì ë¸Œë¼ìš°ì € -->
                <div class="bg-gray-900 rounded-lg overflow-hidden">
                    <!-- ë¸Œë¼ìš°ì € í¬ë¡¬ -->
                    <div class="bg-gray-700 px-3 py-2 flex items-center gap-2">
                        <div class="flex gap-1">
                            <div class="w-2 h-2 rounded-full bg-red-500"></div>
                            <div class="w-2 h-2 rounded-full bg-yellow-500"></div>
                            <div class="w-2 h-2 rounded-full bg-green-500"></div>
                        </div>
                        <input type="text" id="attackerUrl" 
                               class="flex-1 bg-gray-800 text-white px-3 py-1 rounded text-xs code-font" 
                               value="https://xxbank.com/login"
                               readonly>
                    </div>
                    
                    <!-- ë¸Œë¼ìš°ì € ë‚´ìš© -->
                    <div id="attackerScreen" class="p-6 bg-white text-black min-h-[350px]">
                        <div class="text-center py-8">
                            <i class="fas fa-play-circle text-6xl text-blue-600 mb-4"></i>
                            <p class="text-gray-600">ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ê³µê²© í†µê³„ -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg">
                <h3 class="font-bold mb-3 flex items-center gap-2">
                    <i class="fas fa-chart-line text-yellow-400"></i>
                    ê³µê²© í†µê³„
                </h3>
                <div id="attackStats" class="grid grid-cols-2 gap-3 text-sm">
                    <div class="bg-gray-700 p-3 rounded">
                        <div class="text-gray-400 text-xs">ì´ ì‹œë„ íšŸìˆ˜</div>
                        <div class="text-2xl font-bold" id="totalAttempts">0</div>
                    </div>
                    <div class="bg-gray-700 p-3 rounded">
                        <div class="text-gray-400 text-xs">ì‹¤íŒ¨ íšŸìˆ˜</div>
                        <div class="text-2xl font-bold text-red-400" id="failedAttempts">0</div>
                    </div>
                    <div class="bg-gray-700 p-3 rounded">
                        <div class="text-gray-400 text-xs">ê²½ê³¼ ì‹œê°„</div>
                        <div class="text-xl font-bold text-cyan-400" id="elapsedTime">0s</div>
                    </div>
                    <div class="bg-gray-700 p-3 rounded">
                        <div class="text-gray-400 text-xs">ì´ˆë‹¹ ì‹œë„</div>
                        <div class="text-xl font-bold text-green-400" id="attemptsPerSec">0/s</div>
                    </div>
                </div>
            </div>

            <!-- ê³µê²© ë‹¨ê³„ -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg">
                <h3 class="font-bold mb-3 flex items-center gap-2">
                    <i class="fas fa-list-ol text-orange-400"></i>
                    ê³µê²© ì§„í–‰ ë‹¨ê³„
                </h3>
                <div id="attackSteps" class="space-y-2 text-sm max-h-[200px] overflow-auto">
                    <div class="text-gray-500">ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”...</div>
                </div>
            </div>

            <!-- ì‹œë‚˜ë¦¬ì˜¤ ì„ íƒ -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg">
                <h3 class="font-bold mb-3 flex items-center gap-2">
                    <i class="fas fa-flask text-red-400"></i>
                    ì‹¤ì „ ê³µê²© ì‹œë‚˜ë¦¬ì˜¤
                </h3>
                <div class="space-y-2">
                    <button onclick="startScenario(1)" 
                            class="w-full text-left bg-red-900 hover:bg-red-800 px-3 py-2 rounded text-sm transition">
                        <i class="fas fa-infinity"></i> <strong>ì‹œë‚˜ë¦¬ì˜¤ 1:</strong> ë¬´ì œí•œ ë¡œê·¸ì¸ ì‹œë„ (ê³„ì •ì ê¸ˆ ì—†ìŒ)
                    </button>
                    <button onclick="startScenario(2)" 
                            class="w-full text-left bg-orange-900 hover:bg-orange-800 px-3 py-2 rounded text-sm transition">
                        <i class="fas fa-robot"></i> <strong>ì‹œë‚˜ë¦¬ì˜¤ 2:</strong> ë”•ì…”ë„ˆë¦¬ ê³µê²© (ìë™í™”)
                    </button>
                    <button onclick="startScenario(3)" 
                            class="w-full text-left bg-purple-900 hover:bg-purple-800 px-3 py-2 rounded text-sm transition">
                        <i class="fas fa-clock"></i> <strong>ì‹œë‚˜ë¦¬ì˜¤ 3:</strong> íƒ€ì´ë° ê³µê²© (ì‘ë‹µì‹œê°„ ë¶„ì„)
                    </button>
                </div>
            </div>

            <!-- ì·¨ì•½í•œ ì½”ë“œ -->
            <div class="bg-gray-900 text-white p-4 rounded-lg shadow-lg border border-red-500">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="font-bold text-red-400">
                        <i class="fas fa-bug"></i> ì·¨ì•½í•œ ì„œë²„ ì½”ë“œ
                    </h3>
                    <span class="text-xs bg-red-600 px-2 py-1 rounded">ë¬¸ì œ ì›ì¸</span>
                </div>
                <pre class="code-font text-xs overflow-x-auto"><code><span class="text-gray-500"># Python Flask</span>
@app.route('/login', methods=['POST'])
def login():
    username = request.form['username']
    password = request.form['password']
    
    user = User.query.filter_by(
        username=username
    ).first()
    
    <span class="text-red-400"># âŒ ë¬¸ì œì  1: ë¹„ë°€ë²ˆí˜¸ ë¬´ì œí•œ ì‹œë„!</span>
    <span class="text-red-400"># âŒ ë¬¸ì œì  2: ê³„ì • ì ê¸ˆ ì—†ìŒ!</span>
    <span class="text-red-400"># âŒ ë¬¸ì œì  3: ë”œë ˆì´ ì—†ìŒ!</span>
    
    if user and user.password == password:
        return {"status": "success"}
    else:
        return {"status": "fail"}

<span class="text-gray-500"># Java Spring</span>
@PostMapping("/login")
public ResponseEntity login(
    @RequestParam String username,
    @RequestParam String password) {
    
    User user = userRepository
        .findByUsername(username);
    
    <span class="text-red-400">// âŒ ì‹¤íŒ¨ íšŸìˆ˜ ì²´í¬ ì—†ìŒ!</span>
    if (user != null && 
        user.getPassword().equals(password)) {
        return ResponseEntity.ok()
            .body("success");
    }
    
    return ResponseEntity.status(401)
        .body("fail");
}</code></pre>
            </div>

        </div>

        <!-- ìš°ì¸¡: ì„œë²„ í™”ë©´ -->
        <div class="space-y-4">
            
            <!-- ì„œë²„ ê´€ì  -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg border-2 border-green-500">
                <div class="flex items-center gap-3 mb-3">
                    <i class="fas fa-server text-green-400 text-2xl"></i>
                    <div>
                        <h2 class="font-bold text-lg">ğŸŸ¢ ì„œë²„ ë‚´ë¶€</h2>
                        <p class="text-sm text-gray-400">XXì€í–‰ ì¸ì¦ ì„œë²„ ì²˜ë¦¬ ê³¼ì •</p>
                    </div>
                </div>
                
                <!-- ì„œë²„ ì²˜ë¦¬ ê³¼ì • -->
                <div class="bg-gray-900 rounded-lg p-4 min-h-[350px] max-h-[400px] overflow-auto">
                    <div id="serverLog" class="code-font text-xs space-y-1 text-green-400">
                        <div class="text-gray-500">[SERVER] Waiting for request...</div>
                    </div>
                </div>
                
                <!-- ì„œë²„ ìƒíƒœ -->
                <div class="mt-3 flex justify-between items-center">
                    <span class="text-xs text-gray-400">ì„œë²„ ìƒíƒœ:</span>
                    <span id="serverStatus" class="text-xs bg-blue-600 px-3 py-1 rounded">IDLE</span>
                </div>
            </div>

            <!-- ì¸ì¦ ì‹œë„ DB í…Œì´ë¸” -->
            <div id="dbTable" class="hidden bg-gray-800 text-white p-4 rounded-lg shadow-lg">
                <div class="flex items-center gap-2 mb-3">
                    <i class="fas fa-table text-purple-400"></i>
                    <h3 class="font-bold">login_attempts í…Œì´ë¸” (ì‹¤ì‹œê°„)</h3>
                </div>
                <div class="bg-gray-900 p-3 rounded overflow-auto">
                    <table class="w-full text-xs code-font">
                        <thead class="text-cyan-400 border-b border-gray-700">
                            <tr>
                                <th class="text-left p-2">username</th>
                                <th class="text-left p-2">attempts</th>
                                <th class="text-left p-2">locked</th>
                                <th class="text-left p-2">last_try</th>
                            </tr>
                        </thead>
                        <tbody id="dbTableBody" class="text-gray-300">
                            <tr>
                                <td colspan="4" class="text-center p-3 text-gray-500">ë°ì´í„° ì—†ìŒ</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ë¬¸ì œì  ë¶„ì„ -->
            <div id="problemBox" class="hidden bg-red-900 text-white p-4 rounded-lg shadow-lg">
                <div class="flex items-center gap-2 mb-3">
                    <i class="fas fa-exclamation-triangle text-yellow-400 text-xl animate-blink"></i>
                    <h3 class="font-bold">ğŸš¨ ë¬¸ì œì  ë¶„ì„</h3>
                </div>
                <div id="problemContent" class="text-sm space-y-2"></div>
            </div>

            <!-- ê³µê²© ì„±ê³µ -->
            <div id="successBox" class="hidden bg-green-900 text-white p-4 rounded-lg shadow-lg border-2 border-green-400">
                <div class="flex items-center gap-2 mb-3">
                    <i class="fas fa-unlock text-green-400 text-xl"></i>
                    <h3 class="font-bold">ğŸ¯ ê³µê²© ì„±ê³µ!</h3>
                </div>
                <div id="successContent" class="text-sm"></div>
            </div>

            <!-- ì•ˆì „í•œ ì½”ë“œ -->
            <div class="bg-gray-900 text-white p-4 rounded-lg shadow-lg border border-green-500">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="font-bold text-green-400">
                        <i class="fas fa-shield-halved"></i> ì•ˆì „í•œ ì„œë²„ ì½”ë“œ
                    </h3>
                    <span class="text-xs bg-green-600 px-2 py-1 rounded">í•´ê²°ì±…</span>
                </div>
                <pre class="code-font text-xs overflow-x-auto max-h-[500px]"><code><span class="text-gray-500"># Python Flask - ì•ˆì „í•œ ë¡œê·¸ì¸</span>
from datetime import datetime, timedelta
from flask_limiter import Limiter

<span class="text-green-400"># âœ… Rate Limiter ì„¤ì •</span>
limiter = Limiter(
    app,
    default_limits=["5 per minute"]
)

@app.route('/login', methods=['POST'])
@limiter.limit("5 per minute")  <span class="text-green-400"># 1ë¶„ì— 5íšŒ ì œí•œ</span>
def login():
    username = request.form['username']
    password = request.form['password']
    
    <span class="text-green-400"># âœ… 1ë‹¨ê³„: ê³„ì • ì ê¸ˆ í™•ì¸</span>
    attempt = LoginAttempt.query.filter_by(
        username=username
    ).first()
    
    if attempt:
        <span class="text-green-400"># 5íšŒ ì‹¤íŒ¨ ì‹œ ê³„ì • ì ê¸ˆ</span>
        if attempt.failed_count >= 5:
            if attempt.locked_until > datetime.now():
                return {
                    "status": "locked",
                    "message": "ê³„ì •ì´ ì ê²¼ìŠµë‹ˆë‹¤. " +
                        "30ë¶„ í›„ ì‹œë„í•˜ì„¸ìš”."
                }, 403
            else:
                <span class="text-green-400"># ì ê¸ˆ ì‹œê°„ ê²½ê³¼ - ë¦¬ì…‹</span>
                attempt.failed_count = 0
                attempt.locked_until = None
    else:
        attempt = LoginAttempt(username=username)
        db.session.add(attempt)
    
    <span class="text-green-400"># âœ… 2ë‹¨ê³„: ì‚¬ìš©ì ì¸ì¦</span>
    user = User.query.filter_by(
        username=username
    ).first()
    
    if user and check_password_hash(
        user.password, password):
        
        <span class="text-green-400"># ì„±ê³µ - ì‹œë„ íšŸìˆ˜ ë¦¬ì…‹</span>
        attempt.failed_count = 0
        attempt.last_success = datetime.now()
        db.session.commit()
        
        session['user_id'] = user.id
        return {"status": "success"}
    
    <span class="text-green-400"># âœ… 3ë‹¨ê³„: ì‹¤íŒ¨ ì²˜ë¦¬</span>
    attempt.failed_count += 1
    attempt.last_attempt = datetime.now()
    
    <span class="text-green-400"># 5íšŒ ì‹¤íŒ¨ ì‹œ 30ë¶„ ì ê¸ˆ</span>
    if attempt.failed_count >= 5:
        attempt.locked_until = (
            datetime.now() + timedelta(minutes=30)
        )
    
    db.session.commit()
    
    <span class="text-green-400"># âœ… 4ë‹¨ê³„: ë¡œê¹…</span>
    logger.warning(
        f"Failed login: {username}, "
        f"attempts: {attempt.failed_count}, "
        f"ip: {request.remote_addr}"
    )
    
    <span class="text-green-400"># âœ… 5ë‹¨ê³„: ë”œë ˆì´ ì¶”ê°€ (íƒ€ì´ë° ê³µê²© ë°©ì–´)</span>
    time.sleep(2)  <span class="text-green-400"># 2ì´ˆ ë”œë ˆì´</span>
    
    return {
        "status": "fail",
        "remaining": max(0, 5 - attempt.failed_count)
    }, 401

<span class="text-gray-500"># Java Spring Security - ì•ˆì „í•œ ë¡œê·¸ì¸</span>
@PostMapping("/login")
public ResponseEntity&lt;LoginResponse&gt; login(
    @RequestParam String username,
    @RequestParam String password,
    HttpServletRequest request) {
    
    <span class="text-green-400">// âœ… 1ë‹¨ê³„: ê³„ì • ì ê¸ˆ í™•ì¸</span>
    LoginAttempt attempt = attemptRepository
        .findByUsername(username)
        .orElseGet(() -> {
            LoginAttempt newAttempt = 
                new LoginAttempt();
            newAttempt.setUsername(username);
            return attemptRepository
                .save(newAttempt);
        });
    
    <span class="text-green-400">// 5íšŒ ì‹¤íŒ¨ ì‹œ ì ê¸ˆ</span>
    if (attempt.getFailedCount() >= 5) {
        if (attempt.getLockedUntil() != null &&
            attempt.getLockedUntil()
                .isAfter(LocalDateTime.now())) {
            
            return ResponseEntity
                .status(HttpStatus.FORBIDDEN)
                .body(new LoginResponse(
                    "locked",
                    "ê³„ì •ì´ ì ê²¼ìŠµë‹ˆë‹¤"
                ));
        }
        <span class="text-green-400">// ì ê¸ˆ ì‹œê°„ ê²½ê³¼</span>
        attempt.setFailedCount(0);
        attempt.setLockedUntil(null);
    }
    
    <span class="text-green-400">// âœ… 2ë‹¨ê³„: ì‚¬ìš©ì ì¸ì¦</span>
    User user = userRepository
        .findByUsername(username)
        .orElse(null);
    
    if (user != null && passwordEncoder
        .matches(password, user.getPassword())) {
        
        <span class="text-green-400">// ì„±ê³µ - ë¦¬ì…‹</span>
        attempt.setFailedCount(0);
        attempt.setLastSuccess(
            LocalDateTime.now()
        );
        attemptRepository.save(attempt);
        
        <span class="text-green-400">// ì„¸ì…˜ ìƒì„±</span>
        String token = jwtUtil.generateToken(user);
        return ResponseEntity.ok(
            new LoginResponse("success", token)
        );
    }
    
    <span class="text-green-400">// âœ… 3ë‹¨ê³„: ì‹¤íŒ¨ ì²˜ë¦¬</span>
    attempt.setFailedCount(
        attempt.getFailedCount() + 1
    );
    attempt.setLastAttempt(LocalDateTime.now());
    
    if (attempt.getFailedCount() >= 5) {
        attempt.setLockedUntil(
            LocalDateTime.now().plusMinutes(30)
        );
    }
    
    attemptRepository.save(attempt);
    
    <span class="text-green-400">// âœ… 4ë‹¨ê³„: ë¡œê¹…</span>
    auditLogger.logFailedLogin(
        username,
        request.getRemoteAddr(),
        attempt.getFailedCount()
    );
    
    <span class="text-green-400">// âœ… 5ë‹¨ê³„: ë”œë ˆì´</span>
    Thread.sleep(2000);
    
    return ResponseEntity
        .status(HttpStatus.UNAUTHORIZED)
        .body(new LoginResponse(
            "fail",
            "ë¡œê·¸ì¸ ì‹¤íŒ¨ (" + 
            (5 - attempt.getFailedCount()) +
            "íšŒ ë‚¨ìŒ)"
        ));
}

<span class="text-gray-500">// DB ìŠ¤í‚¤ë§ˆ</span>
CREATE TABLE login_attempts (
    id BIGINT PRIMARY KEY,
    username VARCHAR(255) NOT NULL,
    failed_count INT DEFAULT 0,
    locked_until TIMESTAMP,
    last_attempt TIMESTAMP,
    last_success TIMESTAMP,
    UNIQUE(username)
);</code></pre>
            </div>

        </div>
    </div>

    <script>
        const COMMON_PASSWORDS = [
            'password', '123456', 'password123', 'admin123', '12345678',
            'qwerty', 'abc123', 'password1', 'admin', '1234567890',
            '123123', '111111', 'welcome', 'monkey', 'dragon'
        ];

        const TARGET_USER = {
            username: 'admin',
            password: 'admin123'  // ì•½í•œ ë¹„ë°€ë²ˆí˜¸
        };

        let isRunning = false;
        let totalAttempts = 0;
        let failedAttempts = 0;
        let startTime = null;
        let statsInterval = null;

        function resetAll() {
            isRunning = false;
            totalAttempts = 0;
            failedAttempts = 0;
            startTime = null;
            
            if (statsInterval) {
                clearInterval(statsInterval);
                statsInterval = null;
            }
            
            document.getElementById('attackerUrl').value = 'https://xxbank.com/login';
            document.getElementById('attackerScreen').innerHTML = 
                '<div class="text-center py-8">' +
                '<i class="fas fa-play-circle text-6xl text-blue-600 mb-4"></i>' +
                '<p class="text-gray-600">ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>' +
                '</div>';
            document.getElementById('serverLog').innerHTML = 
                '<div class="text-gray-500">[SERVER] Waiting for request...</div>';
            document.getElementById('serverStatus').textContent = 'IDLE';
            document.getElementById('serverStatus').className = 'text-xs bg-blue-600 px-3 py-1 rounded';
            document.getElementById('attackSteps').innerHTML = 
                '<div class="text-gray-500">ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”...</div>';
            
            document.getElementById('totalAttempts').textContent = '0';
            document.getElementById('failedAttempts').textContent = '0';
            document.getElementById('elapsedTime').textContent = '0s';
            document.getElementById('attemptsPerSec').textContent = '0/s';
            
            document.getElementById('dbTable').classList.add('hidden');
            document.getElementById('problemBox').classList.add('hidden');
            document.getElementById('successBox').classList.add('hidden');
        }

        async function startScenario(scenario) {
            if (isRunning) return;
            isRunning = true;
            
            resetAll();
            await sleep(300);
            
            startTime = Date.now();
            statsInterval = setInterval(updateStats, 100);
            
            if (scenario === 1) {
                await scenario1_UnlimitedAttempts();
            } else if (scenario === 2) {
                await scenario2_DictionaryAttack();
            } else if (scenario === 3) {
                await scenario3_TimingAttack();
            }
            
            if (statsInterval) {
                clearInterval(statsInterval);
                statsInterval = null;
            }
            
            isRunning = false;
        }

        function updateStats() {
            if (!startTime) return;
            
            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            document.getElementById('elapsedTime').textContent = elapsed + 's';
            
            const rate = elapsed > 0 ? (totalAttempts / elapsed).toFixed(1) : '0';
            document.getElementById('attemptsPerSec').textContent = rate + '/s';
        }

        // ì‹œë‚˜ë¦¬ì˜¤ 1: ë¬´ì œí•œ ë¡œê·¸ì¸ ì‹œë„
        async function scenario1_UnlimitedAttempts() {
            updateStep('ğŸ¯ ì‹œë‚˜ë¦¬ì˜¤ 1: ë¬´ì œí•œ ë¡œê·¸ì¸ ì‹œë„ (ê³„ì •ì ê¸ˆ ì—†ìŒ)');
            await sleep(1000);
            
            updateStep('1ï¸âƒ£ ê³µê²©ìê°€ admin ê³„ì •ì„ íƒ€ê²Ÿìœ¼ë¡œ ì„¤ì •');
            
            // ë¡œê·¸ì¸ í™”ë©´ í‘œì‹œ
            showLoginScreen();
            await sleep(1000);
            
            updateStep('2ï¸âƒ£ <span class="text-red-400">ìë™í™” ìŠ¤í¬ë¦½íŠ¸ë¡œ ë¬´ì°¨ë³„ ëŒ€ì… ì‹œì‘!</span>');
            
            await addServerLog('[SERVER] Login endpoint active', 'text-green-400');
            await sleep(300);
            await addServerLog('[WARNING] No rate limiting configured!', 'text-yellow-400');
            await sleep(500);
            
            document.getElementById('dbTable').classList.remove('hidden');
            updateServerStatus('UNDER_ATTACK', 'bg-red-600 animate-pulse');
            
            // ì—¬ëŸ¬ ë¹„ë°€ë²ˆí˜¸ ì‹œë„
            const passwords = ['password', 'admin', '123456', 'password123', 'admin123'];
            
            for (let i = 0; i < passwords.length; i++) {
                const pwd = passwords[i];
                totalAttempts++;
                
                // ê³µê²©ì í™”ë©´ ì—…ë°ì´íŠ¸
                showLoginAttempt('admin', pwd, totalAttempts);
                
                await addServerLog(`[REQUEST] POST /login (attempt ${totalAttempts})`, 'text-blue-400');
                await sleep(100);
                await addServerLog(`[AUTH] username=admin, password=${pwd}`, 'text-gray-400');
                await sleep(200);
                
                // DB ì¡°íšŒ
                await addServerLog('[SQL] SELECT * FROM users WHERE username=\'admin\'', 'text-cyan-400');
                await sleep(200);
                await addServerLog('[DATABASE] User found: admin', 'text-cyan-400');
                await sleep(200);
                await addServerLog('[AUTH] Checking password...', 'text-yellow-400');
                await sleep(300);
                
                if (pwd === TARGET_USER.password) {
                    // ì„±ê³µ!
                    await addServerLog('[AUTH] âœ“ Password matched!', 'text-green-400 font-bold');
                    await sleep(300);
                    await addServerLog('[SESSION] Creating session...', 'text-green-400');
                    await sleep(300);
                    await addServerLog('[CRITICAL] Login successful without rate limit!', 'text-red-500 font-bold');
                    
                    updateStep(`3ï¸âƒ£ <span class="text-green-400 font-bold">âœ“ ${totalAttempts}ë²ˆì§¸ ì‹œë„ì—ì„œ ì„±ê³µ!</span>`);
                    
                    showSuccessScreen();
                    break;
                } else {
                    // ì‹¤íŒ¨
                    failedAttempts++;
                    await addServerLog('[AUTH] âœ— Password mismatch', 'text-red-400');
                    await sleep(200);
                    await addServerLog('[CRITICAL] No attempt counter!', 'text-red-500');
                    await sleep(200);
                    await addServerLog('[RESPONSE] 401 Unauthorized', 'text-red-400');
                    await sleep(400);
                    
                    updateDBTable('admin', failedAttempts, false);
                    updateCounters();
                }
            }
            
            // ë¬¸ì œì  ë¶„ì„
            document.getElementById('problemBox').classList.remove('hidden');
            document.getElementById('problemContent').innerHTML = 
                '<div class="bg-black bg-opacity-30 p-3 rounded">' +
                '<p class="font-bold mb-2">âŒ ë°œê²¬ëœ ë¬¸ì œì :</p>' +
                '<div class="space-y-1 ml-4">' +
                '<div>1. ë¡œê·¸ì¸ ì‹¤íŒ¨ íšŸìˆ˜ ì¹´ìš´íŠ¸ ì—†ìŒ</div>' +
                '<div>2. ê³„ì • ì ê¸ˆ ë©”ì»¤ë‹ˆì¦˜ ì—†ìŒ</div>' +
                '<div>3. Rate limiting (ì†ë„ ì œí•œ) ì—†ìŒ</div>' +
                '<div>4. ë”œë ˆì´ ì—†ì–´ ì´ˆë‹¹ ìˆ˜ë°± íšŒ ì‹œë„ ê°€ëŠ¥</div>' +
                '<div>5. CAPTCHA ì—†ìŒ</div>' +
                '</div></div>' +
                '<div class="bg-black bg-opacity-30 p-3 rounded mt-2">' +
                '<p class="font-bold mb-2">ğŸ’¥ ì‹¤ì œ í”¼í•´:</p>' +
                '<div class="space-y-1 ml-4">' +
                '<div>â€¢ ë‹¨ ' + totalAttempts + 'íšŒ ì‹œë„ë¡œ ê´€ë¦¬ì ê³„ì • íƒˆì·¨</div>' +
                '<div>â€¢ ì•½í•œ ë¹„ë°€ë²ˆí˜¸ ì‚¬ìš© ì‹œ ìˆ˜ì´ˆ ë‚´ ëš«ë¦¼</div>' +
                '<div>â€¢ ì „ìê¸ˆìœµê°ë…ê·œì • ìœ„ë°˜ (5íšŒ ì œí•œ í•„ìˆ˜)</div>' +
                '</div></div>';
        }

        // ì‹œë‚˜ë¦¬ì˜¤ 2: ë”•ì…”ë„ˆë¦¬ ê³µê²©
        async function scenario2_DictionaryAttack() {
            updateStep('ğŸ¯ ì‹œë‚˜ë¦¬ì˜¤ 2: ë”•ì…”ë„ˆë¦¬ ê³µê²© (ìë™í™”)');
            await sleep(1000);
            
            updateStep('1ï¸âƒ£ ê³µê²©ìê°€ ì¼ë°˜ì ì¸ ë¹„ë°€ë²ˆí˜¸ ëª©ë¡ ì¤€ë¹„');
            
            document.getElementById('attackerScreen').innerHTML = 
                '<div class="p-6">' +
                '<h2 class="text-xl font-bold mb-4 text-red-600">Brute Force ë„êµ¬</h2>' +
                '<div class="bg-gray-900 text-green-400 p-4 rounded code-font text-xs">' +
                '<div class="text-yellow-400">$ hydra -l admin -P common_passwords.txt xxbank.com http-post-form</div>' +
                '<div class="mt-2">[*] Loaded 15 common passwords</div>' +
                '<div>[*] Target: admin@xxbank.com</div>' +
                '<div>[*] Starting attack...</div>' +
                '</div></div>';
            
            await sleep(1500);
            updateStep('2ï¸âƒ£ <span class="text-red-400">15ê°œ ì¼ë°˜ ë¹„ë°€ë²ˆí˜¸ë¡œ ìë™ ì‹œë„</span>');
            
            await addServerLog('[ALERT] Automated attack detected!', 'text-red-400');
            await sleep(300);
            await addServerLog('[WARNING] Multiple login attempts from same IP', 'text-yellow-400');
            await sleep(300);
            await addServerLog('[CRITICAL] No protection mechanism!', 'text-red-500 font-bold');
            await sleep(500);
            
            document.getElementById('dbTable').classList.remove('hidden');
            updateServerStatus('COMPROMISED', 'bg-red-600');
            
            // ë”•ì…”ë„ˆë¦¬ ê³µê²©
            for (let i = 0; i < COMMON_PASSWORDS.length; i++) {
                const pwd = COMMON_PASSWORDS[i];
                totalAttempts++;
                
                showLoginAttempt('admin', pwd, totalAttempts);
                
                await addServerLog(`[REQUEST] POST /login (${totalAttempts}/15)`, 'text-blue-400');
                await sleep(80);
                
                if (pwd === TARGET_USER.password) {
                    await addServerLog(`[AUTH] Testing: ${pwd}`, 'text-gray-400');
                    await sleep(150);
                    await addServerLog('[AUTH] âœ“ Match found!', 'text-green-400 font-bold');
                    await sleep(300);
                    await addServerLog('[BREACH] Account compromised!', 'text-red-500 font-bold');
                    
                    updateStep(`3ï¸âƒ£ <span class="text-red-500 font-bold">âœ“ ${totalAttempts}ë²ˆì§¸ ì‹œë„ ì„±ê³µ! ë¹„ë°€ë²ˆí˜¸: ${pwd}</span>`);
                    
                    showSuccessScreen();
                    break;
                } else {
                    failedAttempts++;
                    await addServerLog('[AUTH] âœ— Failed', 'text-red-400');
                    await sleep(50);
                    
                    updateDBTable('admin', failedAttempts, false);
                    updateCounters();
                }
            }
            
            document.getElementById('problemBox').classList.remove('hidden');
            document.getElementById('problemContent').innerHTML = 
                '<div class="bg-black bg-opacity-30 p-3 rounded">' +
                '<p class="font-bold mb-2">âŒ ë”•ì…”ë„ˆë¦¬ ê³µê²© ì„±ê³µ:</p>' +
                '<div class="space-y-1 ml-4">' +
                '<div>â€¢ ì¼ë°˜ì ì¸ ë¹„ë°€ë²ˆí˜¸ ì‚¬ìš© (admin123)</div>' +
                '<div>â€¢ 15ê°œ ëª©ë¡ ì¤‘ ' + totalAttempts + 'ë²ˆì§¸ì—ì„œ ë°œê²¬</div>' +
                '<div>â€¢ ê³„ì • ì ê¸ˆì´ ì—†ì–´ ë¬´ì œí•œ ì‹œë„</div>' +
                '<div>â€¢ ë¹„ë°€ë²ˆí˜¸ ë³µì¡ë„ ì •ì±… ì—†ìŒ</div>' +
                '</div></div>' +
                '<div class="bg-black bg-opacity-30 p-3 rounded mt-2">' +
                '<p class="font-bold mb-2">ğŸ›¡ï¸ í•„ìš”í•œ ë°©ì–´:</p>' +
                '<div class="space-y-1 ml-4">' +
                '<div>â€¢ 5íšŒ ì‹¤íŒ¨ ì‹œ ê³„ì • ì ê¸ˆ (30ë¶„)</div>' +
                '<div>â€¢ ë¹„ë°€ë²ˆí˜¸ ë³µì¡ë„: ì˜ë¬¸+ìˆ«ì+íŠ¹ìˆ˜ë¬¸ì</div>' +
                '<div>â€¢ CAPTCHA ì¶”ê°€</div>' +
                '<div>â€¢ ë¡œê·¸ì¸ ì‹œë„ë§ˆë‹¤ 2ì´ˆ ë”œë ˆì´</div>' +
                '</div></div>';
        }

        // ì‹œë‚˜ë¦¬ì˜¤ 3: íƒ€ì´ë° ê³µê²©
        async function scenario3_TimingAttack() {
            updateStep('ğŸ¯ ì‹œë‚˜ë¦¬ì˜¤ 3: íƒ€ì´ë° ê³µê²© (ì‘ë‹µì‹œê°„ ë¶„ì„)');
            await sleep(1000);
            
            updateStep('1ï¸âƒ£ ê³µê²©ìê°€ ì‘ë‹µ ì‹œê°„ì„ ì¸¡ì •í•˜ì—¬ ìœ íš¨ ê³„ì • íƒìƒ‰');
            
            document.getElementById('attackerScreen').innerHTML = 
                '<div class="p-6">' +
                '<h2 class="text-xl font-bold mb-4 text-purple-600">íƒ€ì´ë° ë¶„ì„</h2>' +
                '<div class="bg-gray-900 text-cyan-400 p-4 rounded code-font text-xs">' +
                '<div>[*] Testing username existence via timing...</div>' +
                '<div class="mt-2" id="timingResults"></div>' +
                '</div></div>';
            
            await sleep(1500);
            updateStep('2ï¸âƒ£ <span class="text-red-400">ê³„ì • ì¡´ì¬ ì—¬ë¶€ë¥¼ ì‘ë‹µ ì‹œê°„ìœ¼ë¡œ íŒë³„</span>');
            
            await addServerLog('[VULNERABILITY] Timing attack possible!', 'text-red-500 font-bold');
            await sleep(500);
            
            const testUsers = ['admin', 'user123', 'test', 'root', 'manager'];
            
            for (let username of testUsers) {
                totalAttempts++;
                
                await addServerLog(`[REQUEST] Testing: ${username}`, 'text-blue-400');
                await sleep(100);
                
                // ì‹¤ì œë¡œëŠ” ì¡´ì¬í•˜ëŠ” ê³„ì •ì˜ ì‘ë‹µì´ ëŠë¦¼ (ë¹„ë°€ë²ˆí˜¸ í•´ì‹œ ë¹„êµ ë•Œë¬¸)
                if (username === 'admin') {
                    await sleep(200);  // ì¡´ì¬í•˜ëŠ” ê³„ì • - ëŠë¦¼
                    await addServerLog('[TIMING] Response time: 245ms (USER EXISTS!)', 'text-red-400');
                    
                    const resultsDiv = document.getElementById('timingResults');
                    resultsDiv.innerHTML += `<div class="text-red-400">[âœ“] ${username}: 245ms â†’ ê³„ì • ì¡´ì¬!</div>`;
                } else {
                    await sleep(50);   // ì—†ëŠ” ê³„ì • - ë¹ ë¦„
                    await addServerLog(`[TIMING] Response time: 52ms (not found)`, 'text-gray-400');
                    
                    const resultsDiv = document.getElementById('timingResults');
                    resultsDiv.innerHTML += `<div class="text-gray-500">[âœ—] ${username}: 52ms</div>`;
                }
                
                await sleep(300);
                updateCounters();
            }
            
            updateStep('3ï¸âƒ£ <span class="text-red-500 font-bold">âœ“ admin ê³„ì • ì¡´ì¬ í™•ì¸! ì§‘ì¤‘ ê³µê²© ì‹œì‘</span>');
            await sleep(1000);
            
            // admin ê³„ì • ì§‘ì¤‘ ê³µê²©
            updateStep('4ï¸âƒ£ admin ê³„ì •ì— ëŒ€í•´ ë¹„ë°€ë²ˆí˜¸ ë¬´ì°¨ë³„ ëŒ€ì…');
            
            for (let i = 0; i < 3; i++) {
                const pwd = COMMON_PASSWORDS[i];
                totalAttempts++;
                
                showLoginAttempt('admin', pwd, totalAttempts);
                
                await addServerLog(`[ATTACK] admin / ${pwd}`, 'text-red-400');
                await sleep(150);
                
                if (pwd === TARGET_USER.password) {
                    await addServerLog('[BREACH] Password cracked!', 'text-red-500 font-bold');
                    showSuccessScreen();
                    break;
                }
                
                failedAttempts++;
                updateCounters();
                await sleep(300);
            }
            
            document.getElementById('problemBox').classList.remove('hidden');
            document.getElementById('problemContent').innerHTML = 
                '<div class="bg-black bg-opacity-30 p-3 rounded">' +
                '<p class="font-bold mb-2">âŒ íƒ€ì´ë° ê³µê²© ì·¨ì•½ì :</p>' +
                '<div class="space-y-1 ml-4">' +
                '<div>â€¢ ì¡´ì¬í•˜ëŠ” ê³„ì •: ë¹„ë°€ë²ˆí˜¸ í•´ì‹œ ë¹„êµ (ëŠë¦¼)</div>' +
                '<div>â€¢ ì—†ëŠ” ê³„ì •: ì¦‰ì‹œ ë°˜í™˜ (ë¹ ë¦„)</div>' +
                '<div>â€¢ ì‘ë‹µ ì‹œê°„ ì°¨ì´ë¡œ ê³„ì • ì¡´ì¬ ì—¬ë¶€ íŒë³„</div>' +
                '<div>â€¢ ìœ íš¨ ê³„ì • ì°¾ì€ í›„ ì§‘ì¤‘ ê³µê²© ê°€ëŠ¥</div>' +
                '</div></div>' +
                '<div class="bg-black bg-opacity-30 p-3 rounded mt-2">' +
                '<p class="font-bold mb-2">ğŸ›¡ï¸ ë°©ì–´ ë°©ë²•:</p>' +
                '<div class="space-y-1 ml-4">' +
                '<div>â€¢ ëª¨ë“  ë¡œê·¸ì¸ ì‹œë„ì— ê³ ì • ë”œë ˆì´ (2ì´ˆ)</div>' +
                '<div>â€¢ ê³„ì • ì¡´ì¬ ì—¬ë¶€ ë…¸ì¶œ ê¸ˆì§€</div>' +
                '<div>â€¢ "ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤" (í†µí•© ë©”ì‹œì§€)</div>' +
                '</div></div>';
        }

        function showLoginScreen() {
            document.getElementById('attackerScreen').innerHTML = 
                '<div class="max-w-md mx-auto mt-8">' +
                '<h2 class="text-xl font-bold mb-4">XXì€í–‰ ë¡œê·¸ì¸</h2>' +
                '<div class="space-y-3">' +
                '<input type="text" value="admin" class="w-full p-2 border rounded" readonly>' +
                '<input type="password" value="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" class="w-full p-2 border rounded" readonly>' +
                '<button class="w-full bg-blue-600 text-white py-2 rounded">ë¡œê·¸ì¸</button>' +
                '</div></div>';
        }

        function showLoginAttempt(username, password, attemptNum) {
            document.getElementById('attackerScreen').innerHTML = 
                '<div class="max-w-md mx-auto mt-8">' +
                '<div class="bg-red-100 border-2 border-red-500 p-3 rounded mb-4 animate-pulse">' +
                '<p class="text-red-700 font-bold text-center">' +
                '<i class="fas fa-robot"></i> ê³µê²© ì§„í–‰ ì¤‘... (ì‹œë„ ' + attemptNum + ')</p>' +
                '</div>' +
                '<h2 class="text-xl font-bold mb-4">XXì€í–‰ ë¡œê·¸ì¸</h2>' +
                '<div class="space-y-3">' +
                '<input type="text" value="' + username + '" class="w-full p-2 border-2 border-red-500 rounded bg-red-50" readonly>' +
                '<input type="text" value="' + password + '" class="w-full p-2 border-2 border-red-500 rounded bg-red-50 code-font" readonly>' +
                '<button class="w-full bg-red-600 text-white py-2 rounded">ì‹œë„ ì¤‘...</button>' +
                '</div></div>';
        }

        function showSuccessScreen() {
            document.getElementById('attackerScreen').innerHTML = 
                '<div class="max-w-md mx-auto mt-8">' +
                '<div class="bg-green-100 border-2 border-green-500 p-4 rounded mb-4">' +
                '<p class="text-green-700 font-bold text-center text-xl">' +
                '<i class="fas fa-check-circle"></i> ë¡œê·¸ì¸ ì„±ê³µ!</p>' +
                '</div>' +
                '<h2 class="text-xl font-bold mb-4">XXì€í–‰ ê´€ë¦¬ì í˜ì´ì§€</h2>' +
                '<div class="bg-blue-50 p-4 rounded">' +
                '<p class="font-bold mb-2">í™˜ì˜í•©ë‹ˆë‹¤, ê´€ë¦¬ìë‹˜</p>' +
                '<div class="text-sm space-y-1">' +
                '<div>â€¢ ì „ì²´ ê³ ê° ê³„ì¢Œ ì¡°íšŒ ê°€ëŠ¥</div>' +
                '<div>â€¢ ê±°ë˜ ìŠ¹ì¸ ê¶Œí•œ</div>' +
                '<div>â€¢ ì‹œìŠ¤í…œ ì„¤ì • ë³€ê²½ ê°€ëŠ¥</div>' +
                '</div></div>' +
                '<div class="mt-4 p-3 bg-red-100 border border-red-500 rounded">' +
                '<p class="text-sm text-red-700">ğŸš¨ <strong>ê´€ë¦¬ì ê³„ì • íƒˆì·¨ ì™„ë£Œ!</strong><br>' +
                'ê³µê²©ìê°€ ì „ì²´ ì‹œìŠ¤í…œì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>' +
                '</div></div>';
            
            document.getElementById('successBox').classList.remove('hidden');
            document.getElementById('successContent').innerHTML = 
                '<div class="bg-black bg-opacity-30 p-3 rounded">' +
                '<p class="font-bold mb-2">ğŸ¯ ê³µê²© ê²°ê³¼:</p>' +
                '<div class="space-y-1 ml-4">' +
                '<div>â€¢ ê³„ì •: admin</div>' +
                '<div>â€¢ ë¹„ë°€ë²ˆí˜¸: admin123 (í¬ë™ë¨)</div>' +
                '<div>â€¢ ì´ ì‹œë„: ' + totalAttempts + 'íšŒ</div>' +
                '<div>â€¢ ì†Œìš” ì‹œê°„: ' + Math.floor((Date.now() - startTime) / 1000) + 'ì´ˆ</div>' +
                '<div>â€¢ ê¶Œí•œ: ê´€ë¦¬ì (ì „ì²´ ì ‘ê·¼)</div>' +
                '</div></div>';
        }

        function updateDBTable(username, attempts, locked) {
            const tbody = document.getElementById('dbTableBody');
            tbody.innerHTML = 
                '<tr class="border-b border-gray-700">' +
                '<td class="p-2">' + username + '</td>' +
                '<td class="p-2 text-red-400 font-bold">' + attempts + '</td>' +
                '<td class="p-2">' + (locked ? '<span class="text-red-500">âœ“ LOCKED</span>' : '<span class="text-gray-500">âœ—</span>') + '</td>' +
                '<td class="p-2 text-gray-400">' + new Date().toLocaleTimeString() + '</td>' +
                '</tr>';
        }

        function updateCounters() {
            document.getElementById('totalAttempts').textContent = totalAttempts;
            document.getElementById('failedAttempts').textContent = failedAttempts;
        }

        function updateStep(html) {
            const steps = document.getElementById('attackSteps');
            const div = document.createElement('div');
            div.className = 'p-2 bg-gray-700 rounded text-sm';
            div.innerHTML = html;
            steps.appendChild(div);
            steps.scrollTop = steps.scrollHeight;
        }

        async function addServerLog(message, colorClass) {
            const div = document.createElement('div');
            div.className = colorClass || 'text-gray-400';
            div.textContent = '> ' + message;
            const container = document.getElementById('serverLog');
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
            await sleep(50);
        }

        function updateServerStatus(text, className) {
            document.getElementById('serverStatus').textContent = text;
            document.getElementById('serverStatus').className = 'text-xs text-white px-3 py-1 rounded ' + className;
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
    </script>
</body>
</html>