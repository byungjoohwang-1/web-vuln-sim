<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>OS Command Injection Simulation</title>
    <script src="config.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; max-width: 800px; margin: 0 auto;}
        .container { display: flex; gap: 20px; }
        .box { flex: 1; border: 1px solid #ddd; padding: 20px; border-radius: 8px; }
        .vuln { background-color: #ffe6e6; }
        .secure { background-color: #e6fffa; }
        input { width: 100%; padding: 8px; margin: 10px 0; box-sizing: border-box; }
        button { padding: 8px 16px; cursor: pointer; }
        
        .code-section { margin-top: 40px; border-top: 2px solid #eee; padding-top: 20px; }
        details { background: #f9f9f9; margin-bottom: 10px; border-radius: 5px; border: 1px solid #ddd; }
        summary { padding: 10px; cursor: pointer; font-weight: bold; }
        pre { background: #333; color: #fff; padding: 15px; overflow-x: auto; }
        .comment { color: #999; }
    </style>
</head>
<body>
    <a href="index.html">â† Main Menu</a>
    <h1>ğŸ’» ìš´ì˜ì²´ì œ ëª…ë ¹ì–´ ì‚½ì… (OS Command Injection)</h1>

    <div style="background:#f4f7f9; padding:15px; margin-bottom:20px; border-left:5px solid #007bff;">
        <h3>ğŸ“˜ ì·¨ì•½ì  ê°œìš” (Overview)</h3>
        <p><strong>[KR]</strong> ì™¸ë¶€ ì…ë ¥ê°’ì„ ì‹œìŠ¤í…œ ëª…ë ¹ì–´ì˜ ì¼ë¶€ë¡œ ì‚¬ìš©í•  ë•Œ, <code>;</code>, <code>|</code>, <code>&</code> ê°™ì€ êµ¬ë¶„ìë¥¼ ì´ìš©í•´ ì•…ì˜ì ì¸ ëª…ë ¹ì–´ë¥¼ ì¶”ê°€ë¡œ ì‹¤í–‰í•˜ëŠ” ê³µê²©ì…ë‹ˆë‹¤.</p>
        <p><strong>[EN]</strong> An attack that executes arbitrary system commands by injecting shell metacharacters (e.g., ; | &) into inputs used in OS commands.</p>
    </div>
    
    <div class="container">
        <!-- ì·¨ì•½í•œ ëª¨ë“œ -->
        <div class="box vuln">
            <h2>ğŸš« ì·¨ì•½í•œ ëª¨ë“œ</h2>
            <p>ê¸°ëŠ¥: Ping í…ŒìŠ¤íŠ¸</p>
            <p>[KR] ê³µê²©: <code>8.8.8.8; ls -al</code> ì…ë ¥ (íŒŒì¼ ëª©ë¡ í›”ì³ë³´ê¸°)</p>
            <input type="text" id="vulnInput" value="8.8.8.8; ls -al">
            <button onclick="runTest('vulnerableCmd', 'vulnInput')">Run Attack</button>
        </div>

        <!-- ì•ˆì „í•œ ëª¨ë“œ -->
        <div class="box secure">
            <h2>âœ… ì•ˆì „í•œ ëª¨ë“œ</h2>
            <p>[KR] ë°©ì–´: ì…ë ¥ê°’ íŒ¨í„´(IPì£¼ì†Œ) ê²€ì¦</p>
            <p>[EN] Defense: Validate Input Pattern (Allow IP only)</p>
            <input type="text" id="secureInput" value="8.8.8.8; ls -al">
            <button onclick="runTest('secureCmd', 'secureInput')">Run Secure</button>
        </div>
    </div>

    <div class="code-section">
        <h2>ğŸ“š ì–¸ì–´ë³„ ì‹œíì–´ ì½”ë”© ê°€ì´ë“œ</h2>
        
        <!-- Python ì˜ˆì œ -->
        <details>
            <summary>ğŸ Python</summary>
            <pre><code><span class="comment"># [KR] shell=True ì˜µì…˜ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³ , ì…ë ¥ê°’ì„ ë¦¬ìŠ¤íŠ¸ë¡œ ë¶„ë¦¬í•˜ì—¬ ì „ë‹¬í•œë‹¤.</span>
<span class="comment"># [EN] Do not use shell=True, pass arguments as a list.</span>

import subprocess

ip = request.POST.get('ip')

<span class="comment"># âŒ ì·¨ì•½ (Vulnerable): ì‰˜ì—ì„œ ë¬¸ìì—´ë¡œ ì‹¤í–‰</span>
<span class="comment"># subprocess.call("ping -c 1 " + ip, shell=True)</span>

<span class="comment"># âœ… ì•ˆì „ (Secure): ì‹¤í–‰ íŒŒì¼ê³¼ ì¸ìë¥¼ ë¶„ë¦¬</span>
subprocess.call(["ping", "-c", "1", ip])</code></pre>
        </details>

        <!-- Java ì˜ˆì œ -->
        <details>
            <summary>â˜• Java</summary>
            <pre><code><span class="comment">// [KR] Runtime.exec() ì‚¬ìš© ì‹œ ë¬¸ìì—´ í•˜ë‚˜ë¡œ ì „ë‹¬í•˜ì§€ ë§ê³  ë°°ì—´ë¡œ ì „ë‹¬í•œë‹¤.</span>
<span class="comment">// [EN] Pass command and arguments as an array to Runtime.exec().</span>

String ip = request.getParameter("ip");

<span class="comment">// âŒ ì·¨ì•½ (Vulnerable)</span>
<span class="comment">// Runtime.getRuntime().exec("ping " + ip);</span>

<span class="comment">// âœ… ì•ˆì „ (Secure): ëª…ë ¹ì–´ì™€ ì¸ìë¥¼ ë¶„ë¦¬</span>
String[] cmd = new String[] { "/bin/ping", "-c", "1", ip };
Runtime.getRuntime().exec(cmd);</code></pre>
        </details>
    </div>

    <script>
        function runTest(funcName, inputId) {
            const inputVal = document.getElementById(inputId).value;
            // ì„¸ë¯¸ì½œë¡  ë“± íŠ¹ìˆ˜ë¬¸ì ì „ì†¡ì„ ìœ„í•´ ì¸ì½”ë”©
            const encodedInput = encodeURIComponent(inputVal);
            const url = `${BASE_URL}/${funcName}?ip=${encodedInput}`;
            window.open(url, '_blank');
        }
    </script>
</body>
</html>