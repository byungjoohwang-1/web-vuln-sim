<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¸ˆìœµê¶Œ ì—ëŸ¬ ë©”ì‹œì§€ ì •ë³´ë…¸ì¶œ ì‹¤ì „ ì‹œë®¬ë ˆì´í„°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        .code-font { font-family: 'Courier New', monospace; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
        .animate-blink { animation: blink 1s infinite; }
        @keyframes slideIn { from { transform: translateX(-20px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        .slide-in { animation: slideIn 0.5s ease-out; }
    </style>
</head>
<body class="bg-gray-900 p-4">

    <!-- íƒ€ì´í‹€ -->
    <div class="max-w-7xl mx-auto mb-4">
        <div class="bg-gradient-to-r from-orange-600 to-red-600 text-white p-4 rounded-lg shadow-lg">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <i class="fas fa-exclamation-triangle text-3xl"></i>
                    <div>
                        <h1 class="font-bold text-xl">ê¸ˆìœµê¶Œ ì—ëŸ¬ ë©”ì‹œì§€ ì •ë³´ë…¸ì¶œ ì‹¤ì „ ì‹œë‚˜ë¦¬ì˜¤</h1>
                        <p class="text-sm">WEB-SER-031: ì‹œìŠ¤í…œ ìš´ì˜ì •ë³´ ë…¸ì¶œ | ìœ„í—˜ë„: 4 (ë†’ìŒ)</p>
                    </div>
                </div>
                <button onclick="resetAll()" class="bg-white text-orange-600 px-4 py-2 rounded font-bold hover:bg-gray-100">
                    <i class="fas fa-redo"></i> ì²˜ìŒë¶€í„°
                </button>
            </div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-2 gap-4">
        
        <!-- ì¢Œì¸¡: ê³µê²©ì í™”ë©´ -->
        <div class="space-y-4">
            
            <!-- ê³µê²©ì ë¸Œë¼ìš°ì € -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg border-2 border-red-500">
                <div class="flex items-center gap-3 mb-3">
                    <i class="fas fa-user-secret text-red-400 text-2xl"></i>
                    <div>
                        <h2 class="font-bold text-lg">ğŸ”´ ê³µê²©ì (í•´ì»¤)</h2>
                        <p class="text-sm text-gray-400" id="attackerStatus">ì—ëŸ¬ ìœ ë°œ ì¤€ë¹„ ì¤‘...</p>
                    </div>
                </div>
                
                <!-- ë¸Œë¼ìš°ì € í™”ë©´ -->
                <div class="bg-white rounded-lg overflow-hidden">
                    <div class="bg-gray-300 px-3 py-2 flex items-center gap-2">
                        <div class="flex gap-1">
                            <div class="w-2 h-2 rounded-full bg-red-500"></div>
                            <div class="w-2 h-2 rounded-full bg-yellow-500"></div>
                            <div class="w-2 h-2 rounded-full bg-green-500"></div>
                        </div>
                        <div class="flex-1 bg-white rounded px-2 py-1">
                            <span class="text-xs text-gray-600 code-font" id="browserUrl">https://xxbank.com/login</span>
                        </div>
                        <button class="text-gray-600 text-xs"><i class="fas fa-sync"></i></button>
                    </div>
                    
                    <div id="browserScreen" class="p-4 bg-white text-gray-900 min-h-[400px] max-h-[450px] overflow-auto">
                        <div class="text-center text-gray-400 py-20">
                            <i class="fas fa-globe text-6xl mb-4"></i>
                            <p>ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ìˆ˜ì§‘í•œ ì •ë³´ -->
            <div id="collectedInfo" class="hidden bg-red-900 text-white p-4 rounded-lg shadow-lg border-2 border-red-500">
                <div class="flex items-center gap-2 mb-3">
                    <i class="fas fa-database text-red-400 text-xl animate-pulse"></i>
                    <h3 class="font-bold">ğŸ”“ ìˆ˜ì§‘í•œ ì‹œìŠ¤í…œ ì •ë³´</h3>
                </div>
                <div id="collectedContent" class="bg-black p-3 rounded code-font text-xs"></div>
            </div>

            <!-- ê³µê²© ë‹¨ê³„ -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg">
                <h3 class="font-bold mb-3 flex items-center gap-2">
                    <i class="fas fa-list-ol text-orange-400"></i>
                    ê³µê²© ì§„í–‰ ë‹¨ê³„
                </h3>
                <div id="attackSteps" class="space-y-2 text-sm max-h-[250px] overflow-auto">
                    <div class="text-gray-500">ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”...</div>
                </div>
            </div>

            <!-- ì‹œë‚˜ë¦¬ì˜¤ ì„ íƒ -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg">
                <h3 class="font-bold mb-3 flex items-center gap-2">
                    <i class="fas fa-flask text-red-400"></i>
                    ì‹¤ì „ ê³µê²© ì‹œë‚˜ë¦¬ì˜¤
                </h3>
                <div class="space-y-2">
                    <button onclick="startScenario(1)" 
                            class="w-full text-left bg-red-900 hover:bg-red-800 px-3 py-2 rounded text-sm transition">
                        <i class="fas fa-bug"></i> <strong>ì‹œë‚˜ë¦¬ì˜¤ 1:</strong> ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ ë…¸ì¶œ (DB ì •ë³´)
                    </button>
                    <button onclick="startScenario(2)" 
                            class="w-full text-left bg-orange-900 hover:bg-orange-800 px-3 py-2 rounded text-sm transition">
                        <i class="fas fa-database"></i> <strong>ì‹œë‚˜ë¦¬ì˜¤ 2:</strong> SQL ì—ëŸ¬ ë©”ì‹œì§€ (í…Œì´ë¸” êµ¬ì¡°)
                    </button>
                    <button onclick="startScenario(3)" 
                            class="w-full text-left bg-purple-900 hover:bg-purple-800 px-3 py-2 rounded text-sm transition">
                        <i class="fas fa-folder-open"></i> <strong>ì‹œë‚˜ë¦¬ì˜¤ 3:</strong> ê²½ë¡œ ì •ë³´ ë…¸ì¶œ (ì„œë²„ êµ¬ì¡°)
                    </button>
                </div>
            </div>

            <!-- ì·¨ì•½í•œ ì½”ë“œ -->
            <div class="bg-gray-900 text-white p-4 rounded-lg shadow-lg border border-red-500">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="font-bold text-red-400">
                        <i class="fas fa-bug"></i> ì·¨ì•½í•œ ì½”ë“œ (ìƒì„¸ ì—ëŸ¬ ë…¸ì¶œ)
                    </h3>
                    <span class="text-xs bg-red-600 px-2 py-1 rounded">ë¬¸ì œ ì›ì¸</span>
                </div>
                <pre class="code-font text-xs overflow-x-auto max-h-[600px]"><code><span class="text-gray-500">// Java Spring - ì·¨ì•½í•œ ì—ëŸ¬ ì²˜ë¦¬</span>

@RestController
public class LoginController {
    
    @PostMapping("/login")
    public ResponseEntity login(@RequestBody LoginDTO dto) {
        try {
            User user = userService.login(
                dto.getUsername(), 
                dto.getPassword()
            );
            return ResponseEntity.ok(user);
            
        } catch (Exception e) {
            <span class="text-red-400">// âŒ ì „ì²´ ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ ë…¸ì¶œ!</span>
            e.printStackTrace();
            
            <span class="text-red-400">// âŒ ìƒì„¸ ì—ëŸ¬ ë©”ì‹œì§€ ë°˜í™˜!</span>
            return ResponseEntity
                .status(HttpStatus.INTERNAL_SERVER_ERROR)
                .body("Error: " + e.getMessage() + 
                      "\nCause: " + e.getCause() + 
                      "\nStack: " + e.getStackTrace()[0]);
        }
    }
}

@Service
public class UserService {
    
    @Autowired
    private DataSource dataSource;
    
    public User login(String username, String password) {
        try {
            <span class="text-red-400">// âŒ DB ì—°ê²° ì‹¤íŒ¨ ì‹œ ì •ë³´ ë…¸ì¶œ</span>
            Connection conn = dataSource.getConnection();
            
            String sql = "SELECT * FROM users " +
                        "WHERE username = ? AND password = ?";
            
            PreparedStatement stmt = conn.prepareStatement(sql);
            stmt.setString(1, username);
            stmt.setString(2, password);
            
            ResultSet rs = stmt.executeQuery();
            
            if (rs.next()) {
                return new User(rs);
            } else {
                <span class="text-red-400">// âŒ êµ¬ì²´ì  ì—ëŸ¬ ë©”ì‹œì§€</span>
                throw new Exception(
                    "Login failed: User not found for username=" 
                    + username
                );
            }
            
        } catch (SQLException e) {
            <span class="text-red-400">// âŒ SQL ì—ëŸ¬ ìƒì„¸ ë…¸ì¶œ!</span>
            throw new RuntimeException(
                "Database error: " + e.getMessage() +
                "\nSQL State: " + e.getSQLState() +
                "\nError Code: " + e.getErrorCode()
            );
        }
    }
}

<span class="text-gray-500">// Python Flask - ì·¨ì•½í•œ ì—ëŸ¬ ì²˜ë¦¬</span>

@app.route('/transfer', methods=['POST'])
def transfer():
    try:
        from_account = request.json['from_account']
        to_account = request.json['to_account']
        amount = request.json['amount']
        
        <span class="text-red-400"># âŒ DB ì—°ê²° ì—ëŸ¬ ë…¸ì¶œ</span>
        conn = mysql.connector.connect(
            host='10.1.2.3',
            user='bank_admin',
            password='BankDB@2024',
            database='bank_prod'
        )
        
        cursor = conn.cursor()
        cursor.execute(
            "UPDATE accounts SET balance = balance - %s "
            "WHERE account_number = %s",
            (amount, from_account)
        )
        
        return jsonify({"status": "success"})
        
    except Exception as e:
        <span class="text-red-400"># âŒ ì „ì²´ ì—ëŸ¬ ì •ë³´ ë°˜í™˜!</span>
        return jsonify({
            "error": str(e),
            "type": type(e).__name__,
            "traceback": traceback.format_exc()
        }), 500

<span class="text-gray-500">// JavaScript/Node.js - ì·¨ì•½í•œ ì—ëŸ¬ ì²˜ë¦¬</span>

app.post('/api/accounts', async (req, res) => {
    try {
        const { accountNumber } = req.body;
        
        <span class="text-red-400">// âŒ íŒŒì¼ ê²½ë¡œ ë…¸ì¶œ</span>
        const configPath = path.join(
            __dirname, 
            '../../config/database.json'
        );
        
        const config = JSON.parse(
            fs.readFileSync(configPath, 'utf8')
        );
        
        const account = await getAccount(accountNumber);
        res.json(account);
        
    } catch (error) {
        <span class="text-red-400">// âŒ ìƒì„¸ ì—ëŸ¬ ìŠ¤íƒ ë…¸ì¶œ!</span>
        res.status(500).json({
            error: error.message,
            stack: error.stack,
            <span class="text-red-400">// âŒ ê°œë°œ ì •ë³´ ë…¸ì¶œ</span>
            env: process.env.NODE_ENV,
            version: process.version,
            platform: process.platform
        });
    }
});

<span class="text-gray-500">// application.properties - ì·¨ì•½í•œ ì„¤ì •</span>

<span class="text-red-400"># âŒ ê°œë°œ ëª¨ë“œë¡œ ìš´ì˜ (ìƒì„¸ ì—ëŸ¬ í‘œì‹œ)</span>
spring.profiles.active=dev

<span class="text-red-400"># âŒ ì—ëŸ¬ ìƒì„¸ì •ë³´ ë…¸ì¶œ</span>
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-stacktrace=always
server.error.include-exception=true

<span class="text-red-400"># âŒ ë””ë²„ê·¸ ëª¨ë“œ í™œì„±í™”</span>
debug=true
logging.level.root=DEBUG

<span class="text-red-400"># âŒ SQL ì¿¼ë¦¬ ë¡œê¹…</span>
spring.jpa.show-sql=true
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql=TRACE</code></pre>
            </div>

        </div>

        <!-- ìš°ì¸¡: ì„œë²„ & ë¶„ì„ -->
        <div class="space-y-4">
            
            <!-- ì„œë²„ ì—ëŸ¬ ë¡œê·¸ -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg border-2 border-orange-500">
                <div class="flex items-center gap-3 mb-3">
                    <i class="fas fa-server text-orange-400 text-2xl"></i>
                    <div>
                        <h2 class="font-bold text-lg">ğŸŸ  ì„œë²„ ì—ëŸ¬ ë¡œê·¸</h2>
                        <p class="text-sm text-gray-400">ìƒì„¸ ì—ëŸ¬ ë©”ì‹œì§€ ë…¸ì¶œ</p>
                    </div>
                </div>
                
                <!-- ì„œë²„ ë¡œê·¸ -->
                <div class="bg-black rounded-lg p-4 min-h-[400px] max-h-[500px] overflow-auto">
                    <div id="serverLog" class="code-font text-xs space-y-1 text-red-400">
                        <div class="text-gray-500">[SERVER] Waiting...</div>
                    </div>
                </div>
                
                <!-- ìƒíƒœ -->
                <div class="mt-3 flex justify-between items-center">
                    <span class="text-xs text-gray-400">ì„œë²„ ìƒíƒœ:</span>
                    <span id="serverStatus" class="text-xs bg-green-600 px-3 py-1 rounded">RUNNING</span>
                </div>
            </div>

            <!-- ê³µê²© ì„±ê³µ -->
            <div id="successBox" class="hidden bg-green-900 text-white p-4 rounded-lg shadow-lg border-2 border-green-400">
                <div class="flex items-center gap-2 mb-3">
                    <i class="fas fa-check-circle text-green-400 text-xl"></i>
                    <h3 class="font-bold">âœ… ì •ë³´ ìˆ˜ì§‘ ì„±ê³µ!</h3>
                </div>
                <div id="successContent" class="text-sm"></div>
            </div>

            <!-- ë¬¸ì œì  ë¶„ì„ -->
            <div id="problemBox" class="hidden bg-red-900 text-white p-4 rounded-lg shadow-lg">
                <div class="flex items-center gap-2 mb-3">
                    <i class="fas fa-exclamation-triangle text-yellow-400 text-xl animate-blink"></i>
                    <h3 class="font-bold">ğŸš¨ ë¬¸ì œì  ë¶„ì„</h3>
                </div>
                <div id="problemContent" class="text-sm space-y-2"></div>
            </div>

            <!-- ì•ˆì „í•œ ì½”ë“œ -->
            <div class="bg-gray-900 text-white p-4 rounded-lg shadow-lg border border-green-500">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="font-bold text-green-400">
                        <i class="fas fa-shield-halved"></i> ì•ˆì „í•œ ì½”ë“œ (ì—ëŸ¬ ì²˜ë¦¬)
                    </h3>
                    <span class="text-xs bg-green-600 px-2 py-1 rounded">í•´ê²°ì±…</span>
                </div>
                <pre class="code-font text-xs overflow-x-auto max-h-[900px]"><code><span class="text-gray-500">// Java Spring - ì•ˆì „í•œ ì—ëŸ¬ ì²˜ë¦¬</span>

<span class="text-green-400">// âœ… ì „ì—­ ì˜ˆì™¸ ì²˜ë¦¬ê¸°</span>
@RestControllerAdvice
public class GlobalExceptionHandler {
    
    private static final Logger logger = 
        LoggerFactory.getLogger(GlobalExceptionHandler.class);
    
    @ExceptionHandler(Exception.class)
    public ResponseEntity<ErrorResponse> handleException(
        Exception e, HttpServletRequest request
    ) {
        <span class="text-green-400">// ë‚´ë¶€ ë¡œê¹… (ìƒì„¸ ì •ë³´)</span>
        logger.error(
            "Error occurred: {} at {}", 
            e.getMessage(), 
            request.getRequestURI(), 
            e  // ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ëŠ” ë¡œê·¸ì—ë§Œ
        );
        
        <span class="text-green-400">// í´ë¼ì´ì–¸íŠ¸ ì‘ë‹µ (ì¼ë°˜ ë©”ì‹œì§€ë§Œ)</span>
        ErrorResponse response = new ErrorResponse(
            "ERR_INTERNAL_SERVER",
            "ì„œë¹„ìŠ¤ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",
            UUID.randomUUID().toString()  // ì¶”ì ìš© ID
        );
        
        return ResponseEntity
            .status(HttpStatus.INTERNAL_SERVER_ERROR)
            .body(response);
    }
    
    @ExceptionHandler(DataAccessException.class)
    public ResponseEntity<ErrorResponse> handleDataAccessException(
        DataAccessException e, HttpServletRequest request
    ) {
        <span class="text-green-400">// ìƒì„¸ ë¡œê¹… (ë‚´ë¶€ìš©)</span>
        logger.error(
            "Database error at {}: {}", 
            request.getRequestURI(),
            e.getMessage(),
            e
        );
        
        <span class="text-green-400">// ì¼ë°˜ì ì¸ ë©”ì‹œì§€ë§Œ ë°˜í™˜</span>
        ErrorResponse response = new ErrorResponse(
            "ERR_DATABASE",
            "ë°ì´í„°ë² ì´ìŠ¤ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",
            UUID.randomUUID().toString()
        );
        
        return ResponseEntity
            .status(HttpStatus.INTERNAL_SERVER_ERROR)
            .body(response);
    }
}

<span class="text-green-400">// âœ… í‘œì¤€í™”ëœ ì—ëŸ¬ ì‘ë‹µ</span>
public class ErrorResponse {
    private String errorCode;      // ì—ëŸ¬ ì½”ë“œ
    private String message;        // ì‚¬ìš©ì ë©”ì‹œì§€
    private String trackingId;     // ì¶”ì  ID
    private LocalDateTime timestamp;
    
    public ErrorResponse(
        String errorCode, 
        String message, 
        String trackingId
    ) {
        this.errorCode = errorCode;
        this.message = message;
        this.trackingId = trackingId;
        this.timestamp = LocalDateTime.now();
    }
    
    <span class="text-green-400">// getter/setter (ìƒì„¸ ì •ë³´ ì œì™¸)</span>
}

@Service
public class SecureUserService {
    
    private static final Logger logger = 
        LoggerFactory.getLogger(SecureUserService.class);
    
    @Autowired
    private UserRepository userRepository;
    
    public User login(String username, String password) {
        try {
            <span class="text-green-400">// Repository íŒ¨í„´ ì‚¬ìš© (DB ì •ë³´ ìˆ¨ê¹€)</span>
            Optional<User> user = userRepository
                .findByUsernameAndPassword(username, password);
            
            if (user.isPresent()) {
                return user.get();
            } else {
                <span class="text-green-400">// ì¼ë°˜ì ì¸ ì—ëŸ¬ ë©”ì‹œì§€</span>
                throw new AuthenticationException(
                    "ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤."
                );
            }
            
        } catch (DataAccessException e) {
            <span class="text-green-400">// ìƒì„¸ ì •ë³´ëŠ” ë¡œê·¸ì—ë§Œ</span>
            logger.error(
                "Database error during login for user: {}", 
                username, 
                e
            );
            
            <span class="text-green-400">// ì‚¬ìš©ìì—ê²ŒëŠ” ì¼ë°˜ ë©”ì‹œì§€</span>
            throw new ServiceException(
                "ë¡œê·¸ì¸ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."
            );
        }
    }
}

<span class="text-gray-500">// Python Flask - ì•ˆì „í•œ ì—ëŸ¬ ì²˜ë¦¬</span>

<span class="text-green-400"># âœ… ì „ì—­ ì—ëŸ¬ í•¸ë“¤ëŸ¬</span>
@app.errorhandler(Exception)
def handle_exception(e):
    <span class="text-green-400"># ìƒì„¸ ë¡œê¹… (ì„œë²„ì¸¡)</span>
    app.logger.error(
        f"Error: {str(e)}",
        exc_info=True  # ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ í¬í•¨
    )
    
    <span class="text-green-400"># ì¶”ì  ID ìƒì„±</span>
    tracking_id = str(uuid.uuid4())
    
    <span class="text-green-400"># ì¼ë°˜ ì‘ë‹µ (í´ë¼ì´ì–¸íŠ¸)</span>
    return jsonify({
        "error_code": "ERR_INTERNAL_SERVER",
        "message": "ì„œë¹„ìŠ¤ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",
        "tracking_id": tracking_id
    }), 500

@app.errorhandler(DatabaseError)
def handle_database_error(e):
    <span class="text-green-400"># ë¡œê·¸ì—ë§Œ ìƒì„¸ ì •ë³´</span>
    app.logger.error(
        f"Database error: {str(e)}",
        exc_info=True
    )
    
    <span class="text-green-400"># ì‚¬ìš©ìì—ê²ŒëŠ” ì¼ë°˜ ë©”ì‹œì§€</span>
    return jsonify({
        "error_code": "ERR_DATABASE",
        "message": "ë°ì´í„°ë² ì´ìŠ¤ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",
        "tracking_id": str(uuid.uuid4())
    }), 500

@app.route('/transfer', methods=['POST'])
def transfer():
    try:
        from_account = request.json.get('from_account')
        to_account = request.json.get('to_account')
        amount = request.json.get('amount')
        
        <span class="text-green-400"># ì…ë ¥ ê²€ì¦</span>
        if not all([from_account, to_account, amount]):
            return jsonify({
                "error_code": "ERR_INVALID_INPUT",
                "message": "í•„ìˆ˜ ì…ë ¥ê°’ì´ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤."
            }), 400
        
        <span class="text-green-400"># DB ì—°ê²° (í™˜ê²½ë³€ìˆ˜ ì‚¬ìš©)</span>
        conn = get_db_connection()  # ë‚´ë¶€ í•¨ìˆ˜
        
        cursor = conn.cursor()
        cursor.execute(
            "UPDATE accounts SET balance = balance - %s "
            "WHERE account_number = %s",
            (amount, from_account)
        )
        conn.commit()
        
        return jsonify({"status": "success"})
        
    except ValueError as e:
        <span class="text-green-400"># ì˜ˆìƒëœ ì—ëŸ¬ (ì‚¬ìš©ì ë©”ì‹œì§€)</span>
        app.logger.warning(f"Invalid input: {str(e)}")
        return jsonify({
            "error_code": "ERR_INVALID_INPUT",
            "message": "ì…ë ¥ê°’ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤."
        }), 400
        
    except Exception as e:
        <span class="text-green-400"># ì˜ˆìƒì¹˜ ëª»í•œ ì—ëŸ¬ (ì¼ë°˜ ë©”ì‹œì§€)</span>
        app.logger.error(f"Transfer error: {str(e)}", exc_info=True)
        return jsonify({
            "error_code": "ERR_TRANSFER_FAILED",
            "message": "ì†¡ê¸ˆ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."
        }), 500

<span class="text-green-400"># âœ… ì•ˆì „í•œ ë¡œê¹… ì„¤ì •</span>
import logging
from logging.handlers import RotatingFileHandler

<span class="text-green-400"># íŒŒì¼ ë¡œê¹… (ìƒì„¸ ì •ë³´)</span>
file_handler = RotatingFileHandler(
    'logs/app.log',
    maxBytes=10240000,
    backupCount=10
)
file_handler.setLevel(logging.ERROR)
file_handler.setFormatter(logging.Formatter(
    '[%(asctime)s] %(levelname)s in %(module)s: %(message)s'
))

app.logger.addHandler(file_handler)

<span class="text-gray-500">// JavaScript/Node.js - ì•ˆì „í•œ ì—ëŸ¬ ì²˜ë¦¬</span>

<span class="text-green-400">// âœ… ì „ì—­ ì—ëŸ¬ ë¯¸ë“¤ì›¨ì–´</span>
app.use((err, req, res, next) => {
    <span class="text-green-400">// ìƒì„¸ ë¡œê¹… (ì„œë²„ì¸¡)</span>
    console.error('Error:', {
        message: err.message,
        stack: err.stack,
        url: req.url,
        method: req.method,
        timestamp: new Date().toISOString()
    });
    
    <span class="text-green-400">// ì¶”ì  ID</span>
    const trackingId = require('uuid').v4();
    
    <span class="text-green-400">// ì¼ë°˜ ì‘ë‹µ (í´ë¼ì´ì–¸íŠ¸)</span>
    res.status(err.status || 500).json({
        error_code: err.code || 'ERR_INTERNAL_SERVER',
        message: err.userMessage || 
                'ì„œë¹„ìŠ¤ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.',
        tracking_id: trackingId
    });
});

app.post('/api/accounts', async (req, res, next) => {
    try {
        const { accountNumber } = req.body;
        
        <span class="text-green-400">// ì…ë ¥ ê²€ì¦</span>
        if (!accountNumber) {
            const error = new Error('Account number required');
            error.status = 400;
            error.code = 'ERR_INVALID_INPUT';
            error.userMessage = 'ê³„ì¢Œë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.';
            throw error;
        }
        
        <span class="text-green-400">// ì•ˆì „í•œ DB ì ‘ê·¼</span>
        const account = await getAccount(accountNumber);
        res.json(account);
        
    } catch (error) {
        <span class="text-green-400">// ì—ëŸ¬ í•¸ë“¤ëŸ¬ë¡œ ì „ë‹¬</span>
        next(error);
    }
});

<span class="text-green-400">// âœ… ì»¤ìŠ¤í…€ ì—ëŸ¬ í´ë˜ìŠ¤</span>
class ApplicationError extends Error {
    constructor(message, code, status, userMessage) {
        super(message);
        this.code = code;
        this.status = status;
        this.userMessage = userMessage;
    }
}

<span class="text-gray-500">// application.properties - ì•ˆì „í•œ ì„¤ì •</span>

<span class="text-green-400"># âœ… ìš´ì˜ ëª¨ë“œ (ìµœì†Œ ì •ë³´)</span>
spring.profiles.active=prod

<span class="text-green-400"># âœ… ì—ëŸ¬ ì •ë³´ ìµœì†Œí™”</span>
server.error.include-message=never
server.error.include-binding-errors=never
server.error.include-stacktrace=never
server.error.include-exception=false

<span class="text-green-400"># âœ… ìš´ì˜ í™˜ê²½ ë¡œê¹…</span>
debug=false
logging.level.root=WARN
logging.level.com.xxbank=INFO

<span class="text-green-400"># âœ… SQL ë¡œê¹… ë¹„í™œì„±í™”</span>
spring.jpa.show-sql=false
logging.level.org.hibernate.SQL=WARN

<span class="text-green-400"># âœ… ì—ëŸ¬ í˜ì´ì§€ ì»¤ìŠ¤í„°ë§ˆì´ì§•</span>
server.error.whitelabel.enabled=false
server.error.path=/error

<span class="text-gray-500">// logback-spring.xml - ì•ˆì „í•œ ë¡œê¹… ì„¤ì •</span>

&lt;configuration&gt;
    <span class="text-green-400">&lt;!-- íŒŒì¼ ë¡œê¹… (ìƒì„¸ ì •ë³´) --&gt;</span>
    &lt;appender name="FILE" 
        class="ch.qos.logback.core.rolling.RollingFileAppender"&gt;
        &lt;file&gt;logs/application.log&lt;/file&gt;
        &lt;encoder&gt;
            &lt;pattern&gt;
                %d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level 
                %logger{36} - %msg%n
            &lt;/pattern&gt;
        &lt;/encoder&gt;
        &lt;rollingPolicy 
            class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy"&gt;
            &lt;fileNamePattern&gt;
                logs/application-%d{yyyy-MM-dd}.log
            &lt;/fileNamePattern&gt;
            &lt;maxHistory&gt;30&lt;/maxHistory&gt;
        &lt;/rollingPolicy&gt;
    &lt;/appender&gt;
    
    <span class="text-green-400">&lt;!-- ì½˜ì†” ë¡œê¹… (ìµœì†Œ ì •ë³´) --&gt;</span>
    &lt;appender name="CONSOLE" 
        class="ch.qos.logback.core.ConsoleAppender"&gt;
        &lt;encoder&gt;
            &lt;pattern&gt;%d{HH:mm:ss} %-5level - %msg%n&lt;/pattern&gt;
        &lt;/encoder&gt;
    &lt;/appender&gt;
    
    &lt;root level="INFO"&gt;
        &lt;appender-ref ref="FILE" /&gt;
        &lt;appender-ref ref="CONSOLE" /&gt;
    &lt;/root&gt;
&lt;/configuration&gt;</code></pre>
            </div>

        </div>
    </div>

    <script>
        let isRunning = false;

        function resetAll() {
            isRunning = false;
            
            document.getElementById('attackerStatus').textContent = 'ì—ëŸ¬ ìœ ë°œ ì¤€ë¹„ ì¤‘...';
            document.getElementById('browserUrl').textContent = 'https://xxbank.com/login';
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="text-center text-gray-400 py-20">' +
                '<i class="fas fa-globe text-6xl mb-4"></i>' +
                '<p>ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”</p>' +
                '</div>';
            
            document.getElementById('serverLog').innerHTML = 
                '<div class="text-gray-500">[SERVER] Waiting...</div>';
            
            document.getElementById('serverStatus').textContent = 'RUNNING';
            document.getElementById('serverStatus').className = 'text-xs bg-green-600 px-3 py-1 rounded';
            
            document.getElementById('attackSteps').innerHTML = 
                '<div class="text-gray-500">ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”...</div>';
            
            document.getElementById('collectedInfo').classList.add('hidden');
            document.getElementById('problemBox').classList.add('hidden');
            document.getElementById('successBox').classList.add('hidden');
        }

        async function startScenario(scenario) {
            if (isRunning) return;
            isRunning = true;
            
            resetAll();
            await sleep(300);
            
            if (scenario === 1) {
                await scenario1_StackTraceExposure();
            } else if (scenario === 2) {
                await scenario2_SqlErrorMessage();
            } else if (scenario === 3) {
                await scenario3_PathInformationLeak();
            }
            
            isRunning = false;
        }

        // ì‹œë‚˜ë¦¬ì˜¤ 1: ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ ë…¸ì¶œ
        async function scenario1_StackTraceExposure() {
            updateStep('ğŸ¯ ì‹œë‚˜ë¦¬ì˜¤ 1: ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ ë…¸ì¶œ (DB ì •ë³´ ìœ ì¶œ)');
            await sleep(1000);
            
            updateStep('1ï¸âƒ£ XXì€í–‰ ë¡œê·¸ì¸ í˜ì´ì§€ ì ‘ì†');
            document.getElementById('attackerStatus').textContent = 'ë¡œê·¸ì¸ í˜ì´ì§€ ì ‘ì†...';
            document.getElementById('browserUrl').textContent = 'https://xxbank.com/login';
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-md mx-auto mt-10">' +
                '<h2 class="text-2xl font-bold mb-6 text-gray-800">XXì€í–‰ ë¡œê·¸ì¸</h2>' +
                '<form class="space-y-4">' +
                '<div>' +
                '<label class="block text-sm font-medium text-gray-700 mb-1">ì•„ì´ë””</label>' +
                '<input type="text" class="w-full border border-gray-300 rounded px-3 py-2" value="test_user">' +
                '</div>' +
                '<div>' +
                '<label class="block text-sm font-medium text-gray-700 mb-1">ë¹„ë°€ë²ˆí˜¸</label>' +
                '<input type="password" class="w-full border border-gray-300 rounded px-3 py-2" value="wrong_password">' +
                '</div>' +
                '<button class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700">ë¡œê·¸ì¸</button>' +
                '</form>' +
                '</div>';
            
            await sleep(2000);
            
            updateStep('2ï¸âƒ£ ì˜ëª»ëœ ë¹„ë°€ë²ˆí˜¸ë¡œ ë¡œê·¸ì¸ ì‹œë„');
            document.getElementById('attackerStatus').textContent = 'ë¡œê·¸ì¸ ì‹œë„...';
            
            await addServerLog('[INFO] Login attempt for user: test_user', 'text-blue-400');
            await sleep(500);
            await addServerLog('[INFO] Connecting to database...', 'text-blue-400');
            await sleep(800);
            
            updateServerStatus('ERROR', 'bg-red-600 animate-pulse');
            
            updateStep('3ï¸âƒ£ <span class="text-red-500 font-bold">ì„œë²„ ì—ëŸ¬ ë°œìƒ! ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ ë…¸ì¶œ!</span>');
            
            await addServerLog('[ERROR] Database connection failed!', 'text-red-400');
            await sleep(300);
            await addServerLog('', 'text-red-400');
            await addServerLog('java.sql.SQLException: Access denied for user', 'text-red-400');
            await sleep(200);
            await addServerLog("  'bank_admin'@'10.1.2.3' (using password: YES)", 'text-red-400');
            await sleep(500);
            await addServerLog('', 'text-red-400');
            await addServerLog('  at com.mysql.cj.jdbc.ConnectionImpl.createNewIO', 'text-gray-400');
            await sleep(200);
            await addServerLog('  at com.mysql.cj.jdbc.ConnectionImpl.<init>', 'text-gray-400');
            await sleep(200);
            await addServerLog('  at com.xxbank.service.UserService.login(UserService.java:45)', 'text-yellow-400');
            await sleep(200);
            await addServerLog('  at com.xxbank.controller.LoginController.login(LoginController.java:28)', 'text-yellow-400');
            await sleep(500);
            await addServerLog('', 'text-red-400');
            await addServerLog('Connection details:', 'text-cyan-400');
            await sleep(200);
            await addServerLog('  URL: jdbc:mysql://10.1.2.3:3306/bank_prod', 'text-red-400');
            await sleep(200);
            await addServerLog('  User: bank_admin', 'text-red-400');
            await sleep(200);
            await addServerLog('  Database: bank_prod', 'text-red-400');
            await sleep(200);
            await addServerLog('  Server: MySQL 8.0.35', 'text-red-400');
            await sleep(1000);
            
            // ë¸Œë¼ìš°ì €ì— ì—ëŸ¬ í‘œì‹œ
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-2xl mx-auto mt-10 bg-red-50 border-2 border-red-300 rounded-lg p-6">' +
                '<div class="flex items-center gap-2 mb-4 text-red-700">' +
                '<i class="fas fa-exclamation-triangle text-2xl"></i>' +
                '<h3 class="text-xl font-bold">500 Internal Server Error</h3>' +
                '</div>' +
                '<div class="bg-white p-4 rounded border border-red-200 code-font text-xs">' +
                '<div class="text-red-600 font-bold mb-2">java.sql.SQLException: Access denied</div>' +
                '<div class="text-gray-700 mb-2">for user \'bank_admin\'@\'10.1.2.3\' (using password: YES)</div>' +
                '<div class="border-t border-gray-300 my-3"></div>' +
                '<div class="text-gray-600 mb-1">Connection details:</div>' +
                '<div class="text-red-600">  URL: jdbc:mysql://10.1.2.3:3306/bank_prod</div>' +
                '<div class="text-red-600">  User: bank_admin</div>' +
                '<div class="text-red-600">  Database: bank_prod</div>' +
                '<div class="border-t border-gray-300 my-3"></div>' +
                '<div class="text-gray-600 mb-1">Stack Trace:</div>' +
                '<div class="text-gray-500 text-xs space-y-1">' +
                '<div>  at com.xxbank.service.UserService.login(UserService.java:45)</div>' +
                '<div>  at com.xxbank.controller.LoginController.login(LoginController.java:28)</div>' +
                '<div>  at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0</div>' +
                '<div>  at org.springframework.web.servlet.mvc.method.annotation...</div>' +
                '</div>' +
                '</div>' +
                '</div>';
            
            await sleep(1000);
            
            updateStep('4ï¸âƒ£ ê³µê²©ìê°€ DB ì •ë³´ ìˆ˜ì§‘');
            
            document.getElementById('collectedInfo').classList.remove('hidden');
            document.getElementById('collectedContent').innerHTML = 
                '<div class="text-cyan-400 mb-2">ğŸ—„ï¸ ìˆ˜ì§‘í•œ DB ì •ë³´:</div>' +
                '<div class="text-red-400">Host: 10.1.2.3</div>' +
                '<div class="text-red-400">Port: 3306</div>' +
                '<div class="text-red-400">Database: bank_prod</div>' +
                '<div class="text-red-400">Username: bank_admin</div>' +
                '<div class="text-red-400">Server: MySQL 8.0.35</div>' +
                '<div class="border-t border-gray-700 my-2"></div>' +
                '<div class="text-yellow-400 mb-2">ğŸ“‚ íŒŒì¼ ê²½ë¡œ:</div>' +
                '<div class="text-green-400">UserService.java:45</div>' +
                '<div class="text-green-400">LoginController.java:28</div>' +
                '<div class="border-t border-gray-700 my-2"></div>' +
                '<div class="text-orange-400 mb-2">âš™ï¸ ì‹œìŠ¤í…œ ì •ë³´:</div>' +
                '<div class="text-green-400">Framework: Spring Boot</div>' +
                '<div class="text-green-400">Java Version: JDK Internal</div>';
            
            showResults(
                'ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ë¥¼ í†µí•´ DB ì ‘ì† ì •ë³´, íŒŒì¼ ê²½ë¡œ, ì‹œìŠ¤í…œ êµ¬ì¡° ë…¸ì¶œ',
                'scenario1'
            );
        }

        // ì‹œë‚˜ë¦¬ì˜¤ 2: SQL ì—ëŸ¬ ë©”ì‹œì§€
        async function scenario2_SqlErrorMessage() {
            updateStep('ğŸ¯ ì‹œë‚˜ë¦¬ì˜¤ 2: SQL ì—ëŸ¬ ë©”ì‹œì§€ (í…Œì´ë¸” êµ¬ì¡° ë…¸ì¶œ)');
            await sleep(1000);
            
            updateStep('1ï¸âƒ£ ê³„ì¢Œ ì¡°íšŒ í˜ì´ì§€ ì ‘ì†');
            document.getElementById('browserUrl').textContent = 'https://xxbank.com/account';
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-md mx-auto mt-10">' +
                '<h2 class="text-2xl font-bold mb-6 text-gray-800">ê³„ì¢Œ ì¡°íšŒ</h2>' +
                '<form class="space-y-4">' +
                '<div>' +
                '<label class="block text-sm font-medium text-gray-700 mb-1">ê³„ì¢Œë²ˆí˜¸</label>' +
                '<input type="text" class="w-full border border-gray-300 rounded px-3 py-2" value="110-123-456789\' OR \'1\'=\'1">' +
                '</div>' +
                '<button class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700">ì¡°íšŒ</button>' +
                '</form>' +
                '</div>';
            
            await sleep(2000);
            
            updateStep('2ï¸âƒ£ SQL Injection ì‹œë„ (ì—ëŸ¬ ê¸°ë°˜)');
            document.getElementById('attackerStatus').textContent = 'SQL ì—ëŸ¬ ìœ ë°œ...';
            
            await addServerLog('[INFO] Account lookup request', 'text-blue-400');
            await sleep(500);
            await addServerLog('[INFO] Executing SQL query...', 'text-blue-400');
            await sleep(800);
            
            updateServerStatus('ERROR', 'bg-red-600');
            
            updateStep('3ï¸âƒ£ <span class="text-red-500 font-bold">SQL ì—ëŸ¬! í…Œì´ë¸” êµ¬ì¡° ë…¸ì¶œ!</span>');
            
            await addServerLog('[ERROR] SQL syntax error!', 'text-red-400');
            await sleep(300);
            await addServerLog('', 'text-red-400');
            await addServerLog('You have an error in your SQL syntax;', 'text-red-400');
            await sleep(200);
            await addServerLog('check the manual that corresponds to your', 'text-red-400');
            await sleep(200);
            await addServerLog('MySQL server version for the right syntax', 'text-red-400');
            await sleep(500);
            await addServerLog('', 'text-red-400');
            await addServerLog('Query:', 'text-cyan-400');
            await sleep(200);
            await addServerLog('  SELECT account_number, customer_name,', 'text-yellow-400');
            await sleep(200);
            await addServerLog('         balance, account_type, status,', 'text-yellow-400');
            await sleep(200);
            await addServerLog('         created_date, last_transaction_date,', 'text-yellow-400');
            await sleep(200);
            await addServerLog('         customer_ssn, phone_number, address', 'text-yellow-400');
            await sleep(200);
            await addServerLog('  FROM bank_prod.customer_accounts', 'text-yellow-400');
            await sleep(200);
            await addServerLog("  WHERE account_number = '110-123-456789' OR '1'='1'", 'text-red-400');
            await sleep(500);
            await addServerLog('', 'text-red-400');
            await addServerLog('Table: bank_prod.customer_accounts', 'text-cyan-400');
            await sleep(200);
            await addServerLog('Columns: 10 columns found', 'text-red-400');
            await sleep(1000);
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-3xl mx-auto mt-10 bg-red-50 border-2 border-red-300 rounded-lg p-6">' +
                '<div class="flex items-center gap-2 mb-4 text-red-700">' +
                '<i class="fas fa-database text-2xl"></i>' +
                '<h3 class="text-xl font-bold">Database Error</h3>' +
                '</div>' +
                '<div class="bg-white p-4 rounded border border-red-200 code-font text-xs">' +
                '<div class="text-red-600 font-bold mb-3">SQLException: Syntax error</div>' +
                '<div class="text-gray-600 mb-2">Failed query:</div>' +
                '<div class="bg-gray-100 p-3 rounded text-gray-700 mb-3">' +
                'SELECT account_number, customer_name, balance,<br>' +
                '       account_type, status, created_date,<br>' +
                '       last_transaction_date, <span class="text-red-600">customer_ssn</span>,<br>' +
                '       phone_number, address<br>' +
                'FROM <span class="text-red-600">bank_prod.customer_accounts</span><br>' +
                'WHERE account_number = \'110-123-456789\' OR \'1\'=\'1\'' +
                '</div>' +
                '<div class="border-t border-gray-300 my-3"></div>' +
                '<div class="text-gray-600">Table: <span class="text-red-600">bank_prod.customer_accounts</span></div>' +
                '<div class="text-gray-600">Database: <span class="text-red-600">bank_prod</span></div>' +
                '<div class="text-gray-600">Columns: <span class="text-red-600">10 columns (including SSN)</span></div>' +
                '</div>' +
                '</div>';
            
            await sleep(1000);
            
            updateStep('4ï¸âƒ£ í…Œì´ë¸” êµ¬ì¡° ë° ë¯¼ê° ì»¬ëŸ¼ ì •ë³´ ìˆ˜ì§‘');
            
            document.getElementById('collectedInfo').classList.remove('hidden');
            document.getElementById('collectedContent').innerHTML = 
                '<div class="text-cyan-400 mb-2">ğŸ—‚ï¸ í…Œì´ë¸” ì •ë³´:</div>' +
                '<div class="text-red-400">Database: bank_prod</div>' +
                '<div class="text-red-400">Table: customer_accounts</div>' +
                '<div class="border-t border-gray-700 my-2"></div>' +
                '<div class="text-yellow-400 mb-2">ğŸ“‹ ì»¬ëŸ¼ ëª©ë¡ (10ê°œ):</div>' +
                '<div class="text-green-400">1. account_number</div>' +
                '<div class="text-green-400">2. customer_name</div>' +
                '<div class="text-green-400">3. balance</div>' +
                '<div class="text-green-400">4. account_type</div>' +
                '<div class="text-green-400">5. status</div>' +
                '<div class="text-green-400">6. created_date</div>' +
                '<div class="text-green-400">7. last_transaction_date</div>' +
                '<div class="text-red-400 font-bold">8. customer_ssn âš ï¸</div>' +
                '<div class="text-green-400">9. phone_number</div>' +
                '<div class="text-green-400">10. address</div>' +
                '<div class="border-t border-gray-700 my-2"></div>' +
                '<div class="text-orange-400">âš¡ ë‹¤ìŒ ê³µê²© ê°€ëŠ¥:</div>' +
                '<div class="text-gray-300 text-xs">â€¢ UNION SELECTë¡œ ë°ì´í„° íƒˆì·¨</div>' +
                '<div class="text-gray-300 text-xs">â€¢ customer_ssn ì»¬ëŸ¼ ì¶”ì¶œ</div>';
            
            showResults(
                'SQL ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ í†µí•´ ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„, í…Œì´ë¸” êµ¬ì¡°, ë¯¼ê° ì»¬ëŸ¼ ì •ë³´ ë…¸ì¶œ',
                'scenario2'
            );
        }

        // ì‹œë‚˜ë¦¬ì˜¤ 3: ê²½ë¡œ ì •ë³´ ë…¸ì¶œ
        async function scenario3_PathInformationLeak() {
            updateStep('ğŸ¯ ì‹œë‚˜ë¦¬ì˜¤ 3: ê²½ë¡œ ì •ë³´ ë…¸ì¶œ (ì„œë²„ êµ¬ì¡° íŒŒì•…)');
            await sleep(1000);
            
            updateStep('1ï¸âƒ£ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ìš”ì²­');
            document.getElementById('browserUrl').textContent = 'https://xxbank.com/download?file=../../../etc/passwd';
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-md mx-auto mt-10">' +
                '<h2 class="text-2xl font-bold mb-6 text-gray-800">ë¬¸ì„œ ë‹¤ìš´ë¡œë“œ</h2>' +
                '<div class="space-y-4">' +
                '<p class="text-gray-600">ìš”ì²­í•œ íŒŒì¼: <code class="bg-gray-100 px-2 py-1 rounded">../../../etc/passwd</code></p>' +
                '<button class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700">ë‹¤ìš´ë¡œë“œ</button>' +
                '</div>' +
                '</div>';
            
            await sleep(2000);
            
            updateStep('2ï¸âƒ£ ê²½ë¡œ ì¡°ì‘ ê³µê²© ì‹œë„');
            document.getElementById('attackerStatus').textContent = 'ê²½ë¡œ ì¡°ì‘ ê³µê²©...';
            
            await addServerLog('[INFO] File download request', 'text-blue-400');
            await sleep(500);
            await addServerLog('[INFO] Processing file: ../../../etc/passwd', 'text-yellow-400');
            await sleep(800);
            
            updateServerStatus('ERROR', 'bg-red-600');
            
            updateStep('3ï¸âƒ£ <span class="text-red-500 font-bold">íŒŒì¼ ì ‘ê·¼ ì—ëŸ¬! ì ˆëŒ€ ê²½ë¡œ ë…¸ì¶œ!</span>');
            
            await addServerLog('[ERROR] File access denied!', 'text-red-400');
            await sleep(300);
            await addServerLog('', 'text-red-400');
            await addServerLog('java.io.FileNotFoundException:', 'text-red-400');
            await sleep(200);
            await addServerLog('  /home/xxbank/app/public/downloads/../../../etc/passwd', 'text-red-400');
            await sleep(300);
            await addServerLog('  (No such file or directory)', 'text-red-400');
            await sleep(500);
            await addServerLog('', 'text-red-400');
            await addServerLog('Application path:', 'text-cyan-400');
            await sleep(200);
            await addServerLog('  Base: /home/xxbank/app', 'text-red-400');
            await sleep(200);
            await addServerLog('  Config: /home/xxbank/app/config', 'text-red-400');
            await sleep(200);
            await addServerLog('  Logs: /home/xxbank/app/logs', 'text-red-400');
            await sleep(200);
            await addServerLog('  Data: /home/xxbank/app/data', 'text-red-400');
            await sleep(500);
            await addServerLog('', 'text-red-400');
            await addServerLog('System info:', 'text-cyan-400');
            await sleep(200);
            await addServerLog('  OS: Linux Ubuntu 20.04.6 LTS', 'text-red-400');
            await sleep(200);
            await addServerLog('  Java: OpenJDK 17.0.8', 'text-red-400');
            await sleep(200);
            await addServerLog('  Tomcat: 9.0.82', 'text-red-400');
            await sleep(200);
            await addServerLog('  User: xxbank (uid=1001)', 'text-red-400');
            await sleep(1000);
            
            document.getElementById('browserScreen').innerHTML = 
                '<div class="max-w-3xl mx-auto mt-10 bg-red-50 border-2 border-red-300 rounded-lg p-6">' +
                '<div class="flex items-center gap-2 mb-4 text-red-700">' +
                '<i class="fas fa-folder-open text-2xl"></i>' +
                '<h3 class="text-xl font-bold">File Access Error</h3>' +
                '</div>' +
                '<div class="bg-white p-4 rounded border border-red-200 code-font text-xs">' +
                '<div class="text-red-600 font-bold mb-3">FileNotFoundException</div>' +
                '<div class="text-gray-600 mb-2">Failed to access:</div>' +
                '<div class="bg-red-100 p-3 rounded text-red-700 mb-3">' +
                '/home/xxbank/app/public/downloads/../../../etc/passwd' +
                '</div>' +
                '<div class="border-t border-gray-300 my-3"></div>' +
                '<div class="text-gray-600 mb-2">Application structure:</div>' +
                '<div class="text-gray-700 space-y-1">' +
                '<div>ğŸ“ /home/xxbank/app/</div>' +
                '<div class="ml-4">ğŸ“ config/ <span class="text-red-600">â† ì„¤ì • íŒŒì¼</span></div>' +
                '<div class="ml-4">ğŸ“ logs/ <span class="text-red-600">â† ë¡œê·¸ íŒŒì¼</span></div>' +
                '<div class="ml-4">ğŸ“ data/ <span class="text-red-600">â† ë°ì´í„°ë² ì´ìŠ¤</span></div>' +
                '<div class="ml-4">ğŸ“ public/downloads/</div>' +
                '</div>' +
                '<div class="border-t border-gray-300 my-3"></div>' +
                '<div class="text-gray-600">System: <span class="text-red-600">Linux Ubuntu 20.04.6 LTS</span></div>' +
                '<div class="text-gray-600">Server: <span class="text-red-600">Apache Tomcat 9.0.82</span></div>' +
                '</div>' +
                '</div>';
            
            await sleep(1000);
            
            updateStep('4ï¸âƒ£ ì„œë²„ ë””ë ‰í† ë¦¬ êµ¬ì¡° ë° ì‹œìŠ¤í…œ ì •ë³´ ìˆ˜ì§‘');
            
            document.getElementById('collectedInfo').classList.remove('hidden');
            document.getElementById('collectedContent').innerHTML = 
                '<div class="text-cyan-400 mb-2">ğŸ“‚ ì„œë²„ ê²½ë¡œ:</div>' +
                '<div class="text-red-400">Base: /home/xxbank/app</div>' +
                '<div class="text-red-400">Config: /home/xxbank/app/config</div>' +
                '<div class="text-red-400">Logs: /home/xxbank/app/logs</div>' +
                '<div class="text-red-400">Data: /home/xxbank/app/data</div>' +
                '<div class="border-t border-gray-700 my-2"></div>' +
                '<div class="text-yellow-400 mb-2">ğŸ’» ì‹œìŠ¤í…œ ì •ë³´:</div>' +
                '<div class="text-green-400">OS: Ubuntu 20.04.6 LTS</div>' +
                '<div class="text-green-400">Java: OpenJDK 17.0.8</div>' +
                '<div class="text-green-400">Tomcat: 9.0.82</div>' +
                '<div class="text-green-400">User: xxbank (uid=1001)</div>' +
                '<div class="border-t border-gray-700 my-2"></div>' +
                '<div class="text-orange-400">âš¡ ë‹¤ìŒ ê³µê²© ê°€ëŠ¥:</div>' +
                '<div class="text-gray-300 text-xs">â€¢ /config ê²½ë¡œì˜ ì„¤ì • íŒŒì¼ ì ‘ê·¼</div>' +
                '<div class="text-gray-300 text-xs">â€¢ /logs ê²½ë¡œì˜ ë¡œê·¸ íŒŒì¼ ì—´ëŒ</div>' +
                '<div class="text-gray-300 text-xs">â€¢ ì•Œë ¤ì§„ Tomcat ì·¨ì•½ì  ê³µê²©</div>';
            
            showResults(
                'ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ í†µí•´ ì„œë²„ ë””ë ‰í† ë¦¬ êµ¬ì¡°, ì‹œìŠ¤í…œ ë²„ì „, ì‹¤í–‰ í™˜ê²½ ë…¸ì¶œ',
                'scenario3'
            );
        }

        function showResults(description, scenario) {
            document.getElementById('problemBox').classList.remove('hidden');
            
            let problems = '';
            if (scenario === 'scenario1') {
                problems = 
                    '<div class="bg-black bg-opacity-30 p-3 rounded">' +
                    '<p class="font-bold mb-2">âŒ ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ ë…¸ì¶œ ë¬¸ì œ:</p>' +
                    '<div class="space-y-1 ml-4">' +
                    '<div>1. DB ì ‘ì† ì •ë³´ í‰ë¬¸ ë…¸ì¶œ</div>' +
                    '<div>2. ì„œë²„ ë‚´ë¶€ íŒŒì¼ ê²½ë¡œ ë…¸ì¶œ</div>' +
                    '<div>3. í”„ë ˆì„ì›Œí¬ ë²„ì „ ì •ë³´ ë…¸ì¶œ</div>' +
                    '<div>4. í´ë˜ìŠ¤ ë° ë©”ì„œë“œ êµ¬ì¡° ë…¸ì¶œ</div>' +
                    '</div></div>';
            } else if (scenario === 'scenario2') {
                problems = 
                    '<div class="bg-black bg-opacity-30 p-3 rounded">' +
                    '<p class="font-bold mb-2">âŒ SQL ì—ëŸ¬ ë…¸ì¶œ ë¬¸ì œ:</p>' +
                    '<div class="space-y-1 ml-4">' +
                    '<div>1. ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ ë…¸ì¶œ</div>' +
                    '<div>2. í…Œì´ë¸” ë° ì»¬ëŸ¼ êµ¬ì¡° ë…¸ì¶œ</div>' +
                    '<div>3. ë¯¼ê° ì»¬ëŸ¼(SSN) ì¡´ì¬ í™•ì¸</div>' +
                    '<div>4. SQL ì¿¼ë¦¬ ì „ì²´ ë…¸ì¶œ</div>' +
                    '</div></div>';
            } else {
                problems = 
                    '<div class="bg-black bg-opacity-30 p-3 rounded">' +
                    '<p class="font-bold mb-2">âŒ ê²½ë¡œ ì •ë³´ ë…¸ì¶œ ë¬¸ì œ:</p>' +
                    '<div class="space-y-1 ml-4">' +
                    '<div>1. ì ˆëŒ€ ê²½ë¡œ ë…¸ì¶œ</div>' +
                    '<div>2. ë””ë ‰í† ë¦¬ êµ¬ì¡° ë…¸ì¶œ</div>' +
                    '<div>3. OS ë° ì„œë²„ ë²„ì „ ë…¸ì¶œ</div>' +
                    '<div>4. ì‹¤í–‰ ì‚¬ìš©ì ì •ë³´ ë…¸ì¶œ</div>' +
                    '</div></div>';
            }
            
            problems += 
                '<div class="bg-black bg-opacity-30 p-3 rounded mt-2">' +
                '<p class="font-bold mb-2">ğŸ’¥ ì˜ˆìƒ í”¼í•´:</p>' +
                '<div class="space-y-1 ml-4">' +
                '<div>â€¢ ì‹œìŠ¤í…œ êµ¬ì¡° íŒŒì•…</div>' +
                '<div>â€¢ ì¶”ê°€ ê³µê²© ê²½ë¡œ ë°œê²¬</div>' +
                '<div>â€¢ ì•Œë ¤ì§„ ì·¨ì•½ì  í™œìš©</div>' +
                '<div>â€¢ ë°ì´í„°ë² ì´ìŠ¤ ê³µê²© ê°€ëŠ¥</div>' +
                '</div></div>';
            
            document.getElementById('problemContent').innerHTML = problems;
            
            document.getElementById('successBox').classList.remove('hidden');
            document.getElementById('successContent').innerHTML = 
                '<div class="bg-black bg-opacity-30 p-3 rounded">' +
                '<p class="font-bold mb-2">ğŸ¯ ìˆ˜ì§‘ ì„±ê³µ:</p>' +
                '<div class="ml-4">' + description + '</div>' +
                '</div>' +
                '<div class="bg-black bg-opacity-30 p-3 rounded mt-2">' +
                '<p class="font-bold mb-2">ğŸ›¡ï¸ í•„ìš”í•œ ë°©ì–´:</p>' +
                '<div class="space-y-1 ml-4">' +
                '<div>â€¢ ì „ì—­ ì˜ˆì™¸ ì²˜ë¦¬ê¸° êµ¬í˜„</div>' +
                '<div>â€¢ ì¼ë°˜í™”ëœ ì—ëŸ¬ ë©”ì‹œì§€ ì‚¬ìš©</div>' +
                '<div>â€¢ ìƒì„¸ ì •ë³´ëŠ” ë¡œê·¸ì—ë§Œ ê¸°ë¡</div>' +
                '<div>â€¢ ìš´ì˜ í™˜ê²½ ì„¤ì • ì ìš©</div>' +
                '</div></div>';
        }

        function updateStep(html) {
            const steps = document.getElementById('attackSteps');
            const div = document.createElement('div');
            div.className = 'p-2 bg-gray-700 rounded text-sm slide-in';
            div.innerHTML = html;
            steps.appendChild(div);
            steps.scrollTop = steps.scrollHeight;
        }

        async function addServerLog(message, colorClass = 'text-green-400') {
            const div = document.createElement('div');
            div.className = colorClass;
            div.textContent = message;
            const container = document.getElementById('serverLog');
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
            await sleep(50);
        }

        function updateServerStatus(text, className) {
            document.getElementById('serverStatus').textContent = text;
            document.getElementById('serverStatus').className = 'text-xs text-white px-3 py-1 rounded ' + className;
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
    </script>
</body>
</html>