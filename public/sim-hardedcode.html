<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¸ˆìœµê¶Œ í•˜ë“œì½”ë”© ì·¨ì•½ì  ì‹¤ì „ ì‹œë®¬ë ˆì´í„°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        .code-font { font-family: 'Courier New', monospace; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
        .animate-blink { animation: blink 1s infinite; }
        @keyframes slideIn { from { transform: translateX(-20px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        .slide-in { animation: slideIn 0.5s ease-out; }
    </style>
</head>
<body class="bg-gray-900 p-4">

    <!-- íƒ€ì´í‹€ -->
    <div class="max-w-7xl mx-auto mb-4">
        <div class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-4 rounded-lg shadow-lg">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <i class="fas fa-mobile-alt text-3xl"></i>
                    <div>
                        <h1 class="font-bold text-xl">ê¸ˆìœµê¶Œ í•˜ë“œì½”ë”© ì·¨ì•½ì  ì‹¤ì „ ì‹œë‚˜ë¦¬ì˜¤</h1>
                        <p class="text-sm">MOB-SER-025: ì•± ì†ŒìŠ¤ì½”ë“œ ë‚´ ìš´ì˜ì •ë³´ ë…¸ì¶œ | ìœ„í—˜ë„: 5 (ë§¤ìš° ë†’ìŒ)</p>
                    </div>
                </div>
                <button onclick="resetAll()" class="bg-white text-indigo-600 px-4 py-2 rounded font-bold hover:bg-gray-100">
                    <i class="fas fa-redo"></i> ì²˜ìŒë¶€í„°
                </button>
            </div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-2 gap-4">
        
        <!-- ì¢Œì¸¡: ê³µê²©ì í™”ë©´ -->
        <div class="space-y-4">
            
            <!-- ê³µê²©ì í™”ë©´ -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg border-2 border-red-500">
                <div class="flex items-center gap-3 mb-3">
                    <i class="fas fa-user-secret text-red-400 text-2xl"></i>
                    <div>
                        <h2 class="font-bold text-lg">ğŸ”´ ê³µê²©ì (í•´ì»¤)</h2>
                        <p class="text-sm text-gray-400" id="attackerStatus">APK ë””ì»´íŒŒì¼ ì¤€ë¹„ ì¤‘...</p>
                    </div>
                </div>
                
                <!-- ê³µê²©ì í„°ë¯¸ë„ -->
                <div class="bg-gray-900 rounded-lg overflow-hidden">
                    <div class="bg-gray-700 px-3 py-2 flex items-center gap-2">
                        <div class="flex gap-1">
                            <div class="w-2 h-2 rounded-full bg-red-500"></div>
                            <div class="w-2 h-2 rounded-full bg-yellow-500"></div>
                            <div class="w-2 h-2 rounded-full bg-green-500"></div>
                        </div>
                        <span class="text-xs text-white code-font">attacker@kali:~$</span>
                    </div>
                    
                    <div id="attackerScreen" class="p-4 bg-black text-green-400 code-font text-xs min-h-[300px] max-h-[350px] overflow-auto">
                        <div class="text-gray-500">$ # Waiting for command...</div>
                    </div>
                </div>
            </div>

            <!-- íƒˆì·¨í•œ ì •ë³´ -->
            <div id="stolenData" class="hidden bg-red-900 text-white p-4 rounded-lg shadow-lg border-2 border-red-500">
                <div class="flex items-center gap-2 mb-3">
                    <i class="fas fa-unlock text-red-400 text-xl animate-pulse"></i>
                    <h3 class="font-bold">ğŸ”“ íƒˆì·¨í•œ ìš´ì˜ì •ë³´</h3>
                </div>
                <div id="stolenDataContent" class="bg-black p-3 rounded code-font text-xs"></div>
            </div>

            <!-- ê³µê²© ë‹¨ê³„ -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg">
                <h3 class="font-bold mb-3 flex items-center gap-2">
                    <i class="fas fa-list-ol text-orange-400"></i>
                    ê³µê²© ì§„í–‰ ë‹¨ê³„
                </h3>
                <div id="attackSteps" class="space-y-2 text-sm max-h-[250px] overflow-auto">
                    <div class="text-gray-500">ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”...</div>
                </div>
            </div>

            <!-- ì‹œë‚˜ë¦¬ì˜¤ ì„ íƒ -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg">
                <h3 class="font-bold mb-3 flex items-center gap-2">
                    <i class="fas fa-flask text-red-400"></i>
                    ì‹¤ì „ ê³µê²© ì‹œë‚˜ë¦¬ì˜¤
                </h3>
                <div class="space-y-2">
                    <button onclick="startScenario(1)" 
                            class="w-full text-left bg-red-900 hover:bg-red-800 px-3 py-2 rounded text-sm transition">
                        <i class="fas fa-database"></i> <strong>ì‹œë‚˜ë¦¬ì˜¤ 1:</strong> DB ë¹„ë°€ë²ˆí˜¸ í•˜ë“œì½”ë”©
                    </button>
                    <button onclick="startScenario(2)" 
                            class="w-full text-left bg-orange-900 hover:bg-orange-800 px-3 py-2 rounded text-sm transition">
                        <i class="fas fa-key"></i> <strong>ì‹œë‚˜ë¦¬ì˜¤ 2:</strong> API í‚¤ ë…¸ì¶œ
                    </button>
                    <button onclick="startScenario(3)" 
                            class="w-full text-left bg-purple-900 hover:bg-purple-800 px-3 py-2 rounded text-sm transition">
                        <i class="fab fa-aws"></i> <strong>ì‹œë‚˜ë¦¬ì˜¤ 3:</strong> AWS ìê²©ì¦ëª… ë…¸ì¶œ
                    </button>
                </div>
            </div>

            <!-- ì·¨ì•½í•œ ì½”ë“œ -->
            <div class="bg-gray-900 text-white p-4 rounded-lg shadow-lg border border-red-500">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="font-bold text-red-400">
                        <i class="fas fa-bug"></i> ì·¨ì•½í•œ ì½”ë“œ (í•˜ë“œì½”ë”©)
                    </h3>
                    <span class="text-xs bg-red-600 px-2 py-1 rounded">ë¬¸ì œ ì›ì¸</span>
                </div>
                <pre class="code-font text-xs overflow-x-auto"><code><span class="text-gray-500">// Java - Android App</span>
public class DatabaseHelper {
    
    <span class="text-red-400">// âŒ DB ì •ë³´ í•˜ë“œì½”ë”©!</span>
    private static final String DB_URL = 
        "jdbc:mysql://10.1.2.3:3306/bank_db";
    
    private static final String DB_USER = "admin";
    
    <span class="text-red-400">// âŒ ë¹„ë°€ë²ˆí˜¸ í‰ë¬¸ ë…¸ì¶œ!</span>
    private static final String DB_PASSWORD = 
        "Bank@1234!";
    
    public Connection connect() {
        return DriverManager.getConnection(
            DB_URL, DB_USER, DB_PASSWORD
        );
    }
}

public class ApiClient {
    
    <span class="text-red-400">// âŒ API í‚¤ í•˜ë“œì½”ë”©!</span>
    private static final String API_KEY = 
        "sk_live_51HxJ9KLp2k3M4n5o6P7q8R9s0T";
    
    <span class="text-red-400">// âŒ Secret í‚¤ë„ ë…¸ì¶œ!</span>
    private static final String API_SECRET = 
        "whsec_9a8b7c6d5e4f3g2h1i0j";
    
    public void sendRequest() {
        headers.put("Authorization", 
            "Bearer " + API_KEY);
    }
}

public class CloudConfig {
    
    <span class="text-red-400">// âŒ AWS ìê²©ì¦ëª… í•˜ë“œì½”ë”©!</span>
    public static final String AWS_ACCESS_KEY = 
        "AKIAIOSFODNN7EXAMPLE";
    
    public static final String AWS_SECRET_KEY = 
        "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY";
    
    public static final String S3_BUCKET = 
        "xxbank-customer-data";
}</code></pre>
            </div>

        </div>

        <!-- ìš°ì¸¡: ì„œë²„ & ë¶„ì„ -->
        <div class="space-y-4">
            
            <!-- ë””ì»´íŒŒì¼ ê²°ê³¼ -->
            <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg border-2 border-green-500">
                <div class="flex items-center gap-3 mb-3">
                    <i class="fas fa-file-code text-green-400 text-2xl"></i>
                    <div>
                        <h2 class="font-bold text-lg">ğŸŸ¢ ë””ì»´íŒŒì¼ ê²°ê³¼</h2>
                        <p class="text-sm text-gray-400">jadxë¡œ APK ì—­ë¶„ì„</p>
                    </div>
                </div>
                
                <!-- ë””ì»´íŒŒì¼ í™”ë©´ -->
                <div class="bg-gray-900 rounded-lg p-4 min-h-[400px] max-h-[500px] overflow-auto">
                    <div id="decompileResult" class="code-font text-xs space-y-1 text-green-400">
                        <div class="text-gray-500">[JADX] Waiting...</div>
                    </div>
                </div>
                
                <!-- ìƒíƒœ -->
                <div class="mt-3 flex justify-between items-center">
                    <span class="text-xs text-gray-400">ë””ì»´íŒŒì¼ ìƒíƒœ:</span>
                    <span id="decompileStatus" class="text-xs bg-blue-600 px-3 py-1 rounded">IDLE</span>
                </div>
            </div>

            <!-- ê³µê²© ì„±ê³µ -->
            <div id="successBox" class="hidden bg-green-900 text-white p-4 rounded-lg shadow-lg border-2 border-green-400">
                <div class="flex items-center gap-2 mb-3">
                    <i class="fas fa-skull-crossbones text-red-400 text-xl"></i>
                    <h3 class="font-bold">ğŸ’€ ê³µê²© ì„±ê³µ!</h3>
                </div>
                <div id="successContent" class="text-sm"></div>
            </div>

            <!-- ë¬¸ì œì  ë¶„ì„ -->
            <div id="problemBox" class="hidden bg-red-900 text-white p-4 rounded-lg shadow-lg">
                <div class="flex items-center gap-2 mb-3">
                    <i class="fas fa-exclamation-triangle text-yellow-400 text-xl animate-blink"></i>
                    <h3 class="font-bold">ğŸš¨ ë¬¸ì œì  ë¶„ì„</h3>
                </div>
                <div id="problemContent" class="text-sm space-y-2"></div>
            </div>

            <!-- ì•ˆì „í•œ ì½”ë“œ -->
            <div class="bg-gray-900 text-white p-4 rounded-lg shadow-lg border border-green-500">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="font-bold text-green-400">
                        <i class="fas fa-shield-halved"></i> ì•ˆì „í•œ ì½”ë“œ
                    </h3>
                    <span class="text-xs bg-green-600 px-2 py-1 rounded">í•´ê²°ì±…</span>
                </div>
                <pre class="code-font text-xs overflow-x-auto max-h-[700px]"><code><span class="text-gray-500">// Java - ì•ˆì „í•œ ì„¤ì • ê´€ë¦¬</span>

<span class="text-green-400">// âœ… ë°©ë²• 1: í™˜ê²½ë³€ìˆ˜ ì‚¬ìš©</span>
public class SecureDatabaseHelper {
    
    private static final String DB_URL = 
        System.getenv("DATABASE_URL");
    
    private static final String DB_USER = 
        System.getenv("DATABASE_USER");
    
    <span class="text-green-400">// í™˜ê²½ë³€ìˆ˜ì—ì„œ ì•ˆì „í•˜ê²Œ ë¡œë“œ</span>
    private static final String DB_PASSWORD = 
        System.getenv("DATABASE_PASSWORD");
    
    public Connection connect() {
        if (DB_URL == null || DB_PASSWORD == null) {
            throw new IllegalStateException(
                "Database credentials not configured"
            );
        }
        
        return DriverManager.getConnection(
            DB_URL, DB_USER, DB_PASSWORD
        );
    }
}

<span class="text-green-400">// âœ… ë°©ë²• 2: ì•”í˜¸í™”ëœ ì„¤ì • íŒŒì¼</span>
public class EncryptedConfigManager {
    
    private Properties config;
    private static final String CONFIG_FILE = 
        "encrypted.properties";
    
    public EncryptedConfigManager() {
        loadEncryptedConfig();
    }
    
    private void loadEncryptedConfig() {
        try {
            <span class="text-green-400">// ì•”í˜¸í™”ëœ íŒŒì¼ ì½ê¸°</span>
            InputStream is = getClass()
                .getResourceAsStream(CONFIG_FILE);
            
            <span class="text-green-400">// AES ë³µí˜¸í™”</span>
            byte[] encryptedData = is.readAllBytes();
            byte[] decryptedData = decrypt(
                encryptedData, 
                getDeviceKey()
            );
            
            <span class="text-green-400">// Properties ë¡œë“œ</span>
            config = new Properties();
            config.load(new ByteArrayInputStream(
                decryptedData
            ));
            
        } catch (Exception e) {
            throw new RuntimeException(
                "Failed to load config", e
            );
        }
    }
    
    private byte[] decrypt(byte[] data, byte[] key) {
        try {
            Cipher cipher = Cipher.getInstance(
                "AES/GCM/NoPadding"
            );
            SecretKeySpec keySpec = 
                new SecretKeySpec(key, "AES");
            
            GCMParameterSpec gcmSpec = 
                new GCMParameterSpec(128, 
                    Arrays.copyOf(data, 12));
            
            cipher.init(Cipher.DECRYPT_MODE, 
                keySpec, gcmSpec);
            
            return cipher.doFinal(data, 12, 
                data.length - 12);
            
        } catch (Exception e) {
            throw new RuntimeException(
                "Decryption failed", e
            );
        }
    }
    
    private byte[] getDeviceKey() {
        <span class="text-green-400">// Android KeyStoreì—ì„œ í‚¤ ê°€ì ¸ì˜¤ê¸°</span>
        try {
            KeyStore keyStore = KeyStore
                .getInstance("AndroidKeyStore");
            keyStore.load(null);
            
            KeyStore.SecretKeyEntry entry = 
                (KeyStore.SecretKeyEntry) keyStore
                    .getEntry("ConfigKey", null);
            
            return entry.getSecretKey()
                .getEncoded();
            
        } catch (Exception e) {
            throw new RuntimeException(
                "Failed to get device key", e
            );
        }
    }
    
    public String getProperty(String key) {
        return config.getProperty(key);
    }
}

<span class="text-green-400">// âœ… ë°©ë²• 3: Android KeyStore í™œìš©</span>
public class SecureApiClient {
    
    private static final String KEY_ALIAS = 
        "api_key_alias";
    
    public SecureApiClient() {
        initializeKeyStore();
    }
    
    private void initializeKeyStore() {
        try {
            KeyStore keyStore = KeyStore
                .getInstance("AndroidKeyStore");
            keyStore.load(null);
            
            <span class="text-green-400">// KeyStoreì— í‚¤ê°€ ì—†ìœ¼ë©´ ìƒì„±</span>
            if (!keyStore.containsAlias(KEY_ALIAS)) {
                KeyGenerator keyGenerator = 
                    KeyGenerator.getInstance(
                        KeyProperties.KEY_ALGORITHM_AES,
                        "AndroidKeyStore"
                    );
                
                keyGenerator.init(
                    new KeyGenParameterSpec
                        .Builder(KEY_ALIAS,
                            KeyProperties.PURPOSE_ENCRYPT |
                            KeyProperties.PURPOSE_DECRYPT)
                        .setBlockModes(
                            KeyProperties.BLOCK_MODE_GCM)
                        .setEncryptionPaddings(
                            KeyProperties
                                .ENCRYPTION_PADDING_NONE)
                        .setUserAuthenticationRequired(false)
                        .build()
                );
                
                keyGenerator.generateKey();
            }
            
        } catch (Exception e) {
            throw new RuntimeException(
                "KeyStore init failed", e
            );
        }
    }
    
    public String getApiKey() {
        <span class="text-green-400">// ì„œë²„ì—ì„œ ì•ˆì „í•˜ê²Œ ê°€ì ¸ì˜¤ê¸°</span>
        try {
            <span class="text-green-400">// 1. ë””ë°”ì´ìŠ¤ ì¸ì¦</span>
            String deviceToken = getDeviceToken();
            
            <span class="text-green-400">// 2. ì„œë²„ì— API í‚¤ ìš”ì²­</span>
            Response response = apiService
                .getApiKey(deviceToken);
            
            <span class="text-green-400">// 3. KeyStoreì— ì•”í˜¸í™” ì €ì¥</span>
            String apiKey = response.getApiKey();
            encryptAndStore(apiKey);
            
            return apiKey;
            
        } catch (Exception e) {
            throw new RuntimeException(
                "Failed to get API key", e
            );
        }
    }
    
    private void encryptAndStore(String data) {
        try {
            KeyStore keyStore = KeyStore
                .getInstance("AndroidKeyStore");
            keyStore.load(null);
            
            SecretKey key = (SecretKey) keyStore
                .getKey(KEY_ALIAS, null);
            
            Cipher cipher = Cipher.getInstance(
                "AES/GCM/NoPadding"
            );
            cipher.init(Cipher.ENCRYPT_MODE, key);
            
            byte[] encrypted = cipher.doFinal(
                data.getBytes()
            );
            
            <span class="text-green-400">// SharedPreferencesì— ì•”í˜¸í™”ëœ ë°ì´í„° ì €ì¥</span>
            SharedPreferences prefs = context
                .getSharedPreferences(
                    "secure_prefs", 
                    Context.MODE_PRIVATE
                );
            
            prefs.edit()
                .putString("encrypted_api_key", 
                    Base64.encodeToString(
                        encrypted, 
                        Base64.DEFAULT
                    ))
                .apply();
            
        } catch (Exception e) {
            throw new RuntimeException(
                "Encryption failed", e
            );
        }
    }
}

<span class="text-green-400">// âœ… ë°©ë²• 4: ë°±ì—”ë“œì—ì„œ í‚¤ ê´€ë¦¬</span>
public class SecureCloudConfig {
    
    <span class="text-green-400">// í•˜ë“œì½”ë”© ëŒ€ì‹  ì„œë²„ì—ì„œ ê°€ì ¸ì˜¤ê¸°</span>
    public CloudCredentials getCloudCredentials() {
        try {
            <span class="text-green-400">// 1. ì‚¬ìš©ì ì¸ì¦ í† í°</span>
            String authToken = getAuthToken();
            
            <span class="text-green-400">// 2. ì„œë²„ì— ì„ì‹œ ìê²©ì¦ëª… ìš”ì²­</span>
            Response response = cloudService
                .getTemporaryCredentials(authToken);
            
            <span class="text-green-400">// 3. STS (ì„ì‹œ ìê²©ì¦ëª…) ë°˜í™˜</span>
            return new CloudCredentials(
                response.getAccessKey(),
                response.getSecretKey(),
                response.getSessionToken(),
                response.getExpiration()
            );
            
        } catch (Exception e) {
            throw new RuntimeException(
                "Failed to get credentials", e
            );
        }
    }
}

<span class="text-gray-500">// ProGuard ì„¤ì • (ë‚œë…í™”)</span>
<span class="text-green-400"># proguard-rules.pro</span>

<span class="text-green-400"># ë¬¸ìì—´ ì•”í˜¸í™”</span>
-keep class com.example.bank.** { *; }
-obfuscate
-repackageclasses 'o'

<span class="text-green-400"># í´ë˜ìŠ¤/ë©”ì„œë“œ ì´ë¦„ ë‚œë…í™”</span>
-keepclassmembers class * {
    native <methods>;
}

<span class="text-green-400"># ë¦¬í”Œë ‰ì…˜ ë°©ì§€</span>
-keepattributes *Annotation*
-keepattributes Signature
-keepattributes Exceptions

<span class="text-gray-500">// build.gradle ì„¤ì •</span>
android {
    buildTypes {
        release {
            minifyEnabled true
            shrinkResources true
            proguardFiles getDefaultProguardFile(
                'proguard-android-optimize.txt'
            ), 'proguard-rules.pro'
            
            <span class="text-green-400">// í™˜ê²½ë³€ìˆ˜ ì£¼ì…</span>
            buildConfigField "String", "API_URL",
                System.getenv("API_URL")
        }
    }
}</code></pre>
            </div>

        </div>
    </div>

    <script>
        let isRunning = false;

        function resetAll() {
            isRunning = false;
            
            document.getElementById('attackerStatus').textContent = 'APK ë””ì»´íŒŒì¼ ì¤€ë¹„ ì¤‘...';
            
            document.getElementById('attackerScreen').innerHTML = 
                '<div class="text-gray-500">$ # Waiting for command...</div>';
            
            document.getElementById('decompileResult').innerHTML = 
                '<div class="text-gray-500">[JADX] Waiting...</div>';
            
            document.getElementById('decompileStatus').textContent = 'IDLE';
            document.getElementById('decompileStatus').className = 'text-xs bg-blue-600 px-3 py-1 rounded';
            
            document.getElementById('attackSteps').innerHTML = 
                '<div class="text-gray-500">ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”...</div>';
            
            document.getElementById('stolenData').classList.add('hidden');
            document.getElementById('problemBox').classList.add('hidden');
            document.getElementById('successBox').classList.add('hidden');
        }

        async function startScenario(scenario) {
            if (isRunning) return;
            isRunning = true;
            
            resetAll();
            await sleep(300);
            
            if (scenario === 1) {
                await scenario1_DatabaseHardcoding();
            } else if (scenario === 2) {
                await scenario2_ApiKeyExposure();
            } else if (scenario === 3) {
                await scenario3_AwsCredentials();
            }
            
            isRunning = false;
        }

        // ì‹œë‚˜ë¦¬ì˜¤ 1: DB ë¹„ë°€ë²ˆí˜¸ í•˜ë“œì½”ë”©
        async function scenario1_DatabaseHardcoding() {
            updateStep('ğŸ¯ ì‹œë‚˜ë¦¬ì˜¤ 1: DB ë¹„ë°€ë²ˆí˜¸ í•˜ë“œì½”ë”©');
            await sleep(1000);
            
            // 1ë‹¨ê³„: APK ë‹¤ìš´ë¡œë“œ
            updateStep('1ï¸âƒ£ ê³µê²©ìê°€ XXì€í–‰ ì•± ë‹¤ìš´ë¡œë“œ');
            document.getElementById('attackerStatus').textContent = 'APK ë‹¤ìš´ë¡œë“œ ì¤‘...';
            
            await addAttackerLog('$ wget https://xxbank.com/app/xxbank.apk');
            await sleep(500);
            await addAttackerLog('--2024-12-09 14:30:15--  https://xxbank.com/app/xxbank.apk');
            await sleep(300);
            await addAttackerLog('Resolving xxbank.com... 203.0.113.10');
            await sleep(300);
            await addAttackerLog('Connecting to xxbank.com:443... connected.');
            await sleep(500);
            await addAttackerLog('HTTP request sent, awaiting response... 200 OK');
            await sleep(300);
            await addAttackerLog('Length: 45678912 (44M) [application/vnd.android.package-archive]');
            await sleep(300);
            await addAttackerLog('Saving to: xxbank.apk');
            await sleep(800);
            await addAttackerLog('xxbank.apk        100%[==================>]  43.54M  5.2MB/s    in 9.2s');
            await sleep(500);
            await addAttackerLog('2024-12-09 14:30:24 (4.73 MB/s) - xxbank.apk saved [45678912/45678912]', 'text-green-400');
            await sleep(500);
            
            // 2ë‹¨ê³„: jadxë¡œ ë””ì»´íŒŒì¼
            updateStep('2ï¸âƒ£ jadxë¡œ APK ë””ì»´íŒŒì¼ ì‹œì‘');
            document.getElementById('attackerStatus').textContent = 'ë””ì»´íŒŒì¼ ì§„í–‰ ì¤‘...';
            
            await addAttackerLog('');
            await addAttackerLog('$ jadx -d xxbank_decompiled xxbank.apk', 'text-yellow-400');
            await sleep(500);
            
            updateDecompileStatus('PROCESSING', 'bg-yellow-600 animate-pulse');
            
            await addDecompileLog('[JADX] INFO: loading...', 'text-blue-400');
            await sleep(300);
            await addDecompileLog('[JADX] INFO: processing...', 'text-blue-400');
            await sleep(500);
            await addDecompileLog('[JADX] INFO: classes: 3,542', 'text-gray-400');
            await sleep(300);
            await addDecompileLog('[JADX] INFO: methods: 28,315', 'text-gray-400');
            await sleep(500);
            
            await addAttackerLog('INFO  - loading...', 'text-blue-400');
            await sleep(300);
            await addAttackerLog('INFO  - processing...', 'text-blue-400');
            await sleep(800);
            await addAttackerLog('INFO  - done', 'text-green-400');
            await sleep(500);
            
            // 3ë‹¨ê³„: ì†ŒìŠ¤ì½”ë“œ ê²€ìƒ‰
            updateStep('3ï¸âƒ£ ì†ŒìŠ¤ì½”ë“œì—ì„œ ë¯¼ê°ì •ë³´ ê²€ìƒ‰');
            
            await addAttackerLog('');
            await addAttackerLog('$ grep -r "password" xxbank_decompiled/', 'text-yellow-400');
            await sleep(500);
            await addAttackerLog('$ grep -r "DB_" xxbank_decompiled/', 'text-yellow-400');
            await sleep(800);
            
            await addDecompileLog('[SEARCH] Searching for credentials...', 'text-yellow-400');
            await sleep(500);
            await addDecompileLog('[FOUND] DatabaseHelper.java', 'text-red-400');
            await sleep(800);
            
            // 4ë‹¨ê³„: í•˜ë“œì½”ë”© ë°œê²¬!
            updateStep('4ï¸âƒ£ <span class="text-red-500 font-bold">DB ì •ë³´ í•˜ë“œì½”ë”© ë°œê²¬!</span>');
            document.getElementById('attackerStatus').textContent = 'DB ì •ë³´ íƒˆì·¨ ì„±ê³µ!';
            
            updateDecompileStatus('FOUND', 'bg-red-600');
            
            const hardcodedCode = `public class DatabaseHelper {
    private static final String DB_URL = 
        "jdbc:mysql://10.1.2.3:3306/bank_db";
    
    private static final String DB_USER = "admin";
    
    private static final String DB_PASSWORD = 
        "Bank@1234!";
    
    public Connection connect() {
        return DriverManager.getConnection(
            DB_URL, DB_USER, DB_PASSWORD);
    }
}`;

            await addDecompileLog('');
            await addDecompileLog('[CODE] DatabaseHelper.java:', 'text-cyan-400');
            await sleep(500);
            await addDecompileLog(hardcodedCode, 'text-red-300');
            await sleep(1000);
            
            // 5ë‹¨ê³„: DB ì ‘ì† ì‹œë„
            updateStep('5ï¸âƒ£ íƒˆì·¨í•œ ì •ë³´ë¡œ DB ì§ì ‘ ì ‘ì†');
            
            await addAttackerLog('');
            await addAttackerLog('$ mysql -h 10.1.2.3 -u admin -p', 'text-yellow-400');
            await sleep(500);
            await addAttackerLog('Enter password: Bank@1234!', 'text-red-400');
            await sleep(1000);
            await addAttackerLog('Welcome to the MySQL monitor.', 'text-green-400');
            await sleep(300);
            await addAttackerLog('');
            await addAttackerLog('mysql> USE bank_db;', 'text-cyan-400');
            await sleep(500);
            await addAttackerLog('Database changed', 'text-green-400');
            await sleep(300);
            await addAttackerLog('');
            await addAttackerLog('mysql> SHOW TABLES;', 'text-cyan-400');
            await sleep(800);
            await addAttackerLog('+-------------------+', 'text-gray-400');
            await addAttackerLog('| Tables_in_bank_db |', 'text-gray-400');
            await addAttackerLog('+-------------------+', 'text-gray-400');
            await addAttackerLog('| accounts          |', 'text-gray-400');
            await addAttackerLog('| transactions      |', 'text-gray-400');
            await addAttackerLog('| users             |', 'text-gray-400');
            await addAttackerLog('| cards             |', 'text-gray-400');
            await addAttackerLog('+-------------------+', 'text-gray-400');
            await sleep(500);
            await addAttackerLog('');
            await addAttackerLog('mysql> SELECT * FROM accounts LIMIT 5;', 'text-cyan-400');
            await sleep(1000);
            
            // íƒˆì·¨í•œ ë°ì´í„° í‘œì‹œ
            document.getElementById('stolenData').classList.remove('hidden');
            document.getElementById('stolenDataContent').innerHTML = 
                '<div class="text-cyan-400 mb-2">ğŸ“Š DB ì ‘ì† ì •ë³´:</div>' +
                '<div class="text-red-400">Host: 10.1.2.3:3306</div>' +
                '<div class="text-red-400">Database: bank_db</div>' +
                '<div class="text-red-400">Username: admin</div>' +
                '<div class="text-red-400">Password: Bank@1234!</div>' +
                '<div class="border-t border-gray-700 my-2"></div>' +
                '<div class="text-yellow-400 mb-2">ğŸ’° íƒˆì·¨í•œ ê³„ì¢Œ ì •ë³´:</div>' +
                '<div class="text-green-400">account_id | name | balance</div>' +
                '<div class="text-gray-400">10001 | ê¹€ì² ìˆ˜ | 15,000,000ì›</div>' +
                '<div class="text-gray-400">10002 | ì´ì˜í¬ | 28,500,000ì›</div>' +
                '<div class="text-gray-400">10003 | ë°•ë¯¼ìˆ˜ | 42,300,000ì›</div>' +
                '<div class="text-gray-400">... (ì „ì²´ 100,000+ ê³„ì¢Œ)</div>';
            
            showResults();
        }

        // ì‹œë‚˜ë¦¬ì˜¤ 2: API í‚¤ ë…¸ì¶œ
        async function scenario2_ApiKeyExposure() {
            updateStep('ğŸ¯ ì‹œë‚˜ë¦¬ì˜¤ 2: API í‚¤ ë…¸ì¶œ');
            await sleep(1000);
            
            updateStep('1ï¸âƒ£ APK ë‹¤ìš´ë¡œë“œ ë° ë””ì»´íŒŒì¼');
            
            await addAttackerLog('$ jadx -d xxbank_decompiled xxbank.apk', 'text-yellow-400');
            await sleep(500);
            await addAttackerLog('INFO  - done', 'text-green-400');
            await sleep(500);
            
            updateDecompileStatus('PROCESSING', 'bg-yellow-600');
            await addDecompileLog('[JADX] Decompiling...', 'text-blue-400');
            await sleep(800);
            
            updateStep('2ï¸âƒ£ API í‚¤ ê²€ìƒ‰');
            
            await addAttackerLog('');
            await addAttackerLog('$ grep -r "api.key\\|API_KEY\\|sk_live" xxbank_decompiled/', 'text-yellow-400');
            await sleep(800);
            
            await addDecompileLog('[SEARCH] Looking for API keys...', 'text-yellow-400');
            await sleep(500);
            await addDecompileLog('[FOUND] ApiClient.java', 'text-red-400');
            await sleep(500);
            
            updateStep('3ï¸âƒ£ <span class="text-red-500 font-bold">ê²°ì œ API í‚¤ ë°œê²¬!</span>');
            
            updateDecompileStatus('FOUND', 'bg-red-600');
            
            const apiCode = `public class ApiClient {
    private static final String API_KEY = 
        "sk_live_51HxJ9KLp2k3M4n5o6P7q8R9s0T";
    
    private static final String API_SECRET = 
        "whsec_9a8b7c6d5e4f3g2h1i0j";
    
    private static final String MERCHANT_ID = 
        "acct_1234567890ABCDEF";
    
    public void sendPayment(String amount) {
        headers.put("Authorization", 
            "Bearer " + API_KEY);
    }
}`;

            await addDecompileLog('');
            await addDecompileLog('[CODE] ApiClient.java:', 'text-cyan-400');
            await sleep(500);
            await addDecompileLog(apiCode, 'text-red-300');
            await sleep(1000);
            
            updateStep('4ï¸âƒ£ APIë¡œ ì§ì ‘ ê²°ì œ ìš”ì²­');
            
            await addAttackerLog('');
            await addAttackerLog('$ curl -X POST https://api.payment.com/v1/charges \\', 'text-yellow-400');
            await sleep(300);
            await addAttackerLog('  -H "Authorization: Bearer sk_live_51HxJ9KLp2k3M4n5o6P7q8R9s0T" \\', 'text-yellow-400');
            await sleep(300);
            await addAttackerLog('  -d "amount=5000000" \\', 'text-yellow-400');
            await sleep(300);
            await addAttackerLog('  -d "currency=krw"', 'text-yellow-400');
            await sleep(1000);
            await addAttackerLog('');
            await addAttackerLog('{', 'text-green-400');
            await addAttackerLog('  "id": "ch_3NxyABCD1234",', 'text-green-400');
            await addAttackerLog('  "status": "succeeded",', 'text-green-400');
            await addAttackerLog('  "amount": 5000000,', 'text-green-400');
            await addAttackerLog('  "currency": "krw"', 'text-green-400');
            await addAttackerLog('}', 'text-green-400');
            await sleep(500);
            
            document.getElementById('stolenData').classList.remove('hidden');
            document.getElementById('stolenDataContent').innerHTML = 
                '<div class="text-cyan-400 mb-2">ğŸ”‘ íƒˆì·¨í•œ API ì •ë³´:</div>' +
                '<div class="text-red-400">API Key: sk_live_51HxJ9K...</div>' +
                '<div class="text-red-400">API Secret: whsec_9a8b7c6...</div>' +
                '<div class="text-red-400">Merchant ID: acct_1234...</div>' +
                '<div class="border-t border-gray-700 my-2"></div>' +
                '<div class="text-yellow-400 mb-2">ğŸ’³ ì‹¤í–‰í•œ ê³µê²©:</div>' +
                '<div class="text-green-400">âœ“ 5,000,000ì› ê²°ì œ ì„±ê³µ</div>' +
                '<div class="text-green-400">âœ“ ì€í–‰ ëª…ì˜ë¡œ ë¬´ë‹¨ ê²°ì œ</div>' +
                '<div class="text-green-400">âœ“ API ì‚¬ìš©ëŸ‰ ë¬´ì œí•œ</div>';
            
            showResults();
        }

        // ì‹œë‚˜ë¦¬ì˜¤ 3: AWS ìê²©ì¦ëª… ë…¸ì¶œ
        async function scenario3_AwsCredentials() {
            updateStep('ğŸ¯ ì‹œë‚˜ë¦¬ì˜¤ 3: AWS ìê²©ì¦ëª… ë…¸ì¶œ');
            await sleep(1000);
            
            updateStep('1ï¸âƒ£ APK ë””ì»´íŒŒì¼ ë° ê²€ìƒ‰');
            
            await addAttackerLog('$ jadx -d xxbank_decompiled xxbank.apk', 'text-yellow-400');
            await sleep(500);
            await addAttackerLog('INFO  - done', 'text-green-400');
            await sleep(500);
            
            updateDecompileStatus('PROCESSING', 'bg-yellow-600');
            
            await addAttackerLog('');
            await addAttackerLog('$ grep -r "AKIA\\|aws_access" xxbank_decompiled/', 'text-yellow-400');
            await sleep(800);
            
            await addDecompileLog('[SEARCH] Searching for AWS credentials...', 'text-yellow-400');
            await sleep(500);
            await addDecompileLog('[FOUND] CloudConfig.java', 'text-red-400');
            await sleep(500);
            
            updateStep('2ï¸âƒ£ <span class="text-red-500 font-bold">AWS ìê²©ì¦ëª… ë°œê²¬!</span>');
            
            updateDecompileStatus('CRITICAL', 'bg-red-600 animate-pulse');
            
            const awsCode = `public class CloudConfig {
    public static final String AWS_ACCESS_KEY = 
        "AKIAIOSFODNN7EXAMPLE";
    
    public static final String AWS_SECRET_KEY = 
        "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY";
    
    public static final String S3_BUCKET = 
        "xxbank-customer-data";
    
    public static final String REGION = "ap-northeast-2";
}`;

            await addDecompileLog('');
            await addDecompileLog('[CODE] CloudConfig.java:', 'text-cyan-400');
            await sleep(500);
            await addDecompileLog(awsCode, 'text-red-300');
            await sleep(1000);
            
            updateStep('3ï¸âƒ£ AWS CLIë¡œ S3 ë²„í‚· ì ‘ê·¼');
            
            await addAttackerLog('');
            await addAttackerLog('$ aws configure', 'text-yellow-400');
            await sleep(300);
            await addAttackerLog('AWS Access Key ID: AKIAIOSFODNN7EXAMPLE', 'text-red-400');
            await sleep(300);
            await addAttackerLog('AWS Secret Access Key: wJalrXUt...', 'text-red-400');
            await sleep(500);
            await addAttackerLog('');
            await addAttackerLog('$ aws s3 ls s3://xxbank-customer-data/', 'text-yellow-400');
            await sleep(1000);
            await addAttackerLog('2024-01-15 10:30:45  customers.csv', 'text-gray-400');
            await addAttackerLog('2024-02-20 14:22:13  transactions/', 'text-gray-400');
            await addAttackerLog('2024-03-10 09:15:32  account_backup.sql', 'text-gray-400');
            await addAttackerLog('2024-04-05 16:45:21  user_data/', 'text-gray-400');
            await sleep(500);
            
            updateStep('4ï¸âƒ£ ê³ ê° ë°ì´í„° ë‹¤ìš´ë¡œë“œ');
            
            await addAttackerLog('');
            await addAttackerLog('$ aws s3 cp s3://xxbank-customer-data/customers.csv ./', 'text-yellow-400');
            await sleep(1000);
            await addAttackerLog('download: s3://xxbank-customer-data/customers.csv to ./customers.csv', 'text-green-400');
            await sleep(500);
            await addAttackerLog('');
            await addAttackerLog('$ head customers.csv', 'text-yellow-400');
            await sleep(500);
            await addAttackerLog('name,ssn,account,phone,balance', 'text-cyan-400');
            await addAttackerLog('ê¹€ì² ìˆ˜,801234-1234567,110-123-456789,010-1234-5678,15000000', 'text-gray-400');
            await addAttackerLog('ì´ì˜í¬,850512-2345678,110-234-567890,010-2345-6789,28500000', 'text-gray-400');
            await sleep(500);
            
            document.getElementById('stolenData').classList.remove('hidden');
            document.getElementById('stolenDataContent').innerHTML = 
                '<div class="text-cyan-400 mb-2">â˜ï¸ AWS ìê²©ì¦ëª…:</div>' +
                '<div class="text-red-400">Access Key: AKIAIOSFODN...</div>' +
                '<div class="text-red-400">Secret Key: wJalrXUtnF...</div>' +
                '<div class="text-red-400">Region: ap-northeast-2</div>' +
                '<div class="border-t border-gray-700 my-2"></div>' +
                '<div class="text-yellow-400 mb-2">ğŸ’¾ íƒˆì·¨í•œ ë°ì´í„°:</div>' +
                '<div class="text-green-400">âœ“ customers.csv (100,000+ ê³ ê°)</div>' +
                '<div class="text-green-400">âœ“ account_backup.sql (ì „ì²´ DB)</div>' +
                '<div class="text-green-400">âœ“ transactions/ (ê±°ë˜ ë‚´ì—­)</div>' +
                '<div class="text-red-400 mt-2">âš ï¸ ì£¼ë¯¼ë²ˆí˜¸ í¬í•¨!</div>';
            
            showResults();
        }

        function showResults() {
            document.getElementById('problemBox').classList.remove('hidden');
            document.getElementById('problemContent').innerHTML = 
                '<div class="bg-black bg-opacity-30 p-3 rounded">' +
                '<p class="font-bold mb-2">âŒ í•˜ë“œì½”ë”© ë¬¸ì œì :</p>' +
                '<div class="space-y-1 ml-4">' +
                '<div>1. ë¯¼ê°ì •ë³´ê°€ ì†ŒìŠ¤ì½”ë“œì— í‰ë¬¸ ë…¸ì¶œ</div>' +
                '<div>2. APK ë””ì»´íŒŒì¼ë¡œ ì‰½ê²Œ ì¶”ì¶œ ê°€ëŠ¥</div>' +
                '<div>3. ë‚œë…í™”ë§Œìœ¼ë¡œëŠ” ë°©ì–´ ë¶ˆê°€</div>' +
                '<div>4. í•œë²ˆ ë…¸ì¶œë˜ë©´ ë³€ê²½ ë¶ˆê°€</div>' +
                '</div></div>' +
                '<div class="bg-black bg-opacity-30 p-3 rounded mt-2">' +
                '<p class="font-bold mb-2">ğŸ’¥ ì˜ˆìƒ í”¼í•´:</p>' +
                '<div class="space-y-1 ml-4">' +
                '<div>â€¢ DB ì „ì²´ ì ‘ê·¼ ê°€ëŠ¥</div>' +
                '<div>â€¢ API ë¬´ë‹¨ ì‚¬ìš©</div>' +
                '<div>â€¢ í´ë¼ìš°ë“œ ë°ì´í„° íƒˆì·¨</div>' +
                '<div>â€¢ ê°œì¸ì •ë³´ ëŒ€ëŸ‰ ìœ ì¶œ</div>' +
                '</div></div>';
            
            document.getElementById('successBox').classList.remove('hidden');
            document.getElementById('successContent').innerHTML = 
                '<div class="bg-black bg-opacity-30 p-3 rounded">' +
                '<p class="font-bold mb-2">ğŸ¯ ê³µê²© ì„±ê³µ:</p>' +
                '<div class="space-y-1 ml-4">' +
                '<div>â€¢ jadxë¡œ APK ë””ì»´íŒŒì¼</div>' +
                '<div>â€¢ í•˜ë“œì½”ë”©ëœ ì •ë³´ íƒˆì·¨</div>' +
                '<div>â€¢ ì„œë²„/DB ì§ì ‘ ì ‘ê·¼</div>' +
                '</div></div>' +
                '<div class="bg-black bg-opacity-30 p-3 rounded mt-2">' +
                '<p class="font-bold mb-2">ğŸ›¡ï¸ í•„ìš”í•œ ë°©ì–´:</p>' +
                '<div class="space-y-1 ml-4">' +
                '<div>â€¢ í™˜ê²½ë³€ìˆ˜ ì‚¬ìš©</div>' +
                '<div>â€¢ Android KeyStore í™œìš©</div>' +
                '<div>â€¢ ì„œë²„ì—ì„œ ë™ì ìœ¼ë¡œ í‚¤ ì „ë‹¬</div>' +
                '<div>â€¢ ì•”í˜¸í™”ëœ ì„¤ì • íŒŒì¼</div>' +
                '</div></div>';
        }

        function updateStep(html) {
            const steps = document.getElementById('attackSteps');
            const div = document.createElement('div');
            div.className = 'p-2 bg-gray-700 rounded text-sm slide-in';
            div.innerHTML = html;
            steps.appendChild(div);
            steps.scrollTop = steps.scrollHeight;
        }

        async function addAttackerLog(message, colorClass = 'text-green-400') {
            const div = document.createElement('div');
            div.className = colorClass;
            div.textContent = message;
            const container = document.getElementById('attackerScreen');
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
            await sleep(50);
        }

        async function addDecompileLog(message, colorClass = 'text-green-400') {
            const div = document.createElement('div');
            div.className = colorClass;
            div.textContent = message;
            const container = document.getElementById('decompileResult');
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
            await sleep(50);
        }

        function updateDecompileStatus(text, className) {
            document.getElementById('decompileStatus').textContent = text;
            document.getElementById('decompileStatus').className = 'text-xs text-white px-3 py-1 rounded ' + className;
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
    </script>
</body>
</html>