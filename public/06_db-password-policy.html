<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>D-02~05 íŒ¨ìŠ¤ì›Œë“œ ì •ì±… ê´€ë¦¬ - DB ë³´ì•ˆ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f4f6f9; padding: 20px; }
        .container { max-width: 1400px; }
        .header { background: #2c3e50; color: white; padding: 25px; border-radius: 10px; margin-bottom: 20px; text-align: center; }
        .nav-pills .nav-link { background: white; color: #555; margin-right: 10px; border: 1px solid #ddd; font-weight: bold; }
        .nav-pills .nav-link.active { background: #0d6efd; color: white; border-color: #0d6efd; }
        .code-box { background: #1e1e1e; color: #d4d4d4; padding: 20px; border-radius: 8px; font-family: 'Consolas', monospace; min-height: 300px; white-space: pre; }
        .badge-risk { background: #dc3545; color: white; font-size: 0.8em; padding: 5px 10px; border-radius: 4px; }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>ğŸ” DB íŒ¨ìŠ¤ì›Œë“œ ì •ì±… (Oracle Profile)</h1>
        <p class="mb-0 text-white-50">D-02(ì‹¤íŒ¨ì œí•œ), D-03(ë§Œë£Œê¸°ê°„), D-04(ë³µì¡ì„±), D-05(ì¬ì‚¬ìš©ë°©ì§€)</p>
    </div>

    <!-- íƒ­ ë©”ë‰´: event ëŒ€ì‹  thisë¥¼ ì „ë‹¬í•˜ë„ë¡ ìˆ˜ì • -->
    <ul class="nav nav-pills mb-4" id="pills-tab" role="tablist">
        <li class="nav-item"><button class="nav-link active" onclick="setContext(this, 'd02')">D-02 ì‹¤íŒ¨ ì œí•œ</button></li>
        <li class="nav-item"><button class="nav-link" onclick="setContext(this, 'd03')">D-03 ë§Œë£Œ ê¸°ê°„</button></li>
        <li class="nav-item"><button class="nav-link" onclick="setContext(this, 'd04')">D-04 ë³µì¡ì„± ê²€ì¦</button></li>
        <li class="nav-item"><button class="nav-link" onclick="setContext(this, 'd05')">D-05 ì¬ì‚¬ìš© ë°©ì§€</button></li>
    </ul>

    <div class="row">
        <div class="col-lg-8">
            <div class="card h-100 shadow-sm">
                <div class="card-header bg-white d-flex justify-content-between align-items-center">
                    <strong class="text-primary"><i class="fa-solid fa-terminal me-2"></i>DBA_PROFILES ì¡°íšŒ ê²°ê³¼</strong>
                    <span id="status-badge" class="badge bg-danger">ì·¨ì•½ (Vulnerable)</span>
                </div>
                <div class="card-body bg-dark p-0">
                    <div id="editor" class="code-box"></div>
                </div>
                <div class="card-footer bg-white">
                    <div class="d-flex gap-2">
                        <button class="btn btn-primary fw-bold flex-grow-1" onclick="checkVuln()">ğŸ” ì§„ë‹¨í•˜ê¸°</button>
                        <button class="btn btn-success fw-bold flex-grow-1" onclick="fixVuln()">ğŸ›¡ï¸ ì¡°ì¹˜í•˜ê¸° (Auto Fix)</button>
                        <button class="btn btn-secondary" onclick="resetVuln()"><i class="fa-solid fa-rotate-right"></i></button>
                    </div>
                    <div id="result-msg" class="mt-3 p-2 rounded text-center fw-bold" style="display:none;"></div>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="card h-100 shadow-sm">
                <div class="card-body">
                    <!-- D-02 Guide -->
                    <div id="info-d02" class="info-content">
                        <span class="badge-risk mb-2">ìœ„í—˜ë„: ìƒ</span>
                        <h5>D-02 ë¡œê·¸ì¸ ì‹¤íŒ¨ íšŸìˆ˜ ì œí•œ</h5>
                        <hr>
                        <p>ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²©(Brute Force) ë°©ì§€.</p>
                        <div class="alert alert-warning small">
                            <strong>ê¸°ì¤€:</strong> <code>FAILED_LOGIN_ATTEMPTS</code> â‰¤ 5
                        </div>
                        <h6>ğŸ”§ ì¡°ì¹˜ ë°©ë²•</h6>
                        <pre class="bg-light p-2 rounded small">ALTER PROFILE DEFAULT LIMIT FAILED_LOGIN_ATTEMPTS 5;</pre>
                    </div>
                    <!-- D-03 Guide -->
                    <div id="info-d03" class="info-content" style="display:none;">
                        <span class="badge-risk mb-2">ìœ„í—˜ë„: ìƒ</span>
                        <h5>D-03 íŒ¨ìŠ¤ì›Œë“œ ë§Œë£Œ ê¸°ê°„</h5>
                        <hr>
                        <p>íŒ¨ìŠ¤ì›Œë“œ ì˜êµ¬ ì‚¬ìš© ë°©ì§€.</p>
                        <div class="alert alert-warning small">
                            <strong>ê¸°ì¤€:</strong> <code>PASSWORD_LIFE_TIME</code> â‰¤ 90 (ì¼)
                        </div>
                        <h6>ğŸ”§ ì¡°ì¹˜ ë°©ë²•</h6>
                        <pre class="bg-light p-2 rounded small">ALTER PROFILE DEFAULT LIMIT PASSWORD_LIFE_TIME 90;</pre>
                    </div>
                    <!-- D-04 Guide -->
                    <div id="info-d04" class="info-content" style="display:none;">
                        <span class="badge-risk mb-2">ìœ„í—˜ë„: ìƒ</span>
                        <h5>D-04 íŒ¨ìŠ¤ì›Œë“œ ë³µì¡ì„±</h5>
                        <hr>
                        <p>ê¸¸ì´, íŠ¹ìˆ˜ë¬¸ì ë“± ë³µì¡ë„ ê°•ì œ.</p>
                        <div class="alert alert-warning small">
                            <strong>ê¸°ì¤€:</strong> <code>PASSWORD_VERIFY_FUNCTION</code> ì„¤ì • í•„ìˆ˜
                        </div>
                        <h6>ğŸ”§ ì¡°ì¹˜ ë°©ë²•</h6>
                        <pre class="bg-light p-2 rounded small">-- 11g ì´ìƒ
ALTER PROFILE DEFAULT LIMIT PASSWORD_VERIFY_FUNCTION VERIFY_FUNCTION_11G;</pre>
                    </div>
                    <!-- D-05 Guide -->
                    <div id="info-d05" class="info-content" style="display:none;">
                        <span class="badge-risk mb-2">ìœ„í—˜ë„: ìƒ</span>
                        <h5>D-05 íŒ¨ìŠ¤ì›Œë“œ ì¬ì‚¬ìš© ë°©ì§€</h5>
                        <hr>
                        <p>ì´ì „ ë¹„ë°€ë²ˆí˜¸ ì¬ì‚¬ìš© ì œí•œ.</p>
                        <div class="alert alert-warning small">
                            <strong>ê¸°ì¤€:</strong> <code>PASSWORD_REUSE_MAX</code> â‰¥ 3
                        </div>
                        <h6>ğŸ”§ ì¡°ì¹˜ ë°©ë²•</h6>
                        <pre class="bg-light p-2 rounded small">ALTER PROFILE DEFAULT LIMIT PASSWORD_REUSE_MAX 3;</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    let currentMode = 'd02';
    const data = {
        d02: { bad: `PROFILE   RESOURCE_NAME          LIMIT\n-------   ---------------------  ---------\nDEFAULT   FAILED_LOGIN_ATTEMPTS  UNLIMITED`, good: `PROFILE   RESOURCE_NAME          LIMIT\n-------   ---------------------  ---------\nDEFAULT   FAILED_LOGIN_ATTEMPTS  5` },
        d03: { bad: `PROFILE   RESOURCE_NAME       LIMIT\n-------   ------------------  ---------\nDEFAULT   PASSWORD_LIFE_TIME  UNLIMITED`, good: `PROFILE   RESOURCE_NAME       LIMIT\n-------   ------------------  ---------\nDEFAULT   PASSWORD_LIFE_TIME  90` },
        d04: { bad: `PROFILE   RESOURCE_NAME             LIMIT\n-------   ------------------------  ---------\nDEFAULT   PASSWORD_VERIFY_FUNCTION  NULL`, good: `PROFILE   RESOURCE_NAME             LIMIT\n-------   ------------------------  -------------------\nDEFAULT   PASSWORD_VERIFY_FUNCTION  VERIFY_FUNCTION_11G` },
        d05: { bad: `PROFILE   RESOURCE_NAME       LIMIT\n-------   ------------------  ---------\nDEFAULT   PASSWORD_REUSE_MAX  UNLIMITED`, good: `PROFILE   RESOURCE_NAME       LIMIT\n-------   ------------------  ---------\nDEFAULT   PASSWORD_REUSE_MAX  3` }
    };

    // Fix: ë§¤ê°œë³€ìˆ˜ ì´ë¦„ì„ eì—ì„œ el(element)ë¡œ ë³€ê²½í•˜ì—¬ ëª…í™•íˆ í•¨
    function setContext(el, mode) {
        currentMode = mode;
        
        // 1. ê°€ì´ë“œ íŒ¨ë„ ì—…ë°ì´íŠ¸
        document.querySelectorAll('.info-content').forEach(element => element.style.display = 'none');
        const guide = document.getElementById('info-' + mode);
        if (guide) guide.style.display = 'block';
        
        // 2. íƒ­ Active ìƒíƒœ ì—…ë°ì´íŠ¸
        document.querySelectorAll('.nav-link').forEach(btn => btn.classList.remove('active'));
        if (el) {
            el.classList.add('active');
        } else {
            // ì´ˆê¸°í™” ì‹œ(elì´ nullì¼ ë•Œ) í•´ë‹¹ ëª¨ë“œì˜ ë²„íŠ¼ì„ ì°¾ì•„ í™œì„±í™”
            const targetBtn = document.querySelector(`button[onclick*="'${mode}'"]`);
            if (targetBtn) targetBtn.classList.add('active');
        }
        
        // 3. ì—ë””í„° ì´ˆê¸°í™”
        resetVuln();
    }

    function resetVuln() {
        document.getElementById('editor').innerText = data[currentMode].bad;
        updateStatus(false);
    }

    function checkVuln() {
        const text = document.getElementById('editor').innerText;
        // ê°„ë‹¨í•œ ë¬¸ìì—´ í¬í•¨ ì—¬ë¶€ë¡œ ì§„ë‹¨
        const isSecure = !text.includes('UNLIMITED') && !text.includes('NULL');
        updateStatus(isSecure);
    }

    function fixVuln() {
        document.getElementById('editor').innerText = data[currentMode].good;
        updateStatus(true);
    }

    function updateStatus(isSecure) {
        const badge = document.getElementById('status-badge');
        const msg = document.getElementById('result-msg');
        
        if (isSecure) {
            badge.className = 'badge bg-success'; badge.innerText = 'ì–‘í˜¸ (Secure)';
            msg.style.display = 'block'; msg.className = 'mt-3 p-2 rounded text-center fw-bold bg-success text-white'; msg.innerText = 'âœ… ì„¤ì •ì´ ì•ˆì „í•˜ê²Œ ì¡°ì¹˜ë˜ì—ˆìŠµë‹ˆë‹¤.';
        } else {
            badge.className = 'badge bg-danger'; badge.innerText = 'ì·¨ì•½ (Vulnerable)';
            msg.style.display = 'block'; msg.className = 'mt-3 p-2 rounded text-center fw-bold bg-danger bg-opacity-25 text-danger'; msg.innerText = 'âš ï¸ ë³´ì•ˆ ì·¨ì•½ì ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì¡°ì¹˜ê°€ í•„ìš”í•©ë‹ˆë‹¤.';
        }
    }
    
    // ì´ˆê¸°í™” í˜¸ì¶œ (null ì „ë‹¬ ì‹œ ë‚´ë¶€ì—ì„œ ì²˜ë¦¬ë¨)
    setContext(null, 'd02'); 
</script>
</body>
</html>