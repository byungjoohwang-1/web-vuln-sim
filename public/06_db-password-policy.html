<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D-08 ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • - DB ë³´ì•ˆ ì‹œë®¬ë ˆì´í„°</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Segoe UI', 'Malgun Gothic', sans-serif; background: #eef2f5; padding: 20px; }
        .container { max-width: 1400px; }
        .header { background: #2c3e50; color: white; padding: 25px; border-radius: 10px; margin-bottom: 20px; text-align: center; border-bottom: 5px solid #00aaaa; }
        .header h1 { color: #00aaaa; font-weight: 800; }
        
        .mode-tabs { display: flex; gap: 15px; margin-bottom: 20px; }
        .mode-tab { flex: 1; padding: 15px; background: rgba(255,255,255,0.9); border: none; border-radius: 12px; cursor: pointer; transition: 0.3s; font-weight: bold; text-align: left; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .mode-tab.active { background: linear-gradient(135deg, #00aaaa 0%, #008888 100%); color: white; transform: translateY(-3px); }
        
        .content-wrapper { display: none; }
        .content-wrapper.active { display: block; animation: fadeIn 0.5s; }
        
        .panel { background: white; border-radius: 12px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); height: 100%; display: flex; flex-direction: column; }
        
        .terminal { background: #1e1e1e; color: #00ff00; padding: 15px; border-radius: 5px; font-family: 'Consolas', monospace; flex-grow: 1; overflow-y: auto; max-height: 500px; font-size: 0.95em; line-height: 1.6; }
        .term-line { margin-bottom: 5px; word-break: break-all; }
        .vuln { color: #ff5555; font-weight: bold; }
        .secure { color: #50fa7b; font-weight: bold; }
        .info { color: #8be9fd; }
        .comment { color: #6272a4; }
        
        .status-badge { padding: 5px 12px; border-radius: 15px; font-size: 0.85em; font-weight: bold; color: white; }
        .status-vulnerable { background: #dc3545; animation: pulse 2s infinite; }
        .status-secure { background: #198754; }
        
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.7; } 100% { opacity: 1; } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <span class="badge bg-secondary mb-2">ì£¼ìš”ì •ë³´í†µì‹ ê¸°ë°˜ì‹œì„¤ ê¸°ìˆ ì  ì·¨ì•½ì  ê°€ì´ë“œ</span>
        <h1>ğŸ—„ï¸ D-08 ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì •</h1>
        <p class="mb-0 text-white-50">Oracle(IDLE_TIME) & MySQL(wait_timeout) Session Management Check</p>
    </div>

    <div class="mode-tabs">
        <button class="mode-tab active" onclick="switchTab(event, 'oracle')">
            <i class="fa-solid fa-database me-2"></i>Oracle Database
            <div class="small opacity-75 mt-1">Profile & Resource Limit ì ê²€</div>
        </button>
        <button class="mode-tab" onclick="switchTab(event, 'mysql')">
            <i class="fa-solid fa-server me-2"></i>MySQL / MariaDB
            <div class="small opacity-75 mt-1">Timeout Variables ì ê²€</div>
        </button>
    </div>

    <!-- Oracle Mode -->
    <div id="oracle-content" class="content-wrapper active">
        <div class="row g-4">
            <div class="col-lg-7">
                <div class="panel">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h5 class="m-0 fw-bold"><i class="fa-solid fa-terminal me-2"></i>SQL*Plus Terminal</h5>
                        <span id="status-oracle" class="status-badge status-vulnerable">ì·¨ì•½ (Vulnerable)</span>
                    </div>
                    <div class="terminal" id="term-oracle">
                        <div class="term-line">SQL*Plus: Release 19.0.0.0.0 - Production</div>
                        <div class="term-line">Connected to: Oracle Database 19c Enterprise Edition</div>
                        <div class="term-line"><br></div>
                        <div class="term-line">SQL> <span class="comment">-- Ready to check session timeout settings</span></div>
                    </div>
                </div>
            </div>
            <div class="col-lg-5">
                <div class="panel">
                    <h5 class="fw-bold"><i class="fa-solid fa-shield-halved me-2"></i>ìƒì„¸ ì¡°ì¹˜ ê°€ì´ë“œ (KISA 2026)</h5>
                    <div class="alert alert-warning small mt-3">
                        <i class="fa-solid fa-triangle-exclamation me-1"></i><strong>ìœ„í—˜ì„±:</strong><br>
                        ì„¸ì…˜ íƒ€ì„ì•„ì›ƒì´ ì„¤ì •ë˜ì§€ ì•Šì€ ê²½ìš°, ê´€ë¦¬ìê°€ ìë¦¬ë¥¼ ë¹„ìš´ ì‚¬ì´ ë¹„ì¸ê°€ìê°€ ì—°ê²°ëœ ì„¸ì…˜ì„ í†µí•´ ì‹œìŠ¤í…œì„ ë¬´ë‹¨ìœ¼ë¡œ ì¡°ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    </div>
                    
                    <div class="accordion" id="guideAccordionOracle">
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#checkOracle">
                                    ğŸ” ì ê²€ ë°©ë²• (Check)
                                </button>
                            </h2>
                            <div id="checkOracle" class="accordion-collapse collapse show">
                                <div class="accordion-body small bg-light">
                                    <p>1. í”„ë¡œíŒŒì¼ì˜ <code>IDLE_TIME</code> ì„¤ì • í™•ì¸ (60ë¶„ ì´í•˜)</p>
                                    <div class="p-2 bg-dark text-white rounded font-monospace mb-2">
                                        SELECT RESOURCE_NAME, LIMIT FROM DBA_PROFILES WHERE RESOURCE_NAME='IDLE_TIME';
                                    </div>
                                    <p>2. <code>RESOURCE_LIMIT</code> íŒŒë¼ë¯¸í„° í™œì„±í™” ì—¬ë¶€ í™•ì¸ (TRUE)</p>
                                    <div class="p-2 bg-dark text-white rounded font-monospace">
                                        SHOW PARAMETER RESOURCE_LIMIT;
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#fixOracle">
                                    ğŸ”§ ì¡°ì¹˜ ë°©ë²• (Action)
                                </button>
                            </h2>
                            <div id="fixOracle" class="accordion-collapse collapse">
                                <div class="accordion-body small bg-light">
                                    <p><strong>Step 1. í”„ë¡œíŒŒì¼ ì„¤ì • (60ë¶„)</strong></p>
                                    <pre class="p-2 bg-dark text-white rounded">ALTER PROFILE DEFAULT LIMIT IDLE_TIME 60;</pre>
                                    <p class="mt-2"><strong>Step 2. ë¦¬ì†ŒìŠ¤ ì œí•œ ê¸°ëŠ¥ í™œì„±í™”</strong></p>
                                    <pre class="p-2 bg-dark text-white rounded">ALTER SYSTEM SET RESOURCE_LIMIT = TRUE;</pre>
                                    <p class="text-danger small mt-1">â€» RESOURCE_LIMITì´ FALSEë©´ IDLE_TIMEì´ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-grid gap-2 mt-auto pt-3">
                        <button class="btn btn-primary fw-bold" onclick="runCheck('oracle')">ğŸ” ì·¨ì•½ì  ì§„ë‹¨ (Check Vulnerability)</button>
                        <button class="btn btn-success fw-bold" onclick="runFix('oracle')">ğŸ›¡ï¸ ìë™ ì¡°ì¹˜ (Auto Fix)</button>
                        <button class="btn btn-secondary" onclick="resetSim('oracle')">ğŸ”„ ì´ˆê¸°í™” (Reset)</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MySQL Mode -->
    <div id="mysql-content" class="content-wrapper">
        <div class="row g-4">
            <div class="col-lg-7">
                <div class="panel">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h5 class="m-0 fw-bold"><i class="fa-solid fa-terminal me-2"></i>MySQL Terminal</h5>
                        <span id="status-mysql" class="status-badge status-vulnerable">ì·¨ì•½ (Vulnerable)</span>
                    </div>
                    <div class="terminal" id="term-mysql">
                        <div class="term-line">Welcome to the MySQL monitor.  Commands end with ; or \g.</div>
                        <div class="term-line">Server version: 8.0.35 MySQL Community Server</div>
                        <div class="term-line"><br></div>
                        <div class="term-line">mysql> <span class="comment">-- Ready to check timeout variables</span></div>
                    </div>
                </div>
            </div>
            <div class="col-lg-5">
                <div class="panel">
                    <h5 class="fw-bold"><i class="fa-solid fa-shield-halved me-2"></i>ìƒì„¸ ì¡°ì¹˜ ê°€ì´ë“œ (MySQL)</h5>
                    <div class="alert alert-warning small mt-3">
                        <i class="fa-solid fa-triangle-exclamation me-1"></i><strong>ìœ„í—˜ì„±:</strong><br>
                        MySQLì˜ ì ‘ì† íƒ€ì„ì•„ì›ƒ(wait_timeout) ì„¤ì •ì´ ì—†ê±°ë‚˜ ë„ˆë¬´ ê¸¸ë©´, ì¢€ë¹„ ì»¤ë„¥ì…˜ì´ ì¦ê°€í•˜ê±°ë‚˜ ì„¸ì…˜ í•˜ì´ì¬í‚¹ì˜ ìœ„í—˜ì´ ì»¤ì§‘ë‹ˆë‹¤.
                    </div>
                    
                    <div class="accordion" id="guideAccordionMysql">
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#checkMysql">
                                    ğŸ” ì ê²€ ë°©ë²• (Check)
                                </button>
                            </h2>
                            <div id="checkMysql" class="accordion-collapse collapse show">
                                <div class="accordion-body small bg-light">
                                    <p>ì‹œìŠ¤í…œ ë³€ìˆ˜ ì¤‘ íƒ€ì„ì•„ì›ƒ ê´€ë ¨ ì„¤ì •ì„ í™•ì¸í•©ë‹ˆë‹¤.</p>
                                    <div class="p-2 bg-dark text-white rounded font-monospace">
                                        SHOW GLOBAL VARIABLES LIKE '%timeout';
                                    </div>
                                    <p class="mt-2 text-muted small">ì£¼ìš” ì ê²€ í•­ëª©: <code>interactive_timeout</code>, <code>wait_timeout</code></p>
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#fixMysql">
                                    ğŸ”§ ì¡°ì¹˜ ë°©ë²• (Action)
                                </button>
                            </h2>
                            <div id="fixMysql" class="accordion-collapse collapse">
                                <div class="accordion-body small bg-light">
                                    <p><strong>Step 1. íƒ€ì„ì•„ì›ƒ ì„¤ì • (3600ì´ˆ/60ë¶„)</strong></p>
                                    <pre class="p-2 bg-dark text-white rounded">SET GLOBAL interactive_timeout = 3600;
SET GLOBAL wait_timeout = 3600;</pre>
                                    <p class="mt-2"><strong>Step 2. ì˜êµ¬ ì ìš© (my.cnf)</strong></p>
                                    <pre class="p-2 bg-dark text-white rounded">[mysqld]
interactive_timeout=3600
wait_timeout=3600</pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-grid gap-2 mt-auto pt-3">
                        <button class="btn btn-primary fw-bold" onclick="runCheck('mysql')">ğŸ” ì·¨ì•½ì  ì§„ë‹¨ (Check Vulnerability)</button>
                        <button class="btn btn-success fw-bold" onclick="runFix('mysql')">ğŸ›¡ï¸ ìë™ ì¡°ì¹˜ (Auto Fix)</button>
                        <button class="btn btn-secondary" onclick="resetSim('mysql')">ğŸ”„ ì´ˆê¸°í™” (Reset)</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function switchTab(event, mode) {
        document.querySelectorAll('.mode-tab').forEach(t => t.classList.remove('active'));
        if (event) {
            event.currentTarget.classList.add('active');
        } else {
             // Fallback for direct calls if needed, though event is passed in HTML
             document.querySelector(`.mode-tab[onclick*="'${mode}'"]`).classList.add('active');
        }
        
        document.querySelectorAll('.content-wrapper').forEach(c => c.classList.remove('active'));
        document.getElementById(mode + '-content').classList.add('active');
    }

    // State Data
    const oracleState = { idleTime: 'UNLIMITED', resourceLimit: 'FALSE' };
    const mysqlState = { interactive: '28800', wait: '28800' }; // Default 8 hours

    function log(mode, msg, type='info') {
        const term = document.getElementById(`term-${mode}`);
        const colorClass = type === 'vuln' ? 'vuln' : (type === 'secure' ? 'secure' : (type === 'cmd' ? 'info' : ''));
        const prompt = mode === 'oracle' ? 'SQL>' : 'mysql>';
        
        let html = '';
        if (type === 'cmd') {
            html = `<div class="term-line"><span style="color:#0ff;font-weight:bold;">${prompt}</span> ${msg}</div>`;
        } else {
            html = `<div class="term-line ${colorClass}">${msg}</div>`;
        }
        term.innerHTML += html;
        term.scrollTop = term.scrollHeight;
    }

    function runCheck(mode) {
        if (mode === 'oracle') {
            log(mode, "SELECT RESOURCE_NAME, LIMIT FROM DBA_PROFILES WHERE RESOURCE_NAME='IDLE_TIME';", 'cmd');
            log(mode, `RESOURCE_NAME       LIMIT`);
            log(mode, `---------------     ---------`);
            const style1 = oracleState.idleTime === 'UNLIMITED' ? 'vuln' : 'secure';
            log(mode, `IDLE_TIME           ${oracleState.idleTime}`, style1);

            log(mode, "SHOW PARAMETER RESOURCE_LIMIT;", 'cmd');
            log(mode, `NAME                TYPE        VALUE`);
            log(mode, `------------------  ----------  -------`);
            const style2 = oracleState.resourceLimit === 'FALSE' ? 'vuln' : 'secure';
            log(mode, `resource_limit      boolean     ${oracleState.resourceLimit}`, style2);

            const isSecure = oracleState.idleTime !== 'UNLIMITED' && oracleState.resourceLimit === 'TRUE';
            updateStatus(mode, isSecure);
        } else {
            log(mode, "SHOW GLOBAL VARIABLES LIKE '%timeout';", 'cmd');
            log(mode, `+---------------------+-------+`);
            log(mode, `| Variable_name       | Value |`);
            log(mode, `+---------------------+-------+`);
            
            const style = mysqlState.wait === '28800' ? 'vuln' : 'secure';
            log(mode, `| interactive_timeout | ${mysqlState.interactive} |`, style);
            log(mode, `| wait_timeout        | ${mysqlState.wait} |`, style);
            log(mode, `+---------------------+-------+`);

            const isSecure = parseInt(mysqlState.wait) <= 3600;
            updateStatus(mode, isSecure);
        }
    }

    function runFix(mode) {
        if (mode === 'oracle') {
            log(mode, "ALTER PROFILE DEFAULT LIMIT IDLE_TIME 60;", 'cmd');
            oracleState.idleTime = '60';
            log(mode, "Profile altered.", 'secure');

            log(mode, "ALTER SYSTEM SET RESOURCE_LIMIT = TRUE;", 'cmd');
            oracleState.resourceLimit = 'TRUE';
            log(mode, "System altered.", 'secure');
            
            updateStatus(mode, true);
        } else {
            log(mode, "SET GLOBAL interactive_timeout = 3600;", 'cmd');
            mysqlState.interactive = '3600';
            log(mode, "Query OK, 0 rows affected (0.00 sec)", 'secure');

            log(mode, "SET GLOBAL wait_timeout = 3600;", 'cmd');
            mysqlState.wait = '3600';
            log(mode, "Query OK, 0 rows affected (0.00 sec)", 'secure');
            
            updateStatus(mode, true);
        }
    }

    function resetSim(mode) {
        if (mode === 'oracle') {
            oracleState.idleTime = 'UNLIMITED';
            oracleState.resourceLimit = 'FALSE';
            document.getElementById('term-oracle').innerHTML = `<div class="term-line">SQL> <span class="comment">-- System Reset</span></div>`;
        } else {
            mysqlState.interactive = '28800';
            mysqlState.wait = '28800';
            document.getElementById('term-mysql').innerHTML = `<div class="term-line">mysql> <span class="comment">-- System Reset</span></div>`;
        }
        updateStatus(mode, false);
    }

    function updateStatus(mode, isSecure) {
        const badge = document.getElementById(`status-${mode}`);
        if (isSecure) {
            badge.className = 'status-badge status-secure';
            badge.innerText = 'ì–‘í˜¸ (Secure)';
        } else {
            badge.className = 'status-badge status-vulnerable';
            badge.innerText = 'ì·¨ì•½ (Vulnerable)';
        }
    }
</script>
</body>
</html>